#該程式未解開Section, 採用最新樣板產出!
#該程式為freestyle程式!
{<section id="s_axcp500.description" type="s" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0093(1900-01-01 00:00:00), PR版次:0093(2021-03-31 13:35:35)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000487
#+ Filename...: s_axcp500
#+ Description: 各種成本計算類型共有的應用元件集合
#+ Creator....: 00378(2014-07-18 14:41:47)
#+ Modifier...: 00000 -SD/PR- 14589
 
{</section>}
 
{<section id="s_axcp500.global" type="s" >}
#應用 p00 樣板自動產生(Version:6)
#add-point:填寫註解說明 name="main.memo"
#150717 By zhangllc 在aoos020加一个成本参数“S-FIN-6017：联产品转出数量是否按分配率计算”
#                    如果是，就按目前的；如果不是，那么在制转出数量在计算时联产品的转出数量不需要乘以分配率
#150730 By zhangllc 一个料件的不同产品特征可能不是相同成本阶
#150810 By zhangllc 由于天和历史数据已经有把入库拆成多仓储批的入库了，必然要重计成本，目前axcp500是不支持的，所以要修正一下axcp500
#                    同时修改取金额时考虑含税否
#160408-00011   By Dido 排除 axct707 傳票
#160518-00033#2 2016/05/30 By 02295 小数点取位问题调整
#160809-00045#1 2016/08/12 By 02040 現行年月預設值改抓aoos020設定 
#160825-00022#1 2016/08/29 By Ann_Huang  修正 s_axcp500_wip_2_3()內, s_axcp500_get_xcce需傳入對應的成本域資料而非傳空白
#160902-00013#1 2016/09/02 By 00768 拆件工单xcci小数点取位问题调整
#160823-00040#1 2016/09/07 By 02295 採購入庫(委外入庫)是有多倉儲入庫的機制(pmdu_t),   但在財務立帳是是以收貨明細(pmdt_t)為立帳依據,
#                                   在入庫有應用多倉儲機制下者，有二筆的庫存異動,成本計算時, 取財務AP數據會重覆取用金額。
#160929-00019#1 2016/09/29 By lixiang s_axcp500.4gl FUNCTION s_axcp500_wip_5()中，取出xccd后，null栏位没有给0
#160906-00036#1 2016/09/29 By whitney 立賬金額0不抓入庫
#161030-00001#1 2016/10/31 By 02040   取工單資料時，需排除回收料部份
#161031-00055#1 2016/11/02 By 02040   調整工單結案後依參數設定，將金額留在差異轉出或是在製轉出
#161114-00003#1 2016/11/15 By 02040   1.抓取發退料需求檔需考慮過帳日期 2.效能調整，加上TEMP TABLE的INDEX 
#161124-00016#1 2016/11/24 By shiun   增加 xcce_tmp INDEX xcce001
#161205-00047#1 2016/12/06 By 02040   撈取工單資料需考慮開單日期
#161129-00063#1 2016/12/14 By 02040   是否可以運算成本，檢查排除axct703之單據
#161212-00077#1 2016/12/14 By 02040   imac003在後續計算成本時不會用到，故拿掉imac_t的串接
#161124-00048#20 2016/12/13 By xujing     整批调整系统RECORD LIKE xxxx_t.* 星号写法
#161202-00047#1  2016/12/23 By 02040  return時未加回傳值，造成程式關閉
#161220-00048#1  2016/12/23 By 02040  1.寫入inser into s_axcp500_tmp0 失敗，調整sql寫法 2.index 命名過長
#161229-00020#1  2016/12/29 By charles4m 將訊息透過 azzi920 設定。f
#161226-00079#1  2017/01/03 By charles4m FUNCTION s_axcp500_get_ap_sum_1() 需要乘上 apcb022
#170109-00008#1  2017/01/12 By 02040   拿掉xcbb004特性條件
#170110-00028#1  2017/01/13 By 02295   將SQL語法內的/*+ PARALLEL(4) */ 清除
#170113-00031#1  2017/01/13 By 02295   s_axcp500_sum_xcci段落：#本期本阶投入金额在處理尾差前，先判斷若xcci007 = 'DL+OH+SUB'時，先做xcci202的加總
#161219-00037#1  2017/01/17 By 02295   160906-00036#1调整的判断STATUS改成sqlca.sqlcode
#161230-00010#7  2017/01/24 By lixiang  先进先出成本调整
#161230-00010#15 2017/01/24 By lixiang  先进先出成本调整(修改先進先出在轉出DL+OH+SUB金額時，要按照每次入庫比例轉出)
#170223-00037#2  2017/02/23 By 02040    倉退折讓純金額退款，已有立帳，但無法進入在製人工費
#170223-00010#1  2017/02/23 By 00768    增加实时成本的计算逻辑
#170120-00013#1  2017/03/10 By lixiang  成本計算s_axcp500_avg.4gl
#                                       1.增加參數「當站報廢轉出」的處理
#                                       2.增加參數「超領轉出方式」的處理
#                                       3.增加參數「下階料報廢轉出方式」的處理
#161121-00018#5  2017/03/21 By 02295    增加工艺成本逻辑
#170322-00107#1  2017/03/27 By 00768    若参数“按料件特性计算成本否”为N时，sfac临时表中特征栏位给空格，以防出现多xccc的情况
#170406-00074#1  2017/04/06 By lixiang  將s_axcp500_disassemble_wip_del程式段mark，不做xcci_t、xcch_t等的刪除動作
#170418-00026#1  2017/04/19 By 02295    增加xchb_tmp的索引,效能优化
#170511-00068#1  2017/05/15 By Mandy    00768 調整客戶的追回,xccg_t 問題:本月无入库的部分不用按比率，按全部算
#170513-00005#1  2017/05/17 By 00768    本月无入库的部分写入diff的xcck资料时，排除金额为0的
#170421-00016#1  2017/05/22 By 02295    工艺成本计算存在当期资料时删除当期所有的数据
#170328-00025#1  2017/05/24 By 02295    整张工单的成本阶,如果是拆件式工单,则工单成本阶应是生产料号所对应的成本阶
#170605-00013#1  2017/06/05 By 07024    FUNCTION中DEFINE的RECORD，改成TYPE寫在inc(s_axcp500)
#                                       EX:INC=>TYPE type_g_xccc RECORD …… END RECORD ； 4gl=>DEFINE l_xxxx type_g_xccc
#170601-00051#1  2017/06/08 By 02111    將 CREATE  GLOBAL TEMPORARY TABLE xrcb_tmp 建立的語法改為一般 temptable 寫法。
#170608-00028#1  2017/06/08 By lixiang  成本計算，抓取委外加工費，無抓到AP時，會改抓委外入庫單及委外倉退單的金額。
#                                       若一張委外工單有委外入庫也有委外倉退時，無AP，會抓到委外入庫單及委外倉退單的金額，做相加，但應該是委外入庫單的金額扣掉委外倉退單的金額。
#170608-00060#1  2017/06/09 By lixiang  委外拆件工單的委外拆件入庫(xcck020='106'委外拆件入庫)，其料也要寫入xcci_t內，目前只抓xcck020='113'拆件入庫
#170609-00032#1  2017/06/13 By lixiang  写入xcci拆件入库资料后，需根据xcci的资料处理与xcck的尾差,并根据xcck的金额更新xccc的金额部分，避免与xccc存在尾差
#170502-00001#1  2017/06/15 By lixiang  对xcce301和xcci301的数量取位remark
#170620-00100#1  2017/06/22 By lixh     SQL修正
#170705-00006#1  2017/07/06 By 08734    用到除數量計算的公式时，要排除數量為0的
#170629-00004#1  2017/08/23 By lixiang  增加参数S-FIN-6025,当站下线的取价方式
#                                       1.系統設定：合計投料的單價*當站下線數量
#                                       2.人工設定：取axct314成本
#170626-00056#1  2017/09/20 By 02294    延續170609-00032問題,處理完xccc302及xccc280後，參考s_axcp500_avg.4gl的結存調整金額xccc903，更新結存調整
#170411-00032#1  2017/09/21 By 02294    增加回收料轉出方式參數S_FIN-6026
#171023-00005#1  2017/10/25 By 00531    成本計算在抓取開帳資料要不要考慮批號成本應該要參考axci100的設置
#170816-00007#104 2017/11/07 By 09773   調整公用元件錯誤訊息,顯示更明確的資訊內容
#171017-00040#1  2017/11/13 By 05599    追单处理170609-00032,处理拆件工单多次入库造成尾差的处理
#180111-00028#1  2018/01/17 BY 09042    5区s_axcp500_chk_cal段代码和1区不同，重新上传
#180129-00075#1  2018/01/31 By 02295    整张工单的成本阶,如果是拆件式工单,则工单成本阶应是备料中成本阶数值最小的成本阶
#171211-00028#13 2018/02/01 By 05423    s_axcp500_std_get_std_cost增加参数'产品特征'
#171007-00001#1  2018/03/06 By 02294    检核是否已有成本凭证重复，axcp500中已有调用s_axcp500_chk_cal
#180424-00058#1  2018/05/02 By 02295    ins xcck_tmp 报错,经检查可能是oracle 12C改成11g后的问题,程式里面有一个字段xccktmp1给其插入值
#180418-00031#1  2018/05/04 By 02295    在拆件工单处理xcci_t与xcck_t尾差后面增加同一料号同期分批发料,整数入库造成差异的处理
#                                       170609-00032此单处理的尾差放在s_axcp500_avg的xcck_5中处理
#180703-00046#1  2018/07/04 By 02295    DL+OH+SUB的投入数量,目前是给的xccd201的数量,当当期没有材料投入时为0,如果为0则DL+OH+SUB的投入数量给期初数量.
#180611-00091#1  2018/07/20 By 05423    在制人工制费转出规则S-FIN-6014=1.依实际输入时，轉出比率=(轉出數量*(SUM(1/(入庫數量*同成本中心的報工站數+約當量)/總報工站數)
#180906-00011#1  2018/09/06 By 00768    结案月有工单入库异动但数量为0会导致xccg资料缺失的情况
#181105-00008#1  2018/11/05 By 02295    xcha_tmp,xchb_tmp临时表在建立之前没有做drop的处理,导致后面创建唯一索引的时报错
#181116-00032#1  2018/11/21 By 02295    效能优化
#190225-00028#1  2019/02/27 By 02295    当参数S-FIN-6013[按料件产品特征计算成本否]为N时,需要将sfaa_tmp临时表中的sfaa011[产品特征]给空格
#190315-00053#1  2019/03/18 By 05423    180906-00011增加過濾條件：非委外拆件工單,否则会导致委外拆件工单抓不到加工费
#190416-00001#1  2019/04/16 By 02295    拆件工单委外加工费抓取时s_axcp500_get_ap_sum_1()这个函数的第一个参数应该为g_xcch.xcch001而不是g_xccd.xccd001
#190513-00024#1  2019/07/17 By 05423    效能优化：暂存档栏位仅保留需要使用到的栏位
#190808-00004#1  2019/09/18 By 02295    DL+OH+SUB的本期投入数量,当xccd201投入为0时,且xccd101期初有数量,xcce101有期初数量则xccd201的数量=0
#190919-00050#1  2019/09/24 By 02295    s_axcp500_sum_xcci()对xcci302,xcci201a~h取位后,将尾差放在数值最大的主要素上
#191003-00005#1  2019/10/09 By 10042    效能優化
#191118-00046#1  2019/11/22 By 01996    调整建立临时表的SQL,SELECT * 改为 SELECT 字段,字段,字段....
#200227-00025#1  2020/02/28 By 02295    在制委外加工费的抓取条件增加MES整合的部分制程=Y 或者 MES单号不为空 或者 MES单号 不为空(sfaa061 = 'Y' OR pmds026 IS NOT NULL OR pmdl056 IS NOT NULL)
#191230-00002#1  2020/03/24 By 02295    inaj_tmp临时表中inaj999(成本域)的字段抓取改用inaj007(库存管理特征),以成本域设置来源字段最大的码的类型給值
#200120-00015#1  2020/04/22 By 02295    效能优化
#200427-00049#1  2020/04/30 By 02295    参数调拨不影响成本='N' AND 不启用成本域 AND 不启用产品特征计算成本 AND 成本计算非批次成本条件下调拨才不参与成本计算
#200617-00029#1  2020/06/18 By 02295    拆件入库料号xcci与xcck尾差处理时,判断有差异的调整,需要增加料工费主要素的对比
#200922-00036#1  2020/09/22 By 02295    补#20200612-02295(效能优化)标记修改的内容(程式标记为20200612-02295)
#201012-00066#1  2020/10/14 By 12731    PGS 效能優化 ( index , analyze , fillfactor )
#201030-00027#5  2020/11/06 By 01534    增加參數「走簽收流程，但依出貨認列發出商品否」= 'Y'的處理
#201210-00021#1  2020/12/11 By 02295    DL+OH+SUB当期在制投入数量xcce201給值,判断元件DL+OH+SUB期初是否有数量,如果没有则给主件的期初数量+投入数量,否则给当期投入数量.
#201216-00043#2  2020/12/16 By 12731    PGS 大數據效能優化 ( update 減少使用到 index , analyze )
#201216-00027#3  2020/12/24 By 01534    axcp500 原先是判斷參數變更xcck055，改成判斷新欄位=Y時變更xcck055 (需注意程式內調撥'401'有沒有抓進去)
#210112-00009#1  2021/01/12 By 01534    新收入準則，要把簽收訂單的出貨調撥及簽退調撥成本倉給計算進去 
#210122-00003#1  2021/01/25 By 12133    增加inaj_tmp刪除條件'當為新收入準則且為簽收訂單時，一並刪除
#210125-00026#1  2021/02/26 By 02295    联产品分配方式:2:联产品分配比率且在制转出数量不按按联产品分批比率折算时,在制转出数量依实际数量计算,但金额转出按联产品分配计算
#210201-00035#1  2021/03/17 By 05423    修正移动加权成本计算时没有暂存档xcde_tmp的问题
#210312-00038#1  2021/03/18 By 13423    新收入准则,在排除调拨性质的出货单时,需要考虑旧的出货单xmdk071为空的情况,不应纳入成本计算
#210308-00004#1  2021/03/31 By 14589    改善開TEMPTABLE時,參考的欄位是inaj007 欄位長度只有10,但庫存管理特徵的長度是30導致的問題。
#end add-point
#add-point:填寫註解說明(客製用) name="main.memo_customerization"

#end add-point
#(ver:6) ---start---
#add-point:填寫註解說明(行業用) name="global.memo_industry"

#end add-point
#(ver:6) --- end ---
 
IMPORT os
#add-point:增加匯入項目 name="main.import"

#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
#add-point:增加匯入變數檔 name="global.inc"
GLOBALS "../../../com/sub/4gl/s_axcp500.inc"
#end add-point
 
{</section>}
 
{<section id="s_axcp500.free_style_variable" type="s" >}
#add-point:free_style模組變數(Module Variable) name="free_style.variable"

#end add-point
 
{</section>}
 
{<section id="s_axcp500.global_variable" type="s" >}
#add-point:自定義模組變數(Module Variable) name="global.variable"
DEFINE g_stat_cnt1            LIKE type_t.num10
DEFINE g_stat_begin1          LIKE type_t.chr8
DEFINE g_stat_end1            LIKE type_t.chr8
#170816-00007#104 by 09773 add(S)
DEFINE g_colname_1   STRING   
DEFINE g_comment_1   STRING       
DEFINE g_msg         STRING   #錯誤訊息
#170816-00007#104 by 09773 add(E)

#end add-point
 
{</section>}
 
{<section id="s_axcp500.other_dialog" type="s" >}

 
{</section>}
 
{<section id="s_axcp500.other_function" readonly="Y" type="s" >}

################################################################################
# Descriptions...: 成本计算时,数据量大的几个表做临时表
# Memo...........: axcp160_cre_tmp_table()复制了sfaa，sfac，sfdd，inaj的临时表创建，请保证2边抓数据的条件一致！
# Usage..........: CALL s_axcp500_cre_tmp_table()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-01-26 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_cre_tmp_table()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_date          LIKE type_t.dat
   
   #axcp160_cre_tmp_table()复制了sfaa，sfac，sfba，inaj的临时表创建，请保证2边抓数据的条件一致！
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   

   DROP TABLE xcck_tmp; #ODI-ORA#
   

   DROP TABLE sfaa_tmp; #ODI-ORA#

   DROP TABLE sfac_tmp;  #add zhangllc 150730 #ODI-ORA#

   DROP TABLE sfac_tmp2;  #add zhangllc 150730 #ODI-ORA#

   DROP TABLE sfdc_tmp;  #add 151205——效能可变：若s_axcp500_avg中有没用到sfdc，sfdd临时表，此处可mark #ODI-ORA#

   DROP TABLE sfdd_tmp;  #add 151205——效能可变：若s_axcp500_avg中有没用到sfdc，sfdd临时表，此处可mark #ODI-ORA#
   

   DROP TABLE inaj_tmp; #ODI-ORA#

   DROP TABLE xmdl_tmp;  #add zhangllc 151029 存销售出货样品记录，用于区分一般出货和样品出货 #ODI-ORA#

   DROP TABLE xccq_tmp;  #add zhangllc 151215 #ODI-ORA#

   DROP TABLE xccc_tmp; #ODI-ORA#

   DROP TABLE sfba_tmp; #ODI-ORA#

   DROP TABLE xccd_tmp; #ODI-ORA#

   DROP TABLE xcce_tmp; #ODI-ORA#

   DROP TABLE xccz_tmp; #ODI-ORA#

   DROP TABLE xccg_tmp; #ODI-ORA#

   DROP TABLE sale_return_tmp; #ODI-ORA#
  #--------171023-00005#1 -bigin-----add

   DROP TABLE xcca_tmp1  #ODI-ORA#

   DROP INDEX xcca_tmp1_01 #ODI-ORA#
  #--------171023-00005#1 -end-----add 

#   DROP TABLE sfaa_tmp1;   #wujie 160522 #ODI-ORA#
   #181105-00008#1---add---s

   DROP TABLE xcha_tmp; #ODI-ORA#

   DROP TABLE xchb_tmp; #ODI-ORA#
   #181105-00008#1---add---e
   #210201-00035#1 add-S
   DROP TABLE xcde_tmp;   
   #210201-00035#1 add-E


   LET l_date = g_edate
   LET l_date = l_date + 1

   #因为下面各表均是大容量的TABLE,所以尽量将 unique index的条件用上,以得快速建成此TEMP TABLE
   
  #--------171023-00005#1 -bigin-----add
   MESSAGE "cre_tmp_table:xcca_tmp1 null"  
   #1.建立临时表xcca_tmp  -- 空表
#   LET g_sql = " SELECT xcca_t.* FROM xcca_t ", #190513-00024#1 mark
   #190513-00024#1 add-S
   LET g_sql = "SELECT xccaent,xccald,xccacomp,xcca001,xcca002,xcca003,xcca004,xcca005,xcca006,xcca007,xcca008,",
               "       xcca101,xcca102,xcca102a,xcca102b,xcca102c,xcca102d,xcca102e,xcca102f,xcca102g,xcca102h,",
               "       xcca110,xcca110a,xcca110b,xcca110c,xcca110d,xcca110e,xcca110f,xcca110g,xcca110h ",
               "  FROM xcca_t ",
   #190513-00024#1 add-E
               " WHERE xccaent = ",g_enterprise,
               "   AND xccald  = '",g_ld,"'",
               "   AND xcca001 = '1' ",
               "   AND xcca003 = '",g_xcat001,"'",
               "   AND xcca004 = ",g_last_yy,
               "   AND xcca005 = ",g_last_pp,
               "   INTO TEMP xcca_tmp1 "

   PREPARE s_axcp500_cre_tmp_table_execute_p0 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p0
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p0
#201216-00043#2 mark  ---s   
#   CREATE UNIQUE INDEX xcca_tmp1_01 ON xcca_tmp1(xccaent,xccald,xcca001,xcca002,xcca003,xcca004,xcca005,xcca006,xcca007,xcca008);
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "CREATE UNIQUE INDEX xcca_tmp1_01"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
   
#&ifdef is_pgs
#   IF cl_db_generate_analyze("xcca_tmp1") THEN END IF #201012-00066#1 add   
#&endif

#201216-00043#2 mark  ---e

   IF g_cost_type <> '3' THEN #非批次成本
      UPDATE xcca_tmp1 SET xcca008 = ' '
   END IF
  #--------171023-00005#1 -bigin-----add   
   

#201216-00043#2 add  ---s
   CREATE UNIQUE INDEX xcca_tmp1_01 ON xcca_tmp1(xccaent,xccald,xcca001,xcca002,xcca003,xcca004,xcca005,xcca006,xcca007,xcca008);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcca_tmp1_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF


#201216-00043#2 add  ---e

   MESSAGE "cre_tmp_table:xcck_tmp null"  
   #1.建立临时表xcck_tmp  -- 空表


   #LET g_sql = " SELECT * FROM xcck_t ",
   LET g_sql = " SELECT xcck_t.*,xcck002 xccktmp1 FROM xcck_t ",  #mod zhangllc 151214 xccktmp1 库存管理特征,为了满足栏位长度属性，这边先用栏位xcck002给值，后面会对用inaj中的真正库存管理特征栏位给它赋值
               "  WHERE xcckent = ",g_enterprise,
               "    AND xcckld  = '",g_ld,"'",
               "    AND xcck001 = '1'",
               "    AND xcck002 = ' '",
               "    AND xcck003 = '",g_xcat001,"'",
               "    AND xcck004 = ",g_yy,
               "    AND xcck005 = ",g_pp,
               "    AND xcck006 = 'x'",
               "    AND xcck007 = 1",
               "    AND xcck008 = 1",
               "    AND xcck009 = 1",
               "   INTO TEMP xcck_tmp "


#201012-00066#1 add  ---s
#201012-00066#1 add  ---e

   PREPARE s_axcp500_cre_tmp_table_execute_p1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p1
   
   CREATE UNIQUE INDEX xcck_tmp_01 ON xcck_tmp(xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck006,xcck007,xcck008,xcck009);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcck_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

#wujie 160523 --begin

   CREATE INDEX xcck_tmp_02 ON xcck_tmp(xcckent,xcckld,xcck001,xcck003,xcck004,xcck005,xcck006,xcck047,xcck055); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcck_tmp_02"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #IF cl_db_generate_analyze("xcck_tmp") THEN END IF  #191003-00005#1 mark
#wujie 160523 --end


   CREATE INDEX xcck_tmp_03 ON xcck_tmp(xcckent,xcckld,xcck001,xcck003,xcck004,xcck005,xcck006,xcck007,xcck008,xcck009,xcck010,xcck011,xcck020,xcck047,xcck055); #161114-00003#1 add #ODI-ORA#

   CREATE INDEX tt_xcck_tmp_n1 ON xcck_tmp(xcckent,xcck047);             #161114-00003#1 add #ODI-ORA#

   CREATE INDEX xcck_tmp_04 ON xcck_tmp(xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck011,xcck010,xcck055);  #191003-00005#1 add #ODI-ORA#
   
   IF cl_db_generate_analyze("xcck_tmp") THEN END IF  #191003-00005#1 add
   
   MESSAGE "cre_tmp_table:inaj_tmp from inaj_t"  
   #2.建立临时表inaj_tmp  -- 把需要运算的inaj全部放至inaj_tmp中     
#   LET g_sql = " SELECT inaj_t.*,0 seq1,inaj008 inaj999 FROM inaj_t,imaa_t,inaa_t,ooef_t ",  #190513-00024#1 mark
   #190513-00024#1 add-S   #暂存档空间缩减
   LET g_sql = " SELECT inajent,inajsite,inaj001,inaj002,inaj003,inaj004,inaj005,inaj006,",
               "        inaj007,inaj008,inaj009,inaj010,inaj011,inaj012,inaj015,inaj016, ",
               "        inaj018,inaj020,inaj022,inaj024,inaj035,inaj036,inaj029,inaj037,",
               "        inaj038,inaj039,inaj040,inaj041,inaj042,inaj043,inaj200,inaj203,",
               #"        inaj048,inaj049,inaj211,0 seq1,inaj008 inaj999 ",   #191230-00002#1 mark
               #"        inaj048,inaj049,inaj211,0 seq1,inaj007 inaj999 ",    #191230-00002#1#PGS(D)-08172 memo mark
              #"        inaj048,inaj049,inaj211,0 seq1,inaj008 inaj999,inaj023 ",  #PGS(D)-08172 memo ad #210308-00004#1 mark
               "        inaj048,inaj049,inaj211,0 seq1,inaj007 inaj999,inaj023 ",  #PGS(D)-08172 memo ad #210308-00004#1 add  inaj008 -> inaj007
               "   FROM inaj_t,imaa_t,inaa_t,ooef_t ",
   #190513-00024#1 add-e
               " WHERE inajent = imaaent AND inajent = ",g_enterprise,
               "   AND inaj005 = imaa001 ",
               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
               "   AND inajsite = ooef001 ",
               "   AND ooefent  = inajent ",
               "   AND ooef017 = '",g_comp,"'",
               "   AND ",g_wc,
               "   AND (inaj004 = 1 OR inaj004 = -1) ",
               "   AND inaaent  = inajent ",
               "   AND inaasite = inajsite ",
               "   AND inaa001  = inaj008 ",
               "   AND inaa010  = 'Y' "  #成本库
   #IF g_sys_6001 = 'N' THEN
   #IF g_sys_6001 = 'N' AND g_sys_6018 = 'N' THEN  #mod zhangllc 150825 #系统参数[S-FIN-6018]:調撥是否納入計算 #200427-00049#1 mark
   #参数调拨不影响成本='N' AND 不启用成本域 AND 不启用产品特征计算成本 AND 成本计算非批次成本条件下调拨才不参与成本计算  #200427-00049#1
   IF g_sys_6001 = 'N' AND g_sys_6018 = 'N' AND g_cost_type <> '3' AND g_sys_6018 = 'N' THEN   #200427-00049#1
#     LET g_sql = g_sql CLIPPED,"   AND inaj036 <> '401' "   #210112-00009#1 mark
#210112-00009#1-S add
      LET g_sql = g_sql CLIPPED,"   AND ((inaj036 <> '401') OR (inaj015 = 'axmt540' AND inaj036 = '401' AND inaj004 = '-1') ",
                                "    OR (inaj015 = 'axmt590' AND inaj036 = '401' AND inaj004 = '1') ) "
#210112-00009#1-E add                                
   END IF
   #委外及采购每个单号+项次只插入一笔
   #LET g_sql = g_sql CLIPPED," AND inaj036 NOT IN ('102','108','103','104','105','106','107','109') "  #mark zhangllc 150810
   
   LET g_sql = g_sql CLIPPED,
               "   INTO TEMP inaj_tmp "

   PREPARE s_axcp500_cre_tmp_table_execute_p2 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p2
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p2
   
   #180906-00011#1 180905 add--s
   #删除工单入库部分，异动数量为0的异动资料
   DELETE FROM inaj_tmp WHERE inaj036 in ('103','104','105','106','110','111','112') AND inaj011=0
                          AND NOT EXISTS(SELECT 1 FROM sfaa_t WHERE sfaadocno = inaj020 AND sfaaent = inajent AND sfaa003 = '3' AND sfaa057 = '2') #190315-00053#1 add
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DEL inaj(The number of work orders is 0)"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #180906-00011#1 180905 add--e

#201216-00027#3-S mark
##201030-00027#5-S add
##5.s_axcp500	抓取當月inaj_t進到inaj_tmp時，判斷參數「走簽收流程，但依出貨認列發出商品否」=Y										
##	1.把inaj015=axmt540且inaj036=401且inaj004=-1(出庫) 抓進inaj_tmp，並把inaj036改成出貨(201)，成本計算時當作出貨										
##	2.inaj015=axmt590且inaj036=401且inaj004=1(入庫) 抓進inaj_tmp，並把inaj036改成銷退(202)，成本計算時當作銷退			
#   IF cl_get_para(g_enterprise,g_site,'S-FIN-1003') = '4' AND cl_get_para(g_enterprise,g_site,'S-FIN-9029') = "Y" THEN
#      UPDATE inaj_tmp SET inaj036 = '201' 
#       WHERE inaj015 = 'axmt540' AND inaj036 = '401' AND inaj004 = '-1'
#       
#      UPDATE inaj_tmp SET inaj036 = '202' 
#       WHERE inaj015 = 'axmt590' AND inaj036 = '401' AND inaj004 = '1'       
#   END IF 
##201030-00027#5-E add
#201216-00027#3-E mark

#201216-00027#3-S add
      UPDATE inaj_tmp SET inaj036 = '201' 
       WHERE inaj015 = 'axmt540' AND inaj036 = '401' AND inaj004 = '-1'
         AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno AND xmdk071 = 'Y' )
       
      UPDATE inaj_tmp SET inaj036 = '202' 
       WHERE inaj015 = 'axmt590' AND inaj036 = '401' AND inaj004 = '1'   
         AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno AND xmdk071 = 'Y' )
#201216-00027#3-E add

#210112-00009#1-S add
      DELETE FROM inaj_tmp 
       WHERE inaj015 = 'axmt540' AND inaj036 = '401' AND inaj004 = '-1'
         #AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno AND xmdk071 = 'N' )    #210122-00003#1 mark
         #210122-00003#1 add -S-
         AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno 
         #                                  AND (xmdk071 = 'N' OR (xmdk071 = 'Y' AND xmdk002 = '3') ) ) #210312-00038#1  mark 
                                            AND (xmdk071 = 'N' OR xmdk071 IS NULL OR (xmdk071 = 'Y' AND xmdk002 = '3') ) ) #210312-00038#1  add 
         #210122-00003#1 add -E-
       
      DELETE FROM inaj_tmp 
       WHERE inaj015 = 'axmt590' AND inaj036 = '401' AND inaj004 = '1'   
         #AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno AND xmdk071 = 'N' )    #210122-00003#1 mark
         #210122-00003#1 add -S-
         AND EXISTS (SELECT 1 FROM xmdk_t WHERE inajent = xmdkent AND inajsite = xmdksite AND inaj001 = xmdkdocno 
          #                                  AND (xmdk071 = 'N'  OR (xmdk071 = 'Y' AND xmdk002 = '3') ) ) #210312-00038#1  mark
                                             AND (xmdk071 = 'N'  OR xmdk071 IS NULL  OR (xmdk071 = 'Y' AND xmdk002 = '3') ) ) #210312-00038#1  add
         
         #210122-00003#1 add -E-
#210112-00009#1-E add


#wujie 160325 --begin
#201216-00043#2 mark  ---s
#&ifdef is_ora
#   CREATE INDEX inaj_tmp_i02 ON inaj_tmp(inajent,inajsite,inaj008,inaj010,inaj020,inaj036,inaj022); #ODI-ORA#
#&endif
#&ifdef is_pgs
#   CREATE INDEX IF NOT EXISTS inaj_tmp_i02 ON inaj_tmp(inajent,inajsite,inaj008,inaj010,inaj020,inaj036,inaj022); #ODI-PGS#
#&endif
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "CREATE UNIQUE INDEX inaj_tmp_i02"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   IF cl_db_generate_analyze("inaj_tmp") THEN END IF  
#wujie 160325 --end  
#wujie 160520 --begin


#&ifdef is_ora
#   CREATE INDEX inaj_tmp_i03 ON inaj_tmp(inajent,inajsite,inaj008,inaj020,inaj036,inaj022); #ODI-ORA#
#&endif
#&ifdef is_pgs
#   CREATE INDEX IF NOT EXISTS inaj_tmp_i03 ON inaj_tmp(inajent,inajsite,inaj008,inaj020,inaj036,inaj022); #ODI-PGS#
#   CREATE INDEX IF NOT EXISTS inaj_test ON inaj_tmp (inajent,inaj020,inaj036,inaj022); # 201012-00066#1 add
#&endif

#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "CREATE UNIQUE INDEX inaj_tmp_i03"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   IF cl_db_generate_analyze("inaj_tmp") THEN END IF 
#wujie 160520 --end
#201216-00043#2 mark  ---e
   #mark zhangllc 150810
   ##委外/采购处理 - 单号+项次+项序,只取一笔,即项序=0
   #LET g_sql = " INSERT INTO inaj_tmp ",
   #            " SELECT a.*,inaj008 inaj999 FROM (",

   #            "  SELECT inaj_t.*,ROW_NUMBER() OVER ( PARTITION BY inajent,inajsite,inaj001,inaj002 ORDER BY inaj003,inaj004 ) seq1", #ODI-ORA#
   #            "    FROM inaj_t,imaa_t,inaa_t,ooef_t ",
   #            "   WHERE inajent = imaaent AND inajent = ",g_enterprise,
   #            "     AND inaj005 = imaa001 ",
   #            "     AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
   #            "     AND inajsite = ooef001 ",
   #            "     AND ooefent  = inajent ",
   #            "     AND ooef017 = '",g_comp,"'",
   #            "     AND ",g_wc,
   #            "     AND (inaj004 = 1 OR inaj004 = -1) ",
   #            "     AND inaaent  = inajent ",
   #            "     AND inaasite = inajsite ",
   #            "     AND inaa001  = inaj008 ",
   #            "     AND inaa010  = 'Y' ",
   #            "     AND inaj036 IN ('102','108','103','104','105','106','107','109') ) a ",
   #            " WHERE seq1 = 1"
   #            --"  INTO TEMP inaj_tmp "
   #PREPARE s_axcp500_cre_tmp_table_execute_p10 FROM g_sql
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p10"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   #EXECUTE s_axcp500_cre_tmp_table_execute_p10
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p10"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   #FREE s_axcp500_cre_tmp_table_execute_p10
   #
   ##此笔项序=0的资料的数量要为各项序的合计值
   #LET g_sql = " MERGE INTO inaj_tmp a",
   #            "       USING (SELECT inajent,inajsite,inaj001,inaj002,inaj004,SUM(inaj011*inaj014) inaj011,imaa006   ",
   #            "                FROM inaj_t,imaa_t     ",                         
   #            "                WHERE inajent = imaaent AND inajent = ",g_enterprise,
   #            "                  AND inaj005 = imaa001 ",
   #            "                  AND inaj036 IN ('102','108','103','104','105','106','107','109') ",
   #            "                GROUP BY inajent,inajsite,inaj001,inaj002,inaj004,imaa006",
   #            "                ) b ",
   #            "          ON ( a.inajent   = b.inajent  ",
   #            "         AND   a.inajsite  = b.inajsite ",
   #            "         AND   a.inaj001   = b.inaj001  ",
   #            "         AND   a.inaj002   = b.inaj002  ",
   #            "         AND   a.inaj004   = b.inaj004  )",
   #            "  WHEN MATCHED THEN    ",
   #            "     UPDATE SET a.inaj003  = 0,           ",
   #            "                a.inaj011  = b.inaj011 ,  ",
   #            "                a.inaj012  = b.imaa006 ,  ",
   #            "                a.inaj014  = 1            "
   #            
   #PREPARE s_axcp500_cre_tmp_table_execute_p11 FROM g_sql
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p11"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   #EXECUTE s_axcp500_cre_tmp_table_execute_p11
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p11"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   #FREE s_axcp500_cre_tmp_table_execute_p11  
   #mark zhangllc 150810 end             
               
   
   UPDATE inaj_tmp SET inaj999 = ' '
   
   #成本域
   CASE g_field_type
        WHEN '1'  #组织
             UPDATE inaj_tmp SET inaj999 = ( SELECT xcbf001 FROM xcbf_t WHERE xcbfent  = inajent
                                                                          AND xcbfcomp = g_comp
                                                                          AND xcbf002  = inajsite )
        WHEN '2'  #仓库
             UPDATE inaj_tmp SET inaj999 = ( SELECT xcbf001 FROM xcbf_t WHERE xcbfent  = inajent
                                                                          AND xcbfcomp = g_comp
                                                                          AND xcbf002  = inaj008 )
        WHEN '3'  #库存管理特征
             UPDATE inaj_tmp SET inaj999 = inaj007
        OTHERWISE
             UPDATE inaj_tmp SET inaj999 = ' '    

   END CASE
   UPDATE inaj_tmp SET inaj999 = ' ' WHERE inaj999 IS NULL
   
   #批次
   IF g_cost_type <> '3' THEN #非批次成本
      UPDATE inaj_tmp SET inaj010 = ' '
   END IF 

   #成本计算细度:料件+特征
   IF g_sys_6013 = 'N' THEN
      UPDATE inaj_tmp SET inaj006 = ' '
   END IF


   CREATE UNIQUE INDEX inaj_tmp_01 ON inaj_tmp(inajent,inajsite,inaj001,inaj002,inaj003,inaj004);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX inaj_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #add zhangllc 151205

#201216-00043#2 add  ---s
   CREATE INDEX inaj_tmp_i02 ON inaj_tmp(inajent,inajsite,inaj008,inaj010,inaj020,inaj036,inaj022); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX inaj_tmp_i02"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   CREATE INDEX inaj_tmp_i03 ON inaj_tmp(inajent,inajsite,inaj008,inaj020,inaj036,inaj022); #ODI-ORA#


   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX inaj_tmp_i03"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
#201216-00043#2 add  ---e

   CREATE INDEX inaj_tmp_02 ON inaj_tmp(inajent,inajsite,inaj001,inaj002,inaj003); #ODI-ORA#

   CREATE INDEX inaj_tmp_03 ON inaj_tmp(inajent,inajsite,inaj001,inaj002,inaj003,inaj036,inaj015); #ODI-ORA#

   CREATE INDEX inaj_tmp_04 ON inaj_tmp(inajent,inajsite,inaj008,inaj020,inaj022,inaj036); #add zhangllc 160323 #ODI-ORA#
   IF cl_db_generate_analyze("inaj_tmp") THEN END IF   #wujie 160521 inaj_t -->inajtmp
   #add zhangllc 151205 end
   
   #add zhangllc 151029 --begin
   #销售出货中的样品出货
   IF g_sys_6019 = 'Y' THEN   #样品单独列示
      MESSAGE "cre_tmp_table:xmdl_tmp from xmdl_t"  
      LET g_sql = " SELECT xmdldocno,xmdlseq FROM xmdl_t ", 
                  "  WHERE xmdlent = ",g_enterprise,
                  "    AND xmdl007 = '9' ",  #样品                  
                  "   INTO TEMP xmdl_tmp "
      PREPARE s_axcp500_cre_tmp_table_xmdl_p FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_xmdl_p"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      EXECUTE s_axcp500_cre_tmp_table_xmdl_p
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_xmdl_p"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      FREE s_axcp500_cre_tmp_table_xmdl_p
      
      CREATE UNIQUE INDEX xmdlseq_0 ON xmdl_tmp(xmdldocno,xmdlseq);
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "CREATE UNIQUE INDEX xmdlseq_0"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
   END IF
   #add zhangllc 151029 --end
   
   
   MESSAGE "cre_tmp_table:sfaa_tmp from sfaa_t"  
   #3.建立临时表sfaa_tmp  -- 把需要运算的SFAA全部放至sfaa_tmp中
   LET l_date = g_edate
   LET l_date = l_date + 1              
#   LET g_sql = " SELECT sfaa_t.*,'N' isgywwrk FROM sfaa_t,ooef_t,imaa_t ",  #mod zhangllc 160131 add 'N' isgywwrk工艺委外入库 #190513-00024#1 mark
   #190513-00024#1 add-S   #去掉未使用到的字段
   LET g_sql = " SELECT sfaaent,sfaasite,sfaadocno,sfaadocdt,sfaa003,sfaa010,sfaa011,sfaa012,",
               "        sfaa013,sfaa028,sfaa042,sfaa048,sfaa057,'N' isgywwrk ",
               "   FROM sfaa_t,ooef_t,imaa_t ",
   #190513-00024#1 add-E
               " WHERE sfaaent = ",g_enterprise,
#              "   AND sfaa003 <> '4' ",                               #研发工单
               "   AND (sfaa048 IS NULL OR sfaa048 >= '",g_bdate,"')", #成会结案日期
               "   AND sfaadocdt <= '",g_edate,"'",                    #开单日期  #161205-00047#1 remark
               "   AND sfaastus IN ('Y','F','C','E','M') ",            #单据状态
               "   AND ooefent = sfaaent ",
               "   AND ooef001 = sfaasite ",
               "   AND ooef017 = '",g_comp,"'",
               "   AND imaaent = ",g_enterprise,
               "   AND sfaa010 = imaa001 ",
               "   AND ",g_wc CLIPPED,
               "   INTO TEMP sfaa_tmp "
               
   PREPARE s_axcp500_cre_tmp_table_execute_p3 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p3"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p3
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p3"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF


   FREE s_axcp500_cre_tmp_table_execute_p3


   CREATE INDEX tt_sfaa_tmp_n1 ON sfaa_tmp(sfaaent,sfaa003,sfaa048,sfaa010,sfaadocno); #161114-00003#1 add #ODI-ORA#
   
   #以后各期的工单也置入sfaa_tmp中了,要把开工日期大于本期,且本期没有异动的工作单砍掉
   DELETE FROM sfaa_tmp WHERE sfaadocdt >= l_date
                          AND sfaadocno NOT IN ( SELECT inaj020 FROM inaj_tmp)
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DELETE sfaa_tmp "
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
               
   CREATE UNIQUE INDEX sfaa_tmp_01 ON sfaa_tmp(sfaaent,sfaadocno );
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfaa_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #add zhangllc 160323

   CREATE INDEX sfaa_tmp_02 ON sfaa_tmp(sfaaent,sfaadocno,sfaa042) #ODI-ORA#
   IF cl_db_generate_analyze("sfaa_tmp") THEN END IF
   #add zhangllc 160323 end
   
   #190225-00028#1---add---s
   IF g_sys_6013 = 'N' THEN
      UPDATE sfaa_tmp SET sfaa011 = ' '
   END IF
   #190225-00028#1---add---e   
   
   
   #add zhangllc 160131 --begin
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO sfaa_tmp a",
               " USING (SELECT DISTINCT pmdp003 FROM pmds_t,pmdt_t,pmdp_t,sfaa_t ",  #工单
               "              ,pmdl_t ",  #200227-00025#1 add
               "        WHERE pmdsent = pmdtent AND pmdsdocno = pmdtdocno ",
               "          AND pmdpent = pmdtent AND pmdpdocno = pmdt001 AND pmdpseq = pmdt002 AND pmdpseq1  = pmdt003 ",
               "          AND sfaaent = pmdpent AND sfaadocno = pmdp003 ",
               "          AND pmdtent = pmdlent AND pmdt001 = pmdldocno ",  #200227-00025#1
               "          AND pmdsent = ",g_enterprise,
               "          AND pmdssite IN(SELECT ooef001 FROM ooef_t WHERE ooefent = ",g_enterprise,
               "                              AND ooefstus ='Y' AND ooef017 ='",g_comp,"') ",
               "          AND pmds011 = '2' ",  #采购性质:2委外采购
               "          AND pmds001 BETWEEN '",g_bdate,"' AND '",g_edate,"'", #扣帐日期
               "          AND pmdsstus = 'S' ", #已委外入库过账
               #"         AND sfaa061 = 'Y'   ", #制程否     #200227-00025#1 mark
               "          AND (sfaa061 = 'Y' OR pmds026 IS NOT NULL OR pmdl056 IS NOT NULL) ",  #200227-00025#1
               "          AND sfaa057 NOT IN ('2') ",  #工单类型：委外
               "      ) b ",
               "          ON ( a.sfaadocno  = b.pmdp003  )",
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET a.isgywwrk  = 'Y' "  #有工艺委外入库
   #PGS(D)-00824 --- end ---
   PREPARE s_axcp500_upd_temp_table_sfaa_p1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_sfaa_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_upd_temp_table_sfaa_p1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_sfaa_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_upd_temp_table_sfaa_p1 
   #add zhangllc 160131 --end

#   SELECT * FROM sfaa_tmp INTO TEMP sfaa_tmp1  #wujie 160522   为最后离开成本阶循环后更新xccd专用，不要拿来做别的用，没有index，使用影响效能的！
#wujie 160523 --begin
   #190513-00024#1 mark-S #该暂存档在成本运算时未使用到，故mark掉节省空间
#   LET g_sql = "SELECT * FROM xcbk_t ",
#               " WHERE xcbkent = ",g_enterprise,
#               "   AND xcbkld  = '",g_ld,"'",
#               "   AND xcbk001 = '",g_xcat001,"'",
#               "   AND xcbk002 = ",g_yy,
#               "   AND xcbk003 = ",g_pp,
#               "   INTO TEMP xcbk_tmp "
#               
#   PREPARE s_axcp500_cre_tmp_table_execute_p12 FROM g_sql
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p12"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#
#   EXECUTE s_axcp500_cre_tmp_table_execute_p12
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p12"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   

#   CREATE INDEX xcbk_tmp_01 ON xcbk_tmp(xcbkent,xcbkld,xcbk001,xcbk002,xcbk003,xcbk005,xcbk006) #ODI-ORA#
#   IF cl_db_generate_analyze("xcbk_tmp") THEN END IF
   #190513-00024#1 mark-E
#wjie 160523 --end

   MESSAGE "cre_tmp_table:sfac_tmp from sfac_t/sfba"  
   #mod zhangllc 160531 SBS7 add sfacsite
   #add zhangllc 150730 --begin
   #建立临时表sfac_tmp  -- 把需要运算的sfac全部放至sfac_tmp中  产品特征使用  
   #LET g_sql = " SELECT sfac_t.*,0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ",    #mod zhangllc 151109 add islevel
   #                           工单      料       产品特征
   #LET g_sql = " SELECT unique sfacdocno,sfac001,sfac006,0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ",  #mod zhangllc 151110
   LET g_sql = " SELECT unique sfacdocno,sfacsite,sfac001,NVL(sfac006,' ') sfac006,0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ",  #mod zhangllc 151110 #mod zhangllc 160528 SBS3提升效能
               "  WHERE sfacent   = sfaaent ",
               "    AND sfacdocno = sfaadocno ",
               "    AND sfac001   = sfaa010  ",  #生产料件
               #add zhangllc 151110
               "    AND sfaaent   = ",g_enterprise,
               "    AND sfaa003 != '3' ",   #非拆件
               "    AND sfac002 != '5' ",   #161030-00001#1 #排除回收料
               " UNION ",
               #" SELECT unique sfbadocno,sfba006,sfba021,0 clevel,'N' islevel FROM sfaa_tmp,sfba_t ",
               " SELECT unique sfbadocno,sfbasite,sfba006,NVL(sfba021,' '),0 clevel,'N' islevel FROM sfaa_tmp,sfba_t ", #mod zhangllc 160528 SBS3提升效能
               "  WHERE sfbaent   = sfaaent ",
               "    AND sfbadocno = sfaadocno ",
               "    AND sfba006   = sfaa010  ",  #生产料件
               "    AND sfaaent   = ",g_enterprise,
               "    AND sfaa003  = '3' ", #拆件
               #end add zhangllc 151110
               ##add zhangllc 160406  拆件式工单也再抓取下sfac档中的，入库的可能不是备料
               #" UNION ",
               ##" SELECT unique sfacdocno,sfacsite,sfac001,sfac006,0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ",
               #" SELECT unique sfacdocno,sfac001,NVL(sfac006,' '),0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ", #mod zhangllc 160528 SBS3提升效能
               #"  WHERE sfacent   = sfaaent ",
               #"    AND sfacdocno = sfaadocno ",
               #"    AND sfaaent   = ",g_enterprise,
               #"    AND sfaa003  = '3' ", #拆件
               ##end add zhangllc 160406
               #161030-00001#1-s-add
               #add zhangllc 160406  拆件式工单也再抓取下sfac档中的，入库的可能不是备料
               " UNION ",
               " SELECT unique sfacdocno,sfacsite,sfac001,NVL(sfac006,' '),0 clevel,'N' islevel FROM sfaa_tmp,sfac_t ",
               "  WHERE sfacent   = sfaaent ",
               "    AND sfacdocno = sfaadocno ",
               "    AND sfaaent   = ",g_enterprise,
               "    AND sfac002 != '5'",                
               #161030-00001#1-e-add
               "   INTO TEMP sfac_tmp "
   PREPARE s_axcp500_cre_tmp_table_execute_p3_1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p3_1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_cre_tmp_table_execute_p3_1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p3_1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_cre_tmp_table_execute_p3_1

   #CREATE UNIQUE INDEX sfac_tmp_01 ON sfac_tmp(sfacent,sfacdocno,sfacseq );

   CREATE INDEX sfac_tmp_01 ON sfac_tmp(sfacdocno); #mod zhangllc 151110 #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfac_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   IF cl_db_generate_analyze("sfac_tmp") THEN END IF
   
   #UPDATE sfac_tmp SET sfac006 = ' ' WHERE sfac006 IS NULL  #空置空格  #mark zhangllc 160528 SBS3提升效能
   
   #170322-00107#1 add--s
   IF g_sys_6013 = 'N' THEN
      UPDATE sfac_tmp SET sfac006 = ' '
   END IF
   #170322-00107#1 add--e
   
   MESSAGE "cre_tmp_table:sfac_tmp2 from sfac_tmp"  
   #建立临时表sfac_tmp2  -- 把sfac_tmp中提炼为工单，主件计算所处成本阶  
   #成本阶栏位，若一个工单的生产料号有多个特征的，则clevel栏位存成本阶最小的，即数字最大的
   #mod zhangllc SBS7 add sfacsite
   LET g_sql = " SELECT unique sfacdocno,sfacsite,clevel FROM sfac_tmp ",  
               "   INTO TEMP sfac_tmp2 "
   PREPARE s_axcp500_cre_tmp_table_execute_p3_2 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p3_2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_cre_tmp_table_execute_p3_2
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p3_2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_cre_tmp_table_execute_p3_2

   CREATE UNIQUE INDEX sfac_tmp2_0 ON sfac_tmp2(sfacdocno);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfac_tmp2_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   CREATE  INDEX sfac_tmp2_1 ON sfac_tmp2(clevel);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfac_tmp2_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #IF cl_db_generate_analyze("sfac_tmp2") THEN END IF  #201216-00043#2 mark
   #add zhangllc 150730 --end
   
   CREATE  INDEX sfac_tmp2_2 ON sfac_tmp2(sfacdocno,clevel);    #161114-00003#1 add 

   
   MESSAGE "cre_tmp_table:sfdc_tmp from sfdc_t"  
  #add zhangllc 151205 解决效能问题——效能可变：若s_axcp500_avg中有没用到sfdc，sfdd临时表，此处可mark
  #5.建立临时表sfdc_tmp  -- 把需要运算的sfdc全部放至sfdc_tmp中   
  #LET g_sql = " SELECT sfdc_t.* FROM sfaa_tmp,sfdc_t ",        #161114-00003#1 mark 
#   LET g_sql = " SELECT sfdc_t.* FROM sfaa_tmp,sfdc_t ,sfda_t", #161114-00003#1 add #190513-00024#1 mark
   #190513-00024#1 add-S
   LET g_sql = " SELECT sfdcent,sfdcdocno,sfdcseq,sfdc001,sfdc002,sfdc003 ",  #20200612-02295 add sfdc003
               "   FROM sfaa_tmp,sfdc_t,sfda_t ",
   #190513-00024#1 add-E
               "  WHERE sfdcent   = sfaaent ",
               "    AND sfdc001   = sfaadocno ",
              #161114-00003#1-s-add 
               "    AND sfdaent = sfaaent ",                  
               "    AND sfdadocno = sfdcdocno ",             
               #"    AND sfda001 > = '",g_bdate,"' AND sfda001 <='",g_edate,"'",    #PGS-(D)-03080 mark
               "    AND sfda001 >= '",g_bdate,"' AND sfda001 <='",g_edate,"'",      #PGS-(D)-03080
              #161114-00003#1-e-add 
               "   INTO TEMP sfdc_tmp "

   PREPARE s_axcp500_cre_sfdc_tmp_execute_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_sfdc_tmp_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_cre_sfdc_tmp_execute_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_sfdc_tmp_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_cre_sfdc_tmp_execute_p
   
   CREATE UNIQUE INDEX sfdc_tmp_pk ON sfdc_tmp(sfdcent,sfdcdocno,sfdcseq );
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfdc_tmp_pk"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   #CREATE INDEX sfdc_tmp_01 ON sfdc_tmp(sfdcent,sfdcdocno,sfdcseq,sfdc001,sfdc002 ); #ODI-ORA#
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "CREATE UNIQUE INDEX sfdc_tmp_01"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF

   #161114-00003#1-s-add
   #b add by zwr 16.10.20 增加索引   

   CREATE INDEX sfdc_tmp_01 ON sfdc_tmp(sfdcent,sfdcdocno,sfdcseq,sfdc001,sfdc002 ); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfdc_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #e add by zwr 16.10.20 增加索引
   #161114-00003#1-e-add
   
   IF cl_db_generate_analyze("sfdc_tmp") THEN END IF
   
   MESSAGE "cre_tmp_table:sfdd_tmp from sfdd_t"  
   #5.建立临时表sfdd_tmp  -- 把需要运算的sfdd全部放至sfdd_tmp中
#   LET g_sql = " SELECT sfdd_t.* FROM sfdd_t,sfdc_tmp ", #190513-00024#1 mark
   #190513-00024#1 add-S
   LET g_sql = " SELECT sfddent,sfddsite,sfdddocno,sfddseq,sfddseq1,sfdd001,sfdd013 ",
               "   FROM sfdd_t,sfdc_tmp ",
   #190513-00024#1 add-E
               "  WHERE sfdcent   = sfddent ",
               "    AND sfdcdocno = sfdddocno ",
               "    AND sfdcseq   = sfddseq ",
               "   INTO TEMP sfdd_tmp "

   PREPARE s_axcp500_cre_sfdd_tmp_execute_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_sfdd_tmp_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_cre_sfdd_tmp_execute_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_sfdd_tmp_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_cre_sfdd_tmp_execute_p
   
   CREATE UNIQUE INDEX sfdd_tmp_pk ON sfdd_tmp(sfddent,sfdddocno,sfddseq,sfddseq1 );
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfdd_tmp_pk"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #161114-00003#1-s-add
   #b add by zwr 16.10.20 增加索引

   CREATE INDEX sfdd_tmp_01 ON sfdd_tmp(sfddent,sfddsite,sfdddocno,sfddseq,sfddseq1,sfdd001); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfdd_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #b add by zwr 16.10.20 增加索引
   #161114-00003#1-e-add
   

   #CREATE INDEX sfdd_tmp_01 ON sfdd_tmp(sfddent,sfddsite,sfdddocno,sfddseq,sfddseq1,sfdd001); #ODI-ORA#
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "CREATE UNIQUE INDEX sfdd_tmp_01"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   IF cl_db_generate_analyze("sfdd_tmp") THEN END IF
   #add zhangllc 151205 end
   
   IF g_sys_6021 = 'Y' THEN  #add zhangllc 160526 --SBS1
      MESSAGE "cre_tmp_table:xccq_tmp null"  
      #add zhangllc 151215 --begin
      #4.建立临时表xccq_tmp
#     LET g_sql = " SELECT * FROM xccq_t ",  #191118-00046#1 mark
      #191118-00046#1 add(s)


      LET g_sql = "SELECT xccqent,xccqcomp,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,xccq006,",
                  "       xccq007,xccq008,xccq009,xccq010,xccq011,xccq012,xccq101,xccq102,xccq102a,xccq102b,",
                  "       xccq102c,xccq102d,xccq102e,xccq102f,xccq102g,xccq102h,xccq201,xccq202,xccq202a,xccq202b,",
                  "       xccq202c,xccq202d,xccq202e,xccq202f,xccq202g,xccq202h,xccq203,xccq204,xccq204a,xccq204b,",
                  "       xccq204c,xccq204d,xccq204e,xccq204f,xccq204g,xccq204h,xccq205,xccq206,xccq206a,xccq206b,",
                  "       xccq206c,xccq206d,xccq206e,xccq206f,xccq206g,xccq206h,xccq207,xccq208,xccq208a,xccq208b,",
                  "       xccq208c,xccq208d,xccq208e,xccq208f,xccq208g,xccq208h,xccq209,xccq210,xccq210a,xccq210b,",
                  "       xccq210c,xccq210d,xccq210e,xccq210f,xccq210g,xccq210h,xccq211,xccq212,xccq212a,xccq212b,",
                  "       xccq212c,xccq212d,xccq212e,xccq212f,xccq212g,xccq212h,xccq213,xccq214,xccq214a,xccq214b,",
                  "       xccq214c,xccq214d,xccq214e,xccq214f,xccq214g,xccq214h,xccq215,xccq216,xccq216a,xccq216b,",
                  "       xccq216c,xccq216d,xccq216e,xccq216f,xccq216g,xccq216h,xccq217,xccq218,xccq218a,xccq218b,",
                  "       xccq218c,xccq218d,xccq218e,xccq218f,xccq218g,xccq218h,xccq280,xccq280a,xccq280b,xccq280c,",
                  "       xccq280d,xccq280e,xccq280f,xccq280g,xccq280h,xccq301,xccq302,xccq302a,xccq302b,xccq302c,",
                  "       xccq302d,xccq302e,xccq302f,xccq302g,xccq302h,xccq303,xccq304,xccq304a,xccq304b,xccq304c,",
                  "       xccq304d,xccq304e,xccq304f,xccq304g,xccq304h,xccq305,xccq306,xccq306a,xccq306b,xccq306c,",
                  "       xccq306d,xccq306e,xccq306f,xccq306g,xccq306h,xccq307,xccq308,xccq308a,xccq308b,xccq308c,",
                  "       xccq308d,xccq308e,xccq308f,xccq308g,xccq308h,xccq309,xccq310,xccq310a,xccq310b,xccq310c,",
                  "       xccq310d,xccq310e,xccq310f,xccq310g,xccq310h,xccq311,xccq312,xccq312a,xccq312b,xccq312c,",
                  "       xccq312d,xccq312e,xccq312f,xccq312g,xccq312h,xccq313,xccq314,xccq314a,xccq314b,xccq314c,",
                  "       xccq314d,xccq314e,xccq314f,xccq314g,xccq314h,xccq401,xccq402,xccq901,xccq902,xccq902a,",
                  "       xccq902b,xccq902c,xccq902d,xccq902e,xccq902f,xccq902g,xccq902h,xccq903,xccq903a,xccq903b,",
                  "       xccq903c,xccq903d,xccq903e,xccq903f,xccq903g,xccq903h,xccqtime ",
                  "  FROM xccq_t ",
      #191118-00046#1 add(e)
                  "  WHERE xccqent = ",g_enterprise,
                  "    AND xccqld  = '",g_ld,"'",
                  "    AND xccqsite= '",g_site,"'",
                  "    AND xccq001 = '1'",
                  "    AND xccq002 = ' '",
                  "    AND xccq003 = '",g_xcat001,"'",
                  "    AND xccq004 = ",g_yy,
                  "    AND xccq005 = ",g_pp,
                  "    AND xccq006 = 'x'",
                  "    AND xccq007 = 1",
                  "    AND xccq008 = 1",
                  "    AND xccq009 = ' '",
                  "    AND xccq010 = ' '",
                  "    AND xccq011 = ' '",
                  "    AND xccq012 = ' '",
                  "   INTO TEMP xccq_tmp "

#201012-00066#1 add  ---s
#201012-00066#1 add  ---e
      
      PREPARE s_axcp500_cre_tmp_table_execute_p4_xccq FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p4_xccq"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      
      EXECUTE s_axcp500_cre_tmp_table_execute_p4_xccq
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p4_xccq"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      FREE s_axcp500_cre_tmp_table_execute_p4_xccq   
      
      CREATE UNIQUE INDEX xccq_tmp_01 ON xccq_tmp(xccqent,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,xccq006,xccq007,xccq008,xccq009,xccq010,xccq011,xccq012);
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "CREATE UNIQUE INDEX xccq_tmp_01"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      #add zhangllc 151215 --end
   END IF   #add zhangllc 160526 --SBS1


   MESSAGE "cre_tmp_table:xccc_tmp null"  
   #4.建立临时表xccc_tmp
#   LET g_sql = " SELECT * FROM xccc_t ",    #191118-00046#1 mark 
    #191118-00046#1 add(s)
    LET g_sql = "SELECT xcccent,xccccomp,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,xccc006,xccc007,",
                "       xccc008,xccc010,xccc101,xccc102,xccc102a,xccc102b,xccc102c,xccc102d,xccc102e,xccc102f,",
                "       xccc102g,xccc102h,xccc201,xccc202,xccc202a,xccc202b,xccc202c,xccc202d,xccc202e,xccc202f,",
                "       xccc202g,xccc202h,xccc203,xccc204,xccc204a,xccc204b,xccc204c,xccc204d,xccc204e,xccc204f,",
                "       xccc204g,xccc204h,xccc205,xccc206,xccc206a,xccc206b,xccc206c,xccc206d,xccc206e,xccc206f,",
                "       xccc206g,xccc206h,xccc207,xccc208,xccc208a,xccc208b,xccc208c,xccc208d,xccc208e,xccc208f,",
                "       xccc208g,xccc208h,xccc209,xccc210,xccc210a,xccc210b,xccc210c,xccc210d,xccc210e,xccc210f,",
                "       xccc210g,xccc210h,xccc211,xccc212,xccc212a,xccc212b,xccc212c,xccc212d,xccc212e,xccc212f,",
                "       xccc212g,xccc212h,xccc213,xccc214,xccc214a,xccc214b,xccc214c,xccc214d,xccc214e,xccc214f,",
                "       xccc214g,xccc214h,xccc215,xccc216,xccc216a,xccc216b,xccc216c,xccc216d,xccc216e,xccc216f,",
                "       xccc216g,xccc216h,xccc217,xccc218,xccc218a,xccc218b,xccc218c,xccc218d,xccc218e,xccc218f,",
                "       xccc218g,xccc218h,xccc280,xccc280a,xccc280b,xccc280c,xccc280d,xccc280e,xccc280f,xccc280g,",
                "       xccc280h,xccc301,xccc302,xccc302a,xccc302b,xccc302c,xccc302d,xccc302e,xccc302f,xccc302g,",
                "       xccc302h,xccc303,xccc304,xccc304a,xccc304b,xccc304c,xccc304d,xccc304e,xccc304f,xccc304g,",
                "       xccc304h,xccc305,xccc306,xccc306a,xccc306b,xccc306c,xccc306d,xccc306e,xccc306f,xccc306g,",
                "       xccc306h,xccc307,xccc308,xccc308a,xccc308b,xccc308c,xccc308d,xccc308e,xccc308f,xccc308g,",
                "       xccc308h,xccc309,xccc310,xccc310a,xccc310b,xccc310c,xccc310d,xccc310e,xccc310f,xccc310g,",
                "       xccc310h,xccc311,xccc312,xccc312a,xccc312b,xccc312c,xccc312d,xccc312e,xccc312f,xccc312g,",
                "       xccc312h,xccc313,xccc314,xccc314a,xccc314b,xccc314c,xccc314d,xccc314e,xccc314f,xccc314g,",
                "       xccc314h,xccc401,xccc402,xccc901,xccc902,xccc902a,xccc902b,xccc902c,xccc902d,xccc902e,",
                "       xccc902f,xccc902g,xccc902h,xccc903,xccc903a,xccc903b,xccc903c,xccc903d,xccc903e,xccc903f,",
                "       xccc903g,xccc903h,xccctime ",
                " FROM xccc_t ",
    #191118-00046#1 add(e)
               "  WHERE xcccent = ",g_enterprise,
               "    AND xcccld  = '",g_ld,"'",
               "    AND xccc001 = '1'",
               "    AND xccc002 = ' '",
               "    AND xccc003 = '",g_xcat001,"'",
               "    AND xccc004 = ",g_yy,
               "    AND xccc005 = ",g_pp,
               "    AND xccc006 = 'x'",
               "    AND xccc007 = 1",
               "    AND xccc008 = 1",
               "   INTO TEMP xccc_tmp "


#201012-00066#1 add  ---s
#201012-00066#1 add  ---e

   PREPARE s_axcp500_cre_tmp_table_execute_p4 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p4"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p4
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p4"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p4   

   CREATE UNIQUE INDEX xccc_tmp_01 ON xccc_tmp(xcccent,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,xccc006,xccc007,xccc008);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xccc_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   IF cl_db_generate_analyze("xccc_tmp") THEN END IF  #191003-00005#1 add
   
   MESSAGE "cre_tmp_table:sfba_tmp from sfba_t"  
   #5.建立临时表sfba_tmp  -- 把需要运算的sfba全部放至sfba_tmp中
              
#   LET g_sql = " SELECT sfba_t.* FROM sfaa_tmp,sfba_t ", #190513-00024#1 mark
   #190513-00024#1 add-S
   LET g_sql = " SELECT sfbaent,sfbasite,sfbadocno,sfbaseq,sfbaseq1,sfba003,sfba006,sfba008,",
               "        sfba010,sfba011,sfba012,sfba013,sfba014,sfba015,sfba016,sfba017,    ",
               "        sfba018,sfba021,sfba022,sfba023,sfba024,sfba025,sfba026,sfba027,    ",
               "        sfba034,sfba035 ",
               "   FROM sfaa_tmp,sfba_t ",
   #190513-00024#1 add-E
               "  WHERE sfbaent   = sfaaent ",
               "    AND sfbadocno = sfaadocno ",
               "   INTO TEMP sfba_tmp "

   PREPARE s_axcp500_cre_tmp_table_execute_p5 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p5"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p5
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p5"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p5
   
   CREATE UNIQUE INDEX sfba_tmp_01 ON sfba_tmp(sfbaent,sfbadocno,sfbaseq,sfbaseq1 );
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sfba_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   #161114-00003#1-s-add
   #b add by zwr 16.10.20 增加索引

   CREATE INDEX sfba_tmp_i01 ON sfba_tmp(sfbaent,sfbadocno,sfbaseq,sfba006,sfba014,sfba022);      #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode

      LET g_errparam.extend = "CREATE INDEX sfba_tmp_i01" #ODI-ORA#
      LET g_errparam.popup  = TRUE
      CALL cl_err()
#      RETURN r_success
   END IF
   IF cl_db_generate_analyze("sfba_tmp") THEN END IF   
   #e add by zwr 16.10.20 增加索引
   #161114-00003#1-e-add
   
   #sfba022 替代率若为0,则置为1,后续会以分母方式存在
   UPDATE sfba_tmp SET sfba022 = 1 WHERE sfba022 IS NULL OR sfba022 = 0
   
   
   MESSAGE "cre_tmp_table:xccd_tmp null"  
   #6.建立临时表xccd_tmp
#   LET g_sql = " SELECT * FROM xccd_t ",   #191118-00046#1 mark
    #191118-00046#1 add(s)

   LET g_sql = " SELECT xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,xccd006,xccd007,",
               "        xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,xccd014,xccd101,xccd102,xccd102a,",
               "        xccd102b,xccd102c,xccd102d,xccd102e,xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,",
               "        xccd202a,xccd202b,xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,",
               "        xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,xccd302,xccd302a,",
               "        xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,xccd302h,xccd303,xccd304,xccd304a,",
               "        xccd304b,xccd304c,xccd304d,xccd304e,xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,",
               "        xccd902b,xccd902c,xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime ",
               "       ,0 xccd301p",   #210125-00026#1
               "    FROM xccd_t ",
    #191118-00046#1 add(e)
               "  WHERE xccdent = ",g_enterprise,
               "    AND xccdld  = '",g_ld,"'",
               "    AND xccd001 = '1'",
               "    AND xccd002 = ' '",
               "    AND xccd003 = '",g_xcat001,"'",
               "    AND xccd004 = ",g_yy,
               "    AND xccd005 = ",g_pp,
               "    AND xccd006 = 'x'",
               "   INTO TEMP xccd_tmp "


   PREPARE s_axcp500_cre_tmp_table_execute_p6 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p6"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p6
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p6"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p6   
   
   CREATE UNIQUE INDEX xccd_tmp_01 ON xccd_tmp(xccdent,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,xccd006);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xccd_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #161114-00003#1-s-add
   #b add by zwr 16.10.20 增加索引

   CREATE INDEX xccd_tmp_i01 ON xccd_tmp(xccdent,xccdld,xccd001,xccd003,xccd004,xccd005,xccd006);       #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode

      LET g_errparam.extend = "CREATE INDEX xccd_tmp_i01" #ODI-ORA#
      LET g_errparam.popup  = TRUE
      CALL cl_err()
#      RETURN r_success
   END IF
   IF cl_db_generate_analyze("xccd_tmp") THEN END IF   
   #e add by zwr 16.10.20 增加索引
   #161114-00003#1-e-add
   
   MESSAGE "cre_tmp_table:xcce_tmp null"  
   #7.建立临时表xcce_tmp
#   LET g_sql = " SELECT * FROM xcce_t ",  #191118-00046#1 mark
   #191118-00046#1 add(s)


   LET g_sql =  " SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,xcce006,xcce007,",
                "        xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,xcce102b,xcce102c,xcce102d,xcce102e,",
                "        xcce102f,xcce102g,xcce102h,xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,",
                "        xcce202f,xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,xcce206e,",
                "        xcce206f,xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,xcce208c,xcce208d,xcce208e,",
                "        xcce208f,xcce208g,xcce208h,xcce209,xcce210,xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,",
                "        xcce210f,xcce210g,xcce210h,xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,",
                "        xcce302f,xcce302g,xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,xcce304e,",
                "        xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,xcce308c,xcce308d,xcce308e,",
                "        xcce308f,xcce308g,xcce308h,xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,",
                "        xcce902f,xcce902g,xcce902h,xccetime ",
                "  FROM xcce_t ",
   #191118-00046#1 add(e)            
               "  WHERE xcceent = ",g_enterprise,
               "    AND xcceld  = '",g_ld,"'",
               "    AND xcce001 = '1'",
               "    AND xcce002 = ' '",
               "    AND xcce003 = '",g_xcat001,"'",
               "    AND xcce004 = ",g_yy,
               "    AND xcce005 = ",g_pp,
               "    AND xcce006 = 'x'",
               "    AND xcce007 = 'x'",
               "    AND xcce008 = 'x'",
               "    AND xcce009 = '*'",
               "   INTO TEMP xcce_tmp "


#201012-00066#1 add  ---s
#201012-00066#1 add  ---e

   PREPARE s_axcp500_cre_tmp_table_execute_p7 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p7"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p7
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p7"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p7   
   
   CREATE UNIQUE INDEX xcce_tmp_01 ON xcce_tmp(xcceent,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,xcce006,xcce007,xcce008,xcce009);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcce_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF      

   #161114-00003#1-s-add
   #b add by zwr 16.10.20 增加索引

   CREATE INDEX xcce_tmp_i01 ON xcce_tmp(xcce006);  #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode

      LET g_errparam.extend = "CREATE INDEX xcce_tmp_i01" #ODI-ORA#
      LET g_errparam.popup  = TRUE
      CALL cl_err()
#     RETURN r_success
   END IF
   #IF cl_db_generate_analyze("xcce_tmp") THEN END IF   #201216-00043#2 mark
   #e add by zwr 16.10.20 增加索引
   #161114-00003#1-e-add
   
   #161124-00016#1-add-s

   CREATE INDEX xcce_tmp_n3 ON xcce_tmp(xcce001);  #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode

      LET g_errparam.extend = "CREATE INDEX xcce_tmp_n3" #ODI-ORA#
      LET g_errparam.popup  = TRUE
      CALL cl_err()
   END IF
   #161124-00016#1-add-e


   MESSAGE "cre_tmp_table:xccz_tmp null"  
   #8.建立临时表xccz_tmp
#   LET g_sql = " SELECT * FROM xccz_t ",  #190513-00024#1 mark
   #190513-00024#1 add-S

   LET g_sql = " SELECT xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,",
               "        xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,",
               "        xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901         ",
               "   FROM xccz_t ",
   #190513-00024#1 add-E
               "  WHERE xcczent = ",g_enterprise,
               "    AND xcczld  = '",g_ld,"'",
               "    AND xccz001 = '1'",
               "    AND xccz002 = ' '",
               "    AND xccz003 = '",g_xcat001,"'",
               "    AND xccz004 = ",g_yy,
               "    AND xccz005 = ",g_pp,
               "    AND xccz006 = 'x'",
               "    AND xccz007 = 'x'",
               "    AND xccz008 = 'x'",
               "    AND xccz009 = '*'",
               "    AND xccz010 = 0 ",
               "    AND xccz011 = 0 ",
               "   INTO TEMP xccz_tmp "


   PREPARE s_axcp500_cre_tmp_table_execute_p8 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p8"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p8
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p8"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p8   
   
   CREATE UNIQUE INDEX xccz_tmp_01 ON xccz_tmp(xcczent,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,xccz006,xccz007,xccz008,xccz009,xccz010,xccz011);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xccz_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 

   
   MESSAGE "cre_tmp_table:xccg_tmp null"  
   #9.建立临时表xccg_tmp
#   LET g_sql = " SELECT * FROM xccg_t ",  #190513-00024#1 mark
   #190513-00024#1 add-S


   LET g_sql = " SELECT xccgent,xccgcomp,xccgld,xccg001,xccg002,xccg003,xccg004,xccg005,",
               "        xccg006,xccg007,xccg008,xccg009,xccg010,xccg101,xccg102,xccg102a,",
               "        xccg102b,xccg102c,xccg102d,xccg102e,xccg102f,xccg102g,xccg102h,xccg301,",
               "        xccg302,xccg302a,xccg302b,xccg302c,xccg302d,xccg302e,xccg302f,xccg302g,",
               "        xccg302h,xccg901,xccg902,xccg902a,xccg902b,xccg902c,xccg902d,xccg902e,",
               "        xccg902f,xccg902g,xccg902h,xccgtime",
               "   FROM xccg_t ",
   #190513-00024#1 add-E
               "  WHERE xccgent = ",g_enterprise,
               "    AND xccgld  = '",g_ld,"'",
               "    AND xccg001 = '1'",
               "    AND xccg002 = ' '",
               "    AND xccg003 = '",g_xcat001,"'",
               "    AND xccg004 = ",g_yy,
               "    AND xccg005 = ",g_pp,
               "    AND xccg006 = 'x'",
               "    AND xccg007 = 'x'",
               "    AND xccg008 = 'x'",
               "    AND xccg009 = '*'",
               "   INTO TEMP xccg_tmp "

#201012-00066#1 add  ---s
#201012-00066#1 add  ---e

   PREPARE s_axcp500_cre_tmp_table_execute_p9 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p9"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p9
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p9"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p9   
   
   CREATE UNIQUE INDEX xccg_tmp_01 ON xccg_tmp(xccgent,xccgld,xccg001,xccg002,xccg003,xccg004,xccg005,xccg006,xccg007,xccg008,xccg009);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xccg_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 


   
   MESSAGE "cre_tmp_table:sale_return_tmp null"  
   #销退成本档
   #若参数S-FIN-6005 销退成本来源=1.原始出货月成本时,销退的成本需要串至对应出货单所属的年/期取得对应成本单价
   CREATE TEMP TABLE sale_return_tmp(
   xcck006     LIKE xcck_t.xcck006,      #销退单
   xcck007     LIKE xcck_t.xcck007,      #销退单项次
   xcck008     LIKE xcck_t.xcck008,      #销退单项序
   xcck009     LIKE xcck_t.xcck009,      #出入库码
   s_docno     LIKE xmdk_t.xmdkdocno,    #销售单
   s_date      LIKE xmdk_t.xmdk001,      #销售单过账日期
   xcck001     LIKE xcck_t.xcck001,      #本位币顺序
   xcck002     LIKE xcck_t.xcck002,      #成本域编号
   xcck010     LIKE xcck_t.xcck010,      #料件编号
   xcck011     LIKE xcck_t.xcck011,      #产品特征
   xcck017     LIKE xcck_t.xcck017,      #批号
   xcck055     LIKE xcck_t.xcck055,      #成本类型
   s_year      LIKE type_t.num5,         #销售单所属年度
   s_pp        LIKE type_t.num5,         #销售单所属期别
   xccc280     LIKE xccc_t.xccc280,      #原始出货月成本单价
   xccc280a    LIKE xccc_t.xccc280a,     #
   xccc280b    LIKE xccc_t.xccc280b,     #
   xccc280c    LIKE xccc_t.xccc280c,     #
   xccc280d    LIKE xccc_t.xccc280d,     #
   xccc280e    LIKE xccc_t.xccc280e,     #
   xccc280f    LIKE xccc_t.xccc280f,     #
   xccc280g    LIKE xccc_t.xccc280g,     #
   xccc280h    LIKE xccc_t.xccc280h      #
   );
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create sale_return_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   CREATE UNIQUE INDEX sale_return_tmp_01 ON sale_return_tmp(xcck006,xcck007,xcck008,xcck009);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX sale_return_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #161114-00003#-s-add
   #b add by zwr 16.10.20 增加索引

  #CREATE INDEX sale_return_tmp_i01 ON sale_return_tmp(xcck006,xcck007,xcck001,xcck002,xcck008,xcck009,xcck055); #161220-00048#1  mark #ODI-ORA#

   CREATE INDEX sale_return_tmp_02 ON sale_return_tmp(xcck006,xcck007,xcck001,xcck002,xcck008,xcck009,xcck055);  #161220-00048#1  add     #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode

     #LET g_errparam.extend = "CREATE INDEX sale_return_tmp_i01"  #161220-00048#1  mark     #ODI-ORA#

      LET g_errparam.extend = "CREATE INDEX sale_return_tmp_02"   #161220-00048#1  add      #ODI-ORA#
      LET g_errparam.popup  = TRUE
      CALL cl_err()
   END IF 
   #e add by zwr 16.10.20 增加索引
   #161114-00003#-e-add

   #161121-00018#5---add---s
   #建立临时表xcha_tmp
   MESSAGE "cre_tmp_table:xcha_tmp null"  
   #11.建立临时表xccg_tmp
#   LET g_sql = " SELECT * FROM xcha_t ",  #191118-00046#1 mark
   #191118-00046#1 add(s)
   LET g_sql = " SELECT xchaent,xchacomp,xchald,xcha001,xcha002,xcha003,xcha004,xcha005,xcha006,xcha007,",
               "        xcha008,xcha009,xcha010,xcha011,xcha012,xcha013,xcha101,xcha102,xcha102a,xcha102b,",
               "        xcha102c,xcha102d,xcha102e,xcha102f,xcha102g,xcha102h,xcha201,xcha202,xcha202a,xcha202b,",
               "        xcha202c,xcha202d,xcha202e,xcha202f,xcha202g,xcha202h,xcha203,xcha204,xcha204a,xcha204b,",
               "        xcha204c,xcha204d,xcha204e,xcha204f,xcha204g,xcha204h,xcha301,xcha302,xcha302a,xcha302b,",
               "        xcha302c,xcha302d,xcha302e,xcha302f,xcha302g,xcha302h,xcha303,xcha304,xcha304a,xcha304b,",
               "        xcha304c,xcha304d,xcha304e,xcha304f,xcha304g,xcha304h,xcha305,xcha306,xcha306a,xcha306b,",
               "        xcha306c,xcha306d,xcha306e,xcha306f,xcha306g,xcha306h,xcha307,xcha308,xcha308a,xcha308b,",
               "        xcha308c,xcha308d,xcha308e,xcha308f,xcha308g,xcha308h,xcha309,xcha310,xcha310a,xcha310b,",
               "        xcha310c,xcha310d,xcha310e,xcha310f,xcha310g,xcha310h,xcha901,xcha902,xcha902a,xcha902b,",
               "        xcha902c,xcha902d,xcha902e,xcha902f,xcha902g,xcha902h,xchatime ",
               "   FROM xcha_t ",
   #191118-00046#1 add(e)
               "  WHERE xchaent = ",g_enterprise,
               "    AND xchald  = '",g_ld,"'",
               "    AND xcha001 = '1'",
               "    AND xcha002 = ' '",
               "    AND xcha003 = '",g_xcat001,"'",
               "    AND xcha004 = ",g_yy,
               "    AND xcha005 = ",g_pp,
               "    AND xcha006 = 'x'",
               "    AND xcha007 = 'x'",
               "    AND xcha008 = 'x'",
               "    AND xcha009 = '*'",
               "   INTO TEMP xcha_tmp "
   PREPARE s_axcp500_cre_tmp_table_execute_p10 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p10"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p10
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p10"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p10   
   
   CREATE UNIQUE INDEX xcha_tmp_01 ON xcha_tmp(xchaent,xchald,xcha001,xcha002,xcha003,xcha004,xcha005,xcha006,xcha007,xcha008);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcha_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF       
   CREATE UNIQUE INDEX xcha_tmp_02 ON xcha_tmp(xchaent,xcha004,xcha005,xcha006,xcha007,xcha008);
  
   IF cl_db_generate_analyze("xcha_tmp") THEN END IF

   #建立临时表xchb_tmp
#   LET g_sql = " SELECT * FROM xchb_t ",   #191118-00046#1 mark
    #191118-00046#1 add(s)
   LET g_sql = "  SELECT xchbent,xchbcomp,xchbld,xchb001,xchb002,xchb003,xchb004,xchb005,xchb006,xchb007,",
               "         xchb008,xchb009,xchb010,xchb011,xchb012,xchb013,xchb014,xchb015,xchb101,xchb102,xchb102a,",
               "         xchb102b,xchb102c,xchb102d,xchb102e,xchb102f,xchb102g,xchb102h,xchb201,xchb202,xchb202a,",
               "         xchb202b,xchb202c,xchb202d,xchb202e,xchb202f,xchb202g,xchb202h,xchb203,xchb204,xchb204a,",
               "         xchb204b,xchb204c,xchb204d,xchb204e,xchb204f,xchb204g,xchb204h,xchb207,xchb208,xchb208a,",
               "         xchb208b,xchb208c,xchb208d,xchb208e,xchb208f,xchb208g,xchb208h,xchb209,xchb210,xchb210a,",
               "         xchb210b,xchb210c,xchb210d,xchb210e,xchb210f,xchb210g,xchb210h,xchb301,xchb302,xchb302a,",
               "         xchb302b,xchb302c,xchb302d,xchb302e,xchb302f,xchb302g,xchb302h,xchb303,xchb304,xchb304a,",
               "         xchb304b,xchb304c,xchb304d,xchb304e,xchb304f,xchb304g,xchb304h,xchb305,xchb306,xchb306a,",
               "         xchb306b,xchb306c,xchb306d,xchb306e,xchb306f,xchb306g,xchb306h,xchb307,xchb308,xchb308a,",
               "         xchb308b,xchb308c,xchb308d,xchb308e,xchb308f,xchb308g,xchb308h,xchb309,xchb310,xchb310a,",
               "         xchb310b,xchb310c,xchb310d,xchb310e,xchb310f,xchb310g,xchb310h,xchb901,xchb902,xchb902a,",
               "         xchb902b,xchb902c,xchb902d,xchb902e,xchb902f,xchb902g,xchb902h,xchbtime ",
               "   FROM xchb_t ",
    #191118-00046#1 add(e)
               "  WHERE xchbent = ",g_enterprise,
               "    AND xchbld  = '",g_ld,"'",
               "    AND xchb001 = '1'",
               "    AND xchb002 = ' '",
               "    AND xchb003 = '",g_xcat001,"'",
               "    AND xchb004 = ",g_yy,
               "    AND xchb005 = ",g_pp,
               "    AND xchb006 = 'x'",
               "    AND xchb007 = 'x'",
               "    AND xchb008 = 'x'",
               "    AND xchb009 = 'x'",
               "    AND xchb010 = 'x'",
               "    AND xchb011 = 'x'",
               "   INTO TEMP xchb_tmp "
   PREPARE s_axcp500_cre_tmp_table_execute_p11 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p11"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p11
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p11"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p11   
   
   CREATE UNIQUE INDEX xchb_tmp_01 ON xchb_tmp(xchbent,xchbld,xchb001,xchb002,xchb003,xchb004,xchb005,xchb006,xchb007,xchb008,xchb009,xchb010,xchb011,xchb014,xchb015);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xchb_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   


   CREATE INDEX xchb_tmp_02 ON xchb_tmp(xchb006); #ODI-ORA#

   CREATE INDEX xchb_tmp_03 ON xchb_tmp(xchbent,xchbld,xchb001,xchb002,xchb003,xchb004,xchb005,xchb006,xchb007,xchb008); #ODI-ORA#
   #170418-00026#1---add---s

   CREATE INDEX xchb_tmp_04 ON xchb_tmp(xchbent,xchbld,xchb001,xchb002,xchb003,xchb004,xchb005,xchb006,xchb007,xchb008,xchb009); #ODI-ORA#

   CREATE INDEX xchb_tmp_05 ON xchb_tmp(xchbent,xchb004,xchb005,xchb006,xchb007,xchb008); #ODI-ORA#

   CREATE INDEX xchb_tmp_06 ON xchb_tmp(xchbent,xchbld,xchb001,xchb002,xchb003,xchb004,xchb005,xchb006,xchb007,xchb008,xchb009,xchb010,xchb011,xchb014,xchb015); #ODI-ORA#
   #170418-00026#1---add---e   
   IF cl_db_generate_analyze("xchb_tmp") THEN END IF
   #161121-00018#5---add---e
   
   #210201-00035#1 add-S
   LET g_sql = " SELECT xcdeent,xcdecomp,xcdeld,xcde001,xcde002,xcde003,xcde004,xcde005,xcde006,xcde007,",
               "        xcde008,xcde009,xcde010,xcde020,xcde101,xcde102,xcde201,xcde202,xcde205,xcde206,",
               "        xcde207,xcde208,xcde209,xcde210,xcde301,xcde302,xcde303,xcde304,xcde307,xcde308,",
               "        xcde901,xcde902,xcdetime ",
               "   FROM xcde_t ",
               "  WHERE xcdeent = ",g_enterprise,
               "    AND xcdeld  = '",g_ld,"'",
               "    AND xcde001 = '1'",
               "    AND xcde002 = ' '",
               "    AND xcde003 = '",g_xcat001,"'",
               "    AND xcde004 = ",g_yy,
               "    AND xcde005 = ",g_pp,
               "    AND xcde006 = 'x'",
               "    AND xcde007 = 'x'",
               "    AND xcde008 = 'x'",
               "    AND xcde009 = '*'",
               "    AND xcde010 = '*'",
               "   INTO TEMP xcde_tmp "

   PREPARE s_axcp500_cre_tmp_table_execute_p12 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_cre_tmp_table_execute_p12"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   EXECUTE s_axcp500_cre_tmp_table_execute_p12
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_cre_tmp_table_execute_p12"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   FREE s_axcp500_cre_tmp_table_execute_p12   
   
   CREATE UNIQUE INDEX xcde_tmp_01 ON xcde_tmp(xcdeent,xcdeld,xcde001,xcde002,xcde003,xcde004,xcde005,xcde006,xcde007,xcde008,xcde009,xcde010);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcde_tmp_01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   CREATE INDEX xcde_tmp_02 ON xcde_tmp(xcde001,xcde002,xcde006,xcde007,xcde008,xcde009); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcde_tmp_02"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   CREATE INDEX xcde_tmp_03 ON xcde_tmp(xcde006);
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xcde_tmp_03"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   IF cl_db_generate_analyze("xcde_tmp") THEN END IF
   #210201-00035#1 add-E
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 各成本计算方式共用的CURSOR 定义汇总 
# Memo...........:
# Usage..........: CALL s_axcp500_def_cursor()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-10-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_def_cursor()
   DEFINE r_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   IF g_sys_6021 = 'Y' THEN  #add zhangllc 160526 --SBS1
      #add zhangllc 151215 --begin
      #用xcck的资料set xccq
      #LET g_sql = "SELECT /*+ full(xcck_tmp) */ xcck055,SUM(xcck201*xcck009), SUM(xcck202*xcck009), SUM(xcck202a*xcck009),",  #170110-00028#1
      LET g_sql = "SELECT xcck055,SUM(xcck201*xcck009), SUM(xcck202*xcck009), SUM(xcck202a*xcck009),",  #170110-00028#1
                  "               SUM(xcck202b*xcck009),SUM(xcck202c*xcck009),SUM(xcck202d*xcck009),",
                  "               SUM(xcck202e*xcck009),SUM(xcck202f*xcck009),SUM(xcck202g*xcck009),",
                  "               SUM(xcck202h*xcck009) ",
                  "  FROM xcck_tmp ",
                  " WHERE xcckent =  ",g_enterprise,
                  "   AND xcckld  = '",g_ld,"'",
                  "   AND xccksite= ? ",
                  "   AND xcck001 = ? ",
                  "   AND xcck002 = ? ",
                  "   AND xcck003 = ? ",
                  "   AND xcck004 = ? ",
                  "   AND xcck005 = ? ",
                  "   AND xcck010 = ? ",
                  "   AND xcck011 = ? ",
                  "   AND xcck017 = ? ",
                  "   AND xccktmp1= ? ",
                  "   AND xcck015 = ? ",
                  "   AND xcck016 = ? ",
                  "   AND xcck028 = ? ",
                  " GROUP BY xcck055  "
      PREPARE s_axcp500_def_cursor_p1_xccq FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p1_xccq"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF  
      DECLARE s_axcp500_get_xccq_from_xcck_cs1 CURSOR FOR s_axcp500_def_cursor_p1_xccq
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "DECLARE s_axcp500_get_xccq_from_xcck_cs1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF   
      #add zhangllc 151215 --end
   END IF   #add zhangllc 160526 --SBS1
   
   #用xcck的资料set xccc
   #LET g_sql = "SELECT /*+ full(xcck_tmp) */ xcck055,SUM(xcck201*xcck009), SUM(xcck202*xcck009), SUM(xcck202a*xcck009),",  #170110-00028#1  
   LET g_sql = "SELECT xcck055,SUM(xcck201*xcck009), SUM(xcck202*xcck009), SUM(xcck202a*xcck009),",  #170110-00028#1  
               "               SUM(xcck202b*xcck009),SUM(xcck202c*xcck009),SUM(xcck202d*xcck009),",
               "               SUM(xcck202e*xcck009),SUM(xcck202f*xcck009),SUM(xcck202g*xcck009),",
               "               SUM(xcck202h*xcck009) ",
               "  FROM xcck_tmp ",
               " WHERE xcckent =  ",g_enterprise,
               "   AND xcckld  = '",g_ld,"'",
               "   AND xcck001 = ? ",
               "   AND xcck002 = ? ",
               "   AND xcck003 = ? ",
               "   AND xcck004 = ? ",
               "   AND xcck005 = ? ",
               "   AND xcck010 = ? ",
               "   AND xcck011 = ? ",
               "   AND xcck017 = ? ",     
               " GROUP BY xcck055  "
   PREPARE s_axcp500_def_cursor_p1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   DECLARE s_axcp500_get_xccc_from_xcck_cs1 CURSOR FOR s_axcp500_def_cursor_p1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_get_xccc_from_xcck_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #取工单入库 - (工单在制计算 - 撷取主件入库数量)
   #LET g_sql = "SELECT inajsite,inaj005,inaj036,SUM(inaj011*inaj014),inaj004 FROM inaj_tmp",  #160518-00033#2 mark
   #LET g_sql = "SELECT inajsite,inaj005,inaj036,SUM(inaj011*inaj048/inaj049),inaj004 FROM inaj_tmp",    #160518-00033#2 add  #170705-00006#1 mark
   LET g_sql = "SELECT inajsite,inaj005,inaj036,SUM(CASE inaj049 WHEN 0 THEN 0 ELSE inaj011*inaj048/inaj049 END),inaj004 FROM inaj_tmp",  #170705-00006#1 add
               " WHERE inajent = ",g_enterprise,
               "   AND inaj020 = ?",                                   #工单
               "   AND inaj036 IN ('110','111','112','113','103','104','105','106')",    #一般/联产品/多产出主件/拆件/回收
               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
               " GROUP BY inajsite,inaj005,inaj036,inaj004"
   PREPARE s_axcp500_def_cursor_p2 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_get_xccd301_cs1 CURSOR FOR s_axcp500_def_cursor_p2
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_get_xccd301_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF       
   
   #取在制元件档(FOR工单在制计算) -- 上期
#   LET g_sql = "SELECT * FROM xcce_t ",  #161124-00048#20 mark
    #161124-00048#20 add(s)
   LET g_sql = "SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,         ",
               "        xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,       ",
               "        xcce102b,xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,         ",
               "        xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,xcce202f,  ",
               "        xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,  ",
               "        xcce206e,xcce206f,xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,  ",
               "        xcce208c,xcce208d,xcce208e,xcce208f,xcce208g,xcce208h,xcce209,xcce210,  ",
               "        xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,",
               "        xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,  ",
               "        xcce302g,xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,  ",
               "        xcce304e,xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,  ",
               "        xcce308c,xcce308d,xcce308e,xcce308f,xcce308g,xcce308h,xcce901,xcce902,  ",
               "        xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h,",
               "        xccetime FROM xcce_t ",
    #161124-00048#20 add(e)
               " WHERE xcceent = ",g_enterprise,
               "   AND xcceld  = '",g_ld,"'",
               "   AND xcce001 = ?",
               "   AND xcce003 = ?",
               "   AND xcce004 = ?",
               "   AND xcce005 = ?",
               "   AND xcce006 = ?"
   PREPARE s_axcp500_def_cursor_p3 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p3"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_2_1_cs1 CURSOR FOR s_axcp500_def_cursor_p3
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_2_1_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #取在制元件档(FOR工单在制计算)  -- 本期
#   LET g_sql = "SELECT * FROM xcce_tmp ", #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = "SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,         ",
               "        xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,       ",
               "        xcce102b,xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,         ",
               "        xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,xcce202f,  ",
               "        xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,  ",
               "        xcce206e,xcce206f,xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,  ",
               "        xcce208c,xcce208d,xcce208e,xcce208f,xcce208g,xcce208h,xcce209,xcce210,  ",
               "        xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,",
               "        xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,  ",
               "        xcce302g,xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,  ",
               "        xcce304e,xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,  ",
               "        xcce308c,xcce308d,xcce308e,xcce308f,xcce308g,xcce308h,xcce901,xcce902,  ",
               "        xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h,",
               "        xccetime FROM xcce_tmp ",
   #161124-00048#20 add(e)
               " WHERE xcceent = ",g_enterprise,
               "   AND xcceld  = '",g_ld,"'",
               "   AND xcce001 = ?",
               "   AND xcce003 = ?",
               "   AND xcce004 = ?",
               "   AND xcce005 = ?",
               "   AND xcce006 = ?"
   PREPARE s_axcp500_def_cursor_p27 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p27"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_4_cs4 CURSOR FOR s_axcp500_def_cursor_p27
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_4_cs4"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF      

   #取工单对应的发料料号 (在制成本计算 - 下阶料投入(发料/退料等))
   #carrier 会不会把主件的盘点也纳进来了
   #LET g_sql = "SELECT /*+ full(xcck_tmp) */ xcck010,xcck011,xcck017,xcck012,xcck020,SUM(xcck201*xcck009*-1),xcck002,", #170110-00028#1  
   LET g_sql = "SELECT xcck010,xcck011,xcck017,xcck012,xcck020,SUM(xcck201*xcck009*-1),xcck002,", #170110-00028#1  
               "       SUM(xcck202*xcck009*-1),SUM(xcck202a*xcck009*-1),SUM(xcck202b*xcck009*-1),",
               "       SUM(xcck202c*xcck009*-1),SUM(xcck202d*xcck009*-1),SUM(xcck202e*xcck009*-1),",
               "       SUM(xcck202f*xcck009*-1),SUM(xcck202g*xcck009*-1),SUM(xcck202h*xcck009*-1) ",   
               "  FROM xcck_tmp ",
               " WHERE xcckent = ",g_enterprise,
               "   AND xcckld  = '",g_ld,"'",
               "   AND xcck001 = ? ",
               "   AND xcck003 = ? ",
               "   AND xcck004 = ",g_yy,
               "   AND xcck005 = ",g_pp,
               "   AND xcck047 = ? "
   IF g_sys_6016 = 'Y' THEN
      LET g_sql = g_sql CLIPPED,
               "   AND xcck020 IN ('302','303','501','114','107') "               #生产发料/生产退料/盘点 
   ELSE
      LET g_sql = g_sql CLIPPED,
               "   AND xcck020 IN ('302','303','115','501','114','107') "         #生产发料/生产退料/当站下线/盘点 
   END IF
   LET g_sql = g_sql CLIPPED," GROUP BY xcck010,xcck011,xcck017,xcck012,xcck020,xcck002"                
   PREPARE s_axcp500_def_cursor_p4 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p4"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_2_cs1 CURSOR FOR s_axcp500_def_cursor_p4
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_2_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   

   #下阶料等于主件阶或是大于主件阶
#   LET g_sql = "SELECT /*+ full(inaj_tmp) */ inaj_tmp.* FROM inaj_tmp ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   #LET g_sql = "SELECT /*+ full(inaj_tmp) */ inajent,inajsite,inaj001,inaj002,inaj003,inaj004,inaj005,inaj006, ", #170110-00028#1
   #190513-00024#1 mark-S
#   LET g_sql = "SELECT inajent,inajsite,inaj001,inaj002,inaj003,inaj004,inaj005,inaj006, ", #170110-00028#1
#               "      inaj007,inaj008,inaj009,inaj010,inaj011,inaj012,inaj013,inaj014,inaj015,inaj016,inaj017, ",
#               "      inaj018,inaj019,inaj020,inaj021,inaj022,inaj023,inaj024,inaj025,inaj026,inaj027,inaj028, ",
#               "      inaj036,inaj029,inaj030,inaj031,inaj032,inaj033,inaj034,inaj035,inaj037,inaj038,inaj039, ",
#               "      inaj040,inaj041,inaj042,inaj043,inaj044,inaj200,inaj201,inaj202,inaj203,inaj204,inaj205, ",
#               "      inaj206,inaj207,inaj208,inaj209,inaj045,inaj046,inaj047,inaj048,inaj049,inaj050,inaj051, ",
#               "      inaj210,inaj211 FROM inaj_tmp ",
   #190513-00024#1 mark-E
   #161124-00048#20 add(e)
   #190513-00024#1 add-S   #暂存档空间缩减
   LET g_sql = " SELECT inajent,inajsite,inaj001,inaj002,inaj003,inaj004,inaj005,inaj006,",
               "        inaj007,inaj008,inaj009,inaj010,inaj011,inaj012,inaj015,inaj016, ",
               "        inaj018,inaj020,inaj022,inaj024,inaj036,inaj029,inaj035,inaj037, ",
               "        inaj038,inaj039,inaj040,inaj041,inaj042,inaj043,inaj200,inaj203, ",
               "        inaj048,inaj049,inaj211,inaj999 ",
               "   FROM inaj_tmp ",
   #190513-00024#1 add-E
               " WHERE inajent = ",g_enterprise,
               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
               "   AND inaj020 = ? "
   IF g_sys_6016 = 'Y' THEN
      LET g_sql = g_sql CLIPPED,
                  "   AND inaj036 IN ('302','303','501','114','107') "              #生产发料/生产退料/盘点    
   ELSE
      LET g_sql = g_sql CLIPPED,
                  "   AND inaj036 IN ('302','303','115','501','114','107') "         #生产发料/生产退料/当站下线/盘点    
   END IF
   
   LET g_sql = g_sql CLIPPED,
               #"   AND NOT EXISTS ( SELECT /*+ full(xcck_tmp) */ 1 FROM xcck_tmp WHERE xcck006 = inaj001 ",  #170110-00028#1
               "   AND NOT EXISTS ( SELECT 1 FROM xcck_tmp WHERE xcck006 = inaj001 ",  #170110-00028#1
               "                                             AND xcck007 = inaj002 ",
               "                                             AND xcck008 = inaj003 ",
               "                                             AND xcck009 = inaj004 ",
               "                                             AND xcckent = ",g_enterprise,
               "                                             AND xcckld  = '",g_ld,"'",
               "                                             AND xcck001 = ? ",
               "                                             AND xcck003 = '",g_xcat001,"'",
               "                                             AND xcck004 = ",g_yy,
               "                                             AND xcck005 = ",g_pp," ) "
                                                           
                                       
   PREPARE s_axcp500_def_cursor_p22 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p22"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_2_cs2 CURSOR FOR s_axcp500_def_cursor_p22
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_2_cs2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF      
   
   #找委外单据(在制计算时:取委外加工费)
#wujie 160522 --begin  去掉inaa，inaj_tmp产生时已经判断过成本仓否了
   #LET g_sql = "SELECT inaj_tmp.* FROM inaj_tmp ",      #160823-00040#1 mark
   LET g_sql = "SELECT UNIQUE inajsite,inaj001,inaj002 FROM inaj_tmp ",      #160823-00040#1 add
               " WHERE inajent = ",g_enterprise,
               #"   AND inaj008 = inaa001 ",                                #mark by zwr 16.06.05
               "   AND inaj020 = ?",
               "   AND inaj036 IN ('103','104','105','106','107','109') ",        #委外入库/委外联产品入库/委外多产出入库/委外拆件入库/委外回收入库  #170223-00037#2 add '109'
               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'" 
#   LET g_sql = "SELECT inaj_tmp.* FROM inaj_tmp,inaa_t ",
#               " WHERE inajent  = inaaent AND inajent = ",g_enterprise,
#               "   AND inajsite = inaasite ",
#               "   AND inaj008 = inaa001 ",
#               "   AND inaa010 = 'Y' ",                                     #成本仓
#               "   AND inaj020 = ?",
#               "   AND inaj036 IN ('103','104','105','106','107') ",        #委外入库/委外联产品入库/委外多产出入库/委外拆件入库/委外回收入库
#               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'" 
#wujie 160522 --end
#               " GROUP BY inaj005,inaj006,inaj010,inaj015,inaj036,xcbb006"               
   PREPARE s_axcp500_def_cursor_p5 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p5"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_2_3_cs1 CURSOR FOR s_axcp500_def_cursor_p5
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_2_3_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   
   #取xccz资料(在制成本计算 - xccz档案处理(发料明细对应至工单备料))
   #xccz为工单发料明细档,为了解决替代料转出引发的问题而设置的
#   LET g_sql = "SELECT * FROM xccz_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = "SELECT xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,",
               "       xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,",
               "       xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901 ",
               "  FROM xccz_t ",
   #161124-00048#20 add(e)
               " WHERE xcczent = ",g_enterprise,
               "   AND xcczld  = '",g_ld,"'",
               "   AND xccz001 = ?",
               "   AND xccz003 = ?",
               "   AND xccz004 = ",g_last_yy,
               "   AND xccz005 = ",g_last_pp,
               "   AND xccz006 = ?"
   PREPARE s_axcp500_def_cursor_p6 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p6"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_3_cs1 CURSOR FOR s_axcp500_def_cursor_p6
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_3_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   
#   LET g_sql = "SELECT * FROM xccz_tmp ",   #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = "SELECT xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,",
               "       xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,",
               "       xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901 ",
               "  FROM xccz_tmp ",
   #161124-00048#20 add(e)
               " WHERE xcczent = ",g_enterprise,
               "   AND xcczld  = '",g_ld,"'",
               "   AND xccz001 = ?",
               "   AND xccz003 = ?",
               "   AND xccz004 = ?",
               "   AND xccz005 = ?",
               "   AND xccz006 = ?"
   PREPARE s_axcp500_def_cursor_p29 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p29"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_4_cs5 CURSOR FOR s_axcp500_def_cursor_p29
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_4_cs5"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   

   #工单在制处理-发料明细对至工单备料档(为后续替代料转出做准备)
   #sfdc_t上有sfdc001(工单单号)/sfdc002(工单项次)/sfdc003(工单项序),其中sfdc001/sfdc002一定和sfbadocno/sfbaseq相符
   #但是sfdc003不一定会和sfbaseq1相符,原因是替代料的关系
   #替代料产生时,sfdc003=0,但是sfbaseq1不是0的现象,所以要特别去串到sfba_t,串的条件为发料料件编号
   #LET g_sql = "SELECT inaj005,inaj006,inaj010,inaj015,inaj036,sfdc001,sfdc002,sfbaseq1,SUM(inaj011*inaj014*inaj004*-1),",   #160518-00033#2 mark
   #LET g_sql = "SELECT inaj005,inaj006,inaj010,inaj015,inaj036,sfdc001,sfdc002,sfbaseq1,SUM(inaj011*inaj048/inaj049*inaj004*-1),",   #160518-00033#2 add #170705-00006#1 mark 
   LET g_sql = "SELECT inaj005,inaj006,inaj010,inaj015,inaj036,sfdc001,sfdc002,sfbaseq1,SUM(CASE inaj049*inaj004 WHEN 0 THEN 0 ELSE inaj011*inaj048/inaj049*inaj004*-1 END),",  #170705-00006#1 add
               "       inaj007,inaj008,inajsite,inaj999 ",
               "  FROM sfdc_t,sfdd_t,sfba_tmp,inaj_tmp ",
               " WHERE inajent = ",g_enterprise,
               "   AND inaj020 = ?",
--             "   AND inaj036 IN ('302','303','115','114','107') ",        #生产发料/生产退料/当站下线
               "   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
               "   AND inajent   = sfdcent AND sfdcent = sfddent ",
               "   AND sfdcdocno = sfdddocno",                  #发料单号
               "   AND sfdcseq   = sfddseq  ",                  #发料项次
               "   AND inaj001   = sfdddocno",
               "   AND inaj002   = sfddseq  ",
               "   AND inaj003   = sfddseq1 ",
               "   AND inajsite  = sfddsite ",
               "   AND sfbaent   = inajent  ",
               "   AND sfbadocno = sfdc001  ",
               "   AND sfbaseq   = sfdc002  ",
               "   AND sfdd001   = sfba006  ",
               " GROUP BY inaj005,inaj006,inaj010,inaj015,inaj036,sfdc001,sfdc002,sfbaseq1,inaj007,inaj008,inajsite,inaj999"
   PREPARE s_axcp500_def_cursor_p7 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p7"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_3_cs2 CURSOR FOR s_axcp500_def_cursor_p7
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_3_cs2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #在制成本计算 - 元件按主件入库数量转出
   #工单按主件入库数量转出-找备料第一次,项序=0的料件
   #                    项次     项序      发料料件 特征    替代率   总应发数        代买数量 生产数量
   LET g_sql = " SELECT sfbaseq, sfbaseq1,sfba006,sfba021,sfba022,sfba023+sfba024,sfba015,sfaa012 ",
               "  FROM sfaa_tmp,sfba_tmp ",
               " WHERE sfaaent   = sfbaent ",
               "   AND sfaasite  = sfbasite ",
               "   AND sfaadocno = sfbadocno ",
               "   AND sfaaent   = ",g_enterprise,
               "   AND sfaadocno = ? ",
#              "   AND (sfba008  = '1' OR sfba008 = '2' )",    #1.主要材料  2.次要材料
               " ORDER BY sfbaseq,sfbaseq1 "
   PREPARE s_axcp500_def_cursor_p8 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p8"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_4_cs1 CURSOR FOR s_axcp500_def_cursor_p8
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_4_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   

   #在制成本计算 串到明细笔的xcce资料
   #备料串xcce档
#   LET g_sql = "SELECT * FROM xcce_tmp",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = "SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,xcce006,        ",
               "       xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,xcce102b,xcce102c,     ",
               "       xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,xcce201,xcce202,xcce202a,xcce202b, ",
               "       xcce202c,xcce202d,xcce202e,xcce202f,xcce202g,xcce202h,xcce205,xcce206,xcce206a, ",
               "       xcce206b,xcce206c,xcce206d,xcce206e,xcce206f,xcce206g,xcce206h,xcce207,xcce208, ",
               "       xcce208a,xcce208b,xcce208c,xcce208d,xcce208e,xcce208f,xcce208g,xcce208h,xcce209,",
               "       xcce210,xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,",
               "       xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,xcce302g, ",
               "       xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,xcce304e,xcce304f, ",
               "       xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,xcce308c,xcce308d,xcce308e, ",
               "       xcce308f,xcce308g,xcce308h,xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d, ",
               "       xcce902e,xcce902f,xcce902g,xcce902h,xccetime ",
               "  FROM xcce_tmp",
   #161124-00048#20 add(e)
               " WHERE xcceent = ",g_enterprise,
               "   AND xcceld  = '",g_ld,"'",
               "   AND xcce001 = ? ",
               "   AND xcce003 = ? ",
               "   AND xcce004 = ? ",
               "   AND xcce005 = ? ",
               "   AND xcce006 = ? ",
               "   AND xcce007 = ? "
   PREPARE s_axcp500_def_cursor_p9 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p9"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_4_cs3 CURSOR FOR s_axcp500_def_cursor_p9
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_4_cs3"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF               

   #取人工/制费(一般/返工/拆件在制成本计算 - 取得人工/加工/制费)
   #carrier xcbk007 分摊方式没有考虑,要加入吗?
#wujie 160522 --begin  改为同一句sql抓5个，不然要分5次执行
   LET g_sql = "SELECT SUM(CASE xcbk005 WHEN '1' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '1' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '1' THEN xcbk222 ELSE 0 END), ",
               "       SUM(CASE xcbk005 WHEN '2' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '2' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '2' THEN xcbk222 ELSE 0 END), ",
               "       SUM(CASE xcbk005 WHEN '3' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '3' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '3' THEN xcbk222 ELSE 0 END), ",
               "       SUM(CASE xcbk005 WHEN '4' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '4' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '4' THEN xcbk222 ELSE 0 END), ",
               "       SUM(CASE xcbk005 WHEN '5' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '5' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '5' THEN xcbk222 ELSE 0 END), ",
               "       SUM(CASE xcbk005 WHEN '6' THEN xcbk202 ELSE 0 END),SUM(CASE xcbk005 WHEN '6' THEN xcbk212 ELSE 0 END),SUM(CASE xcbk005 WHEN '6' THEN xcbk222 ELSE 0 END) ",
               "  FROM xcbk_t ",  
               " WHERE xcbkent = ",g_enterprise,
               "   AND xcbkld  = '",g_ld,"'",
               "   AND xcbk001 = '",g_xcat001,"'",
               "   AND xcbk002 = ",g_yy,
               "   AND xcbk003 = ",g_pp,
               "   AND xcbk006 = ? "                      #工单

#   LET g_sql = "SELECT SUM(xcbk202),SUM(xcbk212),SUM(xcbk222) FROM xcbk_t ",  
#               " WHERE xcbkent = ",g_enterprise,
#               "   AND xcbkld  = '",g_ld,"'",
#               "   AND xcbk001 = '",g_xcat001,"'",
#               "   AND xcbk002 = ",g_yy,
#               "   AND xcbk003 = ",g_pp,
#               "   AND xcbk005 = ? ",                     #費用分類(成本主要素)
#               "   AND xcbk006 = ? "                      #工单
##              "   AND xcbkstus = 'Y'"    
#wujie 160522 --end
   PREPARE s_axcp500_def_cursor_p10 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p10"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
#wujie 160523 --begin

   DROP INDEX xccp_i01 #ODI-ORA#

   CREATE INDEX xccp_i01 ON xccp_t(xccpent,xccpld,xccp001,xccp003,xccp004,xccp005,xccp007,xccpstus); #ODI-ORA#
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE UNIQUE INDEX xccp_t_i01"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   IF cl_db_generate_analyze("xccp_t") THEN END IF
#wujie 160523 --end

   #取在制成本调整资料(在制成本计算 - 取当期在制成本调整资料)
   LET g_sql = "SELECT SUM(xccp101) ,SUM(xccp102) ,SUM(xccp102a),SUM(xccp102b),SUM(xccp102c),",
               "       SUM(xccp102d),SUM(xccp102e),SUM(xccp102f),SUM(xccp102g),SUM(xccp102h) ",
               "  FROM xccp_t",
               " WHERE xccpent = ",g_enterprise,
               "   AND xccpld  = '",g_ld,"'",
               "   AND xccp001 = ? ",               #记帐本位币顺序
               "   AND xccp003 = '",g_xcat001,"'",
               "   AND xccp004 = ",g_yy,
               "   AND xccp005 = ",g_pp,
               "   AND xccp007 = ? ",               #工单单号
               "   AND xccpstus = 'Y'"
   PREPARE s_axcp500_def_cursor_p11 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p11"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #拆件处理:取拆件工单对应的xcci资料
   #取拆件在制元件成本
#   LET g_sql = "SELECT * FROM xcci_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = "SELECT xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,",
               "       xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,",
               "       xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,",
               "       xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,xcci202f,",
               "       xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,xcci302c,xcci302d,",
               "       xcci302e,xcci302f,xcci302g,xcci302h,xcci303,xcci304,xcci304a,xcci304b,",
               "       xcci304c,xcci304d,xcci304e,xcci304f,xcci304g,xcci304h,xcci901,xcci902,",
               "       xcci902a,xcci902b,xcci902c,xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,",
               "       xccitime FROM xcci_t ",
   #161124-00048#20 add(e)
               " WHERE xccient = ",g_enterprise,
               "   AND xccild  = '",g_ld,"'",
               "   AND xcci001 = ?",
               "   AND xcci003 = ?",
               "   AND xcci004 = ?",
               "   AND xcci005 = ?",
               "   AND xcci006 = ?"
   PREPARE s_axcp500_def_cursor_p12 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p12"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_disassemble_wip_2_1_cs1 CURSOR FOR s_axcp500_def_cursor_p12
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_disassemble_wip_2_1_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #拆件在制成本计算 - 成品入xcci
   #拆件工单-入库资料
   LET g_sql = "SELECT xcck010,xcck011,xcck017,SUM(xcck201*xcck009*-1),xcck002 FROM xcck_tmp", 
               " WHERE xcckent = ",g_enterprise,
               "   AND xcckld  = '",g_ld,"'",
               "   AND xcck001 = ? ",
               "   AND xcck003 = ? ",
               "   AND xcck004 = ",g_yy,
               "   AND xcck005 = ",g_pp,
               "   AND xcck047 = ? ",
               #"   AND xcck020 = '113' ",  #170608-00060#1 mark
               "   AND (xcck020 = '113' OR xcck020 = '106') ",  #170608-00060#1 add
               " GROUP BY xcck010,xcck011,xcck017,xcck002 " 
   PREPARE s_axcp500_def_cursor_p13 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p13"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_disassemble_wip_4_cs1 CURSOR FOR s_axcp500_def_cursor_p13
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_disassemble_wip_4_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   
   #add 150721 zhangllc--begin-- 
   #找工艺委外的单据(取委外加工费)    #工艺委外没有inaj
   #mod 不用pmdu,用pmdt
   #LET g_sql = "SELECT pmdudocno,pmduseq,pmduseq1 FROM pmds_t,pmdt_t,pmdu_t,pmdp_t,sfaa_t ",  #入库单号/退货单号,项次
   #            " WHERE pmdsent = pmdtent AND pmdsdocno = pmdtdocno ",
   #            "   AND pmduent = pmdtent AND pmdudocno = pmdtdocno AND pmduseq = pmdtseq ",
   #            "   AND pmdpent = pmdtent AND pmdpdocno = pmdt001 AND pmdpseq = pmdt002 AND pmdpseq1  = pmdt003 ",
   #            "   AND sfaaent = pmdpent AND sfaadocno = pmdp003 ",
   #            "   AND pmdsent = ",g_enterprise,
   #            "   AND pmdssite IN(SELECT ooef001 FROM ooef_t WHERE ooefent = '",g_enterprise,"'",
   #            "                       AND ooefstus ='Y' AND ooef017 ='",g_comp,"') ",
   #            "   AND pmdp003 = ?     ",  #工单编号
   #            "   AND pmds011 = '2' ",  #采购性质:2委外采购
   #            "   AND pmds001 BETWEEN '",g_bdate,"' AND '",g_edate,"'", #扣帐日期
   #            "   AND pmdsstus = 'S' ", #已委外入库过账
   #            "   AND sfaa061 = 'Y'   ", #制程否
   #            "   AND sfaa057 NOT IN ('2') "  #工单类型：委外
   LET g_sql = "SELECT pmdtdocno,pmdtseq FROM pmds_t,pmdt_t,pmdp_t,sfaa_t ",  #入库单号/退货单号,项次
               "       ,pmdl_t ",  #200227-00025#1 add
               " WHERE pmdsent = pmdtent AND pmdsdocno = pmdtdocno ",
               "   AND pmdpent = pmdtent AND pmdpdocno = pmdt001 AND pmdpseq = pmdt002 AND pmdpseq1  = pmdt003 ",
               "   AND sfaaent = pmdpent AND sfaadocno = pmdp003 ",
               "   AND pmdtent = pmdlent AND pmdt001 = pmdldocno ",  #200227-00025#1
               "   AND pmdsent = ",g_enterprise,
               "   AND pmdssite IN(SELECT ooef001 FROM ooef_t WHERE ooefent = '",g_enterprise,"'",
               "                       AND ooefstus ='Y' AND ooef017 ='",g_comp,"') ",
               "   AND pmdp003 = ?     ",  #工单编号
               "   AND pmds011 = '2' ",  #采购性质:2委外采购
               "   AND pmds001 BETWEEN '",g_bdate,"' AND '",g_edate,"'", #扣帐日期
               "   AND pmdsstus = 'S' ", #已委外入库过账
               #"   AND sfaa061 = 'Y'   ", #制程否  #200227-00025#1 mark
               "   AND (sfaa061 = 'Y' OR pmds026 IS NOT NULL OR pmdl056 IS NOT NULL) ", #200227-00025#1
               "   AND sfaa057 NOT IN ('2') "  #工单类型：委外
   PREPARE s_axcp500_def_cursor_p14 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p14"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_wip_2_3_cs2 CURSOR FOR s_axcp500_def_cursor_p14
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_wip_2_3_cs2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   #add 150721 zhangllc---end---
   
   LET g_sql = " UPDATE xcck_tmp SET ",
               "        xcck010  = ? ,xcck011  = ? ,xcck012  = ? ,xcck013  = ? ,xcck014  = ? , ",
               "        xcck015  = ? ,xcck016  = ? ,xcck017  = ? ,xcck020  = ? ,xcck021  = ? , ",
               "        xcck022  = ? ,xcck023  = ? ,xcck024  = ? ,xcck025  = ? ,xcck026  = ? , ",
               "        xcck027  = ? ,xcck028  = ? ,xcck029  = ? ,xcck030  = ? ,xcck031  = ? , ",
               "        xcck032  = ? ,xcck033  = ? ,xcck034  = ? ,xcck040  = ? ,xcck041  = ? , ",
               "        xcck042  = ? ,xcck043  = ? ,xcck044  = ? ,xcck045  = ? ,xcck046  = ? , ",
               "        xcck047  = ? ,xcck048  = ? ,xcck049  = ? ,xcck050  = ? ,xcck051  = ? , ",
               "        xcck055  = ? ,xcck201  = ? ,xcck202  = ? ,xcck202a = ? ,xcck202b = ? , ",
               "        xcck202c = ? ,xcck202d = ? ,xcck202e = ? ,xcck202f = ? ,xcck202g = ? , ",
               "        xcck202h = ? ,xcck282  = ? ,xcck282a = ? ,xcck282b = ? ,xcck282c = ? , ",
               "        xcck282d = ? ,xcck282e = ? ,xcck282f = ? ,xcck282g = ? ,xcck282h = ? , ",
               "        xcck301  = ? ,xcck302  = ? ,xcck302a = ? ,xcck302b = ? ,xcck302c = ? , ",
               "        xcck302d = ? ,xcck302e = ? ,xcck302f = ? ,xcck302g = ? ,xcck302h = ? , ",
               "        xcck901  = ? ,xcck902  = ? ,xcck902a = ? ,xcck902b = ? ,xcck902c = ? , ",
               "        xcck902d = ? ,xcck902e = ? ,xcck902f = ? ,xcck902g = ? ,xcck902h = ? , ",
               "        xcck980  = ? ,xcck980a = ? ,xcck980b = ? ,xcck980c = ? ,xcck980d = ? , ",
               "        xcck980e = ? ,xcck980f = ? ,xcck980g = ? ,xcck980h = ? ,xcck903  = ? , ",
               "        xcck903a = ? ,xcck903b = ? ,xcck903c = ? ,xcck903d = ? ,xcck903e = ? , ",
               "        xcck903f = ? ,xcck903g = ? ,xcck903h = ? ,xccktmp1 = ? ",     #mod zhangllc 151214 add xccktmp1  
               "  WHERE xcckent = ? ", 
               "    AND xcckld  = ? ", 
               "    AND xcck001 = ? ", 
               "    AND xcck002 = ? ", 
               "    AND xcck003 = ? ", 
               "    AND xcck004 = ? ", 
               "    AND xcck005 = ? ", 
               "    AND xcck006 = ? ", 
               "    AND xcck007 = ? ", 
               "    AND xcck008 = ? ", 
               "    AND xcck009 = ? "      

   PREPARE s_axcp500_def_cursor_p24 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p24"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF
   
   IF g_sys_6021 = 'Y' THEN  #add zhangllc 160526 --SBS1
      #add zhangllc 151215 --begin
      LET g_sql = " UPDATE xccq_tmp SET ",
                  "        xccq101    = ?, xccq102    = ?, xccq102a   = ?, xccq102b   = ?, xccq102c   = ?,",
                  "        xccq102d   = ?, xccq102e   = ?, xccq102f   = ?, xccq102g   = ?, xccq102h   = ?,",
                  "        xccq201    = ?, xccq202    = ?, xccq202a   = ?, xccq202b   = ?, xccq202c   = ?,",
                  "        xccq202d   = ?, xccq202e   = ?, xccq202f   = ?, xccq202g   = ?, xccq202h   = ?,",
                  "        xccq203    = ?, xccq204    = ?, xccq204a   = ?, xccq204b   = ?, xccq204c   = ?,",
                  "        xccq204d   = ?, xccq204e   = ?, xccq204f   = ?, xccq204g   = ?, xccq204h   = ?,",
                  "        xccq205    = ?, xccq206    = ?, xccq206a   = ?, xccq206b   = ?, xccq206c   = ?,",
                  "        xccq206d   = ?, xccq206e   = ?, xccq206f   = ?, xccq206g   = ?, xccq206h   = ?,",
                  "        xccq207    = ?, xccq208    = ?, xccq208a   = ?, xccq208b   = ?, xccq208c   = ?,",
                  "        xccq208d   = ?, xccq208e   = ?, xccq208f   = ?, xccq208g   = ?, xccq208h   = ?,",
                  "        xccq209    = ?, xccq210    = ?, xccq210a   = ?, xccq210b   = ?, xccq210c   = ?,",
                  "        xccq210d   = ?, xccq210e   = ?, xccq210f   = ?, xccq210g   = ?, xccq210h   = ?,",
                  "        xccq211    = ?, xccq212    = ?, xccq212a   = ?, xccq212b   = ?, xccq212c   = ?,",
                  "        xccq212d   = ?, xccq212e   = ?, xccq212f   = ?, xccq212g   = ?, xccq212h   = ?,",
                  "        xccq213    = ?, xccq214    = ?, xccq214a   = ?, xccq214b   = ?, xccq214c   = ?,",
                  "        xccq214d   = ?, xccq214e   = ?, xccq214f   = ?, xccq214g   = ?, xccq214h   = ?,",
                  "        xccq215    = ?, xccq216    = ?, xccq216a   = ?, xccq216b   = ?, xccq216c   = ?,",
                  "        xccq216d   = ?, xccq216e   = ?, xccq216f   = ?, xccq216g   = ?, xccq216h   = ?,",
                  "        xccq217    = ?, xccq218    = ?, xccq218a   = ?, xccq218b   = ?, xccq218c   = ?,",
                  "        xccq218d   = ?, xccq218e   = ?, xccq218f   = ?, xccq218g   = ?, xccq218h   = ?,",
                  "        xccq280    = ?, xccq280a   = ?, xccq280b   = ?, xccq280c   = ?, xccq280d   = ?,",
                  "        xccq280e   = ?, xccq280f   = ?, xccq280g   = ?, xccq280h   = ?, xccq301    = ?,",
                  "        xccq302    = ?, xccq302a   = ?, xccq302b   = ?, xccq302c   = ?, xccq302d   = ?,",
                  "        xccq302e   = ?, xccq302f   = ?, xccq302g   = ?, xccq302h   = ?, xccq303    = ?,",
                  "        xccq304    = ?, xccq304a   = ?, xccq304b   = ?, xccq304c   = ?, xccq304d   = ?,",
                  "        xccq304e   = ?, xccq304f   = ?, xccq304g   = ?, xccq304h   = ?, xccq305    = ?,",
                  "        xccq306    = ?, xccq306a   = ?, xccq306b   = ?, xccq306c   = ?, xccq306d   = ?,",
                  "        xccq306e   = ?, xccq306f   = ?, xccq306g   = ?, xccq306h   = ?, xccq307    = ?,",
                  "        xccq308    = ?, xccq308a   = ?, xccq308b   = ?, xccq308c   = ?, xccq308d   = ?,",
                  "        xccq308e   = ?, xccq308f   = ?, xccq308g   = ?, xccq308h   = ?, xccq309    = ?,",
                  "        xccq310    = ?, xccq310a   = ?, xccq310b   = ?, xccq310c   = ?, xccq310d   = ?,",
                  "        xccq310e   = ?, xccq310f   = ?, xccq310g   = ?, xccq310h   = ?, xccq311    = ?,",
                  "        xccq312    = ?, xccq312a   = ?, xccq312b   = ?, xccq312c   = ?, xccq312d   = ?,",
                  "        xccq312e   = ?, xccq312f   = ?, xccq312g   = ?, xccq312h   = ?, xccq313    = ?,",
                  "        xccq314    = ?, xccq314a   = ?, xccq314b   = ?, xccq314c   = ?, xccq314d   = ?,",
                  "        xccq314e   = ?, xccq314f   = ?, xccq314g   = ?, xccq314h   = ?, xccq401    = ?,",
                  "        xccq402    = ?, xccq901    = ?, xccq902    = ?, xccq902a   = ?, xccq902b   = ?,",
                  "        xccq902c   = ?, xccq902d   = ?, xccq902e   = ?, xccq902f   = ?, xccq902g   = ?,",
                  "        xccq902h   = ?, xccq903    = ?, xccq903a   = ?, xccq903b   = ?, xccq903c   = ?,",
                  "        xccq903d   = ?, xccq903e   = ?, xccq903f   = ?, xccq903g   = ?, xccq903h   = ? ",
                  "  WHERE xccqent = ? ", 
                  "    AND xccqld  = ? ",
                  "    AND xccqsite= ? ",               
                  "    AND xccq001 = ? ", 
                  "    AND xccq002 = ? ", 
                  "    AND xccq003 = ? ", 
                  "    AND xccq004 = ? ", 
                  "    AND xccq005 = ? ", 
                  "    AND xccq006 = ? ", 
                  "    AND xccq007 = ? ", 
                  "    AND xccq008 = ? ", 
                  "    AND xccq009 = ? ",
                  "    AND xccq010 = ? ",
                  "    AND xccq011 = ? ",
                  "    AND xccq012 = ? "
      
      PREPARE s_axcp500_def_cursor_p25_xccq FROM g_sql                                
      IF SQLCA.sqlcode THEN                                               
         INITIALIZE g_errparam TO NULL                                    
         LET g_errparam.code   = SQLCA.sqlcode                            
         LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p25_xccq"              
         LET g_errparam.popup  = TRUE                                     
         CALL cl_err()                                                    
         RETURN r_success                                                 
      END IF 
      #add zhangllc 151215 --end
   END IF   #add zhangllc 160526 --SBS1
   
   LET g_sql = " UPDATE xccc_tmp SET ",
               "        xccc101    = ?, xccc102    = ?, xccc102a   = ?, xccc102b   = ?, xccc102c   = ?,",
               "        xccc102d   = ?, xccc102e   = ?, xccc102f   = ?, xccc102g   = ?, xccc102h   = ?,",
               "        xccc201    = ?, xccc202    = ?, xccc202a   = ?, xccc202b   = ?, xccc202c   = ?,",
               "        xccc202d   = ?, xccc202e   = ?, xccc202f   = ?, xccc202g   = ?, xccc202h   = ?,",
               "        xccc203    = ?, xccc204    = ?, xccc204a   = ?, xccc204b   = ?, xccc204c   = ?,",
               "        xccc204d   = ?, xccc204e   = ?, xccc204f   = ?, xccc204g   = ?, xccc204h   = ?,",
               "        xccc205    = ?, xccc206    = ?, xccc206a   = ?, xccc206b   = ?, xccc206c   = ?,",
               "        xccc206d   = ?, xccc206e   = ?, xccc206f   = ?, xccc206g   = ?, xccc206h   = ?,",
               "        xccc207    = ?, xccc208    = ?, xccc208a   = ?, xccc208b   = ?, xccc208c   = ?,",
               "        xccc208d   = ?, xccc208e   = ?, xccc208f   = ?, xccc208g   = ?, xccc208h   = ?,",
               "        xccc209    = ?, xccc210    = ?, xccc210a   = ?, xccc210b   = ?, xccc210c   = ?,",
               "        xccc210d   = ?, xccc210e   = ?, xccc210f   = ?, xccc210g   = ?, xccc210h   = ?,",
               "        xccc211    = ?, xccc212    = ?, xccc212a   = ?, xccc212b   = ?, xccc212c   = ?,",
               "        xccc212d   = ?, xccc212e   = ?, xccc212f   = ?, xccc212g   = ?, xccc212h   = ?,",
               "        xccc213    = ?, xccc214    = ?, xccc214a   = ?, xccc214b   = ?, xccc214c   = ?,",
               "        xccc214d   = ?, xccc214e   = ?, xccc214f   = ?, xccc214g   = ?, xccc214h   = ?,",
               "        xccc215    = ?, xccc216    = ?, xccc216a   = ?, xccc216b   = ?, xccc216c   = ?,",
               "        xccc216d   = ?, xccc216e   = ?, xccc216f   = ?, xccc216g   = ?, xccc216h   = ?,",
               "        xccc217    = ?, xccc218    = ?, xccc218a   = ?, xccc218b   = ?, xccc218c   = ?,",
               "        xccc218d   = ?, xccc218e   = ?, xccc218f   = ?, xccc218g   = ?, xccc218h   = ?,",
               "        xccc280    = ?, xccc280a   = ?, xccc280b   = ?, xccc280c   = ?, xccc280d   = ?,",
               "        xccc280e   = ?, xccc280f   = ?, xccc280g   = ?, xccc280h   = ?, xccc301    = ?,",
               "        xccc302    = ?, xccc302a   = ?, xccc302b   = ?, xccc302c   = ?, xccc302d   = ?,",
               "        xccc302e   = ?, xccc302f   = ?, xccc302g   = ?, xccc302h   = ?, xccc303    = ?,",
               "        xccc304    = ?, xccc304a   = ?, xccc304b   = ?, xccc304c   = ?, xccc304d   = ?,",
               "        xccc304e   = ?, xccc304f   = ?, xccc304g   = ?, xccc304h   = ?, xccc305    = ?,",
               "        xccc306    = ?, xccc306a   = ?, xccc306b   = ?, xccc306c   = ?, xccc306d   = ?,",
               "        xccc306e   = ?, xccc306f   = ?, xccc306g   = ?, xccc306h   = ?, xccc307    = ?,",
               "        xccc308    = ?, xccc308a   = ?, xccc308b   = ?, xccc308c   = ?, xccc308d   = ?,",
               "        xccc308e   = ?, xccc308f   = ?, xccc308g   = ?, xccc308h   = ?, xccc309    = ?,",
               "        xccc310    = ?, xccc310a   = ?, xccc310b   = ?, xccc310c   = ?, xccc310d   = ?,",
               "        xccc310e   = ?, xccc310f   = ?, xccc310g   = ?, xccc310h   = ?, xccc311    = ?,",
               "        xccc312    = ?, xccc312a   = ?, xccc312b   = ?, xccc312c   = ?, xccc312d   = ?,",
               "        xccc312e   = ?, xccc312f   = ?, xccc312g   = ?, xccc312h   = ?, xccc313    = ?,",
               "        xccc314    = ?, xccc314a   = ?, xccc314b   = ?, xccc314c   = ?, xccc314d   = ?,",
               "        xccc314e   = ?, xccc314f   = ?, xccc314g   = ?, xccc314h   = ?, xccc401    = ?,",
               "        xccc402    = ?, xccc901    = ?, xccc902    = ?, xccc902a   = ?, xccc902b   = ?,",
               "        xccc902c   = ?, xccc902d   = ?, xccc902e   = ?, xccc902f   = ?, xccc902g   = ?,",
               "        xccc902h   = ?, xccc903    = ?, xccc903a   = ?, xccc903b   = ?, xccc903c   = ?,",
               "        xccc903d   = ?, xccc903e   = ?, xccc903f   = ?, xccc903g   = ?, xccc903h   = ? ",
               "  WHERE xcccent = ? ", 
               "    AND xcccld  = ? ", 
               "    AND xccc001 = ? ", 
               "    AND xccc002 = ? ", 
               "    AND xccc003 = ? ", 
               "    AND xccc004 = ? ", 
               "    AND xccc005 = ? ", 
               "    AND xccc006 = ? ", 
               "    AND xccc007 = ? ", 
               "    AND xccc008 = ? " 

   PREPARE s_axcp500_def_cursor_p25 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p25"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF 
   
   LET g_sql = " UPDATE xccd_tmp SET ",
               "        xccd101    = ?, xccd102    = ?, xccd102a   = ?, xccd102b   = ?, xccd102c   = ?,",
               "        xccd102d   = ?, xccd102e   = ?, xccd102f   = ?, xccd102g   = ?, xccd102h   = ?,",
               "        xccd200    = ?,                                                                ",
               "        xccd201    = ?, xccd202    = ?, xccd202a   = ?, xccd202b   = ?, xccd202c   = ?,",
               "        xccd202d   = ?, xccd202e   = ?, xccd202f   = ?, xccd202g   = ?, xccd202h   = ?,",
               "                        xccd204    = ?, xccd204a   = ?, xccd204b   = ?, xccd204c   = ?,",
               "        xccd204d   = ?, xccd204e   = ?, xccd204f   = ?, xccd204g   = ?, xccd204h   = ?,",
               "        xccd301    = ?, xccd302    = ?, xccd302a   = ?, xccd302b   = ?, xccd302c   = ?,",
               "        xccd302d   = ?, xccd302e   = ?, xccd302f   = ?, xccd302g   = ?, xccd302h   = ?,",
               "        xccd303    = ?, xccd304    = ?, xccd304a   = ?, xccd304b   = ?, xccd304c   = ?,",
               "        xccd304d   = ?, xccd304e   = ?, xccd304f   = ?, xccd304g   = ?, xccd304h   = ?,",
               "        xccd901    = ?, xccd902    = ?, xccd902a   = ?, xccd902b   = ?, xccd902c   = ?,",
               "        xccd902d   = ?, xccd902e   = ?, xccd902f   = ?, xccd902g   = ?, xccd902h   = ? ",
               "  WHERE xccdent = ? ", 
               "    AND xccdld  = ? ", 
               "    AND xccd001 = ? ", 
               "    AND xccd002 = ? ", 
               "    AND xccd003 = ? ", 
               "    AND xccd004 = ? ", 
               "    AND xccd005 = ? ", 
               "    AND xccd006 = ? "

   PREPARE s_axcp500_def_cursor_p26 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p26"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF 
   
   LET g_sql = " UPDATE xcce_tmp SET ",
               "        xcce101    = ?, xcce102    = ?, xcce102a   = ?, xcce102b   = ?, xcce102c   = ?,",
               "        xcce102d   = ?, xcce102e   = ?, xcce102f   = ?, xcce102g   = ?, xcce102h   = ?,",
               "        xcce201    = ?, xcce202    = ?, xcce202a   = ?, xcce202b   = ?, xcce202c   = ?,",
               "        xcce202d   = ?, xcce202e   = ?, xcce202f   = ?, xcce202g   = ?, xcce202h   = ?,",
               "        xcce205    = ?, xcce206    = ?, xcce206a   = ?, xcce206b   = ?, xcce206c   = ?,",
               "        xcce206d   = ?, xcce206e   = ?, xcce206f   = ?, xcce206g   = ?, xcce206h   = ?,",
               "        xcce207    = ?, xcce208    = ?, xcce208a   = ?, xcce208b   = ?, xcce208c   = ?,",
               "        xcce208d   = ?, xcce208e   = ?, xcce208f   = ?, xcce208g   = ?, xcce208h   = ?,",
               "        xcce209    = ?, xcce210    = ?, xcce210a   = ?, xcce210b   = ?, xcce210c   = ?,",
               "        xcce210d   = ?, xcce210e   = ?, xcce210f   = ?, xcce210g   = ?, xcce210h   = ?,",
               "        xcce301    = ?, xcce302    = ?, xcce302a   = ?, xcce302b   = ?, xcce302c   = ?,",
               "        xcce302d   = ?, xcce302e   = ?, xcce302f   = ?, xcce302g   = ?, xcce302h   = ?,",
               "        xcce303    = ?, xcce304    = ?, xcce304a   = ?, xcce304b   = ?, xcce304c   = ?,",
               "        xcce304d   = ?, xcce304e   = ?, xcce304f   = ?, xcce304g   = ?, xcce304h   = ?,",
               "        xcce307    = ?, xcce308    = ?, xcce308a   = ?, xcce308b   = ?, xcce308c   = ?,",
               "        xcce308d   = ?, xcce308e   = ?, xcce308f   = ?, xcce308g   = ?, xcce308h   = ?,",
               "        xcce901    = ?, xcce902    = ?, xcce902a   = ?, xcce902b   = ?, xcce902c   = ?,",
               "        xcce902d   = ?, xcce902e   = ?, xcce902f   = ?, xcce902g   = ?, xcce902h   = ? ",
               "  WHERE xcceent = ? ", 
               "    AND xcceld  = ? ", 
               "    AND xcce001 = ? ", 
               "    AND xcce002 = ? ", 
               "    AND xcce003 = ? ", 
               "    AND xcce004 = ? ", 
               "    AND xcce005 = ? ", 
               "    AND xcce006 = ? ",
               "    AND xcce007 = ? ",
               "    AND xcce008 = ? ",
               "    AND xcce009 = ? "

   PREPARE s_axcp500_def_cursor_p28 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p28"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF 
         
   LET g_sql = " UPDATE xccz_tmp SET ",
               "        xccz101    = ?, xccz201    = ?, xccz205   = ?, xccz207   = ?, xccz209   = ?,",
               "        xccz301    = ?, xccz303    = ?, xccz307   = ?, xccz901   = ? ",
               "  WHERE xcczent = ? ", 
               "    AND xcczld  = ? ", 
               "    AND xccz001 = ? ", 
               "    AND xccz002 = ? ", 
               "    AND xccz003 = ? ", 
               "    AND xccz004 = ? ", 
               "    AND xccz005 = ? ", 
               "    AND xccz006 = ? ",
               "    AND xccz007 = ? ",
               "    AND xccz008 = ? ",
               "    AND xccz009 = ? ",
               "    AND xccz010 = ? ",
               "    AND xccz011 = ? "

   PREPARE s_axcp500_def_cursor_p30 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p30"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF 
   
   LET g_sql = " UPDATE xccg_tmp SET ",
               "        xccg101    = ?, xccg102    = ?, xccg102a   = ?, xccg102b   = ?, xccg102c   = ?,",
               "        xccg102d   = ?, xccg102e   = ?, xccg102f   = ?, xccg102g   = ?, xccg102h   = ?,",
               "        xccg301    = ?, xccg302    = ?, xccg302a   = ?, xccg302b   = ?, xccg302c   = ?,",
               "        xccg302d   = ?, xccg302e   = ?, xccg302f   = ?, xccg302g   = ?, xccg302h   = ?,",
               "        xccg901    = ?, xccg902    = ?, xccg902a   = ?, xccg902b   = ?, xccg902c   = ?,",
               "        xccg902d   = ?, xccg902e   = ?, xccg902f   = ?, xccg902g   = ?, xccg902h   = ? ",
               "  WHERE xccgent = ? ", 
               "    AND xccgld  = ? ", 
               "    AND xccg001 = ? ", 
               "    AND xccg002 = ? ", 
               "    AND xccg003 = ? ", 
               "    AND xccg004 = ? ", 
               "    AND xccg005 = ? ", 
               "    AND xccg006 = ? ",
               "    AND xccg007 = ? ",
               "    AND xccg008 = ? ",
               "    AND xccg009 = ? "

   PREPARE s_axcp500_def_cursor_p31 FROM g_sql                                
   IF SQLCA.sqlcode THEN                                               
      INITIALIZE g_errparam TO NULL                                    
      LET g_errparam.code   = SQLCA.sqlcode                            
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p31"              
      LET g_errparam.popup  = TRUE                                     
      CALL cl_err()                                                    
      RETURN r_success                                                 
   END IF    
   
   #170609-00032#1---add--s
   LET g_sql = " SELECT SUM(xcck202),SUM(xcck202a),SUM(xcck202b),SUM(xcck202c),",
               "        SUM(xcck202d),SUM(xcck202e),SUM(xcck202f),SUM(xcck202g),SUM(xcck202h) ",
               "   FROM xcck_tmp ",
               "  WHERE xcckent = ",g_enterprise,
               "    AND xcckld  = '",g_ld,"'",
               "    AND xcck001 = ?",
               "    AND xcck003 = '",g_xcat001,"'",
               "    AND xcck004 = ",g_yy,
               "    AND xcck005 = ",g_pp,
               "    AND xcck047 = ? ", 
               "    AND xcck010 = ? ",
               "    AND xcck011 = ? ",
               "    AND xcck017 = ? ",
               "    AND xcck055 = '3012' AND (xcck020 = '113' OR xcck020 = '106') "  #拆件入库
      
   PREPARE s_axcp500_def_cursor_p32 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p32"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #联产品时,可能已经计算过,本笔要排除掉
   LET g_sql = " SELECT SUM(xcck202),SUM(xcck202a),SUM(xcck202b),SUM(xcck202c), ", 
               "        SUM(xcck202d),SUM(xcck202e),SUM(xcck202f),SUM(xcck202g),SUM(xcck202h) ",
               "  FROM xcck_tmp ",
               " WHERE xcckent = ",g_enterprise,
               "   AND xcckld  = '",g_ld,"'",
               "   AND xcck001 = ?",
               "   AND xcck003 = '",g_xcat001,"'",
               "   AND xcck004 = ",g_yy,
               "   AND xcck005 = ",g_pp,
               "   AND xcck047 = ?",
               "   AND xcck055 = '3012' AND (xcck020 = '113' OR xcck020 = '106')",  #拆件入库
               "   AND xcck006 = ? ", #单号
               "   AND xcck007 = ? ", #项次
               "   AND xcck008 = ? ", #项序
               "   AND xcck009 = ? "  #出入库码
   PREPARE s_axcp500_def_cursor_p33 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p33"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   LET g_sql = "SELECT xcck010,xcck011,xcck017,SUM(xcck201*xcck009*-1),xcck002, ",  
               "       xcck049,xccksite,xcck006,xcck007,xcck008,xcck009 ",  
               "   FROM xcck_tmp", 
               " WHERE xcckent = ",g_enterprise,
               "   AND xcckld  = '",g_ld,"'",
               "   AND xcck001 = ? ",
               "   AND xcck003 = ? ",
               "   AND xcck004 = ",g_yy,
               "   AND xcck005 = ",g_pp,
               "   AND xcck047 = ? ",
               "   AND xcck010 = ? ",
               "   AND xcck011 = ? ",
               "   AND xcck017 = ? ",
               "   AND xcck002 = ? ",
               "   AND (xcck020 = '113' OR xcck020 = '106') ",  
               " GROUP BY xcck010,xcck011,xcck017,xcck002, " ,
               "          xcck049,xccksite,xcck006,xcck007,xcck008,xcck009  " 
   PREPARE s_axcp500_def_cursor_p34 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p34"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_disassemble_wip_4_cs2 CURSOR FOR s_axcp500_def_cursor_p34
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_disassemble_wip_4_cs2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO xccc_tmp ",
               "       USING (SELECT xcckent,xcckld, xcck001,xcck002,xcck003,   ",
               "                     xcck004,xcck005,xcck010,xcck011,xcck017,   ",
               "                     SUM(xcck202*xcck009)  xcck202, SUM(xcck202a*xcck009) xcck202a, ",
               "                     SUM(xcck202b*xcck009) xcck202b,SUM(xcck202c*xcck009) xcck202c,SUM(xcck202d*xcck009) xcck202d,",
               "                     SUM(xcck202e*xcck009) xcck202e,SUM(xcck202f*xcck009) xcck202f,SUM(xcck202g*xcck009) xcck202g,",
               "                     SUM(xcck202h*xcck009) xcck202h ",
               "                FROM xcck_tmp     ",  
               "              WHERE xcckent = ",g_enterprise,
               "                AND xcckld  = '",g_ld,"'",
               "                AND xcck001 = ? ",
               "                AND xcck003 = ? ",
               "                AND xcck004 = ",g_yy,
               "                AND xcck005 = ",g_pp,	
               "                AND xcck010 = ? ",
               "                AND xcck011 = ? ",
               "                AND xcck017 = ? ",			   
               "                AND xcck055 IN ('301','3011','3012') ",
               "                GROUP BY xcckent,xcckld, xcck001,xcck002,xcck003,",
               "                         xcck004,xcck005,xcck010,xcck011,xcck017",
               "                ) b ",
               "          ON ( xcccent = b.xcckent  ",
               "         AND   xcccld  = b.xcckld   ",
               "         AND   xccc001 = b.xcck001  ",
               "         AND   xccc002 = b.xcck002  ",
               "         AND   xccc003 = b.xcck003  ",
               "         AND   xccc004 = b.xcck004  ",
               "         AND   xccc005 = b.xcck005  ",
               "         AND   xccc006 = b.xcck010  ",
               "         AND   xccc007 = b.xcck011  ",
               "         AND   xccc008 = b.xcck017 ) ",
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET xccc302  = nvl(b.xcck202 ,0) ,  ",
               "                xccc302a = nvl(b.xcck202a,0) ,  ",
               "                xccc302b = nvl(b.xcck202b,0) ,  ",
               "                xccc302c = nvl(b.xcck202c,0) ,  ",
               "                xccc302d = nvl(b.xcck202d,0) ,  ",
               "                xccc302e = nvl(b.xcck202e,0) ,  ",
               "                xccc302f = nvl(b.xcck202f,0) ,  ",
               "                xccc302g = nvl(b.xcck202g,0) ,  ",
               "                xccc302h = nvl(b.xcck202h,0)    "
   #PGS(D)-00824 --- end ---
   PREPARE s_axcp500_def_cursor_p35 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p35"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF     
   
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO xccc_tmp ",
               "       USING (SELECT xcckent,xcckld, xcck001,xcck002,xcck003,   ",
               "                     xcck004,xcck005,xcck010,xcck011,xcck017,   ",
               "                     SUM(xcck202*xcck009)  xcck202, SUM(xcck202a*xcck009) xcck202a, ",
               "                     SUM(xcck202b*xcck009) xcck202b,SUM(xcck202c*xcck009) xcck202c,SUM(xcck202d*xcck009) xcck202d,",
               "                     SUM(xcck202e*xcck009) xcck202e,SUM(xcck202f*xcck009) xcck202f,SUM(xcck202g*xcck009) xcck202g,",
               "                     SUM(xcck202h*xcck009) xcck202h ",
               "                FROM xcck_tmp     ",  
               "              WHERE xcckent = ",g_enterprise,
               "                AND xcckld  = '",g_ld,"'",
               "                AND xcck001 = ? ",
               "                AND xcck003 = ? ",
               "                AND xcck004 = ",g_yy,
               "                AND xcck005 = ",g_pp,	
               "                AND xcck010 = ? ",
               "                AND xcck011 = ? ",
               "                AND xcck017 = ? ",			   
               "                AND xcck055 IN ('207') ",
               "                GROUP BY xcckent,xcckld, xcck001,xcck002,xcck003,",
               "                         xcck004,xcck005,xcck010,xcck011,xcck017",
               "                ) b ",
               "          ON ( xcccent = b.xcckent  ",
               "         AND   xcccld  = b.xcckld   ",
               "         AND   xccc001 = b.xcck001  ",
               "         AND   xccc002 = b.xcck002  ",
               "         AND   xccc003 = b.xcck003  ",
               "         AND   xccc004 = b.xcck004  ",
               "         AND   xccc005 = b.xcck005  ",
               "         AND   xccc006 = b.xcck010  ",
               "         AND   xccc007 = b.xcck011  ",
               "         AND   xccc008 = b.xcck017 ) ",
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET xccc208  = nvl(b.xcck202,0)  ,  ",
               "                xccc208a = nvl(b.xcck202a,0) ,  ",
               "                xccc208b = nvl(b.xcck202b,0) ,  ",
               "                xccc208c = nvl(b.xcck202c,0) ,  ",
               "                xccc208d = nvl(b.xcck202d,0) ,  ",
               "                xccc208e = nvl(b.xcck202e,0) ,  ",
               "                xccc208f = nvl(b.xcck202f,0) ,  ",
               "                xccc208g = nvl(b.xcck202g,0) ,  ",
               "                xccc208h = nvl(b.xcck202h,0)    "
   #PGS(D)-00824 --- end ---
   PREPARE s_axcp500_def_cursor_p36 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p36"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF     
   #170609-00032#1---add--e


   #170626-00056#1---add---s
   #结余调整
   UPDATE xccc_tmp SET xccc903  = (xccc102 + xccc202 + xccc204 + xccc206 + xccc208 + xccc210 + xccc212 + xccc214 +
                                  xccc216 + xccc218 + xccc302 + xccc304 + xccc306 + xccc308 + xccc310 + xccc312 +
                                  xccc314 ) * -1 + xccc902 ,
                       xccc903a = (xccc102a + xccc202a + xccc204a + xccc206a + xccc208a + xccc210a + xccc212a + xccc214a +
                                  xccc216a + xccc218a + xccc302a + xccc304a + xccc306a + xccc308a + xccc310a + xccc312a +
                                  xccc314a ) * -1 + xccc902a ,
                       xccc903b = (xccc102b + xccc202b + xccc204b + xccc206b + xccc208b + xccc210b + xccc212b + xccc214b +
                                  xccc216b + xccc218b + xccc302b + xccc304b + xccc306b + xccc308b + xccc310b + xccc312b +
                                  xccc314b) * -1  + xccc902b ,
                       xccc903c = (xccc102c + xccc202c + xccc204c + xccc206c + xccc208c + xccc210c + xccc212c + xccc214c +
                                  xccc216c + xccc218c + xccc302c + xccc304c + xccc306c + xccc308c + xccc310c + xccc312c +
                                  xccc314c) * -1  + xccc902c ,
                       xccc903d = (xccc102d + xccc202d + xccc204d + xccc206d + xccc208d + xccc210d + xccc212d + xccc214d +
                                  xccc216d + xccc218d + xccc302d + xccc304d + xccc306d + xccc308d + xccc310d + xccc312d +
                                  xccc314d) * -1  + xccc902d ,
                       xccc903e = (xccc102e + xccc202e + xccc204e + xccc206e + xccc208e + xccc210e + xccc212e + xccc214e +
                                  xccc216e + xccc218e + xccc302e + xccc304e + xccc306e + xccc308e + xccc310e + xccc312e +
                                  xccc314e) * -1  + xccc902e ,
                       xccc903f = (xccc102f + xccc202f + xccc204f + xccc206f + xccc208f + xccc210f + xccc212f + xccc214f +
                                  xccc216f + xccc218f + xccc302f + xccc304f + xccc306f + xccc308f + xccc310f + xccc312f +
                                  xccc314f) * -1  + xccc902f ,
                       xccc903g = (xccc102g + xccc202g + xccc204g + xccc206g + xccc208g + xccc210g + xccc212g + xccc214g +
                                  xccc216g + xccc218g + xccc302g + xccc304g + xccc306g + xccc308g + xccc310g + xccc312g +
                                  xccc314g) * -1  + xccc902g ,
                       xccc903h = (xccc102h + xccc202h + xccc204h + xccc206h + xccc208h + xccc210h + xccc212h + xccc214h +
                                  xccc216h + xccc218h + xccc302h + xccc304h + xccc306h + xccc308h + xccc310h + xccc312h +
                                  xccc314h) * -1  + xccc902h

   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE xccc_tmp SET xccc903"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error('','','','','','','','','','','',
                               '',SQLCA.sqlcode,'','UPDATE xccc_tmp SET xccc903')         
   END IF     
   #170626-00056#1---add---e
   
   
   #171017-00040#1 add (s)      
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO xcck_tmp a ",
               " USING (SELECT xcckent,xcckld,xcck001,xcck002,xcck003,",
               "               xcck004,xcck005,xcck006,xcck007,xcck008,",
               "               xcck009,(xcck202+xcci302) xcck202, ",
               "               (xcck202a+xcci302a) xcck202a, ",
               "               (xcck202b+xcci302b) xcck202b, ",
               "               (xcck202c+xcci302c) xcck202c, ",
               "               (xcck202d+xcci302d) xcck202d, ",
               "               (xcck202e+xcci302e) xcck202e, ",
               "               (xcck202f+xcci302f) xcck202f, ",
               "               (xcck202g+xcci302g) xcck202g, ",
               "               (xcck202h+xcci302h) xcck202h ",
               "          FROM ( SELECT xcckent,xcckld,xcck001,xcck002,xcck003,",
               "                        xcck004,xcck005,xcck006,xcck007,xcck008,xcck009,xcci301,xcci302,xcci302a,xcci302b,xcci302c,xcci302d,xcci302e,xcci302f,xcci302g,xcci302h,",
               "                        SUM(xcck201*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck201,",
               "                        SUM(xcck202*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202,",
               "                        SUM(xcck202a*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202a,",
               "                        SUM(xcck202b*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202b,",
               "                        SUM(xcck202c*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202c,",
               "                        SUM(xcck202d*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202d,",
               "                        SUM(xcck202e*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202e,",
               "                        SUM(xcck202f*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202f,",
               "                        SUM(xcck202g*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202g,",             
               "                        SUM(xcck202h*xcck009) OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck047,xcck010,xcck011,xcck017) xcck202h,",
               "                        ROW_NUMBER() OVER(PARTITION BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck010,xcck011,xcck017  ",
               "                                              ORDER BY xcckent,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,xcck010,xcck011,xcck017,xcck202 DESC ) AS numm",
               "                   FROM xcck_tmp,xcci_t",
               "                  WHERE xccient = xcckent",
               "                    AND xccild  = xcckld",
               "                    AND xcci001 = xcck001",
               "                    AND xcci002 = xcck002",
               "                    AND xcci003 = xcck003",
               "                    AND xcci004 = xcck004",
               "                    AND xcci005 = xcck005",
               "                    AND xcci006 = xcck047",
               "                    AND xcci007 = xcck010",
               "                    AND xcci008 = xcck011",
               "                    AND xcci009 = xcck017",
               "                    AND xcckent = ",g_enterprise,
               "                    AND xcck001 = ? ",
               "                    AND xcck003 = ? ",
               "                    AND xcck004 = ",g_yy,
               "                    AND xcck005 = ",g_pp,	               
               "                    AND xcck047 = ? ",
               "                    AND xcck010 = ? ",
               "                    AND xcck011 = ? ",
               "                    AND xcck017 = ? ",
               "                    AND xcck055 = '3012' AND (xcck020 = '113' OR xcck020 = '106')) ",
               #"         WHERE xcck201 + xcci301 = 0 AND xcck202 + xcci302 <> 0 AND numm = 1) b",  #200617-00029#1 mark
               #200617-00029#1---add---s
               "         WHERE xcck201 + xcci301 = 0 AND numm = 1 ",
               "           AND (xcck202 + xcci302 <> 0 ",
               "             OR xcck202a + xcci302a <> 0 ",
               "             OR xcck202b + xcci302b <> 0 ",
               "             OR xcck202c + xcci302c <> 0 ",
               "             OR xcck202d + xcci302d <> 0 ",
               "             OR xcck202e + xcci302e <> 0 ",
               "             OR xcck202f + xcci302f <> 0 ",
               "             OR xcck202g + xcci302g <> 0 ",
               "             OR xcck202h + xcci302h <> 0 )",
               "     ) b",  
               #200617-00029#1---add---e
               "    ON (a.xcckent = b.xcckent ",
               "   AND  a.xcckld  = b.xcckld  ",
               "   AND  a.xcck001 = b.xcck001 ",
               "   AND  a.xcck002 = b.xcck002 ",
               "   AND  a.xcck003 = b.xcck003 ",
               "   AND  a.xcck004 = b.xcck004 ",
               "   AND  a.xcck005 = b.xcck005 ",
               "   AND  a.xcck006 = b.xcck006 ",
               "   AND  a.xcck007 = b.xcck007 ",
               "   AND  a.xcck008 = b.xcck008 ",
               "   AND  a.xcck009 = b.xcck009)",
               "  WHEN MATCHED THEN    ",
               "  UPDATE SET a.xcck202  = a.xcck202 - b.xcck202, ",
               "             a.xcck202a  = a.xcck202a - b.xcck202a, ",
               "             a.xcck202b  = a.xcck202b - b.xcck202b, ",
               "             a.xcck202c  = a.xcck202c - b.xcck202c, ",
               "             a.xcck202d  = a.xcck202d - b.xcck202d, ",
               "             a.xcck202e  = a.xcck202e - b.xcck202e, ",
               "             a.xcck202f  = a.xcck202f - b.xcck202f, ",
               "             a.xcck202g  = a.xcck202g - b.xcck202g, ",
               "             a.xcck202h  = a.xcck202h - b.xcck202h "
   #PGS(D)-00824 --- end ---
   PREPARE s_axcp500_def_cursor_p37 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_def_cursor_p37"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF                 
   #171017-00040#1 add (e)
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 各成本计算方式共用:从xcck中取资料置于xccq
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccq_from_xcck()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccq_from_xcck()
   DEFINE l_choice        LIKE type_t.chr10
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_sum           type_get_cost_rec
   DEFINE l_condition     LIKE type_t.chr100
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   #201(采购入库) 203(委外入库) 205(一般工单入库,含拆件) 211(杂入) 217(其他入库)  313(调拨出)
   #207(本期重工领出) 215(本期销退入库)
   #209(重工入库)
   #205(入库) 301(工单领用) 303(销货) 305(销退) 307(销售费用) 309(杂发) 311(盘盈亏)

   FOREACH s_axcp500_get_xccq_from_xcck_cs1 USING g_xccq.xccqsite,g_xccq.xccq001,g_xccq.xccq002,g_xccq.xccq003,
                                                  g_xccq.xccq004 ,g_xccq.xccq005,g_xccq.xccq006,g_xccq.xccq007,
                                                  g_xccq.xccq008 ,g_xccq.xccq009,g_xccq.xccq010,g_xccq.xccq011,
                                                  g_xccq.xccq012
                                             INTO l_choice,l_sum.*
                                             
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_xccq_from_xcck_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error(g_xccq.xccq001,g_xccq.xccq002,g_xccq.xccq004,g_xccq.xccq005,
                                  '','','','',g_xccq.xccq006,g_xccq.xccq007,g_xccq.xccq008,'',
                                  SQLCA.sqlcode,'','FOREACH s_axcp500_get_xccq_from_xcck_cs1')
            
         CONTINUE FOREACH
      END IF
      
      CASE l_choice
           #mod zhangllc 160224  还原151203修改。2011和2012是为了区分金额不同的抓取方式，抓完回归上级201，因为后面将xcck整批写入xccc的时候会直接按这个分类sum出数量金额后直接赋值给xccc201/202的，不是用累加的方式，了都能算到，不会一个覆盖掉另一个，这边xcck055还是归集到最上层的采购入库类型201
           WHEN '201'  #采购入库
           #WHEN '2011'  #采购入库  #mod zhangllc 151203
                LET g_xccq.xccq201  = l_sum.qty
                LET g_xccq.xccq202  = l_sum.tot
                LET g_xccq.xccq202a = l_sum.a
                LET g_xccq.xccq202b = l_sum.b
                LET g_xccq.xccq202c = l_sum.c
                LET g_xccq.xccq202d = l_sum.d
                LET g_xccq.xccq202e = l_sum.e
                LET g_xccq.xccq202f = l_sum.f
                LET g_xccq.xccq202g = l_sum.g
                LET g_xccq.xccq202h = l_sum.h
           ##add zhangllc 151203 --s
           #WHEN '2012'  #采购入库
           #     LET g_xccq.xccq201  = l_sum.qty
           #     LET g_xccq.xccq202  = l_sum.tot
           #     LET g_xccq.xccq202a = l_sum.a
           #     LET g_xccq.xccq202b = l_sum.b
           #     LET g_xccq.xccq202c = l_sum.c
           #     LET g_xccq.xccq202d = l_sum.d
           #     LET g_xccq.xccq202e = l_sum.e
           #     LET g_xccq.xccq202f = l_sum.f
           #     LET g_xccq.xccq202g = l_sum.g
           #     LET g_xccq.xccq202h = l_sum.h
           ##add zhangllc 151203 --e
           WHEN '203'  #委外入库
                LET g_xccq.xccq203  = l_sum.qty     
                LET g_xccq.xccq204  = l_sum.tot     
                LET g_xccq.xccq204a = l_sum.a       
                LET g_xccq.xccq204b = l_sum.b       
                LET g_xccq.xccq204c = l_sum.c       
                LET g_xccq.xccq204d = l_sum.d       
                LET g_xccq.xccq204e = l_sum.e       
                LET g_xccq.xccq204f = l_sum.f       
                LET g_xccq.xccq204g = l_sum.g       
                LET g_xccq.xccq204h = l_sum.h           
           WHEN '205'  #一般工单入库
                LET g_xccq.xccq205  = l_sum.qty     
                LET g_xccq.xccq206  = l_sum.tot     
                LET g_xccq.xccq206a = l_sum.a       
                LET g_xccq.xccq206b = l_sum.b       
                LET g_xccq.xccq206c = l_sum.c       
                LET g_xccq.xccq206d = l_sum.d       
                LET g_xccq.xccq206e = l_sum.e       
                LET g_xccq.xccq206f = l_sum.f       
                LET g_xccq.xccq206g = l_sum.g       
                LET g_xccq.xccq206h = l_sum.h      
           WHEN '207'  #重工领出
                LET g_xccq.xccq207  = l_sum.qty     
                LET g_xccq.xccq208  = l_sum.tot     
                LET g_xccq.xccq208a = l_sum.a       
                LET g_xccq.xccq208b = l_sum.b       
                LET g_xccq.xccq208c = l_sum.c       
                LET g_xccq.xccq208d = l_sum.d       
                LET g_xccq.xccq208e = l_sum.e       
                LET g_xccq.xccq208f = l_sum.f       
                LET g_xccq.xccq208g = l_sum.g       
                LET g_xccq.xccq208h = l_sum.h       
           WHEN '209'  #重工入库
                LET g_xccq.xccq209  = l_sum.qty     
                LET g_xccq.xccq210  = l_sum.tot     
                LET g_xccq.xccq210a = l_sum.a       
                LET g_xccq.xccq210b = l_sum.b       
                LET g_xccq.xccq210c = l_sum.c       
                LET g_xccq.xccq210d = l_sum.d       
                LET g_xccq.xccq210e = l_sum.e       
                LET g_xccq.xccq210f = l_sum.f       
                LET g_xccq.xccq210g = l_sum.g       
                LET g_xccq.xccq210h = l_sum.h              
           WHEN '211'  #杂项入库
                LET g_xccq.xccq211  = l_sum.qty     
                LET g_xccq.xccq212  = l_sum.tot     
                LET g_xccq.xccq212a = l_sum.a       
                LET g_xccq.xccq212b = l_sum.b       
                LET g_xccq.xccq212c = l_sum.c       
                LET g_xccq.xccq212d = l_sum.d       
                LET g_xccq.xccq212e = l_sum.e       
                LET g_xccq.xccq212f = l_sum.f       
                LET g_xccq.xccq212g = l_sum.g       
                LET g_xccq.xccq212h = l_sum.h 
           #add zhangllc 151208 --begin           
           WHEN '213'  #调整入库--当站下线(调整入库栏位相当于其他入库栏位)
                LET g_xccq.xccq213  = l_sum.qty     
                LET g_xccq.xccq214  = l_sum.tot     
                LET g_xccq.xccq214a = l_sum.a       
                LET g_xccq.xccq214b = l_sum.b       
                LET g_xccq.xccq214c = l_sum.c       
                LET g_xccq.xccq214d = l_sum.d       
                LET g_xccq.xccq214e = l_sum.e       
                LET g_xccq.xccq214f = l_sum.f       
                LET g_xccq.xccq214g = l_sum.g       
                LET g_xccq.xccq214h = l_sum.h  
           #add zhangllc 151208 --end               
           WHEN '215'  #销退入库
                LET g_xccq.xccq215  = l_sum.qty     
                LET g_xccq.xccq216  = l_sum.tot     
                LET g_xccq.xccq216a = l_sum.a       
                LET g_xccq.xccq216b = l_sum.b       
                LET g_xccq.xccq216c = l_sum.c       
                LET g_xccq.xccq216d = l_sum.d       
                LET g_xccq.xccq216e = l_sum.e       
                LET g_xccq.xccq216f = l_sum.f       
                LET g_xccq.xccq216g = l_sum.g       
                LET g_xccq.xccq216h = l_sum.h        
           WHEN '217'  #其他入库->151208 含义已改成调拨入库
                LET g_xccq.xccq217  = l_sum.qty     
                LET g_xccq.xccq218  = l_sum.tot     
                LET g_xccq.xccq218a = l_sum.a       
                LET g_xccq.xccq218b = l_sum.b       
                LET g_xccq.xccq218c = l_sum.c       
                LET g_xccq.xccq218d = l_sum.d       
                LET g_xccq.xccq218e = l_sum.e       
                LET g_xccq.xccq218f = l_sum.f       
                LET g_xccq.xccq218g = l_sum.g       
                LET g_xccq.xccq218h = l_sum.h  
           WHEN '301'  #工单领用
                LET g_xccq.xccq301  = l_sum.qty
                LET g_xccq.xccq302  = l_sum.tot
                LET g_xccq.xccq302a = l_sum.a  
                LET g_xccq.xccq302b = l_sum.b  
                LET g_xccq.xccq302c = l_sum.c  
                LET g_xccq.xccq302d = l_sum.d  
                LET g_xccq.xccq302e = l_sum.e  
                LET g_xccq.xccq302f = l_sum.f  
                LET g_xccq.xccq302g = l_sum.g  
                LET g_xccq.xccq302h = l_sum.h  
           WHEN '303'  #销货
                LET g_xccq.xccq303  = l_sum.qty
                LET g_xccq.xccq304  = l_sum.tot
                LET g_xccq.xccq304a = l_sum.a  
                LET g_xccq.xccq304b = l_sum.b  
                LET g_xccq.xccq304c = l_sum.c  
                LET g_xccq.xccq304d = l_sum.d  
                LET g_xccq.xccq304e = l_sum.e  
                LET g_xccq.xccq304f = l_sum.f  
                LET g_xccq.xccq304g = l_sum.g  
                LET g_xccq.xccq304h = l_sum.h  
           WHEN '305'  #销退
                LET g_xccq.xccq305  = l_sum.qty
                LET g_xccq.xccq306  = l_sum.tot
                LET g_xccq.xccq306a = l_sum.a  
                LET g_xccq.xccq306b = l_sum.b  
                LET g_xccq.xccq306c = l_sum.c  
                LET g_xccq.xccq306d = l_sum.d  
                LET g_xccq.xccq306e = l_sum.e  
                LET g_xccq.xccq306f = l_sum.f  
                LET g_xccq.xccq306g = l_sum.g  
                LET g_xccq.xccq306h = l_sum.h  
           WHEN '307'  #销售费用
                LET g_xccq.xccq307  = l_sum.qty
                LET g_xccq.xccq308  = l_sum.tot
                LET g_xccq.xccq308a = l_sum.a  
                LET g_xccq.xccq308b = l_sum.b  
                LET g_xccq.xccq308c = l_sum.c  
                LET g_xccq.xccq308d = l_sum.d  
                LET g_xccq.xccq308e = l_sum.e  
                LET g_xccq.xccq308f = l_sum.f  
                LET g_xccq.xccq308g = l_sum.g  
                LET g_xccq.xccq308h = l_sum.h  
           WHEN '309' OR '309X' #杂发  #161109-00032#3 add '309X' #项目投料退料
                LET g_xccq.xccq309  = l_sum.qty
                LET g_xccq.xccq310  = l_sum.tot
                LET g_xccq.xccq310a = l_sum.a  
                LET g_xccq.xccq310b = l_sum.b  
                LET g_xccq.xccq310c = l_sum.c  
                LET g_xccq.xccq310d = l_sum.d  
                LET g_xccq.xccq310e = l_sum.e  
                LET g_xccq.xccq310f = l_sum.f  
                LET g_xccq.xccq310g = l_sum.g  
                LET g_xccq.xccq310h = l_sum.h  
           WHEN '311'  #盘盈亏
                LET g_xccq.xccq311  = l_sum.qty
                LET g_xccq.xccq312  = l_sum.tot
                LET g_xccq.xccq312a = l_sum.a  
                LET g_xccq.xccq312b = l_sum.b  
                LET g_xccq.xccq312c = l_sum.c  
                LET g_xccq.xccq312d = l_sum.d  
                LET g_xccq.xccq312e = l_sum.e  
                LET g_xccq.xccq312f = l_sum.f  
                LET g_xccq.xccq312g = l_sum.g  
                LET g_xccq.xccq312h = l_sum.h         
           WHEN '313'  #其他出库
                LET g_xccq.xccq313  = l_sum.qty
                LET g_xccq.xccq314  = l_sum.tot
                LET g_xccq.xccq314a = l_sum.a  
                LET g_xccq.xccq314b = l_sum.b  
                LET g_xccq.xccq314c = l_sum.c  
                LET g_xccq.xccq314d = l_sum.d  
                LET g_xccq.xccq314e = l_sum.e  
                LET g_xccq.xccq314f = l_sum.f  
                LET g_xccq.xccq314g = l_sum.g  
                LET g_xccq.xccq314h = l_sum.h      
      END CASE              
   END FOREACH 

   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 各成本计算方式共用:从xcck中取资料置于xccc
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccc_from_xcck()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-10-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccc_from_xcck()
   DEFINE l_choice        LIKE type_t.chr10
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_sum           type_get_cost_rec
   DEFINE l_condition     LIKE type_t.chr100
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   #201(采购入库) 203(委外入库) 205(一般工单入库,含拆件) 211(杂入) 217(其他入库)  313(调拨出)
   #207(本期重工领出) 215(本期销退入库)
   #209(重工入库)
   #205(入库) 301(工单领用) 303(销货) 305(销退) 307(销售费用) 309(杂发) 311(盘盈亏)
   
   FOREACH s_axcp500_get_xccc_from_xcck_cs1 USING g_xccc.xccc001,g_xccc.xccc002,g_xccc.xccc003,g_xccc.xccc004,
                                                  g_xccc.xccc005,g_xccc.xccc006,g_xccc.xccc007,g_xccc.xccc008
                                             INTO l_choice,l_sum.*
                                             
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_xccc_from_xcck_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error(g_xccc.xccc001,g_xccc.xccc002,g_xccc.xccc004,g_xccc.xccc005,
                                  '','','','',g_xccc.xccc006,g_xccc.xccc007,g_xccc.xccc008,'',
                                  SQLCA.sqlcode,'','FOREACH s_axcp500_get_xccc_from_xcck_cs1')
            
         CONTINUE FOREACH
      END IF
      
      CASE l_choice
           #mod zhangllc 160224  还原151203修改。2011和2012是为了区分金额不同的抓取方式，抓完回归上级201，因为后面将xcck整批写入xccc的时候会直接按这个分类sum出数量金额后直接赋值给xccc201/202的，不是用累加的方式，了都能算到，不会一个覆盖掉另一个，这边xcck055还是归集到最上层的采购入库类型201
           WHEN '201'  #采购入库
           #WHEN '2011'  #采购入库  #mod zhangllc 151203
                LET g_xccc.xccc201  = l_sum.qty
                LET g_xccc.xccc202  = l_sum.tot
                LET g_xccc.xccc202a = l_sum.a
                LET g_xccc.xccc202b = l_sum.b
                LET g_xccc.xccc202c = l_sum.c
                LET g_xccc.xccc202d = l_sum.d
                LET g_xccc.xccc202e = l_sum.e
                LET g_xccc.xccc202f = l_sum.f
                LET g_xccc.xccc202g = l_sum.g
                LET g_xccc.xccc202h = l_sum.h
           ##add zhangllc 151203 --s
           #WHEN '2012'  #采购入库
           #     LET g_xccc.xccc201  = l_sum.qty
           #     LET g_xccc.xccc202  = l_sum.tot
           #     LET g_xccc.xccc202a = l_sum.a
           #     LET g_xccc.xccc202b = l_sum.b
           #     LET g_xccc.xccc202c = l_sum.c
           #     LET g_xccc.xccc202d = l_sum.d
           #     LET g_xccc.xccc202e = l_sum.e
           #     LET g_xccc.xccc202f = l_sum.f
           #     LET g_xccc.xccc202g = l_sum.g
           #     LET g_xccc.xccc202h = l_sum.h
           ##add zhangllc 151203 --e
           WHEN '203'  #委外入库
                LET g_xccc.xccc203  = l_sum.qty     
                LET g_xccc.xccc204  = l_sum.tot     
                LET g_xccc.xccc204a = l_sum.a       
                LET g_xccc.xccc204b = l_sum.b       
                LET g_xccc.xccc204c = l_sum.c       
                LET g_xccc.xccc204d = l_sum.d       
                LET g_xccc.xccc204e = l_sum.e       
                LET g_xccc.xccc204f = l_sum.f       
                LET g_xccc.xccc204g = l_sum.g       
                LET g_xccc.xccc204h = l_sum.h           
           WHEN '205'  #一般工单入库
                LET g_xccc.xccc205  = l_sum.qty     
                LET g_xccc.xccc206  = l_sum.tot     
                LET g_xccc.xccc206a = l_sum.a       
                LET g_xccc.xccc206b = l_sum.b       
                LET g_xccc.xccc206c = l_sum.c       
                LET g_xccc.xccc206d = l_sum.d       
                LET g_xccc.xccc206e = l_sum.e       
                LET g_xccc.xccc206f = l_sum.f       
                LET g_xccc.xccc206g = l_sum.g       
                LET g_xccc.xccc206h = l_sum.h      
           WHEN '207'  #重工领出
                LET g_xccc.xccc207  = l_sum.qty     
                LET g_xccc.xccc208  = l_sum.tot     
                LET g_xccc.xccc208a = l_sum.a       
                LET g_xccc.xccc208b = l_sum.b       
                LET g_xccc.xccc208c = l_sum.c       
                LET g_xccc.xccc208d = l_sum.d       
                LET g_xccc.xccc208e = l_sum.e       
                LET g_xccc.xccc208f = l_sum.f       
                LET g_xccc.xccc208g = l_sum.g       
                LET g_xccc.xccc208h = l_sum.h       
           WHEN '209'  #重工入库
                LET g_xccc.xccc209  = l_sum.qty     
                LET g_xccc.xccc210  = l_sum.tot     
                LET g_xccc.xccc210a = l_sum.a       
                LET g_xccc.xccc210b = l_sum.b       
                LET g_xccc.xccc210c = l_sum.c       
                LET g_xccc.xccc210d = l_sum.d       
                LET g_xccc.xccc210e = l_sum.e       
                LET g_xccc.xccc210f = l_sum.f       
                LET g_xccc.xccc210g = l_sum.g       
                LET g_xccc.xccc210h = l_sum.h              
           WHEN '211'  #杂项入库
                LET g_xccc.xccc211  = l_sum.qty     
                LET g_xccc.xccc212  = l_sum.tot     
                LET g_xccc.xccc212a = l_sum.a       
                LET g_xccc.xccc212b = l_sum.b       
                LET g_xccc.xccc212c = l_sum.c       
                LET g_xccc.xccc212d = l_sum.d       
                LET g_xccc.xccc212e = l_sum.e       
                LET g_xccc.xccc212f = l_sum.f       
                LET g_xccc.xccc212g = l_sum.g       
                LET g_xccc.xccc212h = l_sum.h 
           #add zhangllc 151208 --begin           
           WHEN '213'  #调整入库--当站下线(调整入库栏位相当于其他入库栏位)
                LET g_xccc.xccc213  = l_sum.qty     
                LET g_xccc.xccc214  = l_sum.tot     
                LET g_xccc.xccc214a = l_sum.a       
                LET g_xccc.xccc214b = l_sum.b       
                LET g_xccc.xccc214c = l_sum.c       
                LET g_xccc.xccc214d = l_sum.d       
                LET g_xccc.xccc214e = l_sum.e       
                LET g_xccc.xccc214f = l_sum.f       
                LET g_xccc.xccc214g = l_sum.g       
                LET g_xccc.xccc214h = l_sum.h  
           #add zhangllc 151208 --end               
           WHEN '215'  #销退入库
                LET g_xccc.xccc215  = l_sum.qty     
                LET g_xccc.xccc216  = l_sum.tot     
                LET g_xccc.xccc216a = l_sum.a       
                LET g_xccc.xccc216b = l_sum.b       
                LET g_xccc.xccc216c = l_sum.c       
                LET g_xccc.xccc216d = l_sum.d       
                LET g_xccc.xccc216e = l_sum.e       
                LET g_xccc.xccc216f = l_sum.f       
                LET g_xccc.xccc216g = l_sum.g       
                LET g_xccc.xccc216h = l_sum.h        
           WHEN '217'  #其他入库->151208 含义已改成调拨入库
                LET g_xccc.xccc217  = l_sum.qty     
                LET g_xccc.xccc218  = l_sum.tot     
                LET g_xccc.xccc218a = l_sum.a       
                LET g_xccc.xccc218b = l_sum.b       
                LET g_xccc.xccc218c = l_sum.c       
                LET g_xccc.xccc218d = l_sum.d       
                LET g_xccc.xccc218e = l_sum.e       
                LET g_xccc.xccc218f = l_sum.f       
                LET g_xccc.xccc218g = l_sum.g       
                LET g_xccc.xccc218h = l_sum.h  
           WHEN '301'  #工单领用
                LET g_xccc.xccc301  = l_sum.qty
                LET g_xccc.xccc302  = l_sum.tot
                LET g_xccc.xccc302a = l_sum.a  
                LET g_xccc.xccc302b = l_sum.b  
                LET g_xccc.xccc302c = l_sum.c  
                LET g_xccc.xccc302d = l_sum.d  
                LET g_xccc.xccc302e = l_sum.e  
                LET g_xccc.xccc302f = l_sum.f  
                LET g_xccc.xccc302g = l_sum.g  
                LET g_xccc.xccc302h = l_sum.h  
           WHEN '303'  #销货
                LET g_xccc.xccc303  = l_sum.qty
                LET g_xccc.xccc304  = l_sum.tot
                LET g_xccc.xccc304a = l_sum.a  
                LET g_xccc.xccc304b = l_sum.b  
                LET g_xccc.xccc304c = l_sum.c  
                LET g_xccc.xccc304d = l_sum.d  
                LET g_xccc.xccc304e = l_sum.e  
                LET g_xccc.xccc304f = l_sum.f  
                LET g_xccc.xccc304g = l_sum.g  
                LET g_xccc.xccc304h = l_sum.h  
           WHEN '305'  #销退
                LET g_xccc.xccc305  = l_sum.qty
                LET g_xccc.xccc306  = l_sum.tot
                LET g_xccc.xccc306a = l_sum.a  
                LET g_xccc.xccc306b = l_sum.b  
                LET g_xccc.xccc306c = l_sum.c  
                LET g_xccc.xccc306d = l_sum.d  
                LET g_xccc.xccc306e = l_sum.e  
                LET g_xccc.xccc306f = l_sum.f  
                LET g_xccc.xccc306g = l_sum.g  
                LET g_xccc.xccc306h = l_sum.h  
           WHEN '307'  #销售费用
                LET g_xccc.xccc307  = l_sum.qty
                LET g_xccc.xccc308  = l_sum.tot
                LET g_xccc.xccc308a = l_sum.a  
                LET g_xccc.xccc308b = l_sum.b  
                LET g_xccc.xccc308c = l_sum.c  
                LET g_xccc.xccc308d = l_sum.d  
                LET g_xccc.xccc308e = l_sum.e  
                LET g_xccc.xccc308f = l_sum.f  
                LET g_xccc.xccc308g = l_sum.g  
                LET g_xccc.xccc308h = l_sum.h  
           WHEN '309' OR '309X' #杂发  #161109-00032#3 add '309X' #项目投料退料
                LET g_xccc.xccc309  = l_sum.qty
                LET g_xccc.xccc310  = l_sum.tot
                LET g_xccc.xccc310a = l_sum.a  
                LET g_xccc.xccc310b = l_sum.b  
                LET g_xccc.xccc310c = l_sum.c  
                LET g_xccc.xccc310d = l_sum.d  
                LET g_xccc.xccc310e = l_sum.e  
                LET g_xccc.xccc310f = l_sum.f  
                LET g_xccc.xccc310g = l_sum.g  
                LET g_xccc.xccc310h = l_sum.h  
           WHEN '311'  #盘盈亏
                LET g_xccc.xccc311  = l_sum.qty
                LET g_xccc.xccc312  = l_sum.tot
                LET g_xccc.xccc312a = l_sum.a  
                LET g_xccc.xccc312b = l_sum.b  
                LET g_xccc.xccc312c = l_sum.c  
                LET g_xccc.xccc312d = l_sum.d  
                LET g_xccc.xccc312e = l_sum.e  
                LET g_xccc.xccc312f = l_sum.f  
                LET g_xccc.xccc312g = l_sum.g  
                LET g_xccc.xccc312h = l_sum.h         
           WHEN '313'  #其他出库
                LET g_xccc.xccc313  = l_sum.qty
                LET g_xccc.xccc314  = l_sum.tot
                LET g_xccc.xccc314a = l_sum.a  
                LET g_xccc.xccc314b = l_sum.b  
                LET g_xccc.xccc314c = l_sum.c  
                LET g_xccc.xccc314d = l_sum.d  
                LET g_xccc.xccc314e = l_sum.e  
                LET g_xccc.xccc314f = l_sum.f  
                LET g_xccc.xccc314g = l_sum.g  
                LET g_xccc.xccc314h = l_sum.h      
      END CASE              
   END FOREACH 

   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 各成本计算方式共用:得到xccq_t的资料
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccq(p_xccqsite,p_xccq001,p_xccq002,p_xccq006,p_xccq007,p_xccq008,p_xccq009,p_xccq010,p_xccq011,p_xccq012)
#                       RETURNING r_success
# Input parameter: p_xccqsite     營運組織    
#                : p_xccq001      记帐本位币顺序
#                : p_xccq002      成本域
#                : p_xccq006      料件编号
#                : p_xccq007      特征
#                : p_xccq008      批号
#                : p_xccq009      库存管理特征
#                : p_xccq010      倉庫
#                : p_xccq011      儲位
#                : p_xccq012      品类
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccq(p_xccqsite,p_xccq001,p_xccq002,p_xccq006,p_xccq007,p_xccq008,p_xccq009,p_xccq010,p_xccq011,p_xccq012)
   DEFINE p_xccqsite      LIKE xccq_t.xccqsite
   DEFINE p_xccq001       LIKE xccq_t.xccq001
   DEFINE p_xccq002       LIKE xccq_t.xccq002
   DEFINE p_xccq006       LIKE xccq_t.xccq006
   DEFINE p_xccq007       LIKE xccq_t.xccq007
   DEFINE p_xccq008       LIKE xccq_t.xccq008
   DEFINE p_xccq009       LIKE xccq_t.xccq009
   DEFINE p_xccq010       LIKE xccq_t.xccq010
   DEFINE p_xccq011       LIKE xccq_t.xccq011
   DEFINE p_xccq012       LIKE xccq_t.xccq012
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_xccq          type_g_xccq   #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_xccq RECORD  #料件庫存成本期異動明細統計檔
#       xccqent LIKE xccq_t.xccqent, #企业编号
#       xccqcomp LIKE xccq_t.xccqcomp, #法人组织
#       xccqld LIKE xccq_t.xccqld, #账套
#       xccqsite LIKE xccq_t.xccqsite, #营运组织
#       xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
#       xccq002 LIKE xccq_t.xccq002, #成本域
#       xccq003 LIKE xccq_t.xccq003, #成本计算类型
#       xccq004 LIKE xccq_t.xccq004, #年度
#       xccq005 LIKE xccq_t.xccq005, #期别
#       xccq006 LIKE xccq_t.xccq006, #料号
#       xccq007 LIKE xccq_t.xccq007, #特性码
#       xccq008 LIKE xccq_t.xccq008, #批号
#       xccq009 LIKE xccq_t.xccq009, #库存管理特征
#       xccq010 LIKE xccq_t.xccq010, #仓库
#       xccq011 LIKE xccq_t.xccq011, #储位
#       xccq012 LIKE xccq_t.xccq012, #品类
#       xccq101 LIKE xccq_t.xccq101, #上期结存数量
#       xccq102 LIKE xccq_t.xccq102, #上期结存金额
#       xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
#       xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
#       xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
#       xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
#       xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
#       xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
#       xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
#       xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
#       xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
#       xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
#       xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
#       xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
#       xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
#       xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
#       xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
#       xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
#       xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
#       xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
#       xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
#       xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
#       xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
#       xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
#       xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
#       xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
#       xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
#       xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
#       xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
#       xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
#       xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
#       xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
#       xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
#       xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
#       xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
#       xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
#       xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
#       xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
#       xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
#       xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
#       xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
#       xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
#       xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
#       xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
#       xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
#       xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
#       xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
#       xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
#       xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
#       xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
#       xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
#       xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
#       xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
#       xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
#       xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
#       xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
#       xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
#       xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
#       xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
#       xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
#       xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
#       xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
#       xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
#       xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
#       xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
#       xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
#       xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
#       xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
#       xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
#       xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
#       xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
#       xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
#       xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
#       xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
#       xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
#       xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
#       xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
#       xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
#       xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
#       xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
#       xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
#       xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
#       xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
#       xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
#       xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
#       xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
#       xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
#       xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
#       xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
#       xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
#       xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
#       xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
#       xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
#       xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
#       xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
#       xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
#       xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
#       xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
#       xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
#       xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
#       xccq280 LIKE xccq_t.xccq280, #本期平均单价
#       xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
#       xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
#       xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
#       xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
#       xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
#       xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
#       xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
#       xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
#       xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
#       xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
#       xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
#       xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
#       xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
#       xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
#       xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
#       xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
#       xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
#       xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
#       xccq303 LIKE xccq_t.xccq303, #本期销货数量
#       xccq304 LIKE xccq_t.xccq304, #本期销货成本
#       xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
#       xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
#       xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
#       xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
#       xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
#       xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
#       xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
#       xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
#       xccq305 LIKE xccq_t.xccq305, #本期销退数量
#       xccq306 LIKE xccq_t.xccq306, #本期销退成本
#       xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
#       xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
#       xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
#       xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
#       xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
#       xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
#       xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
#       xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
#       xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
#       xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
#       xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
#       xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
#       xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
#       xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
#       xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
#       xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
#       xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
#       xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
#       xccq309 LIKE xccq_t.xccq309, #本期杂发数量
#       xccq310 LIKE xccq_t.xccq310, #本期杂发金额
#       xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
#       xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
#       xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
#       xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
#       xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
#       xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
#       xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
#       xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
#       xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
#       xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
#       xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
#       xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
#       xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
#       xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
#       xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
#       xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
#       xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
#       xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
#       xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
#       xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
#       xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
#       xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
#       xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
#       xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
#       xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
#       xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
#       xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
#       xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
#       xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
#       xccq402 LIKE xccq_t.xccq402, #本期销退金额
#       xccq901 LIKE xccq_t.xccq901, #期末结存数量
#       xccq902 LIKE xccq_t.xccq902, #期末结存金额
#       xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
#       xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
#       xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
#       xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
#       xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
#       xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
#       xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
#       xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
#       xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
#       xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
#       xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
#       xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
#       xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
#       xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
#       xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
#       xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
#       xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
#       xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_qty           LIKE xccq_t.xccq201
   DEFINE l_avg           type_g_std_cost
   
   #标准/加权使用
   #
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE        
   INITIALIZE g_xccq.* TO NULL

   #取得xccq_t的值
   CALL s_axcp500_get_xccq(p_xccqsite,p_xccq001,p_xccq002,p_xccq006,p_xccq007,p_xccq008,p_xccq009,p_xccq010,p_xccq011,p_xccq012)
        RETURNING l_xccq.*
   LET g_xccq.* = l_xccq.*
   
   #将xcck的资料成本信息汇总至xccq
   CALL s_axcp500_get_xccq_from_xcck()
        RETURNING l_success
   IF NOT l_success THEN
#     RETURN r_success
   END IF
      
   ##本期调整入库 '213'  #同s_cost_realtime,无法分摊
   #CALL s_axcp500_get_adjust_xccq() 
         
   CALL s_axcp500_set_xccq_null_to_zero(g_xccq.*)
        RETURNING g_xccq.*
        
   IF g_cost_type = '2' THEN  #先进先出
      #平均单价=总金额/总数量
      LET l_qty   = g_xccq.xccq101 + g_xccq.xccq201 + g_xccq.xccq203 + g_xccq.xccq205 + g_xccq.xccq207 +
                    g_xccq.xccq209 + g_xccq.xccq211 + g_xccq.xccq213 + g_xccq.xccq215 + g_xccq.xccq217 +
                    g_xccq.xccq301 + g_xccq.xccq303 + g_xccq.xccq305 + g_xccq.xccq307 + g_xccq.xccq309 +
                    g_xccq.xccq311 + g_xccq.xccq313  

      LET l_avg.sum = g_xccq.xccq102 + g_xccq.xccq202 + g_xccq.xccq204 + g_xccq.xccq206 + g_xccq.xccq208 +
                      g_xccq.xccq210 + g_xccq.xccq212 + g_xccq.xccq214 + g_xccq.xccq216 + g_xccq.xccq218 +
                      g_xccq.xccq302 + g_xccq.xccq304 + g_xccq.xccq306 + g_xccq.xccq308 + g_xccq.xccq310 +
                      g_xccq.xccq312 + g_xccq.xccq314 
                      
      LET l_avg.a = g_xccq.xccq102a + g_xccq.xccq202a + g_xccq.xccq204a + g_xccq.xccq206a + g_xccq.xccq208a +
                    g_xccq.xccq210a + g_xccq.xccq212a + g_xccq.xccq214a + g_xccq.xccq216a + g_xccq.xccq218a +
                    g_xccq.xccq302a + g_xccq.xccq304a + g_xccq.xccq306a + g_xccq.xccq308a + g_xccq.xccq310a +
                    g_xccq.xccq312a + g_xccq.xccq314a       
                    
      LET l_avg.b = g_xccq.xccq102b + g_xccq.xccq202b + g_xccq.xccq204b + g_xccq.xccq206b + g_xccq.xccq208b +
                    g_xccq.xccq210b + g_xccq.xccq212b + g_xccq.xccq214b + g_xccq.xccq216b + g_xccq.xccq218b +
                    g_xccq.xccq302b + g_xccq.xccq304b + g_xccq.xccq306b + g_xccq.xccq308b + g_xccq.xccq310b +
                    g_xccq.xccq312b + g_xccq.xccq314b    
                      
      LET l_avg.c = g_xccq.xccq102c + g_xccq.xccq202c + g_xccq.xccq204c + g_xccq.xccq206c + g_xccq.xccq208c +
                    g_xccq.xccq210c + g_xccq.xccq212c + g_xccq.xccq214c + g_xccq.xccq216c + g_xccq.xccq218c +
                    g_xccq.xccq302c + g_xccq.xccq304c + g_xccq.xccq306c + g_xccq.xccq308c + g_xccq.xccq310c +
                    g_xccq.xccq312c + g_xccq.xccq314c   
                        
      LET l_avg.d = g_xccq.xccq102d + g_xccq.xccq202d + g_xccq.xccq204d + g_xccq.xccq206d + g_xccq.xccq208d +
                    g_xccq.xccq210d + g_xccq.xccq212d + g_xccq.xccq214d + g_xccq.xccq216d + g_xccq.xccq218d +
                    g_xccq.xccq302d + g_xccq.xccq304d + g_xccq.xccq306d + g_xccq.xccq308d + g_xccq.xccq310d +
                    g_xccq.xccq312d + g_xccq.xccq314d             
                    
      LET l_avg.e = g_xccq.xccq102e + g_xccq.xccq202e + g_xccq.xccq204e + g_xccq.xccq206e + g_xccq.xccq208e +
                    g_xccq.xccq210e + g_xccq.xccq212e + g_xccq.xccq214e + g_xccq.xccq216e + g_xccq.xccq218e +
                    g_xccq.xccq302e + g_xccq.xccq304e + g_xccq.xccq306e + g_xccq.xccq308e + g_xccq.xccq310e +
                    g_xccq.xccq312e + g_xccq.xccq314e                                          
                    
      LET l_avg.f = g_xccq.xccq102f + g_xccq.xccq202f + g_xccq.xccq204f + g_xccq.xccq206f + g_xccq.xccq208f +
                    g_xccq.xccq210f + g_xccq.xccq212f + g_xccq.xccq214f + g_xccq.xccq216f + g_xccq.xccq218f +
                    g_xccq.xccq302f + g_xccq.xccq304f + g_xccq.xccq306f + g_xccq.xccq308f + g_xccq.xccq310f +
                    g_xccq.xccq312f + g_xccq.xccq314f   
                        
      LET l_avg.g = g_xccq.xccq102g + g_xccq.xccq202g + g_xccq.xccq204g + g_xccq.xccq206g + g_xccq.xccq208g +
                    g_xccq.xccq210g + g_xccq.xccq212g + g_xccq.xccq214g + g_xccq.xccq216g + g_xccq.xccq218g +
                    g_xccq.xccq302g + g_xccq.xccq304g + g_xccq.xccq306g + g_xccq.xccq308g + g_xccq.xccq310g +
                    g_xccq.xccq312g + g_xccq.xccq314g   
                        
      LET l_avg.h = g_xccq.xccq102h + g_xccq.xccq202h + g_xccq.xccq204h + g_xccq.xccq206h + g_xccq.xccq208h +
                    g_xccq.xccq210h + g_xccq.xccq212h + g_xccq.xccq214h + g_xccq.xccq216h + g_xccq.xccq218h +
                    g_xccq.xccq302h + g_xccq.xccq304h + g_xccq.xccq306h + g_xccq.xccq308h + g_xccq.xccq310h +
                    g_xccq.xccq312h + g_xccq.xccq314h  
      #170705-00006#1 mark(s)
      #LET l_avg.sum = l_avg.sum / l_qty 
      #LET l_avg.a = l_avg.a / l_qty                      
      #LET l_avg.b = l_avg.b / l_qty                      
      #LET l_avg.c = l_avg.c / l_qty                      
      #LET l_avg.d = l_avg.d / l_qty                      
      #LET l_avg.e = l_avg.e / l_qty                      
      #LET l_avg.f = l_avg.f / l_qty                      
      #LET l_avg.g = l_avg.g / l_qty                      
      #LET l_avg.h = l_avg.h / l_qty
      #170705-00006#1 mark(E)
      #170705-00006#1 add(S)
      IF l_qty <> 0 THEN
         LET l_avg.sum = l_avg.sum / l_qty 
         LET l_avg.a = l_avg.a / l_qty                      
         LET l_avg.b = l_avg.b / l_qty                      
         LET l_avg.c = l_avg.c / l_qty                      
         LET l_avg.d = l_avg.d / l_qty                      
         LET l_avg.e = l_avg.e / l_qty                      
         LET l_avg.f = l_avg.f / l_qty                      
         LET l_avg.g = l_avg.g / l_qty                      
         LET l_avg.h = l_avg.h / l_qty 
      ELSE 
         LET l_avg.sum = 0 
         LET l_avg.a = 0                      
         LET l_avg.b = 0                      
         LET l_avg.c = 0                      
         LET l_avg.d = 0                      
         LET l_avg.e = 0                      
         LET l_avg.f = 0                      
         LET l_avg.g = 0                      
         LET l_avg.h = 0      
      END IF
      #170705-00006#1 add(E)      
      CALL s_axcp500_get_round_setting(g_xccq.xccq006)


      CALL s_num_round(g_round_type,l_avg.sum,g_curr[p_xccq001].digit1) RETURNING l_avg.sum
      CALL s_num_round(g_round_type,l_avg.a,  g_curr[p_xccq001].digit1) RETURNING l_avg.a     
      CALL s_num_round(g_round_type,l_avg.b,  g_curr[p_xccq001].digit1) RETURNING l_avg.b     
      CALL s_num_round(g_round_type,l_avg.c,  g_curr[p_xccq001].digit1) RETURNING l_avg.c     
      CALL s_num_round(g_round_type,l_avg.d,  g_curr[p_xccq001].digit1) RETURNING l_avg.d     
      CALL s_num_round(g_round_type,l_avg.e,  g_curr[p_xccq001].digit1) RETURNING l_avg.e     
      CALL s_num_round(g_round_type,l_avg.f,  g_curr[p_xccq001].digit1) RETURNING l_avg.f     
      CALL s_num_round(g_round_type,l_avg.g,  g_curr[p_xccq001].digit1) RETURNING l_avg.g     
      CALL s_num_round(g_round_type,l_avg.h,  g_curr[p_xccq001].digit1) RETURNING l_avg.h  
      LET l_avg.a = l_avg.sum - ( l_avg.b + l_avg.c + l_avg.d + l_avg.e + l_avg.f + l_avg.g + l_avg.h)      

   END IF


    CASE g_cost_type 
         WHEN '1'  #取标准成本
#                   CALL s_axcp500_std_get_std_cost(g_xccq.xccq001,g_xccq.xccq002,g_xcag001,g_xccq.xccq006)  #171211-00028#13 mark
                   CALL s_axcp500_std_get_std_cost1(g_xccq.xccq001,g_xccq.xccq002,g_xcag001,g_xccq.xccq006,g_xccq.xccq007)  #171211-00028#13 mod
                        RETURNING l_success,l_avg.*

         WHEN '4'  #取最近移动加权平均成本
                   CALL s_axcp500_moving_get_xccu_cost(g_xccq.xccq001,g_xccq.xccq002,g_xcat001,g_xccq.xccq006,
                                                       g_xccq.xccq007,g_xccq.xccq008,0)
                        RETURNING l_qty,l_avg.*
    
    
    END CASE

   
   LET g_xccq.xccq280a = l_avg.a        #本期平均单价-材料
   LET g_xccq.xccq280b = l_avg.b        #本期平均单价-人工
   LET g_xccq.xccq280c = l_avg.c        #本期平均单价-加工
   LET g_xccq.xccq280d = l_avg.d        #本期平均单价-制费1
   LET g_xccq.xccq280e = l_avg.e        #本期平均单价-制费2
   LET g_xccq.xccq280f = l_avg.f        #本期平均单价-制费3
   LET g_xccq.xccq280g = l_avg.g        #本期平均单价-制费4
   LET g_xccq.xccq280h = l_avg.h        #本期平均单价-制费5
   LET g_xccq.xccq280  = l_avg.sum       #本期平均单价

   CALL s_axcp500_sum_xccq(g_xccq.*)
        RETURNING g_xccq.*

   CALL s_axcp500_ins_or_upd_xccq(g_xccq.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 各成本计算方式共用:得到xccc_t的资料
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccc(p_seq,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_xccc002      成本域
#                : p_xccc006      料件编号
#                : p_xccc007      特征
#                : p_xccc008      批号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-10-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccc(p_seq,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_xccc002       LIKE xccc_t.xccc002
   DEFINE p_xccc006       LIKE xccc_t.xccc006
   DEFINE p_xccc007       LIKE xccc_t.xccc007
   DEFINE p_xccc008       LIKE xccc_t.xccc008
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_xccc          type_g_xccc #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_xccc RECORD  #料件庫存成本期異動統計檔
#       xcccent LIKE xccc_t.xcccent, #企业编号
#       xccccomp LIKE xccc_t.xccccomp, #法人组织
#       xcccld LIKE xccc_t.xcccld, #账套
#       xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
#       xccc002 LIKE xccc_t.xccc002, #成本域
#       xccc003 LIKE xccc_t.xccc003, #成本计算类型
#       xccc004 LIKE xccc_t.xccc004, #年度
#       xccc005 LIKE xccc_t.xccc005, #期别
#       xccc006 LIKE xccc_t.xccc006, #料号
#       xccc007 LIKE xccc_t.xccc007, #产品特征
#       xccc008 LIKE xccc_t.xccc008, #批号
#       xccc010 LIKE xccc_t.xccc010, #核算币种
#       xccc101 LIKE xccc_t.xccc101, #上期结存数量
#       xccc102 LIKE xccc_t.xccc102, #上期结存金额
#       xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
#       xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
#       xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
#       xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
#       xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
#       xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
#       xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
#       xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
#       xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
#       xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
#       xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
#       xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
#       xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
#       xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
#       xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
#       xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
#       xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
#       xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
#       xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
#       xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
#       xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
#       xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
#       xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
#       xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
#       xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
#       xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
#       xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
#       xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
#       xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
#       xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
#       xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
#       xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
#       xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
#       xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
#       xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
#       xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
#       xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
#       xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
#       xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
#       xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
#       xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
#       xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
#       xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
#       xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
#       xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
#       xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
#       xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
#       xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
#       xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
#       xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
#       xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
#       xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
#       xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
#       xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
#       xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
#       xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
#       xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
#       xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
#       xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
#       xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
#       xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
#       xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
#       xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
#       xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
#       xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
#       xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
#       xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
#       xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
#       xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
#       xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
#       xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
#       xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
#       xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
#       xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
#       xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
#       xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
#       xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
#       xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
#       xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
#       xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
#       xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
#       xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
#       xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
#       xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
#       xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
#       xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
#       xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
#       xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
#       xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
#       xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
#       xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
#       xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
#       xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
#       xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
#       xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
#       xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
#       xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
#       xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
#       xccc280 LIKE xccc_t.xccc280, #本期平均单价
#       xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
#       xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
#       xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
#       xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
#       xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
#       xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
#       xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
#       xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
#       xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
#       xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
#       xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
#       xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
#       xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
#       xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
#       xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
#       xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
#       xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
#       xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
#       xccc303 LIKE xccc_t.xccc303, #本期销货数量
#       xccc304 LIKE xccc_t.xccc304, #本期销货成本
#       xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
#       xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
#       xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
#       xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
#       xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
#       xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
#       xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
#       xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
#       xccc305 LIKE xccc_t.xccc305, #本期销退数量
#       xccc306 LIKE xccc_t.xccc306, #本期销退成本
#       xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
#       xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
#       xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
#       xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
#       xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
#       xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
#       xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
#       xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
#       xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
#       xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
#       xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
#       xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
#       xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
#       xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
#       xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
#       xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
#       xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
#       xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
#       xccc309 LIKE xccc_t.xccc309, #本期杂发数量
#       xccc310 LIKE xccc_t.xccc310, #本期杂发金额
#       xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
#       xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
#       xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
#       xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
#       xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
#       xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
#       xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
#       xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
#       xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
#       xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
#       xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
#       xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
#       xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
#       xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
#       xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
#       xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
#       xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
#       xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
#       xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
#       xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
#       xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
#       xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
#       xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
#       xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
#       xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
#       xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
#       xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
#       xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
#       xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
#       xccc402 LIKE xccc_t.xccc402, #本期销退金额
#       xccc901 LIKE xccc_t.xccc901, #期末结存数量
#       xccc902 LIKE xccc_t.xccc902, #期末结存金额
#       xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
#       xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
#       xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
#       xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
#       xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
#       xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
#       xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
#       xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
#       xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
#       xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
#       xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
#       xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
#       xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
#       xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
#       xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
#       xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
#       xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
#       xccctime LIKE xccc_t.xccctime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_qty           LIKE xccc_t.xccc201
   DEFINE l_avg           type_g_std_cost
   
   #标准/加权使用
   #
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE        
   INITIALIZE g_xccc.* TO NULL

   #取得xccc_t的值
   CALL s_axcp500_get_xccc(p_seq,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
        RETURNING l_xccc.*
   LET g_xccc.* = l_xccc.*
   
   #将xcck的资料成本信息汇总至xccc
   CALL s_axcp500_get_xccc_from_xcck()
        RETURNING l_success
   IF NOT l_success THEN
#     RETURN r_success
   END IF
      
   #本期调整入库 '213'
   CALL s_axcp500_get_adjust(g_xccc.xccc001,g_xccc.xccc002,g_xccc.xccc006,g_xccc.xccc007,g_xccc.xccc008)  
         
   CALL s_axcp500_set_xccc_null_to_zero(g_xccc.*)
        RETURNING g_xccc.*
        
   IF g_cost_type = '2' THEN  #先进先出
      #平均单价=总金额/总数量
      LET l_qty   = g_xccc.xccc101 + g_xccc.xccc201 + g_xccc.xccc203 + g_xccc.xccc205 + g_xccc.xccc207 +
                    g_xccc.xccc209 + g_xccc.xccc211 + g_xccc.xccc213 + g_xccc.xccc215 + g_xccc.xccc217 +
                    g_xccc.xccc301 + g_xccc.xccc303 + g_xccc.xccc305 + g_xccc.xccc307 + g_xccc.xccc309 +
                    g_xccc.xccc311 + g_xccc.xccc313  

      LET l_avg.sum = g_xccc.xccc102 + g_xccc.xccc202 + g_xccc.xccc204 + g_xccc.xccc206 + g_xccc.xccc208 +
                      g_xccc.xccc210 + g_xccc.xccc212 + g_xccc.xccc214 + g_xccc.xccc216 + g_xccc.xccc218 +
                      g_xccc.xccc302 + g_xccc.xccc304 + g_xccc.xccc306 + g_xccc.xccc308 + g_xccc.xccc310 +
                      g_xccc.xccc312 + g_xccc.xccc314 
                      
      LET l_avg.a = g_xccc.xccc102a + g_xccc.xccc202a + g_xccc.xccc204a + g_xccc.xccc206a + g_xccc.xccc208a +
                    g_xccc.xccc210a + g_xccc.xccc212a + g_xccc.xccc214a + g_xccc.xccc216a + g_xccc.xccc218a +
                    g_xccc.xccc302a + g_xccc.xccc304a + g_xccc.xccc306a + g_xccc.xccc308a + g_xccc.xccc310a +
                    g_xccc.xccc312a + g_xccc.xccc314a       
                    
      LET l_avg.b = g_xccc.xccc102b + g_xccc.xccc202b + g_xccc.xccc204b + g_xccc.xccc206b + g_xccc.xccc208b +
                    g_xccc.xccc210b + g_xccc.xccc212b + g_xccc.xccc214b + g_xccc.xccc216b + g_xccc.xccc218b +
                    g_xccc.xccc302b + g_xccc.xccc304b + g_xccc.xccc306b + g_xccc.xccc308b + g_xccc.xccc310b +
                    g_xccc.xccc312b + g_xccc.xccc314b    
                      
      LET l_avg.c = g_xccc.xccc102c + g_xccc.xccc202c + g_xccc.xccc204c + g_xccc.xccc206c + g_xccc.xccc208c +
                    g_xccc.xccc210c + g_xccc.xccc212c + g_xccc.xccc214c + g_xccc.xccc216c + g_xccc.xccc218c +
                    g_xccc.xccc302c + g_xccc.xccc304c + g_xccc.xccc306c + g_xccc.xccc308c + g_xccc.xccc310c +
                    g_xccc.xccc312c + g_xccc.xccc314c   
                        
      LET l_avg.d = g_xccc.xccc102d + g_xccc.xccc202d + g_xccc.xccc204d + g_xccc.xccc206d + g_xccc.xccc208d +
                    g_xccc.xccc210d + g_xccc.xccc212d + g_xccc.xccc214d + g_xccc.xccc216d + g_xccc.xccc218d +
                    g_xccc.xccc302d + g_xccc.xccc304d + g_xccc.xccc306d + g_xccc.xccc308d + g_xccc.xccc310d +
                    g_xccc.xccc312d + g_xccc.xccc314d             
                    
      LET l_avg.e = g_xccc.xccc102e + g_xccc.xccc202e + g_xccc.xccc204e + g_xccc.xccc206e + g_xccc.xccc208e +
                    g_xccc.xccc210e + g_xccc.xccc212e + g_xccc.xccc214e + g_xccc.xccc216e + g_xccc.xccc218e +
                    g_xccc.xccc302e + g_xccc.xccc304e + g_xccc.xccc306e + g_xccc.xccc308e + g_xccc.xccc310e +
                    g_xccc.xccc312e + g_xccc.xccc314e                                          
                    
      LET l_avg.f = g_xccc.xccc102f + g_xccc.xccc202f + g_xccc.xccc204f + g_xccc.xccc206f + g_xccc.xccc208f +
                    g_xccc.xccc210f + g_xccc.xccc212f + g_xccc.xccc214f + g_xccc.xccc216f + g_xccc.xccc218f +
                    g_xccc.xccc302f + g_xccc.xccc304f + g_xccc.xccc306f + g_xccc.xccc308f + g_xccc.xccc310f +
                    g_xccc.xccc312f + g_xccc.xccc314f   
                        
      LET l_avg.g = g_xccc.xccc102g + g_xccc.xccc202g + g_xccc.xccc204g + g_xccc.xccc206g + g_xccc.xccc208g +
                    g_xccc.xccc210g + g_xccc.xccc212g + g_xccc.xccc214g + g_xccc.xccc216g + g_xccc.xccc218g +
                    g_xccc.xccc302g + g_xccc.xccc304g + g_xccc.xccc306g + g_xccc.xccc308g + g_xccc.xccc310g +
                    g_xccc.xccc312g + g_xccc.xccc314g   
                        
      LET l_avg.h = g_xccc.xccc102h + g_xccc.xccc202h + g_xccc.xccc204h + g_xccc.xccc206h + g_xccc.xccc208h +
                    g_xccc.xccc210h + g_xccc.xccc212h + g_xccc.xccc214h + g_xccc.xccc216h + g_xccc.xccc218h +
                    g_xccc.xccc302h + g_xccc.xccc304h + g_xccc.xccc306h + g_xccc.xccc308h + g_xccc.xccc310h +
                    g_xccc.xccc312h + g_xccc.xccc314h  
      #170705-00006#1 mark(S)
      #LET l_avg.sum = l_avg.sum / l_qty 
      #LET l_avg.a = l_avg.a / l_qty                      
      #LET l_avg.b = l_avg.b / l_qty                      
      #LET l_avg.c = l_avg.c / l_qty                      
      #LET l_avg.d = l_avg.d / l_qty                      
      #LET l_avg.e = l_avg.e / l_qty                      
      #LET l_avg.f = l_avg.f / l_qty                      
      #LET l_avg.g = l_avg.g / l_qty                      
      #LET l_avg.h = l_avg.h / l_qty 
      #170705-00006#1 mark(E)
      #170705-00006#1 add(S)
      IF l_qty <> 0 THEN
         LET l_avg.sum = l_avg.sum / l_qty 
         LET l_avg.a = l_avg.a / l_qty                      
         LET l_avg.b = l_avg.b / l_qty                      
         LET l_avg.c = l_avg.c / l_qty                      
         LET l_avg.d = l_avg.d / l_qty                      
         LET l_avg.e = l_avg.e / l_qty                      
         LET l_avg.f = l_avg.f / l_qty                      
         LET l_avg.g = l_avg.g / l_qty                      
         LET l_avg.h = l_avg.h / l_qty 
      ELSE
         LET l_avg.sum = 0 
         LET l_avg.a = 0                      
         LET l_avg.b = 0                      
         LET l_avg.c = 0                      
         LET l_avg.d = 0                      
         LET l_avg.e = 0                     
         LET l_avg.f = 0                      
         LET l_avg.g = 0                      
         LET l_avg.h = 0
      END IF    
      #170705-00006#1 add(E)              
      CALL s_axcp500_get_round_setting(g_xccc.xccc006)


      CALL s_num_round(g_round_type,l_avg.sum,g_curr[p_seq].digit1) RETURNING l_avg.sum
      CALL s_num_round(g_round_type,l_avg.a,  g_curr[p_seq].digit1) RETURNING l_avg.a     
      CALL s_num_round(g_round_type,l_avg.b,  g_curr[p_seq].digit1) RETURNING l_avg.b     
      CALL s_num_round(g_round_type,l_avg.c,  g_curr[p_seq].digit1) RETURNING l_avg.c     
      CALL s_num_round(g_round_type,l_avg.d,  g_curr[p_seq].digit1) RETURNING l_avg.d     
      CALL s_num_round(g_round_type,l_avg.e,  g_curr[p_seq].digit1) RETURNING l_avg.e     
      CALL s_num_round(g_round_type,l_avg.f,  g_curr[p_seq].digit1) RETURNING l_avg.f     
      CALL s_num_round(g_round_type,l_avg.g,  g_curr[p_seq].digit1) RETURNING l_avg.g     
      CALL s_num_round(g_round_type,l_avg.h,  g_curr[p_seq].digit1) RETURNING l_avg.h  
      LET l_avg.a = l_avg.sum - ( l_avg.b + l_avg.c + l_avg.d + l_avg.e + l_avg.f + l_avg.g + l_avg.h)      

   END IF
   
#   #若平均单位为零
#   IF l_avg.sum = 0 THEN
  
#      END IF
#   END IF

    CASE g_cost_type 
         WHEN '1'  #取标准成本
#                   CALL s_axcp500_std_get_std_cost(p_seq,g_xccc.xccc002,g_xcag001,g_xccc.xccc006) #171211-00028#13 mark
                   CALL s_axcp500_std_get_std_cost1(p_seq,g_xccc.xccc002,g_xcag001,g_xccc.xccc006,g_xccc.xccc007) #171211-00028#13 mod
                        RETURNING l_success,l_avg.*

         WHEN '4'  #取最近移动加权平均成本
                   CALL s_axcp500_moving_get_xccu_cost(p_seq,g_xccc.xccc002,g_xcat001,g_xccc.xccc006,
                                                       g_xccc.xccc007,g_xccc.xccc008,0)
                        RETURNING l_qty,l_avg.*
    
    
    END CASE

   
   LET g_xccc.xccc280a = l_avg.a        #本期平均单价-材料
   LET g_xccc.xccc280b = l_avg.b        #本期平均单价-人工
   LET g_xccc.xccc280c = l_avg.c        #本期平均单价-加工
   LET g_xccc.xccc280d = l_avg.d        #本期平均单价-制费1
   LET g_xccc.xccc280e = l_avg.e        #本期平均单价-制费2
   LET g_xccc.xccc280f = l_avg.f        #本期平均单价-制费3
   LET g_xccc.xccc280g = l_avg.g        #本期平均单价-制费4
   LET g_xccc.xccc280h = l_avg.h        #本期平均单价-制费5
   
   LET g_xccc.xccc280 = l_avg.sum       #本期平均单价

   CALL s_axcp500_sum_xccc(g_xccc.*)
        RETURNING g_xccc.*

   CALL s_axcp500_ins_or_upd_xccc(g_xccc.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET r_success = TRUE
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: 成本计算--取得录入DEFAULT值
# Memo...........:
# Usage..........: CALL ss_axcp500_get_input_default(p_site,p_date,p_ld,p_xcat001)
#                       RETURNING r_ld,r_cost_type,r_field_flag,r_yy,r_pp
# Input parameter: p_site         营运据点
#                : p_date         日期
#                : p_ld           帐套
#                : p_xcat001      成本计算类型
# Return code....: r_ld           帐套
#                : r_cost_type    成本计算类型
#                : r_field_flag   成本要素否
#                : r_yy           年度
#                : r_pp           期别
# Date & Author..: 2014-07-18 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_input_default(p_site,p_date,p_ld,p_xcat001)
   DEFINE p_site          LIKE inaj_t.inajsite
   DEFINE p_date          LIKE type_t.dat
   DEFINE p_ld            LIKE glaa_t.glaald
   DEFINE p_xcat001       LIKE xcat_t.xcat001
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_comp          LIKE ooef_t.ooef017                #法人
   DEFINE r_ld            LIKE glaa_t.glaald                 #帐套  
   DEFINE r_cost_type     LIKE xcat_t.xcat001
   DEFINE r_field_flag    LIKE type_t.chr1
   DEFINE r_yy            LIKE type_t.num5
   DEFINE r_pp            LIKE type_t.num5 
   DEFINE l_xcat005       LIKE xcat_t.xcat005
   DEFINE l_glaa010       LIKE glaa_t.glaa010
   DEFINE l_glaa011       LIKE glaa_t.glaa011
   DEFINE l_cost_type     LIKE xcat_t.xcat001

   WHENEVER ERROR CONTINUE
   
   LET r_ld         = p_ld
   LET r_cost_type  = p_xcat001
   LET r_field_flag = ''
   LET r_yy         = ''
   LET r_pp         = ''
   
   IF cl_null(p_site) THEN LET p_site = g_site END IF
   #160809-00045#1-s-add
    #1.取法人编号
    SELECT ooef017 INTO l_comp FROM ooef_t
     WHERE ooefent = g_enterprise
       AND ooef001 = p_site
   #160809-00045#1-e-add

   IF cl_null(r_ld) THEN
     #160809-00045#1-s-mark
     ##1.取法人编号
     #SELECT ooef017 INTO l_comp FROM ooef_t
     # WHERE ooefent = g_enterprise
     #   AND ooef001 = p_site
     #160809-00045#1-e-mark
      #2.取法人所属的主帐套值
      CALL s_axcp500_get_ld(l_comp) 
           RETURNING l_success,r_ld
   END IF


  #3.取ld的"成本计算类型"
  SELECT glaa120,glaa010,glaa011 
    INTO l_cost_type,l_glaa010,l_glaa011 
    FROM glaa_t
   WHERE glaaent = g_enterprise
     AND glaald  = r_ld 
     
   IF cl_null(r_cost_type) THEN
      LET r_cost_type = l_cost_type
   END IF         
      
   #4."按成本域计算否"
   SELECT xcat005 INTO l_xcat005 FROM xcat_t
    WHERE xcatent = g_enterprise
      AND xcat001 = r_cost_type   
   IF l_xcat005 MATCHES '[67]' THEN
      LET r_field_flag = 'Y'
   ELSE
      LET r_field_flag = 'N'
   END IF
   #160809-00045#1-s-add
   CALL cl_get_para(g_enterprise,l_comp,'S-FIN-6010') RETURNING r_yy
   CALL cl_get_para(g_enterprise,l_comp,'S-FIN-6011') RETURNING r_pp    
   #160809-00045#1-e-add
   
   #160809-00045#1-s-mark
   ##5.取当期的年度/期别及日期范围
   #IF cl_null(l_glaa010) AND cl_null(l_glaa011) THEN
   #   CALL s_fin_date_get_period_value('',r_ld,p_date)
   #        RETURNING l_success,r_yy,r_pp 
   #ELSE
   #   LET r_yy = l_glaa010
   #   LET r_pp = l_glaa011
   #END IF
   #160809-00045#1-e-mark
   RETURN r_ld,r_cost_type,r_field_flag,r_yy,r_pp         
   
END FUNCTION

################################################################################
# Descriptions...: 检查成本类型编号
# Memo...........:
# Usage..........: CALL s_axcp500_chk_xcat001(p_ld,p_xcat001)
#                       RETURNING r_success,r_field_flag
# Input parameter: p_ld           帐套
#                : p_xcat001      成本类型编号
# Return code....: r_success      成功否标识符
#                : r_field_flag   成本域否
# Date & Author..: 2014-07-18 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_chk_xcat001(p_ld,p_xcat001)
   DEFINE p_ld                LIKE glaa_t.glaald
   DEFINE p_xcat001           LIKE xcat_t.xcat001
   DEFINE r_success           LIKE type_t.num5
   DEFINE r_field_flag        LIKE type_t.chr1
   DEFINE l_xcat003           LIKE xcat_t.xcat003
   DEFINE l_xcat005           LIKE xcat_t.xcat005
   DEFINE l_xcatstus          LIKE xcat_t.xcatstus
   DEFINE l_errno             LIKE gzze_t.gzze001
   DEFINE l_comp              LIKE glaa_t.glaacomp
   DEFINE l_sys1              LIKE ooab_t.ooab002      #参数值
   DEFINE l_sys2              LIKE ooab_t.ooab002      #参数值
   
   WHENEVER ERROR CONTINUE
   LET r_success    = FALSE
   LET r_field_flag = 'N'
   
   SELECT glaacomp INTO l_comp FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = p_ld

   LET l_sys1 = cl_get_para(g_enterprise,l_comp,'S-FIN-6001')
   LET l_sys2 = cl_get_para(g_enterprise,l_comp,'S-FIN-6002')
   
   SELECT xcat003,xcat005,xcatstus 
     INTO l_xcat003,l_xcat005,l_xcatstus
     FROM xcat_t
    WHERE xcatent = g_enterprise
      AND xcat001 = p_xcat001
      
   CASE
      WHEN SQLCA.sqlcode = 100               LET l_errno = 'axc-00503'   #无此[成本类型编号]
      WHEN l_xcatstus = 'X'                  LET l_errno = 'axc-00102'   #對應的成本類型資料無效，請重新輸入！
      WHEN l_xcat003 NOT MATCHES '[12]'      LET l_errno = 'axc-00501'   #成本计算的[计算时点]值设置有误！  
      #WHEN l_xcat003 = '2'                   LET l_errno = 'axc-00516'   #成本的计算时点，仅限'1.月末'的成本类型编号      #170223-00010#1 mark
      WHEN l_xcat005 = '6' 
           IF l_sys1 = 'N'  THEN
              #系统参数[S-FIN-6001]设置为=N.不使用成本域 ;[成本类型编号xcat001]所属的[成本计算类型xcat005]设置为6.成本域，两者不符！   
              LET l_errno = 'axc-00504'   
           ELSE
              #系统参数[S-FIN-6001]设置=Y.使用成本域，但是系统参数[S-FIN-6002]成本域类型没有设置！
              IF cl_null(l_sys2) THEN
                 LET l_errno = 'axc-00505'                 
              END IF
           END IF      
      OTHERWISE                              LET l_errno = SQLCA.SQLCODE USING '-----'
   END CASE
   
   IF l_xcat005 MATCHES '[6]' THEN
      LET r_field_flag = 'Y'
   END IF
   
   IF NOT cl_null(l_errno) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = l_errno
      LET g_errparam.extend = p_xcat001
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success,r_field_flag
   END IF

   LET r_success = TRUE
   RETURN r_success,r_field_flag
   
END FUNCTION

################################################################################
# Descriptions...: 检查是否可以进行成本计算
# Memo...........:
# Usage..........: CALL s_axcp500_chk_cal(p_ld,p_xcat001,p_yy,p_pp)
#                       RETURNING r_success
# Input parameter: p_ld           帐套
#                : p_xcat001      成本计算编号
#                : p_yy           年度
#                : p_pp           期别
# Return code....: r_success      成本可否计算 TRUE -可以计算  FALSE - 不可计算
# Date & Author..: 2014-07-21 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_chk_cal(p_ld,p_xcat001,p_yy,p_pp)
   DEFINE p_ld            LIKE glaa_t.glaald
   DEFINE p_xcat001       LIKE xcat_t.xcat001
   DEFINE p_yy            LIKE type_t.num5
   DEFINE p_pp            LIKE type_t.num5
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_cnt           LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #170816-00007#104 by 09773 mod(S)
#   IF cl_null(p_ld) OR cl_null(p_yy) OR cl_null(p_pp) OR cl_null(p_xcat001) THEN
#      #传入参数为空或传入值不正确!
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = "sub-00280"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
   #170816-00007#104 by 09773 mod(E)
   
   #170816-00007#104 by 09773 add(S)
   #修改錯誤訊息報錯內容
   LET g_msg = ''
   LET g_colname_1 = ''
   LET g_comment_1 = ''
   IF cl_null(p_ld) THEN
      CALL s_azzi902_get_gzzd("aapp131","lbl_apcald") RETURNING g_colname_1,g_comment_1  #帐套 
      LET g_msg = g_colname_1   
   END IF
   IF cl_null(p_yy) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("axcp500","lbl_xcat001") RETURNING g_colname_1,g_comment_1   #成本类型编号
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF cl_null(p_xcat001) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("aapp940","lbl_xref001") RETURNING g_colname_1,g_comment_1   #年度
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF cl_null(p_pp) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("aapp134","lbl_apca064") RETURNING g_colname_1,g_comment_1   #期别
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF NOT cl_null(g_msg) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-00788'  #%1傳入值為空(錯誤)
      LET g_errparam.extend = ''
      LET g_errparam.popup = TRUE
      LET g_errparam.replace[1] = g_msg
      CALL cl_err()
      
      RETURN r_success
   END IF   
   #170816-00007#104 by 09773 add(E)
   
   #SELECT COUNT(*) INTO l_cnt FROM xcea_t  #171007-00001#1 mark
   SELECT COUNT(1) INTO l_cnt FROM xcea_t  #171007-00001#1 add
    WHERE xceaent = g_enterprise
      AND xceald  = p_ld
      AND xcea003 = p_xcat001
      AND xcea004 = p_yy
      AND xcea005 = p_pp
      AND xcea101 IS NOT NULL
      AND xceastus = 'Y'
   #  AND xcea002 <> '7'             #160408-00011 排除 axct707 單據
      AND xcea002 NOT IN('7','3')    #161129-00063#1 add
   IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
   
   IF l_cnt > 0 THEN
      #帐套 %1  年度 %2  期别 %3 的成本资料已经有抛转凭证,不可重复产生!
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'axc-00517'
      LET g_errparam.extend = ''
      LET g_errparam.popup = TRUE
      LET g_errparam.replace[1] = p_ld
      LET g_errparam.replace[2] = p_yy
      LET g_errparam.replace[3] = p_pp
      CALL cl_err()
      RETURN r_success
   END IF
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 成本计算时出现的错误写入xccy中
# Memo...........:
# Usage..........: CALL s_axcp500_ins_error(p_xccy001,p_xccy002,p_xccy004,p_xccy005,p_xccy006,p_xccy007,p_xccy008,p_xccy009,p_xccy010,p_xccy011,p_xccy012,p_xccy013,p_xccy021,p_xccy022,p_extend)
#                       RETURNING NULL
# Input parameter: p_xccy001      本位币顺序
#                : p_xccy002      成本域
#                : p_xccy004      年度
#                : p_xccy005      期别
#                : p_xccy006      单号
#                : p_xccy007      项次
#                : p_xccy008      项序
#                : p_xccy009      出入库码
#                : p_xccy010      料件
#                : p_xccy011      产品特征
#                : p_xccy012      批号
#                : p_xccy013      成本次要素
#                : p_xccy021      错误代号
#                : p_xccy022      错误说明
#                : p_extend       特别说明信息
# Return code....: NULL
# Date & Author..: 2014-09-17 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_error(p_xccy001,p_xccy002,p_xccy004,p_xccy005,p_xccy006,p_xccy007,p_xccy008,p_xccy009,p_xccy010,p_xccy011,p_xccy012,p_xccy013,p_xccy021,p_xccy022,p_extend)
   DEFINE p_xccy001       LIKE xccy_t.xccy001           #本位币顺序   
   DEFINE p_xccy002       LIKE xccy_t.xccy002           #成本域   
   DEFINE p_xccy004       LIKE xccy_t.xccy004           #年度   
   DEFINE p_xccy005       LIKE xccy_t.xccy005           #期别   
   DEFINE p_xccy006       LIKE xccy_t.xccy006           #单号   
   DEFINE p_xccy007       LIKE xccy_t.xccy007           #项次   
   DEFINE p_xccy008       LIKE xccy_t.xccy008           #项序   
   DEFINE p_xccy009       LIKE xccy_t.xccy009           #出入库码   
   DEFINE p_xccy010       LIKE xccy_t.xccy010           #料件   
   DEFINE p_xccy011       LIKE xccy_t.xccy011           #产品特征   
   DEFINE p_xccy012       LIKE xccy_t.xccy012           #批号   
   DEFINE p_xccy013       LIKE xccy_t.xccy013           #成本次要素
   DEFINE p_xccy021       LIKE xccy_t.xccy021           #错误代号   
   DEFINE p_xccy022       LIKE xccy_t.xccy022           #错误说明   
   DEFINE p_extend        LIKE type_t.chr200            #其他信息            
#   DEFINE l_xccy          RECORD LIKE xccy_t.*     #161124-00048#20 mark
   DEFINE l_xccy          type_g_xccy  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccy RECORD  #成本計算的特殊狀況訊息檔
   #    xccyent LIKE xccy_t.xccyent, #企业编号
   #    xccycomp LIKE xccy_t.xccycomp, #法人
   #    xccyld LIKE xccy_t.xccyld, #账套
   #    xccy001 LIKE xccy_t.xccy001, #账套本位币顺序
   #    xccy002 LIKE xccy_t.xccy002, #成本域
   #    xccy003 LIKE xccy_t.xccy003, #成本计算类型
   #    xccy004 LIKE xccy_t.xccy004, #年度
   #    xccy005 LIKE xccy_t.xccy005, #期别
   #    xccy006 LIKE xccy_t.xccy006, #参考单号
   #    xccy007 LIKE xccy_t.xccy007, #项次
   #    xccy008 LIKE xccy_t.xccy008, #项序
   #    xccy009 LIKE xccy_t.xccy009, #出入库码
   #    xccy010 LIKE xccy_t.xccy010, #料号
   #    xccy011 LIKE xccy_t.xccy011, #产品特征
   #    xccy012 LIKE xccy_t.xccy012, #批号
   #    xccy013 LIKE xccy_t.xccy013, #成本次要素编号
   #    xccy021 LIKE xccy_t.xccy021, #错误编号
   #    xccy022 LIKE xccy_t.xccy022, #异常说明
   #    xccycrtid LIKE xccy_t.xccycrtid, #资料录入者
   #    xccycrtdp LIKE xccy_t.xccycrtdp, #资料录入部门
   #    xccycrtdt LIKE xccy_t.xccycrtdt  #资料创建日
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE

   INITIALIZE l_xccy.* TO NULL
   
   #错误代号及错误说明均为空
   IF cl_null(p_xccy021) AND cl_null(p_xccy022) THEN
      RETURN
   END IF
   
   LET l_xccy.xccyent   = g_enterprise      #企業代碼
   LET l_xccy.xccycomp  = g_comp            #法人
   LET l_xccy.xccyld    = g_ld              #帳別
   LET l_xccy.xccy001   = p_xccy001         #帳套本位幣順序
   LET l_xccy.xccy002   = p_xccy002         #成本域
   LET l_xccy.xccy003   = g_xcat001         #成本計算類型
   LET l_xccy.xccy004   = p_xccy004         #年度
   LET l_xccy.xccy005   = p_xccy005         #期別
   LET l_xccy.xccy006   = p_xccy006         #參考單號
   LET l_xccy.xccy007   = p_xccy007         #項次
   LET l_xccy.xccy008   = p_xccy008         #項序
   LET l_xccy.xccy009   = p_xccy009         #出入庫碼
   LET l_xccy.xccy010   = p_xccy010         #料號
   LET l_xccy.xccy011   = p_xccy011         #產品特徵
   LET l_xccy.xccy012   = p_xccy012         #批號
   LET l_xccy.xccy013   = p_xccy013         #成本次要素
   LET l_xccy.xccy021   = p_xccy021         #錯誤代號
   LET l_xccy.xccy022   = p_xccy022         #異常說明
   #错误内容为空时,按错误代号选出错误说明                  
   IF cl_null(l_xccy.xccy022) THEN                         
      LET l_xccy.xccy022 = cl_getmsg(l_xccy.xccy021,g_lang)
   END IF    

   #p_extend有信息时,要放在ERROR中
   IF NOT cl_null(p_extend) THEN
      LET l_xccy.xccy022 = p_extend,":",l_xccy.xccy022
   END IF
   
   IF NOT cl_null(l_xccy.xccy010) OR NOT cl_null(l_xccy.xccy006) THEN
      IF cl_null(l_xccy.xccy001) THEN LET l_xccy.xccy001 = '1' END IF
      
      IF cl_null(l_xccy.xccy004) THEN LET l_xccy.xccy004 = g_yy END IF
      IF cl_null(l_xccy.xccy005) THEN LET l_xccy.xccy005 = g_pp END IF
   END IF
   
   LET l_xccy.xccycrtid = g_user            #資料建立者
   LET l_xccy.xccycrtdp = g_dept            #資料建立部門
   LET l_xccy.xccycrtdt = cl_get_current()  #資料創建日

#   INSERT INTO xccy_t VALUES(l_xccy.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccy_t(xccyent,xccycomp,xccyld,xccy001,xccy002,xccy003,xccy004,xccy005,
                      xccy006,xccy007,xccy008,xccy009,xccy010,xccy011,xccy012,xccy013,
                      xccy021,xccy022,xccycrtid,xccycrtdp,xccycrtdt) 
               VALUES(l_xccy.xccyent,l_xccy.xccycomp,l_xccy.xccyld,l_xccy.xccy001,l_xccy.xccy002,l_xccy.xccy003,l_xccy.xccy004,l_xccy.xccy005,
                      l_xccy.xccy006,l_xccy.xccy007,l_xccy.xccy008,l_xccy.xccy009,l_xccy.xccy010,l_xccy.xccy011,l_xccy.xccy012,l_xccy.xccy013,
                      l_xccy.xccy021,l_xccy.xccy022,l_xccy.xccycrtid,l_xccy.xccycrtdp,l_xccy.xccycrtdt)
   #161124-00048#20 add(e)
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 'INSERT INTO xccy_t'
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN  
   END IF
   
END FUNCTION

################################################################################
# Descriptions...: 成本计算
# Memo...........:
# Usage..........: CALL s_axcp500_cal(p_ld,p_xcat001,p_yy,p_pp,p_wc)
#                       RETURNING r_success
# Input parameter: p_ld           帐套
#                : p_xcat001      成本类型编号
#                : p_yy           年度
#                : p_pp           期别
#                : p_wc           成本计算范围的WHERE子句
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-10-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_cal(p_ld,p_xcat001,p_yy,p_pp,p_wc)
   DEFINE p_ld            LIKE glaa_t.glaald
   DEFINE p_xcat001       LIKE xcat_t.xcat001
   DEFINE p_yy            LIKE type_t.num5
   DEFINE p_pp            LIKE type_t.num5
   DEFINE p_wc            STRING
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_cnt           LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcat005       LIKE xcat_t.xcat005
   DEFINE l_done          LIKE type_t.chr1
   DEFINE l_xcbf004       LIKE xcbf_t.xcbf004
   DEFINE l_cnt1          LIKE type_t.num10
   DEFINE l_cnt2          LIKE type_t.num10
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   CALL s_axcp500_cal1(p_ld,p_xcat001,p_yy,p_pp,p_wc)
        RETURNING r_success
   RETURN r_success
   
   #zhangllc mark 未使用 --begin
   #IF cl_null(p_ld) OR cl_null(p_yy) OR cl_null(p_xcat001) OR cl_null(p_pp) THEN
   #   #传入参数为空或传入值不正确!
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = "sub-00280"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   ##成本计算前检查-是否已经成本计算且已经抛转凭证
   #CALL s_axcp500_chk_cal(p_ld,p_xcat001,p_yy,p_pp)
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #
   ##GLOBAL变量赋值
   #LET g_xcat001 = p_xcat001
   #LET g_ld = p_ld
   #LET g_yy = p_yy
   #LET g_pp = p_pp
   #LET g_wc = p_wc
   #IF cl_null(g_wc) THEN LET g_wc = ' 1=1' END IF
   #SELECT glaacomp INTO g_comp FROM glaa_t
   # WHERE glaaent = g_enterprise
   #   AND glaald  = g_ld
   #
   ##取参数
   #LET g_sys_6001 = cl_get_para(g_enterprise,g_comp,'S-FIN-6001')   #系统参数[S-FIN-6001]:採用成本域否
   #LET g_sys_6002 = cl_get_para(g_enterprise,g_comp,'S-FIN-6002')   #系统参数[S-FIN-6002]:成本域類型
   #IF g_sys_6001 = 'N' THEN
   #   LET g_sys_6002 = ''
   #END IF
   #LET g_sys_6004 = cl_get_para(g_enterprise,g_comp,'S-FIN-6004')   #系统参数[S-FIN-6004]:雜項發料的取價方式
   #LET g_sys_6005 = cl_get_para(g_enterprise,g_comp,'S-FIN-6005')   #系统参数[S-FIN-6005]:銷退成本來源
   #LET g_sys_6006 = cl_get_para(g_enterprise,g_comp,'S-FIN-6006')   #系统参数[S-FIN-6006]:銷退是否影響成本
   #LET g_sys_6008 = cl_get_para(g_enterprise,g_comp,'S-FIN-6008')   #系统参数[S-FIN-6008]:工單結案在製差異轉入主件當期入庫
   #LET g_sys_6009 = cl_get_para(g_enterprise,g_comp,'S-FIN-6009')   #系统参数[S-FIN-6009]:聯產品分配方式
   #LET g_sys_6017 = cl_get_para(g_enterprise,g_comp,'S-FIN-6017')   #系统参数[S-FIN-6017]:聯產品入庫折算在制轉出數量是否按分配率計算  #add zhangllc 150717
   #LET g_sys_6013 = cl_get_para(g_enterprise,g_comp,'S-FIN-6013')   #系统参数[S-FIN-6013]:按料件特性计算成本否
   #LET g_sys_6014 = cl_get_para(g_enterprise,g_comp,'S-FIN-6014')   #系统参数[S-FIN-6014]:在製人工製費分攤方式
   #LET g_sys_6015 = cl_get_para(g_enterprise,g_comp,'S-FIN-6015')   #系统参数[S-FIN-6015]:啟用成本次要素
   #LET g_sys_6016 = cl_get_para(g_enterprise,g_comp,'S-FIN-6016')   #系统参数[S-FIN-6016]:當站下線是否影響成本
   #LET g_sys_6018 = cl_get_para(g_enterprise,g_comp,'S-FIN-6018')   #系统参数[S-FIN-6018]:調撥是否納入計算  #add zhangllc 150825
   #
   ##LET g_ent_0001 = cl_get_para(g_enterprise,'','E-CIR-0001')  #集团参数[E-CIR-0001]:品類管理層級  #add zhangllc 150809 mark zhangllc 151204
   #
   ##取成本计算方式
   #SELECT xcat005 INTO l_xcat005 FROM xcat_t
   # WHERE xcatent = g_enterprise
   #   AND xcat001 = p_xcat001
   #LET g_field_type = g_sys_6002
   #CASE l_xcat005
   #     WHEN '7'
   #          LET g_cost_type = '7'
   #     WHEN '6'
   #          LET g_cost_type = '6'
   #          #成本域类型
   #          LET g_field_type = g_sys_6002
   #     OTHERWISE 
   #          LET g_cost_type = l_xcat005
   #END CASE
   #
   ##目前仅支援“月加权”，其他不支持
   #IF g_cost_type NOT MATCHES '[123456]' THEN
   #   #传入参数为空或传入值不正确!
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = ""
   #   LET g_errparam.extend = "目前仅支持月加权,标准,移动加权,先进先出的成本计算方式，其他方式暂时不支持"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success   
   #END IF
   #
   ##取日期相关资讯
   #CALL s_axcp500_get_date()
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #
   ##取得帐套对应的本位币信息
   #CALL s_axcp500_get_curr() 
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF 
   #
   ##成本域时,检查同一类型是否相同的成本计算类型,若同一类型,则目前可以支持
   ##若不同类型,则目前不支持
   ##若成本域类型为3.库存管理特征时,先用月加权方式
   #IF g_cost_type = '6' THEN
   #   CASE g_field_type
   #        WHEN '1'      #组织型
   #          SELECT UNIQUE xcbf004 INTO l_xcbf004 
   #            FROM xcbf_t,inaj_t,inaa_t,ooef_t
   #           WHERE xcbfent  = inajent AND inajent = inaaent AND xcbfent  = g_enterprise
   #             AND inajsite = inaasite
   #             AND inaj008  = inaa001
   #             AND inaa010  = 'Y'
   #             AND ooef001  = inajsite
   #             AND ooefent  = inajent
   #             AND xcbfcomp = ooef017 AND xcbfcomp = g_comp
   #             AND (inaj004 = 1 OR inaj004 = -1)
   #             AND inaj022 BETWEEN g_bdate AND g_edate
   #             AND xcbf002  = inajsite         
   #             
   #        WHEN '2'      #仓库型
   #          SELECT UNIQUE xcbf004 INTO l_xcbf004 
   #            FROM xcbf_t,inaj_t,inaa_t,ooef_t
   #           WHERE xcbfent  = inajent AND inajent = inaaent AND xcbfent  = g_enterprise
   #             AND inajsite = inaasite
   #             AND inaj008  = inaa001
   #             AND inaa010  = 'Y'
   #             AND ooef001  = inajsite
   #             AND ooefent  = inajent                
   #             AND xcbfcomp = ooef017 AND xcbfcomp = g_comp
   #             AND (inaj004 = 1 OR inaj004 = -1)
   #             AND inaj022 BETWEEN g_bdate AND g_edate
   #             AND xcbf002  = inaj008
   #             
   #        WHEN '3'      #库存管理特征
   #           LET l_xcbf004 = '1'
   #           
   #   END CASE 
   #   
   #   IF cl_null(l_xcbf004) THEN
   #      #传入参数为空或传入值不正确!
   #      INITIALIZE g_errparam TO NULL
   #      LET g_errparam.code   = ""
   #      LET g_errparam.extend = "成本域条件下,目前不支持不同的成本计算方式"
   #      LET g_errparam.popup  = TRUE
   #      CALL cl_err()
   #      RETURN r_success  
   #   ELSE
   #      LET g_cost_type = l_xcbf004
   #   END IF      
   #END IF
   #
   ##建立xcck_tmp/sfaa_tmp/inaj_tmp/xccc_tmp/xccd_tmp/xcce_tmp/xccg_tmp/xccz_tmp 等临时表
   #CALL s_axcp500_cre_tmp_table()
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #
   ##处理资料插入临时表
   #CALL s_axcp500_ins_temp_table()   
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #
   ##计算进度条的笔数
   #LET g_progress_cnt = 0
   #LET l_cnt1 = 0
   #LET l_cnt2 = 0
   #SELECT COUNT(*) INTO l_cnt1 FROM (       
   # SELECT UNIQUE imaa001,xccc007,xcbb006,imac003,imaa004,imaa011,imae013,xccc002,xccc008,xccc003,imag014
   #   FROM s_axcp500_tmp,imag_t
   #  WHERE imagent  = g_enterprise
   #    AND imagsite = g_comp
   #    AND imag001  = imaa001
   #    AND xcbb006 <> 99)
   #    
   #SELECT COUNT(*) INTO l_cnt2 FROM ( 
   # SELECT UNIQUE imaa001,xccc007,xcbb006,imac003,imaa004,imaa011,imae013,xccc002,xccc008,xccc003,imag014
   #   FROM s_axcp500_tmp,imag_t,inaj_tmp
   #  WHERE imagent  = g_enterprise
   #    AND imagsite = g_comp
   #    AND imag001  = imaa001
   #    AND inajent  = g_enterprise
   #    AND inaj005  = imaa001
   #    AND inaj006  = xccc007
   #    AND inaj010  = xccc008
   #    AND xcbb006 = 99     
   #    )
   #IF cl_null(l_cnt1) THEN LET l_cnt1 = 0 END IF
   #IF cl_null(l_cnt2) THEN LET l_cnt2 = 0 END IF
   #
   ##进整体FOREACH的料件笔数
   #LET g_progress_cnt = l_cnt1 + l_cnt2             
   #
   ##每一成本阶算完后,会做这一阶的重工/联产品/拆件,但是99阶是不需要做的
   #LET l_cnt1 = 0
   #SELECT COUNT(UNIQUE xcbb006) INTO l_cnt1 FROM s_axcp500_tmp
   #IF cl_null(l_cnt1) THEN LET l_cnt1 = 0 END IF
   #LET g_progress_cnt = g_progress_cnt + l_cnt1 - 1 #99阶不需要做重工/联产品/拆件的处理,故-1
   #
   ##s_axcp500_del_data()/s_axcp500_avg_get_previous_balance
   #LET g_progress_cnt = g_progress_cnt + 2              #2为其他2个整批性动作
   #IF cl_null(g_progress_cnt) THEN LET g_progress_cnt = 0 END IF   
   #
   ##預先計算progressbar迴圈次數
   #IF g_bgjob <> "Y" THEN
   #   CALL cl_progress_bar_no_window(g_progress_cnt)
   #END IF
   #
   #IF g_bgjob <> "Y" THEN      
   #   #删除本期成本资料,以便重新计算
   #   LET g_progress_msg = cl_getmsg('axc-00631',g_dlang)
   #   CALL cl_progress_no_window_ing(g_progress_msg)
   #END IF   
   #
   ##成本计算前,把对应的资料删除
   #CALL s_axcp500_del_data()   
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #
   ##结转上期资料
   #IF g_bgjob <> "Y" THEN      
   #   #结转上期的结余成本至本期的期初成本中
   #   LET g_progress_msg = cl_getmsg('axc-00633',g_dlang)
   #   CALL cl_progress_no_window_ing(g_progress_msg)
   #END IF    
   #IF g_cost_type NOT MATCHES '[35]' THEN
   #   CALL s_axcp500_get_previous_balance()
   #        RETURNING l_success
   #   IF NOT l_success THEN
   #      RETURN r_success
   #   END IF
   #ELSE
   #   CALL s_axcp500_avg_get_previous_balance('1')
   #        RETURNING l_success
   #   IF NOT l_success THEN
   #      RETURN r_success
   #   END IF   
   #END IF
   #
   #
   ##各成本计算类型共用的CURSOR定义放在s_axcp500中
   #CALL s_axcp500_def_cursor()
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF 
   #
   ##错误收集
   #CALL cl_err_collect_init()   
   #
   #CASE g_cost_type
   #     WHEN '1' CALL s_axcp500_std()
   #                   RETURNING l_success
   #     WHEN '2' CALL s_axcp500_fifo()
   #                   RETURNING l_success
   #     WHEN '4' CALL s_axcp500_moving()
   #                   RETURNING l_success
   #     WHEN '5' CALL s_axcp500_avg()
   #                   RETURNING l_success
   #     OTHERWISE
   #END CASE
   #
   ##错误整体显示
   #CALL cl_err_collect_show()
   #
   #LET r_success = TRUE
   #RETURN r_success
   #zhangllc mark 未使用 --end
   
END FUNCTION

################################################################################
# Descriptions...: 取得帐套
# Memo...........:
# Usage..........: CALL s_axcp500_get_ld(p_comp)
#                       RETURNING r_success,r_ld
# Input parameter: p_comp         法人代号
# Return code....: r_success      成功否标识符
#                : r_ld           帐套
# Date & Author..: 2014-05-23 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_ld(p_comp)
   DEFINE p_comp          LIKE glaa_t.glaacomp
   DEFINE r_success       LIKE type_t.num5
   DEFINE r_ld            LIKE glaa_t.glaald
   DEFINE l_ld            LIKE glaa_t.glaald

   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   LET r_ld = NULL
   
   #检查是否有主帐套设定
   #实时运算时，不会传入“帐套”，而是由营运据点所属法人对应的主帐套值做为计算依据
   SELECT glaald INTO l_ld FROM glaa_t
    WHERE glaaent  = g_enterprise
      AND glaacomp = p_comp
      AND glaa014  = 'Y'
   IF cl_null(l_ld) THEN
      #该法人没有设置主账套,无成本计算依据!
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'axc-00508'
      LET g_errparam.extend = p_comp
      LET g_errparam.popup = TRUE
      CALL cl_err()

      RETURN r_success,r_ld
   END IF
   
   LET r_success = TRUE
   LET r_ld = l_ld
   RETURN r_success,r_ld
END FUNCTION

################################################################################
# Descriptions...: 取得与日期及年期相关的资讯
# Memo...........:
# Usage..........: CALL s_axcp500_get_date()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_date()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_glaa003       LIKE glaa_t.glaa003
   DEFINE l_success       LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #取"會計週期參照表號"
   SELECT glaa003 INTO l_glaa003 FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_ld
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'Select glaa003'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #取当期的起始及截止日期
   CALL s_fin_date_get_period_range(l_glaa003,g_yy,g_pp)
        RETURNING g_bdate,g_edate

   #取上期的年度/期别
   CALL s_fin_date_get_last_period('',g_ld,g_yy,g_pp)
        RETURNING l_success,g_last_yy,g_last_pp
   IF NOT l_success THEN
      RETURN r_success
   END IF

   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 各本位币计算成本否
# Memo...........:
# Usage..........: CALL s_axcp500_get_curr()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_curr()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_glaa026       LIKE glaa_t.glaa026   #币种参照表
#   DEFINE l_ooaj          RECORD LIKE ooaj_t.*              #161124-00048#20 mark
  #161124-00048#20 add(s)
  DEFINE l_ooaj RECORD  #使用幣別設定檔
       ooajent LIKE ooaj_t.ooajent, #企业编号
       ooajownid LIKE ooaj_t.ooajownid, #资料所有者
       ooajowndp LIKE ooaj_t.ooajowndp, #资料所有部门
       ooajcrtid LIKE ooaj_t.ooajcrtid, #资料录入者
       ooajcrtdp LIKE ooaj_t.ooajcrtdp, #资料录入部门
       ooajcrtdt LIKE ooaj_t.ooajcrtdt, #资料创建日
       ooajmodid LIKE ooaj_t.ooajmodid, #资料更改者
       ooajmoddt LIKE ooaj_t.ooajmoddt, #最近更改日
       ooajstus LIKE ooaj_t.ooajstus, #状态码
       ooaj001 LIKE ooaj_t.ooaj001, #币种参照表号
       ooaj002 LIKE ooaj_t.ooaj002, #使用币种
       ooaj003 LIKE ooaj_t.ooaj003, #单价小数字数
       ooaj004 LIKE ooaj_t.ooaj004, #金额小数字数
       ooaj005 LIKE ooaj_t.ooaj005, #汇率计算精度
       ooaj006 LIKE ooaj_t.ooaj006, #成本单价小数字数
       ooaj007 LIKE ooaj_t.ooaj007  #成本金额小数字数
END RECORD
  #161124-00048#20 add(e)

   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE

   CALL g_curr.clear()

   #取各币种设定
   SELECT glaa001,'Y','2',glaa025,0,0,
          glaa016,glaa015,glaa017,glaa018,0,0,
          glaa020,glaa019,glaa021,glaa022,0,0,
          glaa026
     INTO g_curr[1].*,g_curr[2].*,g_curr[3].*,l_glaa026
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_ld
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL                        
      LET g_errparam.code = SQLCA.sqlcode                    
      LET g_errparam.extend = g_ld           
      LET g_errparam.popup = TRUE                          
      CALL cl_err()                                        
      RETURN r_success         
   END IF

   #2.取币种设定档
   #150915---earl---mod---s---改抓ooaj006,ooaj007
   #SELECT ooaj003,ooaj004 INTO g_curr[1].digit1,g_curr[1].digit2 FROM ooaj_t
   SELECT ooaj006,ooaj007 INTO g_curr[1].digit1,g_curr[1].digit2 FROM ooaj_t
   #150915---earl---mod---e
    WHERE ooajent = g_enterprise                           
      AND ooaj001 = l_glaa026                              
      AND ooaj002 = g_curr[1].curr                     
   IF SQLCA.sqlcode THEN                                   
      INITIALIZE g_errparam TO NULL                        
      LET g_errparam.code = 'aoo-00175'                    
      LET g_errparam.extend = g_curr[1].curr           
      LET g_errparam.popup = TRUE                          
      CALL cl_err()                                        
      RETURN r_success    
   END IF
   #add zhangllc 151103 --begin
   IF cl_null(g_curr[1].digit1) OR cl_null(g_curr[1].digit2) THEN
      #无法获取币别%1的小数位数设置,请检查[使用币别设置作业aooi150]！
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = 'aoo-00661'
      LET g_errparam.extend = ''
      LET g_errparam.replace[1] = g_curr[1].curr
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   #add zhangllc 151103 --end

#      #carrier 暂时
#      LET g_curr[1].digit1 = 6
#      LET g_curr[1].digit2 = 6

   IF g_curr[2].cal = 'Y' THEN
      #150915---earl---mod---s---改抓ooaj006,ooaj007
      #SELECT ooaj003,ooaj004 INTO g_curr[2].digit1,g_curr[2].digit2 FROM ooaj_t
      SELECT ooaj006,ooaj007 INTO g_curr[2].digit1,g_curr[2].digit2 FROM ooaj_t
      #150915---earl---mod---e
       WHERE ooajent = g_enterprise                           
         AND ooaj001 = l_glaa026                              
         AND ooaj002 = g_curr[2].curr                     
      IF SQLCA.sqlcode THEN                                   
         INITIALIZE g_errparam TO NULL                        
         LET g_errparam.code = 'aoo-00175'                    
         LET g_errparam.extend = g_curr[2].curr           
         LET g_errparam.popup = TRUE                          
         CALL cl_err()                                        
         RETURN r_success                                     
      END IF
      #add zhangllc 151103 --begin
      IF cl_null(g_curr[2].digit1) OR cl_null(g_curr[2].digit2) THEN
         #无法获取币别%1的小数位数设置,请检查[使用币别设置作业aooi150]！
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = 'aoo-00661'
         LET g_errparam.extend = ''
         LET g_errparam.replace[1] = g_curr[2].curr
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      #add zhangllc 151103 --end
   END IF
   
   IF g_curr[3].cal = 'Y' THEN
      #150915---earl---mod---s---改抓ooaj006,ooaj007
      #SELECT ooaj003,ooaj004 INTO g_curr[3].digit1,g_curr[3].digit2 FROM ooaj_t
      SELECT ooaj006,ooaj007 INTO g_curr[3].digit1,g_curr[3].digit2 FROM ooaj_t
      #150915---earl---mod---e
       WHERE ooajent = g_enterprise                           
         AND ooaj001 = l_glaa026                              
         AND ooaj002 = g_curr[3].curr                     
      IF SQLCA.sqlcode THEN                                   
         INITIALIZE g_errparam TO NULL                        
         LET g_errparam.code = 'aoo-00175'                    
         LET g_errparam.extend = g_curr[3].curr           
         LET g_errparam.popup = TRUE                          
         CALL cl_err()                                        
         RETURN r_success                                     
      END IF
      #add zhangllc 151103 --begin
      IF cl_null(g_curr[3].digit1) OR cl_null(g_curr[3].digit2) THEN
         #无法获取币别%1的小数位数设置,请检查[使用币别设置作业aooi150]！
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = 'aoo-00661'
         LET g_errparam.extend = ''
         LET g_errparam.replace[1] = g_curr[3].curr
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      #add zhangllc 151103 --end
   END IF
   
   #3.取企业参数设置-金额舍入类型
   LET g_round_type = cl_get_para(g_enterprise,'','E-COM-0006')
   IF g_round_type NOT MATCHES '[1234]' OR cl_null(g_round_type) THEN
      #进位方式不正确
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-00293'
      LET g_errparam.extend = g_round_type
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   LET r_success = TRUE
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: 成本计算-主本位币与某币种的转换率
# Memo...........:
# Usage..........: CALL s_axcp500_curr_get_exrate(p_seq,p_date,p_curr,p_amt1,p_amt2)
# Input parameter: p_seq      币种顺序
#                : p_date     交易日期
#                : p_curr     交易币种
#                : p_amt1     交易金额
#                : p_amt2     本位币1的金额
# Return code....: r_amt      经过汇率换算后的金额值
# Date & Author..: 2014-09-28 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_curr_get_exrate(p_seq,p_date,p_curr,p_amt1,p_amt2)
   DEFINE p_seq        LIKE type_t.num5
   DEFINE p_date       LIKE type_t.dat
   DEFINE p_curr       LIKE glaa_t.glaa001    #交易币种
   DEFINE p_amt1       LIKE xccc_t.xccc102    #交易金额
   DEFINE p_amt2       LIKE xccc_t.xccc102    #本位币1的金额
   DEFINE r_amt        LIKE xccc_t.xccc102
   DEFINE l_amt        LIKE xccc_t.xccc102
   DEFINE l_exrate     LIKE type_t.num26_10

   WHENEVER ERROR CONTINUE

   IF p_amt2 <> 0 THEN   #本位币1的金额不为零时
      CASE p_seq
           WHEN 1  #第一本位币
              CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[1].curr,p_amt1,g_curr[1].type2)
                   RETURNING l_amt
           WHEN 2  #第二本位币
              IF g_curr[2].type1 = '1' THEN  #依交易币种
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[2].curr,p_amt1,g_curr[2].type2)
                      RETURNING l_amt
              ELSE                           #依主本位币
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[2].curr,p_amt2,g_curr[2].type2)
                      RETURNING l_amt
              END IF
           WHEN 3  #第三本位币
              IF g_curr[3].type1 = '1' THEN  #依交易币种
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[3].curr,p_amt1,g_curr[3].type2)
                      RETURNING l_amt
              ELSE                      #依主本位币
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[3].curr,p_amt2,g_curr[3].type2)
                      RETURNING l_amt
              END IF
      END CASE
   ELSE
      CASE p_seq
           WHEN 1  #第一本位币
              CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[1].curr,p_amt1,g_curr[1].type2)
                   RETURNING l_amt
           WHEN 2  #第二本位币
              IF g_curr[2].type1 = '1' THEN  #依交易币种
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[2].curr,p_amt1,g_curr[2].type2)
                      RETURNING l_amt
              ELSE                           #依主本位币
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[1].curr,0,g_curr[1].type2)
                      RETURNING l_exrate       
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[2].curr,0,g_curr[2].type2)
                      RETURNING l_amt
                 LET l_amt = l_amt * l_exrate * p_amt1
              END IF
           WHEN 3  #第三本位币
              IF g_curr[3].type1 = '1' THEN  #依交易币种
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[3].curr,p_amt1,g_curr[3].type2)
                      RETURNING l_amt
              ELSE                      #依主本位币
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[1].curr,0,g_curr[1].type2)
                      RETURNING l_exrate 
                 CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[3].curr,0,g_curr[3].type2)
                      RETURNING l_amt
                 LET l_amt = l_amt * l_exrate * p_amt1
              END IF
      END CASE   
   END IF

   IF cl_null(l_amt) THEN LET l_amt = 0 END IF

   LET r_amt = l_amt
   RETURN r_amt

END FUNCTION

################################################################################
# Descriptions...: 成本计算-主本位币与某币种的转换率
# Memo...........:
# Usage..........: CALL s_axcp500_get_exrate(p_seq,p_date,p_curr,p_amt1,p_amt2)
# Input parameter: p_seq      币种顺序
#                : p_date     交易日期
#                : p_curr     交易币种
#                : p_amt1     交易金额
#                : p_amt2     本位币1的金额
# Return code....: r_amt      经过汇率换算后的金额值
# Date & Author..: 2014-07-28 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_exrate(p_seq,p_date,p_curr,p_amt1,p_amt2)
   DEFINE p_seq        LIKE type_t.num5
   DEFINE p_date       LIKE type_t.dat
   DEFINE p_curr       LIKE glaa_t.glaa001    #交易币种
   DEFINE p_amt1       LIKE xccc_t.xccc102    #交易金额
   DEFINE p_amt2       LIKE xccc_t.xccc102    #本位币1的金额
   DEFINE r_amt        LIKE xccc_t.xccc102
   DEFINE l_amt        LIKE xccc_t.xccc102

   WHENEVER ERROR CONTINUE

   CASE p_seq
        WHEN 1  #第一本位币
           CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[1].curr,p_amt1,g_curr[1].type2)
                RETURNING l_amt
        WHEN 2  #第二本位币
           IF g_curr[2].type1 = '1' THEN  #依交易币种
              CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[2].curr,p_amt1,g_curr[2].type2)
                   RETURNING l_amt
           ELSE                           #依主本位币
              CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[2].curr,p_amt2,g_curr[2].type2)
                   RETURNING l_amt
           END IF
        WHEN 3  #第三本位币
           IF g_curr[3].type1 = '1' THEN  #依交易币种
              CALL s_aooi160_get_exrate('2',g_ld,p_date,p_curr,g_curr[3].curr,p_amt1,g_curr[3].type2)
                   RETURNING l_amt
           ELSE                      #依主本位币
              CALL s_aooi160_get_exrate('2',g_ld,p_date,g_curr[1].curr,g_curr[3].curr,p_amt2,g_curr[3].type2)
                   RETURNING l_amt
           END IF
   END CASE

   IF cl_null(l_amt) THEN LET l_amt = 0 END IF

   LET r_amt = l_amt
   RETURN r_amt

END FUNCTION

################################################################################
# Descriptions...: 取单位的进位方式
# Memo...........:
# Usage..........: CALL s_axcp500_get_unit_round_setting(p_imaa001,p_unit)
#                       RETURNING r_success
# Input parameter: p_imaa001      料件编号
#                : p_unit         单位
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-29 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_unit_round_setting(p_imaa001,p_unit)
   DEFINE p_imaa001       LIKE imaa_t.imaa001
   DEFINE p_unit          LIKE ooca_t.ooca001
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_ooca          RECORD LIKE ooca_t.*   #161124-00048#20 mark
   #161124-00048#20 add(s)
   DEFINE l_ooca RECORD  #單位資料檔
       oocastus LIKE ooca_t.oocastus, #状态码
       oocaent LIKE ooca_t.oocaent, #企业编号
       ooca001 LIKE ooca_t.ooca001, #单位编号
       ooca002 LIKE ooca_t.ooca002, #小数字数
       ooca003 LIKE ooca_t.ooca003, #单位类型
       ooca004 LIKE ooca_t.ooca004, #舍入类型
       ooca005 LIKE ooca_t.ooca005, #ISO编号
       ooca006 LIKE ooca_t.ooca006, #面积单位
       ooca007 LIKE ooca_t.ooca007, #体积单位
       oocaownid LIKE ooca_t.oocaownid, #资料所有者
       oocaowndp LIKE ooca_t.oocaowndp, #资料所有部门
       oocacrtid LIKE ooca_t.oocacrtid, #资料录入者
       oocacrtdp LIKE ooca_t.oocacrtdp, #资料录入部门
       oocacrtdt LIKE ooca_t.oocacrtdt, #资料创建日
       oocamodid LIKE ooca_t.oocamodid, #资料更改者
       oocamoddt LIKE ooca_t.oocamoddt  #最近更改日
END RECORD
   #161124-00048#20 add(e)
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #1.取单位设定档
#   SELECT * INTO l_ooca.* FROM ooca_t #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT oocastus,oocaent,ooca001,ooca002,ooca003,ooca004,ooca005,
          ooca006,ooca007,oocaownid,oocaowndp,oocacrtid,oocacrtdp,
          oocacrtdt,oocamodid,oocamoddt 
     INTO l_ooca.* FROM ooca_t
   #161124-00048#20 add(e)
    WHERE oocaent = g_enterprise
      AND ooca001 = p_unit
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      #缺少單位資訊
      LET g_errparam.code = 'sub-00017'
      LET g_errparam.extend = p_unit
      LET g_errparam.popup = TRUE
      CALL cl_err()
      
      CALL s_axcp500_ins_error('','','','','','','','',p_imaa001,'','','','sub-00017','',p_unit)
      LET g_unit_round_type  = '2'
      LET g_unit_round_digit = 6     
      RETURN r_success
   END IF
   
   LET g_unit_round_type  = l_ooca.ooca004 
   LET g_unit_round_digit = l_ooca.ooca002  
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取料件的单位取位设置
# Memo...........:
# Usage..........: CALL s_axcp500_get_round_setting(p_imaa001)
#                       RETURNING NULL
# Input parameter: p_imaa001      料件编号
# Return code....: NULL
# Date & Author..: 2014-09-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_round_setting(p_imaa001)
   DEFINE p_imaa001           LIKE imaa_t.imaa001
   DEFINE l_imag014           LIKE imag_t.imag014
   DEFINE l_imaa006           LIKE imaa_t.imaa006
   DEFINE l_success           LIKE type_t.num5

   WHENEVER ERROR CONTINUE
#  #取成本单位
#  SELECT imag014 INTO l_imag014 FROM imag_t
#   WHERE imagent  = g_enterprise
#     AND imagsite = g_comp
#     AND imag001  = p_imaa001
#
#  IF cl_null(l_imag014) THEN
#     SELECT imaa006 INTO l_imag014 FROM imaa_t
      SELECT imaa006 INTO l_imaa006 FROM imaa_t
       WHERE imaaent = g_enterprise
         AND imaa001 = p_imaa001
#  END IF
   
   #若料件不存在,则直接给取位方式
#  IF cl_null(l_imag014) THEN
   IF cl_null(l_imaa006) THEN
      LET g_unit_round_type  = '1'             #1.四舍五入
      LET g_unit_round_digit = 6               #6位小数
      RETURN
   END IF
   
   #取成本单位的进位相关内容
#  CALL s_axcp500_get_unit_round_setting(p_imaa001,l_imag014)
   CALL s_axcp500_get_unit_round_setting(p_imaa001,l_imaa006)
        RETURNING l_success
      
END FUNCTION

################################################################################
# Descriptions...: 重复计算前将资料清空
# Memo...........:
# Usage..........: CALL s_axcp500_del_data()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-21 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_del_data()
   DEFINE r_success       LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #IF g_sys_6021 = 'Y' THEN　#add zhangllc 160526 SBS1 #mark zhangllc 160630 参数未勾选，运行axcp500后，应该删除对应xccq_t记录，使xccq_t的记录与xccc_t等表保持一致。
      #add SBS10--s
      LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccq006")
      #add SBS10--e
      #add zhangllc 151215 --begin
      #1.删除一般统计档(除主件档)
      #1.1  xccq_t 料件库存成本期异动统计档   
      LET g_sql = " DELETE FROM xccq_t ",
                  "  WHERE xccqent = ",g_enterprise,
                  "    AND xccqld  = '",g_ld,"'",
                  "    AND xccq003 = '",g_xcat001,"'",
                  "    AND xccq004 = ",g_yy,
                  "    AND xccq005 = ",g_pp
      #mod SBS10--s 能够提高某些运行条件的效能
      #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
      #            "                  WHERE imaaent = xccqent ",
      #            "                    AND imaa001 = xccq006 AND ",g_wc CLIPPED,") "
      IF g_wc2.getIndexOf("imaa",1) THEN
         LET g_sql = g_sql CLIPPED,
                  "    AND EXISTS ( SELECT 1 FROM imaa_t ",
                  "                  WHERE imaaent = xccqent ",
                  "                    AND imaa001 = xccq006 AND ",g_wc CLIPPED,") "
      ELSE
         LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
      END IF
      #mod SBS10--e
      PREPARE s_axcp500_del_data_xccq FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE delete xccq_t"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      EXECUTE s_axcp500_del_data_xccq 
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "EXECUTE delete xccq_t"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF   
      #add zhangllc 151215 --end
   #END IF 　#add zhangllc 160526 SBS1 #mark zhangllc 160630 
   
   #1.删除一般统计档(除主件档)
   #1.1  xccc_t 料件库存成本期异动统计档  
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccc006")
   #add SBS10--e 
   LET g_sql = " DELETE FROM xccc_t ",
               "  WHERE xcccent = ",g_enterprise,
               "    AND xcccld  = '",g_ld,"'",
               "    AND xccc003 = '",g_xcat001,"'",
               "    AND xccc004 = ",g_yy,
               "    AND xccc005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcccent ",
   #            "                    AND imaa001 = xccc006 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcccent ",
               "                    AND imaa001 = xccc006 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccc FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccc_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccc 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccc_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #161230-00010#7---s
   #同步删除在制成本异动明细档
   #1.8 xcct_t 在制工艺成本转出明细档
   LET g_sql = " DELETE FROM xcct_t ",
               "  WHERE xcctent = ",g_enterprise,
               "    AND xcctld  = '",g_ld,"'",
               "    AND xcct003 = '",g_xcat001,"'",
               "    AND xcct004 = ",g_yy,
               "    AND xcct005 = ",g_pp
               
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcct007")  
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcctent ",
               "                    AND imaa001 = xcct007 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF   
   PREPARE s_axcp500_del_data_xcct FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcct_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcct 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcct_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   #161230-00010#7---e
   
   #1.2  xcce_t 在制组件成本期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcce_t ",
               "  WHERE xcceent = ",g_enterprise,
               "    AND xcceld  = '",g_ld,"'",
               "    AND xcce003 = '",g_xcat001,"'",
               "    AND xcce004 = ",g_yy,
               "    AND xcce005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xcceent ",
   #            "                    AND xccdld  = xcceld  ",
   #            "                    AND xccd003 = xcce003 ",
   #            "                    AND xccd004 = xcce004 ",
   #            "                    AND xccd005 = xcce005 ",
   #            "                    AND xccd006 = xcce006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xcceent ",
               "                    AND xccdld  = xcceld  ",
               "                    AND xccd003 = xcce003 ",
               "                    AND xccd004 = xcce004 ",
               "                    AND xccd005 = xcce005 ",
               "                    AND xccd006 = xcce006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xcceent ",
               "                    AND xccdld  = xcceld  ",
               "                    AND xccd003 = xcce003 ",
               "                    AND xccd004 = xcce004 ",
               "                    AND xccd005 = xcce005 ",
               "                    AND xccd006 = xcce006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcce FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcce_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcce 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcce_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   

   #1.2.1  xccz_t 在制元件发料明细档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccz_t ",
               "  WHERE xcczent = ",g_enterprise,
               "    AND xcczld  = '",g_ld,"'",
               "    AND xccz003 = '",g_xcat001,"'",
               "    AND xccz004 = ",g_yy,
               "    AND xccz005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xcczent ",
   #            "                    AND xccdld  = xcczld  ",
   #            "                    AND xccd003 = xccz003 ",
   #            "                    AND xccd004 = xccz004 ",
   #            "                    AND xccd005 = xccz005 ",
   #            "                    AND xccd006 = xccz006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xcczent ",
               "                    AND xccdld  = xcczld  ",
               "                    AND xccd003 = xccz003 ",
               "                    AND xccd004 = xccz004 ",
               "                    AND xccd005 = xccz005 ",
               "                    AND xccd006 = xccz006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xcczent ",
               "                    AND xccdld  = xcczld  ",
               "                    AND xccd003 = xccz003 ",
               "                    AND xccd004 = xccz004 ",
               "                    AND xccd005 = xccz005 ",
               "                    AND xccd006 = xccz006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccz FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccz_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccz 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccz_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #1.2.2  xccn_t 本期在制轉出成本與工單入庫標準成本差異檔
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccn_t ",
               "  WHERE xccnent = ",g_enterprise,
               "    AND xccnld  = '",g_ld,"'",
               "    AND xccn003 = '",g_xcat001,"'",
               "    AND xccn004 = ",g_yy,
               "    AND xccn005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xccnent ",
   #            "                    AND xccdld  = xccnld  ",
   #            "                    AND xccd003 = xccn003 ",
   #            "                    AND xccd004 = xccn004 ",
   #            "                    AND xccd005 = xccn005 ",
   #            "                    AND xccd006 = xccn006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xccnent ",
               "                    AND xccdld  = xccnld  ",
               "                    AND xccd003 = xccn003 ",
               "                    AND xccd004 = xccn004 ",
               "                    AND xccd005 = xccn005 ",
               "                    AND xccd006 = xccn006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xccnent ",
               "                    AND xccdld  = xccnld  ",
               "                    AND xccd003 = xccn003 ",
               "                    AND xccd004 = xccn004 ",
               "                    AND xccd005 = xccn005 ",
               "                    AND xccd006 = xccn006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccn FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccn_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccn 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccn_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   

#   #1.3  xccf_t 在制组件工艺成本期异动统计档
#   LET g_sql = " DELETE FROM xccf_t ",
#               "  WHERE xccfent = ",g_enterprise,
#               "    AND xccfld  = '",g_ld,"'",
#               "    AND xccf003 = '",g_xcat001,"'",
#               "    AND xccf004 = ",g_yy,
#               "    AND xccf005 = ",g_pp,
#               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
#               "                  WHERE xccdent = xccfent ",
#               "                    AND xccdld  = xccfld  ",
#               "                    AND xccd003 = xccf003 ",
#               "                    AND xccd004 = xccf004 ",
#               "                    AND xccd005 = xccf005 ",
#               "                    AND xccd006 = xccf006 ",
#               "                    AND xccdent = imaaent ",
#               "                    AND xccd007 = imaa001 ",
#               "                    AND ",g_wc CLIPPED,") "
#   PREPARE s_axcp500_del_data_xccf FROM g_sql
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "PREPARE delete xccf_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   EXECUTE s_axcp500_del_data_xccf 
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "EXECUTE delete xccf_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF  

   #1.4  xccg_t 联产品成本期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccg_t ",
               "  WHERE xccgent = ",g_enterprise,
               "    AND xccgld  = '",g_ld,"'",
               "    AND xccg003 = '",g_xcat001,"'",
               "    AND xccg004 = ",g_yy,
               "    AND xccg005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xccgent ",
   #            "                    AND xccdld  = xccgld  ",
   #            "                    AND xccd003 = xccg003 ",
   #            "                    AND xccd004 = xccg004 ",
   #            "                    AND xccd005 = xccg005 ",
   #            "                    AND xccd006 = xccg006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xccgent ",
               "                    AND xccdld  = xccgld  ",
               "                    AND xccd003 = xccg003 ",
               "                    AND xccd004 = xccg004 ",
               "                    AND xccd005 = xccg005 ",
               "                    AND xccd006 = xccg006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xccgent ",
               "                    AND xccdld  = xccgld  ",
               "                    AND xccd003 = xccg003 ",
               "                    AND xccd004 = xccg004 ",
               "                    AND xccd005 = xccg005 ",
               "                    AND xccd006 = xccg006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccg FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccg_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccg 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccg_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   
   #1.5  xcci_t 拆件在制组件成本期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcch007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcci_t ",
               "  WHERE xccient = ",g_enterprise,
               "    AND xccild  = '",g_ld,"'",
               "    AND xcci003 = '",g_xcat001,"'",
               "    AND xcci004 = ",g_yy,
               "    AND xcci005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xcch_t,imaa_t ",
   #            "                  WHERE xcchent = xccient ",
   #            "                    AND xcchld  = xccild  ",
   #            "                    AND xcch003 = xcci003 ",
   #            "                    AND xcch004 = xcci004 ",
   #            "                    AND xcch005 = xcci005 ",
   #            "                    AND xcch006 = xcci006 ",
   #            "                    AND xcchent = imaaent ",
   #            "                    AND xcch007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xcch_t,imaa_t ",
               "                  WHERE xcchent = xccient ",
               "                    AND xcchld  = xccild  ",
               "                    AND xcch003 = xcci003 ",
               "                    AND xcch004 = xcci004 ",
               "                    AND xcch005 = xcci005 ",
               "                    AND xcch006 = xcci006 ",
               "                    AND xcchent = imaaent ",
               "                    AND xcch007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xcch_t ",
               "                  WHERE xcchent = xccient ",
               "                    AND xcchld  = xccild  ",
               "                    AND xcch003 = xcci003 ",
               "                    AND xcch004 = xcci004 ",
               "                    AND xcch005 = xcci005 ",
               "                    AND xcch006 = xcci006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcci FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcci_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcci 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcci_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #1.6  xcck_t 本期料件明细进出成本档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcck010")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcck_t ",
               "  WHERE xcckent = ",g_enterprise,
               "    AND xcckld  = '",g_ld,"'",
               "    AND xcck003 = '",g_xcat001,"'",
               "    AND xcck004 = ",g_yy,
               "    AND xcck005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcckent ",
   #            "                    AND imaa001 = xcck010 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcckent ",
               "                    AND imaa001 = xcck010 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
               
   PREPARE s_axcp500_del_data_xcck FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcck_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcck 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcck_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   
   #1.7  xccl_t 本期料件明细出库冲销明细入库档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccl012")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccl_t ",
               "  WHERE xcclent = ",g_enterprise,
               "    AND xcclld  = '",g_ld,"'",
               "    AND xccl003 = '",g_xcat001,"'",
               "    AND xccl004 = ",g_yy,
               "    AND xccl005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcclent ",
   #            "                    AND imaa001 = xccl012 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcclent ",
               "                    AND imaa001 = xccl012 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccl FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccl_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccl 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccl_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #1.8 xccm_t 期末料件明细进出成本统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccm010")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccm_t ",
               "  WHERE xccment = ",g_enterprise,
               "    AND xccmld  = '",g_ld,"'",
               "    AND xccm003 = '",g_xcat001,"'",
               "    AND xccm004 = ",g_yy,
               "    AND xccm005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xccment ",
   #            "                    AND imaa001 = xccm010 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xccment ",
               "                    AND imaa001 = xccm010 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccm FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccm_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccm 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccm_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF     

#   #1.8 xcct_t 在制工艺成本转出明细档
#   LET g_sql = " DELETE FROM xcct_t ",
#               "  WHERE xcctent = ",g_enterprise,
#               "    AND xcctld  = '",g_ld,"'",
#               "    AND xcct003 = '",g_xcat001,"'",
#               "    AND xcct004 = ",g_yy,
#               "    AND xcct005 = ",g_pp,
#               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
#               "                  WHERE xccdent = xcctent ",
#               "                    AND xccdld  = xcctld  ",
#               "                    AND xccd003 = xcct003 ",
#               "                    AND xccd004 = xcct004 ",
#               "                    AND xccd005 = xcct005 ",
#               "                    AND xccd006 = xcct006 ",
#               "                    AND xccdent = imaaent ",
#               "                    AND xccd007 = imaa001 ",
#               "                    AND ",g_wc CLIPPED,") "
#   PREPARE s_axcp500_del_data_xcct FROM g_sql
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "PREPARE delete xcct_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   EXECUTE s_axcp500_del_data_xcct 
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "EXECUTE delete xcct_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF 
   
   #2.删除成本要素档
   #2.1 xcdc_t 料件库存成本要素期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcdc006")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdc_t ",
               "  WHERE xcdcent = ",g_enterprise,
               "    AND xcdcld  = '",g_ld,"'",
               "    AND xcdc003 = '",g_xcat001,"'",
               "    AND xcdc004 = ",g_yy,
               "    AND xcdc005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcdcent ",
   #            "                    AND imaa001 = xcdc006 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcdcent ",
               "                    AND imaa001 = xcdc006 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdc FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdc_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdc 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdc_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #2.2 xcde_t 在制组件成本要素期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcde_t ",
               "  WHERE xcdeent = ",g_enterprise,
               "    AND xcdeld  = '",g_ld,"'",
               "    AND xcde003 = '",g_xcat001,"'",
               "    AND xcde004 = ",g_yy,
               "    AND xcde005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xcdeent ",
   #            "                    AND xccdld  = xcdeld  ",
   #            "                    AND xccd003 = xcde003 ",
   #            "                    AND xccd004 = xcde004 ",
   #            "                    AND xccd005 = xcde005 ",
   #            "                    AND xccd006 = xcde006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xcdeent ",
               "                    AND xccdld  = xcdeld  ",
               "                    AND xccd003 = xcde003 ",
               "                    AND xccd004 = xcde004 ",
               "                    AND xccd005 = xcde005 ",
               "                    AND xccd006 = xcde006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xcdeent ",
               "                    AND xccdld  = xcdeld  ",
               "                    AND xccd003 = xcde003 ",
               "                    AND xccd004 = xcde004 ",
               "                    AND xccd005 = xcde005 ",
               "                    AND xccd006 = xcde006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcde FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcde_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcde 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcde_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #2.3 xcdf_t 在制组件工艺成本要素期异动统计档
#   LET g_sql = " DELETE FROM xcdf_t ",
#               "  WHERE xcdfent = ",g_enterprise,
#               "    AND xcdfld  = '",g_ld,"'",
#               "    AND xcdf003 = '",g_xcat001,"'",
#               "    AND xcdf004 = ",g_yy,
#               "    AND xcdf005 = ",g_pp,
#               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
#               "                  WHERE xccdent = xcdfent ",
#               "                    AND xccdld  = xcdfld  ",
#               "                    AND xccd003 = xcdf003 ",
#               "                    AND xccd004 = xcdf004 ",
#               "                    AND xccd005 = xcdf005 ",
#               "                    AND xccd006 = xcdf006 ",
#               "                    AND xccdent = imaaent ",
#               "                    AND xccd007 = imaa001 ",
#               "                    AND ",g_wc CLIPPED,") "
#   PREPARE s_axcp500_del_data_xcdf FROM g_sql
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "PREPARE delete xcdf_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
#   EXECUTE s_axcp500_del_data_xcdf 
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = SQLCA.sqlcode
#      LET g_errparam.extend = "EXECUTE delete xcdf_t"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF   
   
   #2.4 xcdg_t 联产品成本要素期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdg_t ",
               "  WHERE xcdgent = ",g_enterprise,
               "    AND xcdgld  = '",g_ld,"'",
               "    AND xcdg003 = '",g_xcat001,"'",
               "    AND xcdg004 = ",g_yy,
               "    AND xcdg005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xcdgent ",
   #            "                    AND xccdld  = xcdgld  ",
   #            "                    AND xccd003 = xcdg003 ",
   #            "                    AND xccd004 = xcdg004 ",
   #            "                    AND xccd005 = xcdg005 ",
   #            "                    AND xccd006 = xcdg006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xcdgent ",
               "                    AND xccdld  = xcdgld  ",
               "                    AND xccd003 = xcdg003 ",
               "                    AND xccd004 = xcdg004 ",
               "                    AND xccd005 = xcdg005 ",
               "                    AND xccd006 = xcdg006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xcdgent ",
               "                    AND xccdld  = xcdgld  ",
               "                    AND xccd003 = xcdg003 ",
               "                    AND xccd004 = xcdg004 ",
               "                    AND xccd005 = xcdg005 ",
               "                    AND xccd006 = xcdg006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdg FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdg_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdg 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdg_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   #2.5 xcdi_t 拆件组件成本要素期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcch007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdi_t ",
               "  WHERE xcdient = ",g_enterprise,
               "    AND xcdild  = '",g_ld,"'",
               "    AND xcdi003 = '",g_xcat001,"'",
               "    AND xcdi004 = ",g_yy,
               "    AND xcdi005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xcch_t,imaa_t ",
   #            "                  WHERE xcchent = xcdient ",
   #            "                    AND xcchld  = xcdild  ",
   #            "                    AND xcch003 = xcdi003 ",
   #            "                    AND xcch004 = xcdi004 ",
   #            "                    AND xcch005 = xcdi005 ",
   #            "                    AND xcch006 = xcdi006 ",
   #            "                    AND xcchent = imaaent ",
   #            "                    AND xcch007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xcch_t,imaa_t ",
               "                  WHERE xcchent = xcdient ",
               "                    AND xcchld  = xcdild  ",
               "                    AND xcch003 = xcdi003 ",
               "                    AND xcch004 = xcdi004 ",
               "                    AND xcch005 = xcdi005 ",
               "                    AND xcch006 = xcdi006 ",
               "                    AND xcchent = imaaent ",
               "                    AND xcch007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xcch_t ",
               "                  WHERE xcchent = xcdient ",
               "                    AND xcchld  = xcdild  ",
               "                    AND xcch003 = xcdi003 ",
               "                    AND xcch004 = xcdi004 ",
               "                    AND xcch005 = xcdi005 ",
               "                    AND xcch006 = xcdi006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdi FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdi_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdi 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdi_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #2.6 xcdk_t 本期料件明细进出成本要素成本档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcdk011")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdk_t ",
               "  WHERE xcdkent = ",g_enterprise,
               "    AND xcdkld  = '",g_ld,"'",
               "    AND xcdk003 = '",g_xcat001,"'",
               "    AND xcdk004 = ",g_yy,
               "    AND xcdk005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcdkent ",
   #            "                    AND imaa001 = xcdk011 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcdkent ",
               "                    AND imaa001 = xcdk011 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdk FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdk_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdk 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdk_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #2.7 xcdl_t 本期料件明细出库冲销明细入库成本要素成本档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcdl013")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdl_t ",
               "  WHERE xcdlent = ",g_enterprise,
               "    AND xcdlld  = '",g_ld,"'",
               "    AND xcdl003 = '",g_xcat001,"'",
               "    AND xcdl004 = ",g_yy,
               "    AND xcdl005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcdlent ",
   #            "                    AND imaa001 = xcdl013 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcdlent ",
               "                    AND imaa001 = xcdl013 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdl FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdl_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdl 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdl_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #2.8 xcdm_t 期末料件明细进出成本要素成本统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcdm011")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdm_t ",
               "  WHERE xcdment = ",g_enterprise,
               "    AND xcdmld  = '",g_ld,"'",
               "    AND xcdm003 = '",g_xcat001,"'",
               "    AND xcdm004 = ",g_yy,
               "    AND xcdm005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcdment ",
   #            "                    AND imaa001 = xcdm011 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcdment ",
               "                    AND imaa001 = xcdm011 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdm FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdm_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdm 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdm_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  

   #2.9 xcdt_t 在制工艺成本转出明细档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcdt_t ",
               "  WHERE xcdtent = ",g_enterprise,
               "    AND xcdtld  = '",g_ld,"'",
               "    AND xcdt003 = '",g_xcat001,"'",
               "    AND xcdt004 = ",g_yy,
               "    AND xcdt005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
   #            "                  WHERE xccdent = xcdtent ",
   #            "                    AND xccdld  = xcdtld  ",
   #            "                    AND xccd003 = xcdt003 ",
   #            "                    AND xccd004 = xcdt004 ",
   #            "                    AND xccd005 = xcdt005 ",
   #            "                    AND xccd006 = xcdt006 ",
   #            "                    AND xccdent = imaaent ",
   #            "                    AND xccd007 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t,imaa_t ",
               "                  WHERE xccdent = xcdtent ",
               "                    AND xccdld  = xcdtld  ",
               "                    AND xccd003 = xcdt003 ",
               "                    AND xccd004 = xcdt004 ",
               "                    AND xccd005 = xcdt005 ",
               "                    AND xccd006 = xcdt006 ",
               "                    AND xccdent = imaaent ",
               "                    AND xccd007 = imaa001 ",
               "                    AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM xccd_t ",
               "                  WHERE xccdent = xcdtent ",
               "                    AND xccdld  = xcdtld  ",
               "                    AND xccd003 = xcdt003 ",
               "                    AND xccd004 = xcdt004 ",
               "                    AND xccd005 = xcdt005 ",
               "                    AND xccd006 = xcdt006 ",
               "                    AND ",g_wc2 CLIPPED,") "
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcdt FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcdt_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcdt 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcdt_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   
   #3.删除一般统计档(主件档)  
   #3.1  xccd_t 在制主件成本期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xccd007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xccd_t ",
               "  WHERE xccdent = ",g_enterprise,
               "    AND xccdld  = '",g_ld,"'",
               "    AND xccd003 = '",g_xcat001,"'",
               "    AND xccd004 = ",g_yy,
               "    AND xccd005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xccdent ",
   #            "                    AND imaa001 = xccd007 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xccdent ",
               "                    AND imaa001 = xccd007 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xccd FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xccd_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xccd 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xccd_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    

   #3.2  xcch_t 拆件在制主件成本期异动统计档
   #add SBS10--s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcch007")
   #add SBS10--e
   LET g_sql = " DELETE FROM xcch_t ",
               "  WHERE xcchent = ",g_enterprise,
               "    AND xcchld  = '",g_ld,"'",
               "    AND xcch003 = '",g_xcat001,"'",
               "    AND xcch004 = ",g_yy,
               "    AND xcch005 = ",g_pp
   #mod SBS10--s 能够提高某些运行条件的效能
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xcchent ",
   #            "                    AND imaa001 = xcch007 AND ",g_wc CLIPPED,") "
   IF g_wc2.getIndexOf("imaa",1) THEN
      LET g_sql = g_sql CLIPPED,
               "    AND EXISTS ( SELECT 1 FROM imaa_t ",
               "                  WHERE imaaent = xcchent ",
               "                    AND imaa001 = xcch007 AND ",g_wc CLIPPED,") "
   ELSE
      LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   END IF
   #mod SBS10--e
   PREPARE s_axcp500_del_data_xcch FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcch_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcch 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcch_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  

   #161121-00018#5---add---s
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcha009")
   LET g_sql = " DELETE FROM xchb_t ",
               "  WHERE xchbent = ",g_enterprise,
               "    AND xchbld  = '",g_ld,"'",
               "    AND xchb003 = '",g_xcat001,"'",
               "    AND xchb004 = ",g_yy,
               "    AND xchb005 = ",g_pp
   #170421-00016#1---mark---s            
   #IF g_wc2.getIndexOf("imaa",1) THEN
   #   LET g_sql = g_sql CLIPPED,
   #            "    AND EXISTS ( SELECT 1 FROM xcha_t,imaa_t ",
   #            "                  WHERE xchaent = xchbent ",
   #            "                    AND xchald  = xchbld  ",
   #            "                    AND xcha003 = xchb003 ",
   #            "                    AND xcha004 = xchb004 ",
   #            "                    AND xcha005 = xchb005 ",
   #            "                    AND xcha006 = xchb006 ",
   #            "                    AND xchaent = imaaent ",
   #            "                    AND xcha009 = imaa001 ",
   #            "                    AND ",g_wc CLIPPED,") "
   #ELSE
   #   LET g_sql = g_sql CLIPPED,
   #            "    AND EXISTS ( SELECT 1 FROM xcha_t ",
   #               "               WHERE xchaent = xchbent ",
   #            "                    AND xchald  = xchbld  ",
   #            "                    AND xcha003 = xchb003 ",
   #            "                    AND xcha004 = xchb004 ",
   #            "                    AND xcha005 = xchb005 ",
   #            "                    AND xcha006 = xchb006 ",
   #            "                    AND ",g_wc2 CLIPPED,") "
   #END IF
   #170421-00016#1---mark---e
   PREPARE s_axcp500_del_data_xchb FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xchb_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xchb 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xchb_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   LET g_wc2 = cl_replace_str(g_wc,"imaa001","xcha009")
   LET g_sql = " DELETE FROM xcha_t ",
               "  WHERE xchaent = ",g_enterprise,
               "    AND xchald  = '",g_ld,"'",
               "    AND xcha003 = '",g_xcat001,"'",
               "    AND xcha004 = ",g_yy,
               "    AND xcha005 = ",g_pp
   #170421-00016#1---mark---s            
   #IF g_wc2.getIndexOf("imaa",1) THEN
   #   LET g_sql = g_sql CLIPPED,
   #            "    AND EXISTS ( SELECT 1 FROM imaa_t ",
   #            "                  WHERE imaaent = xchaent ",
   #            "                    AND imaa001 = xcha009 AND ",g_wc CLIPPED,") "
   #ELSE
   #   LET g_sql = g_sql CLIPPED," AND ",g_wc2 CLIPPED
   #END IF
   #170421-00016#1---mark---e
   PREPARE s_axcp500_del_data_xcha FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE delete xcha_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_del_data_xcha 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE delete xcha_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   #161121-00018#5---add---e
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 结转上期余额
# Memo...........:
# Usage..........: CALL s_axcp500_get_previous_balance()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-21 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_previous_balance()
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_success           LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   
   CALL s_axcp500_get_previous_balance_def_cursor()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   IF g_curr[1].cal = 'Y' THEN
      CALL s_axcp500_get_previous_balance_process(1)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END IF           

   IF g_curr[2].cal = 'Y' THEN
      CALL s_axcp500_get_previous_balance_process(2)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END IF 
   
   IF g_curr[3].cal = 'Y' THEN
      CALL s_axcp500_get_previous_balance_process(3)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END IF 
   
   LET r_success = TRUE
   RETURN r_success 
END FUNCTION

################################################################################
# Descriptions...: 结转上期余额 - 定义CURSOR
# Memo...........:
# Usage..........: CALL s_axcp500_get_previous_balance_def_cursor()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-21 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_previous_balance_def_cursor()
   DEFINE r_success           LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   
   IF g_sys_6021 = 'Y' THEN　#add zhangllc 160526 SBS1
      #add zhangllc 151215 --begin
      #料件库存成本期异动统计档
#      LET g_sql = " SELECT xccq_t.* FROM xccq_t,imaa_t ",  #161124-00048#20 mark
      #161124-00048#20 add(s)
      LET g_sql = " SELECT xccqent,xccqcomp,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,",
                  "        xccq006,xccq007,xccq008,xccq009,xccq010,xccq011,xccq012,xccq101,xccq102, ",
                  "        xccq102a,xccq102b,xccq102c,xccq102d,xccq102e,xccq102f,xccq102g,xccq102h, ",
                  "        xccq201,xccq202,xccq202a,xccq202b,xccq202c,xccq202d,xccq202e,xccq202f,   ",
                  "        xccq202g,xccq202h,xccq203,xccq204,xccq204a,xccq204b,xccq204c,xccq204d,   ",
                  "        xccq204e,xccq204f,xccq204g,xccq204h,xccq205,xccq206,xccq206a,xccq206b,   ",
                  "        xccq206c,xccq206d,xccq206e,xccq206f,xccq206g,xccq206h,xccq207,xccq208,   ",
                  "        xccq208a,xccq208b,xccq208c,xccq208d,xccq208e,xccq208f,xccq208g,xccq208h, ",
                  "        xccq209,xccq210,xccq210a,xccq210b,xccq210c,xccq210d,xccq210e,xccq210f,   ",
                  "        xccq210g,xccq210h,xccq211,xccq212,xccq212a,xccq212b,xccq212c,xccq212d,   ",
                  "        xccq212e,xccq212f,xccq212g,xccq212h,xccq213,xccq214,xccq214a,xccq214b,   ",
                  "        xccq214c,xccq214d,xccq214e,xccq214f,xccq214g,xccq214h,xccq215,xccq216,   ",
                  "        xccq216a,xccq216b,xccq216c,xccq216d,xccq216e,xccq216f,xccq216g,xccq216h, ",
                  "        xccq217,xccq218,xccq218a,xccq218b,xccq218c,xccq218d,xccq218e,xccq218f,   ",
                  "        xccq218g,xccq218h,xccq280,xccq280a,xccq280b,xccq280c,xccq280d,xccq280e,  ",
                  "        xccq280f,xccq280g,xccq280h,xccq301,xccq302,xccq302a,xccq302b,xccq302c,   ",
                  "        xccq302d,xccq302e,xccq302f,xccq302g,xccq302h,xccq303,xccq304,xccq304a,   ",
                  "        xccq304b,xccq304c,xccq304d,xccq304e,xccq304f,xccq304g,xccq304h,xccq305,  ",
                  "        xccq306,xccq306a,xccq306b,xccq306c,xccq306d,xccq306e,xccq306f,xccq306g,  ",
                  "        xccq306h,xccq307,xccq308,xccq308a,xccq308b,xccq308c,xccq308d,xccq308e,   ",
                  "        xccq308f,xccq308g,xccq308h,xccq309,xccq310,xccq310a,xccq310b,xccq310c,   ",
                  "        xccq310d,xccq310e,xccq310f,xccq310g,xccq310h,xccq311,xccq312,xccq312a,   ",
                  "        xccq312b,xccq312c,xccq312d,xccq312e,xccq312f,xccq312g,xccq312h,xccq313,  ",
                  "        xccq314,xccq314a,xccq314b,xccq314c,xccq314d,xccq314e,xccq314f,xccq314g,  ",
                  "        xccq314h,xccq401,xccq402,xccq901,xccq902,xccq902a,xccq902b,xccq902c,     ",
                  "        xccq902d,xccq902e,xccq902f,xccq902g,xccq902h,xccq903,xccq903a,xccq903b,  ",
                  "        xccq903c,xccq903d,xccq903e,xccq903f,xccq903g,xccq903h,xccqtime           ",
                  "   FROM xccq_t,imaa_t ",
      #161124-00048#20 add(e)
                  "  WHERE xccqent =  ",g_enterprise,
                  "    AND xccqld  = '",g_ld,"'",
                  "    AND xccq001 = ?",
                  "    AND xccq003 = '",g_xcat001,"'",
                  "    AND xccq004 =  ",g_last_yy,
                  "    AND xccq005 =  ",g_last_pp,
                  "    AND imaaent = xccqent ",
                  "    AND imaa001 = xccq006 ",
                  "    AND ",g_wc
      PREPARE s_axcp500_get_previous_balance_xccq_p FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccq_p'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      
      DECLARE s_axcp500_get_previous_balance_xccq_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccq_p
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccq_cs1'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success
      END IF      
      #add zhangllc 151215 --end
   END IF 　#add zhangllc 160526 SBS1
   
   #料件库存成本期异动统计档
#  LET g_sql = " SELECT xccc_t.* FROM xccc_t,imaa_t ", #161124-00048#20 mark 
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xcccent,xccccomp,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,          ",
               "        xccc006,xccc007,xccc008,xccc010,xccc101,xccc102,xccc102a,xccc102b,        ",
               "        xccc102c,xccc102d,xccc102e,xccc102f,xccc102g,xccc102h,xccc201,xccc202,    ",
               "        xccc202a,xccc202b,xccc202c,xccc202d,xccc202e,xccc202f,xccc202g,xccc202h,  ",
               "        xccc203,xccc204,xccc204a,xccc204b,xccc204c,xccc204d,xccc204e,xccc204f,    ",
               "        xccc204g,xccc204h,xccc205,xccc206,xccc206a,xccc206b,xccc206c,xccc206d,    ",
               "        xccc206e,xccc206f,xccc206g,xccc206h,xccc207,xccc208,xccc208a,xccc208b,    ",
               "        xccc208c,xccc208d,xccc208e,xccc208f,xccc208g,xccc208h,xccc209,xccc210,    ",
               "        xccc210a,xccc210b,xccc210c,xccc210d,xccc210e,xccc210f,xccc210g,xccc210h,  ",
               "        xccc211,xccc212,xccc212a,xccc212b,xccc212c,xccc212d,xccc212e,xccc212f,    ",
               "        xccc212g,xccc212h,xccc213,xccc214,xccc214a,xccc214b,xccc214c,xccc214d,    ",
               "        xccc214e,xccc214f,xccc214g,xccc214h,xccc215,xccc216,xccc216a,xccc216b,    ",
               "        xccc216c,xccc216d,xccc216e,xccc216f,xccc216g,xccc216h,xccc217,xccc218,    ",
               "        xccc218a,xccc218b,xccc218c,xccc218d,xccc218e,xccc218f,xccc218g,xccc218h,  ",
               "        xccc280,xccc280a,xccc280b,xccc280c,xccc280d,xccc280e,xccc280f,xccc280g,   ",
               "        xccc280h,xccc301,xccc302,xccc302a,xccc302b,xccc302c,xccc302d,xccc302e,    ",
               "        xccc302f,xccc302g,xccc302h,xccc303,xccc304,xccc304a,xccc304b,xccc304c,    ",
               "        xccc304d,xccc304e,xccc304f,xccc304g,xccc304h,xccc305,xccc306,xccc306a,    ",
               "        xccc306b,xccc306c,xccc306d,xccc306e,xccc306f,xccc306g,xccc306h,xccc307,   ",
               "        xccc308,xccc308a,xccc308b,xccc308c,xccc308d,xccc308e,xccc308f,xccc308g,   ",
               "        xccc308h,xccc309,xccc310,xccc310a,xccc310b,xccc310c,xccc310d,xccc310e,    ",
               "        xccc310f,xccc310g,xccc310h,xccc311,xccc312,xccc312a,xccc312b,xccc312c,    ",
               "        xccc312d,xccc312e,xccc312f,xccc312g,xccc312h,xccc313,xccc314,xccc314a,    ",
               "        xccc314b,xccc314c,xccc314d,xccc314e,xccc314f,xccc314g,xccc314h,xccc401,   ",
               "        xccc402,xccc901,xccc902,xccc902a,xccc902b,xccc902c,xccc902d,xccc902e,     ",
               "        xccc902f,xccc902g,xccc902h,xccc903,xccc903a,xccc903b,xccc903c,xccc903d,   ",
               "        xccc903e,xccc903f,xccc903g,xccc903h,xccctime FROM xccc_t,imaa_t ",        
   #161124-00048#20 add(e)
               "  WHERE xcccent =  ",g_enterprise,
               "    AND xcccld  = '",g_ld,"'",
               "    AND xccc001 = ?",
               "    AND xccc003 = '",g_xcat001,"'",
               "    AND xccc004 =  ",g_last_yy,
               "    AND xccc005 =  ",g_last_pp,
               "    AND imaaent = xcccent ",
               "    AND imaa001 = xccc006 ",
               "    AND ",g_wc
   PREPARE s_axcp500_get_previous_balance_xccc_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccc_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xccc_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccc_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccc_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF      
               
   #期初库存料件成本开账档
#   LET g_sql = " SELECT xcca_t.* FROM xcca_t,imaa_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xccaent,xccald,xccacomp,xcca001,xcca002,xcca003,xcca004,xcca005,xcca006,",
               "        xcca007,xcca008,xcca101,xcca102,xcca102a,xcca102b,xcca102c,xcca102d,xcca102e,",
               "        xcca102f,xcca102g,xcca102h,xcca110,xcca110a,xcca110b,xcca110c,xcca110d,xcca110e,",
               "        xcca110f,xcca110g,xcca110h,xccaownid,xccaowndp,xccacrtid,xccacrtdp,xccacrtdt,",
               "        xccamodid,xccamoddt,xccacnfid,xccacnfdt,xccapstid,xccapstdt,xccastus ",
               "   FROM xcca_t,imaa_t ",
   #161124-00048#20 add(e)
               "  WHERE xccaent =  ",g_enterprise,
               "    AND xccald  = '",g_ld,"'",
               "    AND xcca001 = ?",
               "    AND xcca003 = '",g_xcat001,"'",
               "    AND xcca004 =  ",g_last_yy,
               "    AND xcca005 =  ",g_last_pp,
               "    AND imaaent = xccaent ",
               "    AND imaa001 = xcca006 ",
               "    AND ",g_wc
   PREPARE s_axcp500_get_previous_balance_xcca_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xcca_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xcca_cs1 CURSOR FOR s_axcp500_get_previous_balance_xcca_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xcca_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #add zhangllc 151215 --begin
   LET g_sql = " SELECT xcbzsite,xcbz005,xcbz006,xcbz007,NVL(SUM(xcbz101),0) FROM xcbz_t ",
               "  WHERE xcbzent  = ? ",
               "    AND xcbzcomp = ? ",  #法人组织
               "    AND xcbzld   = ? ",
               "    AND xcbz001  = ? ", #年
               "    AND xcbz002  = ? ", #期
               "    AND xcbz003  = ? ", #料件
               "    AND xcbz004  = ? ", #特性
               "    AND xcbz008  = ? ", #批
               "    AND xcbzsite IN(SELECT ooef001 FROM ooef_t ",
               "                     WHERE ooefent = ? AND ooefstus ='Y' AND ooef017 = ?) ",
               "  GROUP BY xcbzsite,xcbz005,xcbz006,xcbz007 "
   PREPARE s_axcp500_get_previous_balance_xcca_p1_xcbz FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xcca_p1_xcbz'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   DECLARE s_axcp500_get_previous_balance_xcca_cs1_xcbz CURSOR FOR s_axcp500_get_previous_balance_xcca_p1_xcbz
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xcca_cs1_xcbz'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   #add zhangllc 151215 --end
   
   #在制主件成本期异动统计档   
#   LET g_sql = " SELECT xccd_t.* FROM xccd_t,imaa_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,",
               "        xccd006,xccd007,xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,",
               "        xccd014,xccd101,xccd102,xccd102a,xccd102b,xccd102c,xccd102d,xccd102e,",
               "        xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,xccd202a,xccd202b,",
               "        xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,",
               "        xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,",
               "        xccd302,xccd302a,xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,",
               "        xccd302h,xccd303,xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,",
               "        xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,xccd902b,xccd902c,",
               "        xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime ",
               "   FROM xccd_t,imaa_t ",
   #161124-00048#20 add(e)
               "  WHERE xccdent =  ",g_enterprise,
               "    AND xccdld  = '",g_ld,"'",
               "    AND xccd001 = ?",
               "    AND xccd003 = '",g_xcat001,"'",
               "    AND xccd004 =  ",g_last_yy,
               "    AND xccd005 =  ",g_last_pp,
               "    AND (xccd901  <> 0 OR xccd902  <> 0 OR xccd902a <> 0 OR xccd902b <> 0 OR ",
               "         xccd902c <> 0 OR xccd902d <> 0 OR xccd902e <> 0 OR xccd902f <> 0 OR ",
               "         xccd902g <> 0 OR xccd902h <> 0 ) ",
               "    AND imaaent = xccdent ",
               "    AND imaa001 = xccd007 ",
               "    AND ",g_wc   
               
   PREPARE s_axcp500_get_previous_balance_xccd_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccd_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xccd_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccd_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccd_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    
   
   #在制组件成本期异动统计档   
#   LET g_sql = " SELECT xcce_t.* FROM xcce_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,",
               "        xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,",
               "        xcce102b,xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,",
               "        xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,xcce202f,   ",
               "        xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,   ",
               "        xcce206e,xcce206f,xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,   ",
               "        xcce208c,xcce208d,xcce208e,xcce208f,xcce208g,xcce208h,xcce209,xcce210,   ",
               "        xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h, ",
               "        xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,   ",
               "        xcce302g,xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,   ",
               "        xcce304e,xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,   ",
               "        xcce308c,xcce308d,xcce308e,xcce308f,xcce308g,xcce308h,xcce901,xcce902,   ",
               "        xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h, ",
               "        xccetime FROM xcce_t ",
   #161124-00048#20 add(e)
               "  WHERE xcceent =  ",g_enterprise,
               "    AND xcceld  = '",g_ld,"'",
               "    AND xcce001 = ?",
               "    AND xcce003 = '",g_xcat001,"'",
               "    AND xcce004 =  ",g_last_yy,
               "    AND xcce005 =  ",g_last_pp,
               "    AND xcce006 = ? ",
               "    AND (xcce901  <> 0 OR xcce902  <> 0 OR xcce902a <> 0 OR xcce902b <> 0 OR ",
               "         xcce902c <> 0 OR xcce902d <> 0 OR xcce902e <> 0 OR xcce902f <> 0 OR ",
               "         xcce902g <> 0 OR xcce902h <> 0 ) "        

   PREPARE s_axcp500_get_previous_balance_xcce_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xcce_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xcce_cs1 CURSOR FOR s_axcp500_get_previous_balance_xcce_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xcce_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF    

   #期初在制數量成本開賬檔
#   LET g_sql = " SELECT xccb_t.* FROM xccb_t ", #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xccbent,xccbld,xccbcomp,xccb001,xccb002,xccb003,xccb004,xccb005,",
               "        xccb006,xccb007,xccb008,xccb009,xccb010,xccb101,xccb102,xccb102a,",
               "        xccb102b,xccb102c,xccb102d,xccb102e,xccb102f,xccb102g,xccb102h,",
               "        xccbownid,xccbowndp,xccbcrtid,xccbcrtdp,xccbcrtdt,xccbmodid,xccbmoddt,",
               "        xccbcnfid,xccbcnfdt,xccbpstid,xccbpstdt,xccbstus FROM xccb_t ",
   #161124-00048#20 add(e)
               "  WHERE xccbent =  ",g_enterprise,
               "    AND xccbld  = '",g_ld,"'",
               "    AND xccb001 = ?",
               "    AND xccb003 = '",g_xcat001,"'",
               "    AND xccb004 =  ",g_last_yy,
               "    AND xccb005 =  ",g_last_pp,
               "    AND xccb006 = ? "
   PREPARE s_axcp500_get_previous_balance_xccb_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccb_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xccb_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccb_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccb_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   #在制元件发料明细档   
#   LET g_sql = " SELECT xccz_t.* FROM xccz_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,",
               "        xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,",
               "        xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901 FROM xccz_t ", 
   #161124-00048#20 add(e)
               "  WHERE xcczent =  ",g_enterprise,
               "    AND xcczld  = '",g_ld,"'",
               "    AND xccz001 = ?",
               "    AND xccz003 = '",g_xcat001,"'",
               "    AND xccz004 =  ",g_last_yy,
               "    AND xccz005 =  ",g_last_pp,
               "    AND xccz006 = ? ",
               "    AND xccz901  <> 0 "        

   PREPARE s_axcp500_get_previous_balance_xccz_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccz_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xccz_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccz_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccz_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   ##在制组件工艺成本期异动统计档
   #LET g_sql = " SELECT xccf_t.* FROM xccf_t,imaa_t ",
   #            "  WHERE xccfent =  ",g_enterprise,
   #            "    AND xccfld  = '",g_ld,"'",
   #            "    AND xccf001 = ?",
   #            "    AND xccf003 = '",g_xcat001,"'",
   #            "    AND xccf004 =  ",g_last_yy,
   #            "    AND xccf005 =  ",g_last_pp,
   #            "    AND (xccf901  <> 0 OR xccf902  <> 0 OR xccf902a <> 0 OR xccf902b <> 0 OR ",
   #            "         xccf902c <> 0 OR xccf902d <> 0 OR xccf902e <> 0 OR xccf902f <> 0 OR ",
   #            "         xccf902g <> 0 OR xccf902h <> 0 ) ",
   #            "    AND imaaent = xccfent ",
   #            "    AND imaa001 = xccf009 ",
   #            "    AND ",g_wc  
   #            
   #PREPARE s_axcp500_get_previous_balance_xccf_p FROM g_sql
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code = SQLCA.sqlcode
   #   LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccf_p'
   #   LET g_errparam.popup = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #
   #DECLARE s_axcp500_get_previous_balance_xccf_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccf_p
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code = SQLCA.sqlcode
   #   LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccf_cs1'
   #   LET g_errparam.popup = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   
   #联产品成本期异动统计档
#   LET g_sql = " SELECT xccg_t.* FROM xccg_t ", #161124-00048#20 mark
    #161124-00048#20 add(s)
   LET g_sql = " SELECT xccgent,xccgcomp,xccgld,xccg001,xccg002,xccg003,xccg004,xccg005,",
               "        xccg006,xccg007,xccg008,xccg009,xccg010,xccg101,xccg102,xccg102a,",
               "        xccg102b,xccg102c,xccg102d,xccg102e,xccg102f,xccg102g,xccg102h,",
               "        xccg301,xccg302,xccg302a,xccg302b,xccg302c,xccg302d,xccg302e,",
               "        xccg302f,xccg302g,xccg302h,xccg901,xccg902,xccg902a,xccg902b,",
               "        xccg902c,xccg902d,xccg902e,xccg902f,xccg902g,xccg902h,xccgtime ",
               "   FROM xccg_t ",
    #161124-00048#20 add(e)
               "  WHERE xccgent =  ",g_enterprise,
               "    AND xccgld  = '",g_ld,"'",
               "    AND xccg001 = ?",
               "    AND xccg003 = '",g_xcat001,"'",
               "    AND xccg004 =  ",g_last_yy,
               "    AND xccg005 =  ",g_last_pp,
               "    AND xccg006 = ? ",
               "    AND (xccg901  <> 0 OR xccg902  <> 0 OR xccg902a <> 0 OR xccg902b <> 0 OR ",
               "         xccg902c <> 0 OR xccg902d <> 0 OR xccg902e <> 0 OR xccg902f <> 0 OR ",
               "         xccg902g <> 0 OR xccg902h <> 0 ) "  
   PREPARE s_axcp500_get_previous_balance_xccg_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xccg_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xccg_cs1 CURSOR FOR s_axcp500_get_previous_balance_xccg_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xccg_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #拆件在制主件成本期异动统计档
#   LET g_sql = " SELECT xcch_t.* FROM xcch_t,imaa_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xcchent,xcchcomp,xcchld,xcch001,xcch002,xcch003,xcch004,xcch005,       ",
               "        xcch006,xcch007,xcch008,xcch009,xcch010,xcch011,xcch101,xcch102,       ",   
               "        xcch102a,xcch102b,xcch102c,xcch102d,xcch102e,xcch102f,xcch102g,        ",
               "        xcch102h,xcch200,xcch201,xcch202,xcch202a,xcch202b,xcch202c,xcch202d,  ",
               "        xcch202e,xcch202f,xcch202g,xcch202h,xcch204,xcch204a,xcch204b,xcch204c,",
               "        xcch204d,xcch204e,xcch204f,xcch204g,xcch204h,xcch301,xcch302,xcch302a, ",
               "        xcch302b,xcch302c,xcch302d,xcch302e,xcch302f,xcch302g,xcch302h,xcch303,",
               "        xcch304,xcch304a,xcch304b,xcch304c,xcch304d,xcch304e,xcch304f,xcch304g,",
               "        xcch304h,xcch901,xcch902,xcch902a,xcch902b,xcch902c,xcch902d,xcch902e, ",
               "        xcch902f,xcch902g,xcch902h,xcchtime FROM xcch_t,imaa_t ",              
   #161124-00048#20 add(e)
               "  WHERE xcchent =  ",g_enterprise,
               "    AND xcchld  = '",g_ld,"'",
               "    AND xcch001 = ?",
               "    AND xcch003 = '",g_xcat001,"'",
               "    AND xcch004 =  ",g_last_yy,
               "    AND xcch005 =  ",g_last_pp,
               "    AND (xcch901  <> 0 OR xcch902  <> 0 OR xcch902a <> 0 OR xcch902b <> 0 OR ",
               "         xcch902c <> 0 OR xcch902d <> 0 OR xcch902e <> 0 OR xcch902f <> 0 OR ",
               "         xcch902g <> 0 OR xcch902h <> 0 ) ",
               "    AND imaaent = xcchent ",
               "    AND imaa001 = xcch007 ",
               "    AND ",g_wc  
               
   PREPARE s_axcp500_get_previous_balance_xcch_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xcch_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xcch_cs1 CURSOR FOR s_axcp500_get_previous_balance_xcch_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xcch_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   #拆件在制组件成本期异动统计档
#   LET g_sql = " SELECT xcci_t.* FROM xcci_t ",  #161124-00048#20 mark
   #161124-00048#20 add(s)
   LET g_sql = " SELECT xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,",
               "        xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,",
               "        xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,",
               "        xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,",
               "        xcci202f,xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,",
               "        xcci302c,xcci302d,xcci302e,xcci302f,xcci302g,xcci302h,xcci303,",
               "        xcci304,xcci304a,xcci304b,xcci304c,xcci304d,xcci304e,xcci304f,",
               "        xcci304g,xcci304h,xcci901,xcci902,xcci902a,xcci902b,xcci902c,",
               "        xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,xccitime ",
               "   FROM xcci_t ",
   #161124-00048#20 add(e)
               "  WHERE xccient =  ",g_enterprise,
               "    AND xccild  = '",g_ld,"'",
               "    AND xcci001 = ?",
               "    AND xcci003 = '",g_xcat001,"'",
               "    AND xcci004 =  ",g_last_yy,
               "    AND xcci005 =  ",g_last_pp,
               "    AND xcci006 = ? ",
               "    AND (xcci901  <> 0 OR xcci902  <> 0 OR xcci902a <> 0 OR xcci902b <> 0 OR ",
               "         xcci902c <> 0 OR xcci902d <> 0 OR xcci902e <> 0 OR xcci902f <> 0 OR ",
               "         xcci902g <> 0 OR xcci902h <> 0 ) " 

   PREPARE s_axcp500_get_previous_balance_xcci_p FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'PREPARE s_axcp500_get_previous_balance_xcci_p'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   DECLARE s_axcp500_get_previous_balance_xcci_cs1 CURSOR FOR s_axcp500_get_previous_balance_xcci_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'DECLARE s_axcp500_get_previous_balance_xcci_cs1'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 结转上期余额 - 处理
# Memo...........:
# Usage..........: CALL s_axcp500_get_previous_balance_process(p_seq)
#                       RETURNING r_success
# Input parameter: p_seq          账套本位币顺序
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-21 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_previous_balance_process(p_seq)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_xccq          type_g_xccq  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_xccq RECORD  #料件庫存成本期異動明細統計檔
#       xccqent LIKE xccq_t.xccqent, #企业编号
#       xccqcomp LIKE xccq_t.xccqcomp, #法人组织
#       xccqld LIKE xccq_t.xccqld, #账套
#       xccqsite LIKE xccq_t.xccqsite, #营运组织
#       xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
#       xccq002 LIKE xccq_t.xccq002, #成本域
#       xccq003 LIKE xccq_t.xccq003, #成本计算类型
#       xccq004 LIKE xccq_t.xccq004, #年度
#       xccq005 LIKE xccq_t.xccq005, #期别
#       xccq006 LIKE xccq_t.xccq006, #料号
#       xccq007 LIKE xccq_t.xccq007, #特性码
#       xccq008 LIKE xccq_t.xccq008, #批号
#       xccq009 LIKE xccq_t.xccq009, #库存管理特征
#       xccq010 LIKE xccq_t.xccq010, #仓库
#       xccq011 LIKE xccq_t.xccq011, #储位
#       xccq012 LIKE xccq_t.xccq012, #品类
#       xccq101 LIKE xccq_t.xccq101, #上期结存数量
#       xccq102 LIKE xccq_t.xccq102, #上期结存金额
#       xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
#       xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
#       xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
#       xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
#       xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
#       xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
#       xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
#       xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
#       xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
#       xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
#       xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
#       xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
#       xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
#       xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
#       xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
#       xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
#       xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
#       xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
#       xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
#       xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
#       xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
#       xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
#       xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
#       xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
#       xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
#       xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
#       xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
#       xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
#       xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
#       xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
#       xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
#       xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
#       xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
#       xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
#       xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
#       xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
#       xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
#       xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
#       xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
#       xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
#       xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
#       xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
#       xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
#       xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
#       xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
#       xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
#       xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
#       xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
#       xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
#       xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
#       xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
#       xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
#       xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
#       xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
#       xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
#       xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
#       xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
#       xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
#       xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
#       xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
#       xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
#       xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
#       xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
#       xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
#       xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
#       xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
#       xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
#       xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
#       xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
#       xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
#       xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
#       xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
#       xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
#       xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
#       xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
#       xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
#       xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
#       xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
#       xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
#       xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
#       xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
#       xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
#       xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
#       xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
#       xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
#       xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
#       xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
#       xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
#       xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
#       xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
#       xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
#       xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
#       xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
#       xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
#       xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
#       xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
#       xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
#       xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
#       xccq280 LIKE xccq_t.xccq280, #本期平均单价
#       xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
#       xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
#       xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
#       xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
#       xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
#       xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
#       xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
#       xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
#       xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
#       xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
#       xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
#       xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
#       xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
#       xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
#       xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
#       xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
#       xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
#       xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
#       xccq303 LIKE xccq_t.xccq303, #本期销货数量
#       xccq304 LIKE xccq_t.xccq304, #本期销货成本
#       xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
#       xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
#       xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
#       xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
#       xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
#       xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
#       xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
#       xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
#       xccq305 LIKE xccq_t.xccq305, #本期销退数量
#       xccq306 LIKE xccq_t.xccq306, #本期销退成本
#       xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
#       xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
#       xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
#       xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
#       xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
#       xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
#       xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
#       xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
#       xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
#       xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
#       xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
#       xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
#       xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
#       xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
#       xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
#       xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
#       xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
#       xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
#       xccq309 LIKE xccq_t.xccq309, #本期杂发数量
#       xccq310 LIKE xccq_t.xccq310, #本期杂发金额
#       xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
#       xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
#       xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
#       xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
#       xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
#       xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
#       xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
#       xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
#       xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
#       xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
#       xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
#       xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
#       xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
#       xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
#       xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
#       xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
#       xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
#       xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
#       xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
#       xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
#       xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
#       xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
#       xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
#       xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
#       xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
#       xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
#       xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
#       xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
#       xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
#       xccq402 LIKE xccq_t.xccq402, #本期销退金额
#       xccq901 LIKE xccq_t.xccq901, #期末结存数量
#       xccq902 LIKE xccq_t.xccq902, #期末结存金额
#       xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
#       xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
#       xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
#       xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
#       xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
#       xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
#       xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
#       xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
#       xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
#       xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
#       xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
#       xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
#       xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
#       xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
#       xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
#       xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
#       xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
#       xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_last_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_last_xccq           type_g_xccq  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_last_xccq RECORD  #料件庫存成本期異動明細統計檔
#       xccqent LIKE xccq_t.xccqent, #企业编号
#       xccqcomp LIKE xccq_t.xccqcomp, #法人组织
#       xccqld LIKE xccq_t.xccqld, #账套
#       xccqsite LIKE xccq_t.xccqsite, #营运组织
#       xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
#       xccq002 LIKE xccq_t.xccq002, #成本域
#       xccq003 LIKE xccq_t.xccq003, #成本计算类型
#       xccq004 LIKE xccq_t.xccq004, #年度
#       xccq005 LIKE xccq_t.xccq005, #期别
#       xccq006 LIKE xccq_t.xccq006, #料号
#       xccq007 LIKE xccq_t.xccq007, #特性码
#       xccq008 LIKE xccq_t.xccq008, #批号
#       xccq009 LIKE xccq_t.xccq009, #库存管理特征
#       xccq010 LIKE xccq_t.xccq010, #仓库
#       xccq011 LIKE xccq_t.xccq011, #储位
#       xccq012 LIKE xccq_t.xccq012, #品类
#       xccq101 LIKE xccq_t.xccq101, #上期结存数量
#       xccq102 LIKE xccq_t.xccq102, #上期结存金额
#       xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
#       xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
#       xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
#       xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
#       xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
#       xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
#       xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
#       xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
#       xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
#       xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
#       xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
#       xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
#       xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
#       xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
#       xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
#       xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
#       xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
#       xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
#       xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
#       xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
#       xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
#       xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
#       xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
#       xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
#       xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
#       xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
#       xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
#       xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
#       xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
#       xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
#       xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
#       xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
#       xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
#       xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
#       xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
#       xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
#       xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
#       xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
#       xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
#       xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
#       xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
#       xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
#       xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
#       xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
#       xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
#       xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
#       xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
#       xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
#       xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
#       xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
#       xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
#       xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
#       xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
#       xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
#       xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
#       xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
#       xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
#       xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
#       xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
#       xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
#       xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
#       xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
#       xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
#       xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
#       xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
#       xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
#       xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
#       xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
#       xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
#       xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
#       xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
#       xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
#       xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
#       xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
#       xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
#       xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
#       xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
#       xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
#       xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
#       xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
#       xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
#       xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
#       xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
#       xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
#       xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
#       xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
#       xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
#       xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
#       xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
#       xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
#       xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
#       xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
#       xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
#       xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
#       xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
#       xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
#       xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
#       xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
#       xccq280 LIKE xccq_t.xccq280, #本期平均单价
#       xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
#       xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
#       xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
#       xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
#       xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
#       xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
#       xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
#       xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
#       xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
#       xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
#       xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
#       xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
#       xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
#       xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
#       xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
#       xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
#       xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
#       xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
#       xccq303 LIKE xccq_t.xccq303, #本期销货数量
#       xccq304 LIKE xccq_t.xccq304, #本期销货成本
#       xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
#       xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
#       xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
#       xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
#       xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
#       xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
#       xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
#       xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
#       xccq305 LIKE xccq_t.xccq305, #本期销退数量
#       xccq306 LIKE xccq_t.xccq306, #本期销退成本
#       xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
#       xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
#       xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
#       xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
#       xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
#       xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
#       xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
#       xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
#       xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
#       xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
#       xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
#       xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
#       xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
#       xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
#       xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
#       xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
#       xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
#       xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
#       xccq309 LIKE xccq_t.xccq309, #本期杂发数量
#       xccq310 LIKE xccq_t.xccq310, #本期杂发金额
#       xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
#       xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
#       xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
#       xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
#       xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
#       xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
#       xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
#       xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
#       xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
#       xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
#       xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
#       xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
#       xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
#       xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
#       xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
#       xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
#       xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
#       xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
#       xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
#       xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
#       xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
#       xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
#       xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
#       xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
#       xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
#       xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
#       xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
#       xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
#       xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
#       xccq402 LIKE xccq_t.xccq402, #本期销退金额
#       xccq901 LIKE xccq_t.xccq901, #期末结存数量
#       xccq902 LIKE xccq_t.xccq902, #期末结存金额
#       xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
#       xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
#       xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
#       xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
#       xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
#       xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
#       xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
#       xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
#       xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
#       xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
#       xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
#       xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
#       xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
#       xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
#       xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
#       xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
#       xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
#       xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_xccc           type_g_xccc  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_xccc RECORD  #料件庫存成本期異動統計檔
#       xcccent LIKE xccc_t.xcccent, #企业编号
#       xccccomp LIKE xccc_t.xccccomp, #法人组织
#       xcccld LIKE xccc_t.xcccld, #账套
#       xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
#       xccc002 LIKE xccc_t.xccc002, #成本域
#       xccc003 LIKE xccc_t.xccc003, #成本计算类型
#       xccc004 LIKE xccc_t.xccc004, #年度
#       xccc005 LIKE xccc_t.xccc005, #期别
#       xccc006 LIKE xccc_t.xccc006, #料号
#       xccc007 LIKE xccc_t.xccc007, #产品特征
#       xccc008 LIKE xccc_t.xccc008, #批号
#       xccc010 LIKE xccc_t.xccc010, #核算币种
#       xccc101 LIKE xccc_t.xccc101, #上期结存数量
#       xccc102 LIKE xccc_t.xccc102, #上期结存金额
#       xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
#       xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
#       xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
#       xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
#       xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
#       xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
#       xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
#       xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
#       xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
#       xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
#       xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
#       xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
#       xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
#       xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
#       xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
#       xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
#       xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
#       xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
#       xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
#       xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
#       xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
#       xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
#       xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
#       xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
#       xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
#       xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
#       xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
#       xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
#       xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
#       xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
#       xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
#       xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
#       xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
#       xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
#       xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
#       xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
#       xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
#       xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
#       xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
#       xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
#       xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
#       xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
#       xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
#       xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
#       xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
#       xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
#       xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
#       xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
#       xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
#       xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
#       xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
#       xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
#       xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
#       xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
#       xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
#       xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
#       xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
#       xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
#       xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
#       xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
#       xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
#       xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
#       xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
#       xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
#       xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
#       xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
#       xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
#       xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
#       xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
#       xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
#       xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
#       xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
#       xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
#       xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
#       xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
#       xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
#       xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
#       xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
#       xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
#       xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
#       xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
#       xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
#       xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
#       xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
#       xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
#       xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
#       xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
#       xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
#       xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
#       xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
#       xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
#       xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
#       xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
#       xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
#       xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
#       xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
#       xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
#       xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
#       xccc280 LIKE xccc_t.xccc280, #本期平均单价
#       xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
#       xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
#       xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
#       xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
#       xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
#       xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
#       xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
#       xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
#       xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
#       xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
#       xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
#       xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
#       xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
#       xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
#       xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
#       xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
#       xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
#       xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
#       xccc303 LIKE xccc_t.xccc303, #本期销货数量
#       xccc304 LIKE xccc_t.xccc304, #本期销货成本
#       xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
#       xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
#       xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
#       xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
#       xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
#       xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
#       xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
#       xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
#       xccc305 LIKE xccc_t.xccc305, #本期销退数量
#       xccc306 LIKE xccc_t.xccc306, #本期销退成本
#       xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
#       xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
#       xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
#       xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
#       xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
#       xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
#       xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
#       xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
#       xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
#       xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
#       xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
#       xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
#       xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
#       xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
#       xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
#       xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
#       xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
#       xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
#       xccc309 LIKE xccc_t.xccc309, #本期杂发数量
#       xccc310 LIKE xccc_t.xccc310, #本期杂发金额
#       xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
#       xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
#       xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
#       xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
#       xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
#       xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
#       xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
#       xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
#       xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
#       xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
#       xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
#       xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
#       xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
#       xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
#       xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
#       xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
#       xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
#       xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
#       xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
#       xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
#       xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
#       xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
#       xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
#       xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
#       xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
#       xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
#       xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
#       xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
#       xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
#       xccc402 LIKE xccc_t.xccc402, #本期销退金额
#       xccc901 LIKE xccc_t.xccc901, #期末结存数量
#       xccc902 LIKE xccc_t.xccc902, #期末结存金额
#       xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
#       xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
#       xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
#       xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
#       xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
#       xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
#       xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
#       xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
#       xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
#       xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
#       xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
#       xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
#       xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
#       xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
#       xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
#       xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
#       xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
#       xccctime LIKE xccc_t.xccctime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_last_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_last_xccc           type_g_xccc   #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_last_xccc RECORD  #料件庫存成本期異動統計檔
#       xcccent LIKE xccc_t.xcccent, #企业编号
#       xccccomp LIKE xccc_t.xccccomp, #法人组织
#       xcccld LIKE xccc_t.xcccld, #账套
#       xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
#       xccc002 LIKE xccc_t.xccc002, #成本域
#       xccc003 LIKE xccc_t.xccc003, #成本计算类型
#       xccc004 LIKE xccc_t.xccc004, #年度
#       xccc005 LIKE xccc_t.xccc005, #期别
#       xccc006 LIKE xccc_t.xccc006, #料号
#       xccc007 LIKE xccc_t.xccc007, #产品特征
#       xccc008 LIKE xccc_t.xccc008, #批号
#       xccc010 LIKE xccc_t.xccc010, #核算币种
#       xccc101 LIKE xccc_t.xccc101, #上期结存数量
#       xccc102 LIKE xccc_t.xccc102, #上期结存金额
#       xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
#       xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
#       xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
#       xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
#       xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
#       xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
#       xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
#       xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
#       xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
#       xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
#       xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
#       xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
#       xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
#       xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
#       xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
#       xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
#       xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
#       xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
#       xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
#       xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
#       xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
#       xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
#       xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
#       xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
#       xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
#       xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
#       xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
#       xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
#       xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
#       xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
#       xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
#       xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
#       xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
#       xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
#       xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
#       xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
#       xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
#       xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
#       xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
#       xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
#       xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
#       xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
#       xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
#       xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
#       xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
#       xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
#       xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
#       xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
#       xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
#       xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
#       xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
#       xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
#       xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
#       xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
#       xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
#       xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
#       xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
#       xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
#       xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
#       xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
#       xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
#       xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
#       xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
#       xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
#       xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
#       xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
#       xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
#       xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
#       xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
#       xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
#       xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
#       xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
#       xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
#       xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
#       xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
#       xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
#       xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
#       xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
#       xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
#       xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
#       xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
#       xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
#       xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
#       xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
#       xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
#       xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
#       xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
#       xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
#       xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
#       xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
#       xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
#       xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
#       xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
#       xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
#       xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
#       xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
#       xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
#       xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
#       xccc280 LIKE xccc_t.xccc280, #本期平均单价
#       xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
#       xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
#       xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
#       xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
#       xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
#       xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
#       xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
#       xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
#       xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
#       xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
#       xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
#       xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
#       xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
#       xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
#       xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
#       xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
#       xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
#       xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
#       xccc303 LIKE xccc_t.xccc303, #本期销货数量
#       xccc304 LIKE xccc_t.xccc304, #本期销货成本
#       xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
#       xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
#       xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
#       xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
#       xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
#       xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
#       xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
#       xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
#       xccc305 LIKE xccc_t.xccc305, #本期销退数量
#       xccc306 LIKE xccc_t.xccc306, #本期销退成本
#       xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
#       xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
#       xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
#       xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
#       xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
#       xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
#       xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
#       xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
#       xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
#       xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
#       xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
#       xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
#       xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
#       xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
#       xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
#       xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
#       xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
#       xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
#       xccc309 LIKE xccc_t.xccc309, #本期杂发数量
#       xccc310 LIKE xccc_t.xccc310, #本期杂发金额
#       xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
#       xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
#       xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
#       xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
#       xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
#       xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
#       xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
#       xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
#       xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
#       xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
#       xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
#       xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
#       xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
#       xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
#       xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
#       xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
#       xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
#       xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
#       xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
#       xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
#       xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
#       xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
#       xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
#       xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
#       xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
#       xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
#       xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
#       xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
#       xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
#       xccc402 LIKE xccc_t.xccc402, #本期销退金额
#       xccc901 LIKE xccc_t.xccc901, #期末结存数量
#       xccc902 LIKE xccc_t.xccc902, #期末结存金额
#       xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
#       xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
#       xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
#       xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
#       xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
#       xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
#       xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
#       xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
#       xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
#       xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
#       xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
#       xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
#       xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
#       xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
#       xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
#       xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
#       xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
#       xccctime LIKE xccc_t.xccctime  #最近成本计算时间
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_xcca          RECORD LIKE xcca_t.*  #161124-00048#20 mark
   DEFINE  l_xcca          type_g_xcca   #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#   DEFINE l_xcca RECORD  #期初庫存數量成本開帳檔
#       xccaent LIKE xcca_t.xccaent, #企业编号
#       xccald LIKE xcca_t.xccald, #账套
#       xccacomp LIKE xcca_t.xccacomp, #法人组织
#       xcca001 LIKE xcca_t.xcca001, #账套本位币顺序
#       xcca002 LIKE xcca_t.xcca002, #成本域
#       xcca003 LIKE xcca_t.xcca003, #成本计算类型
#       xcca004 LIKE xcca_t.xcca004, #年度
#       xcca005 LIKE xcca_t.xcca005, #期别
#       xcca006 LIKE xcca_t.xcca006, #料号
#       xcca007 LIKE xcca_t.xcca007, #特性
#       xcca008 LIKE xcca_t.xcca008, #批号
#       xcca101 LIKE xcca_t.xcca101, #当月期末数量
#       xcca102 LIKE xcca_t.xcca102, #当月期末金额-金额合计
#       xcca102a LIKE xcca_t.xcca102a, #当月期末金额-材料
#       xcca102b LIKE xcca_t.xcca102b, #当月期末金额-人工
#       xcca102c LIKE xcca_t.xcca102c, #当月期末金额-委外加工
#       xcca102d LIKE xcca_t.xcca102d, #当月期末金额-制费一
#       xcca102e LIKE xcca_t.xcca102e, #当月期末金额-制费二
#       xcca102f LIKE xcca_t.xcca102f, #当月期末金额-制费三
#       xcca102g LIKE xcca_t.xcca102g, #当月期末金额-制费四
#       xcca102h LIKE xcca_t.xcca102h, #当月期末金额-制费五
#       xcca110 LIKE xcca_t.xcca110, #当月期末金额-平均单价
#       xcca110a LIKE xcca_t.xcca110a, #当月期末金额-材料平均单价
#       xcca110b LIKE xcca_t.xcca110b, #当月期末金额-人工平均单价
#       xcca110c LIKE xcca_t.xcca110c, #当月期末金额-委外加工平均单
#       xcca110d LIKE xcca_t.xcca110d, #当月期末金额-制费一平均单价
#       xcca110e LIKE xcca_t.xcca110e, #当月期末金额-制费二平均单价
#       xcca110f LIKE xcca_t.xcca110f, #当月期末金额-制费三平均单价
#       xcca110g LIKE xcca_t.xcca110g, #当月期末金额-制费四平均单价
#       xcca110h LIKE xcca_t.xcca110h, #当月期末金额-制费五平均单价
#       xccaownid LIKE xcca_t.xccaownid, #资料所有者
#       xccaowndp LIKE xcca_t.xccaowndp, #资料所有部门
#       xccacrtid LIKE xcca_t.xccacrtid, #资料录入者
#       xccacrtdp LIKE xcca_t.xccacrtdp, #资料录入部门
#       xccacrtdt LIKE xcca_t.xccacrtdt, #资料创建日
#       xccamodid LIKE xcca_t.xccamodid, #资料更改者
#       xccamoddt LIKE xcca_t.xccamoddt, #最近更改日
#       xccacnfid LIKE xcca_t.xccacnfid, #资料审核者
#       xccacnfdt LIKE xcca_t.xccacnfdt, #数据审核日
#       xccapstid LIKE xcca_t.xccapstid, #资料过账者
#       xccapstdt LIKE xcca_t.xccapstdt, #资料过账日
#       xccastus LIKE xcca_t.xccastus  #状态码
#END RECORD
#   #161124-00048#20 add(e)
#170605-00013#1-e-mark
#161124-00048#20 mark(s)
#   DEFINE l_xccd          RECORD LIKE xccd_t.*
#   DEFINE l_last_xccd     RECORD LIKE xccd_t.*
#   DEFINE l_xcce          RECORD LIKE xcce_t.*
#   DEFINE l_last_xcce     RECORD LIKE xcce_t.*   
#   DEFINE l_xccb          RECORD LIKE xccb_t.*
#   DEFINE l_xccz          RECORD LIKE xccz_t.*
#   DEFINE l_last_xccz     RECORD LIKE xccz_t.*   
#   DEFINE l_xccg          RECORD LIKE xccg_t.*
#   DEFINE l_last_xccg     RECORD LIKE xccg_t.*   
#   DEFINE l_xcch          RECORD LIKE xcch_t.*
#   DEFINE l_last_xcch     RECORD LIKE xcch_t.*   
#   DEFINE l_xcci          RECORD LIKE xcci_t.*
#   DEFINE l_last_xcci     RECORD LIKE xcci_t.*  
#161124-00048#20 mark(e)
    #170605-00013#1-s-add
    DEFINE l_xccd          type_g_xccd
    DEFINE l_last_xccd     type_g_xccd
    DEFINE l_xcce          type_g_xcce
    DEFINE l_last_xcce     type_g_xcce
    DEFINE l_xccb          type_g_xccb
    DEFINE l_xccz          type_g_xccz
    DEFINE l_last_xccz     type_g_xccz
    DEFINE l_xccg          type_g_xccg
    DEFINE l_last_xccg     type_g_xccg
    DEFINE l_xcch          type_g_xcch
    DEFINE l_last_xcch     type_g_xcch
    DEFINE l_xcci          type_g_xcci
    DEFINE l_last_xcci     type_g_xcci
    #170605-00013#1-e-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企业编号
#       xccdcomp LIKE xccd_t.xccdcomp, #法人组织
#       xccdld LIKE xccd_t.xccdld, #账套
#       xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本计算类型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期别
#       xccd006 LIKE xccd_t.xccd006, #工单编号
#       xccd007 LIKE xccd_t.xccd007, #主件料号
#       xccd008 LIKE xccd_t.xccd008, #产品特征
#       xccd009 LIKE xccd_t.xccd009, #批号
#       xccd010 LIKE xccd_t.xccd010, #项目号
#       xccd011 LIKE xccd_t.xccd011, #核算币种
#       xccd012 LIKE xccd_t.xccd012, #重复性成产否
#       xccd013 LIKE xccd_t.xccd013, #成产计划号
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期结存数量
#       xccd102 LIKE xccd_t.xccd102, #上期结存金额
#       xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
#       xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
#       xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
#       xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
#       xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工时
#       xccd201 LIKE xccd_t.xccd201, #本期投入数量
#       xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
#       xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
#       xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
#       xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
#       xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
#       xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
#       xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
#       xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
#       xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
#       xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
#       xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
#       xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
#       xccd301 LIKE xccd_t.xccd301, #本期转出数量
#       xccd302 LIKE xccd_t.xccd302, #本期转出金额
#       xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
#       xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
#       xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
#       xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
#       xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
#       xccd303 LIKE xccd_t.xccd303, #差异转出数量
#       xccd304 LIKE xccd_t.xccd304, #差异转出金额
#       xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
#       xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
#       xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
#       xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
#       xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
#       xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
#       xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
#       xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
#       xccd901 LIKE xccd_t.xccd901, #期末结存数量
#       xccd902 LIKE xccd_t.xccd902, #期末结存金额
#       xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
#       xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
#       xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
#       xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
#       xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
#END RECORD
#DEFINE l_last_xccd RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企业编号
#       xccdcomp LIKE xccd_t.xccdcomp, #法人组织
#       xccdld LIKE xccd_t.xccdld, #账套
#       xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本计算类型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期别
#       xccd006 LIKE xccd_t.xccd006, #工单编号
#       xccd007 LIKE xccd_t.xccd007, #主件料号
#       xccd008 LIKE xccd_t.xccd008, #产品特征
#       xccd009 LIKE xccd_t.xccd009, #批号
#       xccd010 LIKE xccd_t.xccd010, #项目号
#       xccd011 LIKE xccd_t.xccd011, #核算币种
#       xccd012 LIKE xccd_t.xccd012, #重复性成产否
#       xccd013 LIKE xccd_t.xccd013, #成产计划号
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期结存数量
#       xccd102 LIKE xccd_t.xccd102, #上期结存金额
#       xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
#       xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
#       xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
#       xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
#       xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工时
#       xccd201 LIKE xccd_t.xccd201, #本期投入数量
#       xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
#       xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
#       xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
#       xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
#       xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
#       xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
#       xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
#       xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
#       xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
#       xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
#       xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
#       xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
#       xccd301 LIKE xccd_t.xccd301, #本期转出数量
#       xccd302 LIKE xccd_t.xccd302, #本期转出金额
#       xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
#       xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
#       xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
#       xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
#       xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
#       xccd303 LIKE xccd_t.xccd303, #差异转出数量
#       xccd304 LIKE xccd_t.xccd304, #差异转出金额
#       xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
#       xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
#       xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
#       xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
#       xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
#       xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
#       xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
#       xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
#       xccd901 LIKE xccd_t.xccd901, #期末结存数量
#       xccd902 LIKE xccd_t.xccd902, #期末结存金额
#       xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
#       xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
#       xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
#       xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
#       xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
#END RECORD
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
#DEFINE l_last_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
#DEFINE l_xccb RECORD  #期初在製數量成本開帳檔
#       xccbent LIKE xccb_t.xccbent, #企业编号
#       xccbld LIKE xccb_t.xccbld, #账套
#       xccbcomp LIKE xccb_t.xccbcomp, #法人组织
#       xccb001 LIKE xccb_t.xccb001, #账套本位币顺序
#       xccb002 LIKE xccb_t.xccb002, #成本域
#       xccb003 LIKE xccb_t.xccb003, #成本计算类型
#       xccb004 LIKE xccb_t.xccb004, #年度
#       xccb005 LIKE xccb_t.xccb005, #期别
#       xccb006 LIKE xccb_t.xccb006, #工单编号
#       xccb007 LIKE xccb_t.xccb007, #元件编号
#       xccb008 LIKE xccb_t.xccb008, #特性
#       xccb009 LIKE xccb_t.xccb009, #批号
#       xccb010 LIKE xccb_t.xccb010, #元件类型
#       xccb101 LIKE xccb_t.xccb101, #当月期末数量
#       xccb102 LIKE xccb_t.xccb102, #当月期末金额-金额合计
#       xccb102a LIKE xccb_t.xccb102a, #当月期末金额-材料
#       xccb102b LIKE xccb_t.xccb102b, #当月期末金额-人工
#       xccb102c LIKE xccb_t.xccb102c, #当月期末金额-委外加工
#       xccb102d LIKE xccb_t.xccb102d, #当月期末金额-制费一
#       xccb102e LIKE xccb_t.xccb102e, #当月期末金额-制费二
#       xccb102f LIKE xccb_t.xccb102f, #当月期末金额-制费三
#       xccb102g LIKE xccb_t.xccb102g, #当月期末金额-制费四
#       xccb102h LIKE xccb_t.xccb102h, #当月期末金额-制费五
#       xccbownid LIKE xccb_t.xccbownid, #资料所有者
#       xccbowndp LIKE xccb_t.xccbowndp, #资料所有部门
#       xccbcrtid LIKE xccb_t.xccbcrtid, #资料录入者
#       xccbcrtdp LIKE xccb_t.xccbcrtdp, #资料录入部门
#       xccbcrtdt LIKE xccb_t.xccbcrtdt, #资料创建日
#       xccbmodid LIKE xccb_t.xccbmodid, #资料更改者
#       xccbmoddt LIKE xccb_t.xccbmoddt, #最近更改日
#       xccbcnfid LIKE xccb_t.xccbcnfid, #资料审核者
#       xccbcnfdt LIKE xccb_t.xccbcnfdt, #数据审核日
#       xccbpstid LIKE xccb_t.xccbpstid, #资料过账者
#       xccbpstdt LIKE xccb_t.xccbpstdt, #资料过账日
#       xccbstus LIKE xccb_t.xccbstus  #状态码
#END RECORD
#DEFINE l_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
#DEFINE l_last_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
#DEFINE l_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE l_last_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE l_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
#DEFINE l_last_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
#DEFINE l_last_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_xcbzsite      LIKE xcbz_t.xcbzsite  #add zhangllc 151215
   DEFINE l_xcbz005       LIKE xcbz_t.xcbz005   #add zhangllc 151215
   DEFINE l_xcbz006       LIKE xcbz_t.xcbz006   #add zhangllc 151215
   DEFINE l_xcbz007       LIKE xcbz_t.xcbz007   #add zhangllc 151215
   DEFINE l_xcbz101       LIKE xcbz_t.xcbz101   #add zhangllc 151215
   
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   
   IF g_sys_6021 = 'Y' THEN　#add zhangllc 160526 SBS1
      #add zhangllc 151215 --begin
      #料件库存成本期异动统计档
      FOREACH s_axcp500_get_previous_balance_xccq_cs1 USING p_seq INTO l_last_xccq.*
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccq_cs1'
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN r_success         
         END IF
         
         CALL s_axcp500_init_xccq0()
              RETURNING l_xccq.*
         LET l_xccq.xccqent  = g_enterprise                 #企业编号
         LET l_xccq.xccqcomp = l_last_xccq.xccqcomp         #法人组织
         LET l_xccq.xccqld   = l_last_xccq.xccqld           #账套
         LET l_xccq.xccqsite = l_last_xccq.xccqsite
         LET l_xccq.xccq001  = l_last_xccq.xccq001          #账套本位币顺序
         LET l_xccq.xccq002  = l_last_xccq.xccq002          #成本域
         LET l_xccq.xccq003  = l_last_xccq.xccq003          #成本计算类型
         LET l_xccq.xccq004  = g_yy                         #年度
         LET l_xccq.xccq005  = g_pp                         #期别
         LET l_xccq.xccq006  = l_last_xccq.xccq006          #料号
         LET l_xccq.xccq007  = l_last_xccq.xccq007          #产品特征
         LET l_xccq.xccq008  = l_last_xccq.xccq008          #批号
         LET l_xccq.xccq009  = l_last_xccq.xccq009
         LET l_xccq.xccq010  = l_last_xccq.xccq010          #
         LET l_xccq.xccq011  = l_last_xccq.xccq011          #
         LET l_xccq.xccq012  = l_last_xccq.xccq012          #
      
         LET l_xccq.xccq101  = l_last_xccq.xccq901          #上期结存数量
         LET l_xccq.xccq102  = l_last_xccq.xccq902          #上期结存金额
         LET l_xccq.xccq102a = l_last_xccq.xccq902a         #上期结存金额-材料
         LET l_xccq.xccq102b = l_last_xccq.xccq902b         #上期结存金额-人工
         LET l_xccq.xccq102c = l_last_xccq.xccq902c         #上期结存金额-加工
         LET l_xccq.xccq102d = l_last_xccq.xccq902d         #上期结存金额-制费一
         LET l_xccq.xccq102e = l_last_xccq.xccq902e         #上期结存金额-制费二
         LET l_xccq.xccq102f = l_last_xccq.xccq902f         #上期结存金额-制费三
         LET l_xccq.xccq102g = l_last_xccq.xccq902g         #上期结存金额-制费四
         LET l_xccq.xccq102h = l_last_xccq.xccq902h         #上期结存金额-制费五
         
         LET l_xccq.xccq280  = l_last_xccq.xccq280          #本期平均单价            
         LET l_xccq.xccq280a = l_last_xccq.xccq280a         #本期平均单价-材料       
         LET l_xccq.xccq280b = l_last_xccq.xccq280b         #本期平均单价-人工       
         LET l_xccq.xccq280c = l_last_xccq.xccq280c         #本期平均单价-加工       
         LET l_xccq.xccq280d = l_last_xccq.xccq280d         #本期平均单价-制费一     
         LET l_xccq.xccq280e = l_last_xccq.xccq280e         #本期平均单价-制费二     
         LET l_xccq.xccq280f = l_last_xccq.xccq280f         #本期平均单价-制费三     
         LET l_xccq.xccq280g = l_last_xccq.xccq280g         #本期平均单价-制费四     
         LET l_xccq.xccq280h = l_last_xccq.xccq280h         #本期平均单价-制费五         
         
         LET l_xccq.xccq901  = l_xccq.xccq101               #期末结存数量
         LET l_xccq.xccq902  = l_xccq.xccq102               #期末结存金额
         LET l_xccq.xccq902a = l_xccq.xccq102a              #期末结存金额-材料
         LET l_xccq.xccq902b = l_xccq.xccq102b              #期末结存金额-人工
         LET l_xccq.xccq902c = l_xccq.xccq102c              #期末结存金额-加工
         LET l_xccq.xccq902d = l_xccq.xccq102d              #期末结存金额-制费一
         LET l_xccq.xccq902e = l_xccq.xccq102e              #期末结存金额-制费二
         LET l_xccq.xccq902f = l_xccq.xccq102f              #期末结存金额-制费三
         LET l_xccq.xccq902g = l_xccq.xccq102g              #期末结存金额-制费四
         LET l_xccq.xccq902h = l_xccq.xccq102h              #期末结存金额-制费五      
      
         LET l_xccq.xccqtime = cl_get_current()             #最近成本计算时间
         
         CALL s_axcp500_ins_or_upd_xccq(l_xccq.*)
              RETURNING l_success
         IF NOT l_success THEN
            RETURN r_success
         END IF
      END FOREACH
      #add zhangllc 151215 --end


   END IF 　#add zhangllc 160526 SBS1
   
   #料件库存成本期异动统计档
   FOREACH s_axcp500_get_previous_balance_xccc_cs1 USING p_seq INTO l_last_xccc.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccc_cs1'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success         
      END IF
      
      CALL s_axcp500_init_xccc0()
           RETURNING l_xccc.*
      LET l_xccc.xcccent  = g_enterprise                 #企业编号
      LET l_xccc.xccccomp = l_last_xccc.xccccomp         #法人组织
      LET l_xccc.xcccld   = l_last_xccc.xcccld           #账套
      LET l_xccc.xccc001  = l_last_xccc.xccc001          #账套本位币顺序
      LET l_xccc.xccc002  = l_last_xccc.xccc002          #成本域
      LET l_xccc.xccc003  = l_last_xccc.xccc003          #成本计算类型
      LET l_xccc.xccc004  = g_yy                         #年度
      LET l_xccc.xccc005  = g_pp                         #期别
      LET l_xccc.xccc006  = l_last_xccc.xccc006          #料号
      LET l_xccc.xccc007  = l_last_xccc.xccc007          #产品特征
      LET l_xccc.xccc008  = l_last_xccc.xccc008          #批号
      LET l_xccc.xccc010  = l_last_xccc.xccc010          #核算币别

      LET l_xccc.xccc101  = l_last_xccc.xccc901          #上期结存数量
      LET l_xccc.xccc102  = l_last_xccc.xccc902          #上期结存金额
      LET l_xccc.xccc102a = l_last_xccc.xccc902a         #上期结存金额-材料
      LET l_xccc.xccc102b = l_last_xccc.xccc902b         #上期结存金额-人工
      LET l_xccc.xccc102c = l_last_xccc.xccc902c         #上期结存金额-加工
      LET l_xccc.xccc102d = l_last_xccc.xccc902d         #上期结存金额-制费一
      LET l_xccc.xccc102e = l_last_xccc.xccc902e         #上期结存金额-制费二
      LET l_xccc.xccc102f = l_last_xccc.xccc902f         #上期结存金额-制费三
      LET l_xccc.xccc102g = l_last_xccc.xccc902g         #上期结存金额-制费四
      LET l_xccc.xccc102h = l_last_xccc.xccc902h         #上期结存金额-制费五
      
      LET l_xccc.xccc280  = l_last_xccc.xccc280          #本期平均单价            
      LET l_xccc.xccc280a = l_last_xccc.xccc280a         #本期平均单价-材料       
      LET l_xccc.xccc280b = l_last_xccc.xccc280b         #本期平均单价-人工       
      LET l_xccc.xccc280c = l_last_xccc.xccc280c         #本期平均单价-加工       
      LET l_xccc.xccc280d = l_last_xccc.xccc280d         #本期平均单价-制费一     
      LET l_xccc.xccc280e = l_last_xccc.xccc280e         #本期平均单价-制费二     
      LET l_xccc.xccc280f = l_last_xccc.xccc280f         #本期平均单价-制费三     
      LET l_xccc.xccc280g = l_last_xccc.xccc280g         #本期平均单价-制费四     
      LET l_xccc.xccc280h = l_last_xccc.xccc280h         #本期平均单价-制费五         
      
      LET l_xccc.xccc901  = l_xccc.xccc101               #期末结存数量
      LET l_xccc.xccc902  = l_xccc.xccc102               #期末结存金额
      LET l_xccc.xccc902a = l_xccc.xccc102a              #期末结存金额-材料
      LET l_xccc.xccc902b = l_xccc.xccc102b              #期末结存金额-人工
      LET l_xccc.xccc902c = l_xccc.xccc102c              #期末结存金额-加工
      LET l_xccc.xccc902d = l_xccc.xccc102d              #期末结存金额-制费一
      LET l_xccc.xccc902e = l_xccc.xccc102e              #期末结存金额-制费二
      LET l_xccc.xccc902f = l_xccc.xccc102f              #期末结存金额-制费三
      LET l_xccc.xccc902g = l_xccc.xccc102g              #期末结存金额-制费四
      LET l_xccc.xccc902h = l_xccc.xccc102h              #期末结存金额-制费五      
   
      LET l_xccc.xccctime = cl_get_current()             #最近成本计算时间
      
      CALL s_axcp500_ins_or_upd_xccc(l_xccc.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END FOREACH

   #期初库存料件成本开账档
   FOREACH s_axcp500_get_previous_balance_xcca_cs1 USING p_seq INTO l_xcca.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xcca_cs1'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success         
      END IF   
      CALL s_axcp500_init_xccc0()
           RETURNING l_xccc.*
      LET l_xccc.xcccent  = g_enterprise            #企业编号
      LET l_xccc.xccccomp = l_xcca.xccacomp         #法人组织
      LET l_xccc.xcccld   = l_xcca.xccald           #账套
      LET l_xccc.xccc001  = l_xcca.xcca001          #账套本位币顺序
      LET l_xccc.xccc002  = l_xcca.xcca002          #成本域
      LET l_xccc.xccc003  = l_xcca.xcca003          #成本计算类型
      LET l_xccc.xccc004  = g_yy                    #年度
      LET l_xccc.xccc005  = g_pp                    #期别
      LET l_xccc.xccc006  = l_xcca.xcca006          #料号
      LET l_xccc.xccc007  = l_xcca.xcca007          #产品特征
      LET l_xccc.xccc008  = l_xcca.xcca008          #批号
      #carrier check
      #LET l_xccc.xccc010  = l_xcca.xcca010          #核算币别
      LET l_xccc.xccc010  = g_curr[p_seq].curr

      IF cl_null(l_xcca.xcca102a) THEN LET l_xcca.xcca102a = 0 END IF
      IF cl_null(l_xcca.xcca102b) THEN LET l_xcca.xcca102b = 0 END IF
      IF cl_null(l_xcca.xcca102c) THEN LET l_xcca.xcca102c = 0 END IF
      IF cl_null(l_xcca.xcca102d) THEN LET l_xcca.xcca102d = 0 END IF
      IF cl_null(l_xcca.xcca102e) THEN LET l_xcca.xcca102e = 0 END IF
      IF cl_null(l_xcca.xcca102f) THEN LET l_xcca.xcca102f = 0 END IF
      IF cl_null(l_xcca.xcca102g) THEN LET l_xcca.xcca102g = 0 END IF
      IF cl_null(l_xcca.xcca102h) THEN LET l_xcca.xcca102h = 0 END IF

      LET l_xcca.xcca102 = l_xcca.xcca102a + l_xcca.xcca102b + l_xcca.xcca102c + l_xcca.xcca102d +
                           l_xcca.xcca102e + l_xcca.xcca102f + l_xcca.xcca102g + l_xcca.xcca102h

      LET l_xccc.xccc101  = l_xcca.xcca101          #上期结存数量
      LET l_xccc.xccc102  = l_xcca.xcca102          #上期结存金额
      LET l_xccc.xccc102a = l_xcca.xcca102a         #上期结存金额-材料
      LET l_xccc.xccc102b = l_xcca.xcca102b         #上期结存金额-人工
      LET l_xccc.xccc102c = l_xcca.xcca102c         #上期结存金额-加工
      LET l_xccc.xccc102d = l_xcca.xcca102d         #上期结存金额-制费一
      LET l_xccc.xccc102e = l_xcca.xcca102e         #上期结存金额-制费二
      LET l_xccc.xccc102f = l_xcca.xcca102f         #上期结存金额-制费三
      LET l_xccc.xccc102g = l_xcca.xcca102g         #上期结存金额-制费四
      LET l_xccc.xccc102h = l_xcca.xcca102h         #上期结存金额-制费五
      
      LET l_xccc.xccc280  = l_xcca.xcca110          #本期平均单价            
      LET l_xccc.xccc280a = l_xcca.xcca110a         #本期平均单价-材料       
      LET l_xccc.xccc280b = l_xcca.xcca110b         #本期平均单价-人工       
      LET l_xccc.xccc280c = l_xcca.xcca110c         #本期平均单价-加工       
      LET l_xccc.xccc280d = l_xcca.xcca110d         #本期平均单价-制费一     
      LET l_xccc.xccc280e = l_xcca.xcca110e         #本期平均单价-制费二     
      LET l_xccc.xccc280f = l_xcca.xcca110f         #本期平均单价-制费三     
      LET l_xccc.xccc280g = l_xcca.xcca110g         #本期平均单价-制费四     
      LET l_xccc.xccc280h = l_xcca.xcca110h         #本期平均单价-制费五         

      LET l_xccc.xccc901  = l_xccc.xccc101          #期末结存数量
      LET l_xccc.xccc902  = l_xccc.xccc102          #期末结存金额
      LET l_xccc.xccc902a = l_xccc.xccc102a         #期末结存金额-材料
      LET l_xccc.xccc902b = l_xccc.xccc102b         #期末结存金额-人工
      LET l_xccc.xccc902c = l_xccc.xccc102c         #期末结存金额-加工
      LET l_xccc.xccc902d = l_xccc.xccc102d         #期末结存金额-制费一
      LET l_xccc.xccc902e = l_xccc.xccc102e         #期末结存金额-制费二
      LET l_xccc.xccc902f = l_xccc.xccc102f         #期末结存金额-制费三
      LET l_xccc.xccc902g = l_xccc.xccc102g         #期末结存金额-制费四
      LET l_xccc.xccc902h = l_xccc.xccc102h         #期末结存金额-制费五      
   
      LET l_xccc.xccctime = cl_get_current()        #最近成本计算时间
      
      CALL s_axcp500_ins_or_upd_xccc(l_xccc.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
      
      IF g_sys_6021 = 'Y' THEN　#add zhangllc 160526 SBS1
         #add zhangllc 151215 --begin
         #写入xccq
         FOREACH s_axcp500_get_previous_balance_xcca_cs1_xcbz
         USING l_xcca.xccaent,l_xcca.xccacomp,l_xcca.xccald,g_yy,g_pp,l_xcca.xcca006,l_xcca.xcca007,l_xcca.xcca008,
               l_xcca.xccaent,l_xcca.xccacomp
         INTO l_xcbzsite,l_xcbz005,l_xcbz006,l_xcbz007,l_xcbz101
            CALL s_axcp500_init_xccq0()
                 RETURNING l_xccq.*
            LET l_xccq.xccqent  = l_xcca.xccaent          #企业编号
            LET l_xccq.xccqcomp = l_xcca.xccacomp         #法人组织
            LET l_xccq.xccqsite = l_xcbzsite              #
            LET l_xccq.xccqld   = l_xcca.xccald           #账套
            LET l_xccq.xccq001  = l_xcca.xcca001          #账套本位币顺序
            LET l_xccq.xccq002  = l_xcca.xcca002          #成本域
            LET l_xccq.xccq003  = l_xcca.xcca003          #成本计算类型
            LET l_xccq.xccq004  = g_yy                    #年度
            LET l_xccq.xccq005  = g_pp                    #期别
            LET l_xccq.xccq006  = l_xcca.xcca006          #料号
            LET l_xccq.xccq007  = l_xcca.xcca007          #产品特征
            LET l_xccq.xccq008  = l_xcca.xcca008          #批号
            LET l_xccq.xccq009  = l_xcbz005               #庫存管理特徵
            LET l_xccq.xccq010  = l_xcbz006               #倉庫編碼
            LET l_xccq.xccq011  = l_xcbz007               #儲位編號
            SELECT imaa009 INTO l_xccq.xccq012 FROM imaa_t
             WHERE imaaent = g_enterprise
               AND imaa001 = l_xccq.xccq006
            IF cl_null(l_xccq.xccq012) THEN
               LET l_xccq.xccq012  = ' '                  #品类
            END IF
            
            LET l_xccq.xccq101  = l_xcbz101               #上期结存数量
            #170705-00006#1 mark(S)
            #LET l_xccq.xccq102 = (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102       #上期结存金额  
            #LET l_xccq.xccq102b= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102b      #上期结存金额-人工  
            #LET l_xccq.xccq102c= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102c      #上期结存金额-加工  
            #LET l_xccq.xccq102d= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102d      #上期结存金额-制费一
            #LET l_xccq.xccq102e= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102e      #上期结存金额-制费二
            #LET l_xccq.xccq102f= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102f      #上期结存金额-制费三
            #LET l_xccq.xccq102g= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102g      #上期结存金额-制费四
            #LET l_xccq.xccq102h= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102h      #上期结存金额-制费五
            #170705-00006#1 mark(E)
            #170705-00006#1 add(S)
            IF l_xcca.xcca101 <> 0 THEN 
               LET l_xccq.xccq102 = (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102       #上期结存金额  
               LET l_xccq.xccq102b= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102b      #上期结存金额-人工  
               LET l_xccq.xccq102c= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102c      #上期结存金额-加工  
               LET l_xccq.xccq102d= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102d      #上期结存金额-制费一
               LET l_xccq.xccq102e= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102e      #上期结存金额-制费二
               LET l_xccq.xccq102f= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102f      #上期结存金额-制费三
               LET l_xccq.xccq102g= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102g      #上期结存金额-制费四
               LET l_xccq.xccq102h= (l_xccq.xccq101/l_xcca.xcca101)*l_xcca.xcca102h      #上期结存金额-制费五
            ELSE
               LET l_xccq.xccq102 = 0       #上期结存金额  
               LET l_xccq.xccq102b= 0      #上期结存金额-人工  
               LET l_xccq.xccq102c= 0      #上期结存金额-加工  
               LET l_xccq.xccq102d= 0      #上期结存金额-制费一
               LET l_xccq.xccq102e= 0      #上期结存金额-制费二
               LET l_xccq.xccq102f= 0      #上期结存金额-制费三
               LET l_xccq.xccq102g= 0      #上期结存金额-制费四
               LET l_xccq.xccq102h= 0      #上期结存金额-制费五
            END IF
            #170705-00006#1 add(E)            
            LET l_xccq.xccq102a= l_xccq.xccq102 - l_xccq.xccq102b - l_xccq.xccq102c - l_xccq.xccq102d -
                                 l_xccq.xccq102e- l_xccq.xccq102f - l_xccq.xccq102g - l_xccq.xccq102h
            #170705-00006#1 mark(S)                                 
            #LET l_xccq.xccq280  = l_xccq.xccq102  / l_xccq.xccq101      #單位成本
            #LET l_xccq.xccq280b = l_xccq.xccq102b / l_xccq.xccq101      #單位成本-人工
            #LET l_xccq.xccq280c = l_xccq.xccq102c / l_xccq.xccq101      #單位成本-加工
            #LET l_xccq.xccq280d = l_xccq.xccq102d / l_xccq.xccq101      #單位成本-製費一
            #LET l_xccq.xccq280e = l_xccq.xccq102e / l_xccq.xccq101      #單位成本-製費二
            #LET l_xccq.xccq280f = l_xccq.xccq102f / l_xccq.xccq101      #單位成本-製費三
            #LET l_xccq.xccq280g = l_xccq.xccq102g / l_xccq.xccq101      #單位成本-製費四
            #LET l_xccq.xccq280h = l_xccq.xccq102h / l_xccq.xccq101      #單位成本-製費五
            #170705-00006#1 mark(E)
            #170705-00006#1 add(S)
            IF l_xccq.xccq101 <> 0 THEN
               LET l_xccq.xccq280  = l_xccq.xccq102  / l_xccq.xccq101      #單位成本
               LET l_xccq.xccq280b = l_xccq.xccq102b / l_xccq.xccq101      #單位成本-人工
               LET l_xccq.xccq280c = l_xccq.xccq102c / l_xccq.xccq101      #單位成本-加工
               LET l_xccq.xccq280d = l_xccq.xccq102d / l_xccq.xccq101      #單位成本-製費一
               LET l_xccq.xccq280e = l_xccq.xccq102e / l_xccq.xccq101      #單位成本-製費二
               LET l_xccq.xccq280f = l_xccq.xccq102f / l_xccq.xccq101      #單位成本-製費三
               LET l_xccq.xccq280g = l_xccq.xccq102g / l_xccq.xccq101      #單位成本-製費四
               LET l_xccq.xccq280h = l_xccq.xccq102h / l_xccq.xccq101      #單位成本-製費五
            ELSE
               LET l_xccq.xccq280  = 0      #單位成本
               LET l_xccq.xccq280b = 0      #單位成本-人工
               LET l_xccq.xccq280c = 0      #單位成本-加工
               LET l_xccq.xccq280d = 0      #單位成本-製費一
               LET l_xccq.xccq280e = 0      #單位成本-製費二
               LET l_xccq.xccq280f = 0      #單位成本-製費三
               LET l_xccq.xccq280g = 0      #單位成本-製費四
               LET l_xccq.xccq280h = 0      #單位成本-製費五
            END IF
            #170705-00006#1 add(E)
            LET l_xccq.xccq280a = l_xccq.xccq280 - l_xccq.xccq280b - l_xccq.xccq280c - l_xccq.xccq280d -
                                  l_xccq.xccq280e- l_xccq.xccq280f - l_xccq.xccq280g - l_xccq.xccq280h      
            
            LET l_xccq.xccq901  = l_xccq.xccq101          #期末结存数量
            LET l_xccq.xccq902  = l_xccq.xccq102          #期末结存金额
            LET l_xccq.xccq902a = l_xccq.xccq102a         #期末结存金额-材料
            LET l_xccq.xccq902b = l_xccq.xccq102b         #期末结存金额-人工
            LET l_xccq.xccq902c = l_xccq.xccq102c         #期末结存金额-加工
            LET l_xccq.xccq902d = l_xccq.xccq102d         #期末结存金额-制费一
            LET l_xccq.xccq902e = l_xccq.xccq102e         #期末结存金额-制费二
            LET l_xccq.xccq902f = l_xccq.xccq102f         #期末结存金额-制费三
            LET l_xccq.xccq902g = l_xccq.xccq102g         #期末结存金额-制费四
            LET l_xccq.xccq902h = l_xccq.xccq102h         #期末结存金额-制费五      
            
            LET l_xccq.xccqtime = cl_get_current()        #最近成本计算时间
            
            CALL s_axcp500_ins_or_upd_xccq(l_xccq.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF
         END FOREACH
         #add zhangllc 151215 --end
      END IF 　#add zhangllc 160526 SBS1
   END FOREACH


   #在制主件成本期异动统计档
   FOREACH s_axcp500_get_previous_balance_xccd_cs1 USING p_seq INTO l_last_xccd.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccd_cs1'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success         
      END IF 
      #月加权时,整批在制时,做在制上期的结转
      IF g_cost_type NOT MATCHES '[35]' THEN   
         CALL s_axcp500_init_xccd0()
              RETURNING l_xccd.*
         LET l_xccd.xccdent  = g_enterprise                 #企业编号
         LET l_xccd.xccdcomp = l_last_xccd.xccdcomp         #法人组织
         LET l_xccd.xccdld   = l_last_xccd.xccdld           #账套
         LET l_xccd.xccd001  = l_last_xccd.xccd001          #账套本位币顺序
         LET l_xccd.xccd002  = l_last_xccd.xccd002          #成本域
         LET l_xccd.xccd003  = l_last_xccd.xccd003          #成本计算类型
         LET l_xccd.xccd004  = g_yy                         #年度
         LET l_xccd.xccd005  = g_pp                         #期别
         LET l_xccd.xccd006  = l_last_xccd.xccd006          #工單編號
         LET l_xccd.xccd007  = l_last_xccd.xccd007          #主件料號
         LET l_xccd.xccd008  = l_last_xccd.xccd008          #特性
         LET l_xccd.xccd009  = l_last_xccd.xccd009          #批號
         LET l_xccd.xccd010  = l_last_xccd.xccd010          #項目號
         LET l_xccd.xccd011  = l_last_xccd.xccd011          #核算幣別
         LET l_xccd.xccd012  = l_last_xccd.xccd012          #重複性成產否
         LET l_xccd.xccd013  = l_last_xccd.xccd013          #成產計劃號
         LET l_xccd.xccd014  = l_last_xccd.xccd014          #BOM特性
   
         LET l_xccd.xccd101  = l_last_xccd.xccd901          #上期结存数量
         LET l_xccd.xccd102  = l_last_xccd.xccd902          #上期结存金额
         LET l_xccd.xccd102a = l_last_xccd.xccd902a         #上期结存金额-材料
         LET l_xccd.xccd102b = l_last_xccd.xccd902b         #上期结存金额-人工
         LET l_xccd.xccd102c = l_last_xccd.xccd902c         #上期结存金额-加工
         LET l_xccd.xccd102d = l_last_xccd.xccd902d         #上期结存金额-制费一
         LET l_xccd.xccd102e = l_last_xccd.xccd902e         #上期结存金额-制费二
         LET l_xccd.xccd102f = l_last_xccd.xccd902f         #上期结存金额-制费三
         LET l_xccd.xccd102g = l_last_xccd.xccd902g         #上期结存金额-制费四
         LET l_xccd.xccd102h = l_last_xccd.xccd902h         #上期结存金额-制费五       
         
         LET l_xccd.xccd901  = l_xccd.xccd101               #期末结存数量
         LET l_xccd.xccd902  = l_xccd.xccd102               #期末结存金额
         LET l_xccd.xccd902a = l_xccd.xccd102a              #期末结存金额-材料
         LET l_xccd.xccd902b = l_xccd.xccd102b              #期末结存金额-人工
         LET l_xccd.xccd902c = l_xccd.xccd102c              #期末结存金额-加工
         LET l_xccd.xccd902d = l_xccd.xccd102d              #期末结存金额-制费一
         LET l_xccd.xccd902e = l_xccd.xccd102e              #期末结存金额-制费二
         LET l_xccd.xccd902f = l_xccd.xccd102f              #期末结存金额-制费三
         LET l_xccd.xccd902g = l_xccd.xccd102g              #期末结存金额-制费四
         LET l_xccd.xccd902h = l_xccd.xccd102h              #期末结存金额-制费五      
      
         LET l_xccd.xccdtime = cl_get_current()             #最近成本计算时间
         
         CALL s_axcp500_ins_or_upd_xccd(l_xccd.*)
              RETURNING l_success
         IF NOT l_success THEN
            RETURN r_success
         END IF
   
         #在制组件成本期异动统计档
         FOREACH s_axcp500_get_previous_balance_xcce_cs1 USING p_seq,l_xccd.xccd006 INTO l_last_xcce.*
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xcce_cs1'
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN r_success         
            END IF   
            CALL s_axcp500_init_xcce0()
                 RETURNING l_xcce.*
            LET l_xcce.xcceent  = g_enterprise                 #企业编号
            LET l_xcce.xccecomp = l_last_xcce.xccecomp         #法人组织
            LET l_xcce.xcceld   = l_last_xcce.xcceld           #账套
            LET l_xcce.xcce001  = l_last_xcce.xcce001          #账套本位币顺序
            LET l_xcce.xcce002  = l_last_xcce.xcce002          #成本域
            LET l_xcce.xcce003  = l_last_xcce.xcce003          #成本计算类型
            LET l_xcce.xcce004  = g_yy                         #年度
            LET l_xcce.xcce005  = g_pp                         #期别
            LET l_xcce.xcce006  = l_last_xcce.xcce006          #工單編號
            LET l_xcce.xcce007  = l_last_xcce.xcce007          #元件編號
            LET l_xcce.xcce008  = l_last_xcce.xcce008          #特性
            LET l_xcce.xcce009  = l_last_xcce.xcce009          #批號
            LET l_xcce.xcce010  = l_last_xcce.xcce010          #核算幣別   
      
            LET l_xcce.xcce101  = l_last_xcce.xcce901          #上期结存数量
            LET l_xcce.xcce102  = l_last_xcce.xcce902          #上期结存金额
            LET l_xcce.xcce102a = l_last_xcce.xcce902a         #上期结存金额-材料
            LET l_xcce.xcce102b = l_last_xcce.xcce902b         #上期结存金额-人工
            LET l_xcce.xcce102c = l_last_xcce.xcce902c         #上期结存金额-加工
            LET l_xcce.xcce102d = l_last_xcce.xcce902d         #上期结存金额-制费一
            LET l_xcce.xcce102e = l_last_xcce.xcce902e         #上期结存金额-制费二
            LET l_xcce.xcce102f = l_last_xcce.xcce902f         #上期结存金额-制费三
            LET l_xcce.xcce102g = l_last_xcce.xcce902g         #上期结存金额-制费四
            LET l_xcce.xcce102h = l_last_xcce.xcce902h         #上期结存金额-制费五       
            
            LET l_xcce.xcce901  = l_xcce.xcce101               #期末结存数量
            LET l_xcce.xcce902  = l_xcce.xcce102               #期末结存金额
            LET l_xcce.xcce902a = l_xcce.xcce102a              #期末结存金额-材料
            LET l_xcce.xcce902b = l_xcce.xcce102b              #期末结存金额-人工
            LET l_xcce.xcce902c = l_xcce.xcce102c              #期末结存金额-加工
            LET l_xcce.xcce902d = l_xcce.xcce102d              #期末结存金额-制费一
            LET l_xcce.xcce902e = l_xcce.xcce102e              #期末结存金额-制费二
            LET l_xcce.xcce902f = l_xcce.xcce102f              #期末结存金额-制费三
            LET l_xcce.xcce902g = l_xcce.xcce102g              #期末结存金额-制费四
            LET l_xcce.xcce902h = l_xcce.xcce102h              #期末结存金额-制费五      
         
            LET l_xcce.xccetime = cl_get_current()             #最近成本计算时间
            
            CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF
         END FOREACH
   
         #在制组件成本期异动统计档
         FOREACH s_axcp500_get_previous_balance_xccb_cs1 USING p_seq,l_xccd.xccd006 INTO l_xccb.*
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccb_cs1'
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN r_success         
            END IF   
            CALL s_axcp500_init_xcce0()
                 RETURNING l_xcce.*
            LET l_xcce.xcceent  = g_enterprise                 #企业编号
            LET l_xcce.xccecomp = l_xccb.xccbcomp              #法人组织
            LET l_xcce.xcceld   = l_xccb.xccbld                #账套
            LET l_xcce.xcce001  = l_xccb.xccb001               #账套本位币顺序
            LET l_xcce.xcce002  = l_xccb.xccb002               #成本域
            LET l_xcce.xcce003  = l_xccb.xccb003               #成本计算类型
            LET l_xcce.xcce004  = g_yy                         #年度
            LET l_xcce.xcce005  = g_pp                         #期别
            LET l_xcce.xcce006  = l_xccb.xccb006               #工單編號
            LET l_xcce.xcce007  = l_xccb.xccb007               #元件編號
            LET l_xcce.xcce008  = l_xccb.xccb008               #特性
            LET l_xcce.xcce009  = l_xccb.xccb009               #批號
            LET l_xcce.xcce010  = g_curr[l_xccb.xccb001].curr  #核算幣別   
      
            LET l_xcce.xcce101  = l_xccb.xccb101               #上期结存数量
            LET l_xcce.xcce102  = l_xccb.xccb102               #上期结存金额
            LET l_xcce.xcce102a = l_xccb.xccb102a              #上期结存金额-材料
            LET l_xcce.xcce102b = l_xccb.xccb102b              #上期结存金额-人工
            LET l_xcce.xcce102c = l_xccb.xccb102c              #上期结存金额-加工
            LET l_xcce.xcce102d = l_xccb.xccb102d              #上期结存金额-制费一
            LET l_xcce.xcce102e = l_xccb.xccb102e              #上期结存金额-制费二
            LET l_xcce.xcce102f = l_xccb.xccb102f              #上期结存金额-制费三
            LET l_xcce.xcce102g = l_xccb.xccb102g              #上期结存金额-制费四
            LET l_xcce.xcce102h = l_xccb.xccb102h              #上期结存金额-制费五       
            
            LET l_xcce.xcce901  = l_xcce.xcce101               #期末结存数量
            LET l_xcce.xcce902  = l_xcce.xcce102               #期末结存金额
            LET l_xcce.xcce902a = l_xcce.xcce102a              #期末结存金额-材料
            LET l_xcce.xcce902b = l_xcce.xcce102b              #期末结存金额-人工
            LET l_xcce.xcce902c = l_xcce.xcce102c              #期末结存金额-加工
            LET l_xcce.xcce902d = l_xcce.xcce102d              #期末结存金额-制费一
            LET l_xcce.xcce902e = l_xcce.xcce102e              #期末结存金额-制费二
            LET l_xcce.xcce902f = l_xcce.xcce102f              #期末结存金额-制费三
            LET l_xcce.xcce902g = l_xcce.xcce102g              #期末结存金额-制费四
            LET l_xcce.xcce902h = l_xcce.xcce102h              #期末结存金额-制费五      
         
            LET l_xcce.xccetime = cl_get_current()             #最近成本计算时间
            
            CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF
         END FOREACH
         
         #在制元件发料明细档
         FOREACH s_axcp500_get_previous_balance_xccz_cs1 USING p_seq,l_xccd.xccd006 INTO l_last_xccz.*
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccz_cs1'
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN r_success         
            END IF   
            CALL s_axcp500_init_xccz0()
                 RETURNING l_xccz.*         
            LET l_xccz.xcczent  = g_enterprise                 #企业编号
            LET l_xccz.xcczcomp = l_last_xccz.xcczcomp         #法人组织
            LET l_xccz.xcczld   = l_last_xccz.xcczld           #账套
            LET l_xccz.xccz001  = l_last_xccz.xccz001          #账套本位币顺序
            LET l_xccz.xccz002  = l_last_xccz.xccz002          #成本域
            LET l_xccz.xccz003  = l_last_xccz.xccz003          #成本计算类型
            LET l_xccz.xccz004  = g_yy                         #年度
            LET l_xccz.xccz005  = g_pp                         #期别
            LET l_xccz.xccz006  = l_last_xccz.xccz006          #工單編號
            LET l_xccz.xccz007  = l_last_xccz.xccz007          #元件編號
            LET l_xccz.xccz008  = l_last_xccz.xccz008          #特性
            LET l_xccz.xccz009  = l_last_xccz.xccz009          #批號
            LET l_xccz.xccz010  = l_last_xccz.xccz010          #項次
            LET l_xccz.xccz011  = l_last_xccz.xccz011          #項序
      
            LET l_xccz.xccz101  = l_last_xccz.xccz901          #上期结存数量       
            LET l_xccz.xccz901  = l_xccz.xccz101               #期末结存数量
                 
            CALL s_axcp500_ins_or_upd_xccz(l_xccz.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF
         END FOREACH
   
         #联产品成本期异动统计档
         FOREACH s_axcp500_get_previous_balance_xccg_cs1 USING p_seq,l_xccd.xccd006 INTO l_last_xccg.*
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xccg_cs1'
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN r_success         
            END IF   
            CALL s_axcp500_init_xccg0()
                 RETURNING l_xccg.*
            LET l_xccg.xccgent  = g_enterprise                 #企业编号
            LET l_xccg.xccgcomp = l_last_xccg.xccgcomp         #法人组织
            LET l_xccg.xccgld   = l_last_xccg.xccgld           #账套
            LET l_xccg.xccg001  = l_last_xccg.xccg001          #账套本位币顺序
            LET l_xccg.xccg002  = l_last_xccg.xccg002          #成本域
            LET l_xccg.xccg003  = l_last_xccg.xccg003          #成本计算类型
            LET l_xccg.xccg004  = g_yy                         #年度
            LET l_xccg.xccg005  = g_pp                         #期别
            LET l_xccg.xccg006  = l_last_xccg.xccg006          #工單編號
            LET l_xccg.xccg007  = l_last_xccg.xccg007          #聯產品料號
            LET l_xccg.xccg008  = l_last_xccg.xccg008          #特性
            LET l_xccg.xccg009  = l_last_xccg.xccg009          #批號
            LET l_xccg.xccg010  = l_last_xccg.xccg010          #核算幣別   
      
            LET l_xccg.xccg101  = l_last_xccg.xccg901          #上期结存数量
            LET l_xccg.xccg102  = l_last_xccg.xccg902          #上期结存金额
            LET l_xccg.xccg102a = l_last_xccg.xccg902a         #上期结存金额-材料
            LET l_xccg.xccg102b = l_last_xccg.xccg902b         #上期结存金额-人工
            LET l_xccg.xccg102c = l_last_xccg.xccg902c         #上期结存金额-加工
            LET l_xccg.xccg102d = l_last_xccg.xccg902d         #上期结存金额-制费一
            LET l_xccg.xccg102e = l_last_xccg.xccg902e         #上期结存金额-制费二
            LET l_xccg.xccg102f = l_last_xccg.xccg902f         #上期结存金额-制费三
            LET l_xccg.xccg102g = l_last_xccg.xccg902g         #上期结存金额-制费四
            LET l_xccg.xccg102h = l_last_xccg.xccg902h         #上期结存金额-制费五       
            
            LET l_xccg.xccg901  = l_xccg.xccg101               #期末结存数量
            LET l_xccg.xccg902  = l_xccg.xccg102               #期末结存金额
            LET l_xccg.xccg902a = l_xccg.xccg102a              #期末结存金额-材料
            LET l_xccg.xccg902b = l_xccg.xccg102b              #期末结存金额-人工
            LET l_xccg.xccg902c = l_xccg.xccg102c              #期末结存金额-加工
            LET l_xccg.xccg902d = l_xccg.xccg102d              #期末结存金额-制费一
            LET l_xccg.xccg902e = l_xccg.xccg102e              #期末结存金额-制费二
            LET l_xccg.xccg902f = l_xccg.xccg102f              #期末结存金额-制费三
            LET l_xccg.xccg902g = l_xccg.xccg102g              #期末结存金额-制费四
            LET l_xccg.xccg902h = l_xccg.xccg102h              #期末结存金额-制费五      
         
            LET l_xccg.xccgtime = cl_get_current()             #最近成本计算时间
            
            CALL s_axcp500_ins_or_upd_xccg(l_xccg.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF
         END FOREACH
      END IF
    
   END FOREACH


   #拆件在制主件成本期异动统计档
   FOREACH s_axcp500_get_previous_balance_xcch_cs1 USING p_seq INTO l_last_xcch.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xcch_cs1'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN r_success         
      END IF   
      CALL s_axcp500_init_xcch0()
           RETURNING l_xcch.*
      LET l_xcch.xcchent  = g_enterprise                 #企业编号
      LET l_xcch.xcchcomp = l_last_xcch.xcchcomp         #法人组织
      LET l_xcch.xcchld   = l_last_xcch.xcchld           #账套
      LET l_xcch.xcch001  = l_last_xcch.xcch001          #账套本位币顺序
      LET l_xcch.xcch002  = l_last_xcch.xcch002          #成本域
      LET l_xcch.xcch003  = l_last_xcch.xcch003          #成本计算类型
      LET l_xcch.xcch004  = g_yy                         #年度
      LET l_xcch.xcch005  = g_pp                         #期别
      LET l_xcch.xcch006  = l_last_xcch.xcch006          #拆件工單編號
      LET l_xcch.xcch007  = l_last_xcch.xcch007          #主件料號
      LET l_xcch.xcch008  = l_last_xcch.xcch008          #特性
      LET l_xcch.xcch009  = l_last_xcch.xcch009          #批號
      LET l_xcch.xcch010  = l_last_xcch.xcch010          #項目號
      LET l_xcch.xcch011  = l_last_xcch.xcch011          #核算幣別

      LET l_xcch.xcch101  = l_last_xcch.xcch901          #上期结存数量
      LET l_xcch.xcch102  = l_last_xcch.xcch902          #上期结存金额
      LET l_xcch.xcch102a = l_last_xcch.xcch902a         #上期结存金额-材料
      LET l_xcch.xcch102b = l_last_xcch.xcch902b         #上期结存金额-人工
      LET l_xcch.xcch102c = l_last_xcch.xcch902c         #上期结存金额-加工
      LET l_xcch.xcch102d = l_last_xcch.xcch902d         #上期结存金额-制费一
      LET l_xcch.xcch102e = l_last_xcch.xcch902e         #上期结存金额-制费二
      LET l_xcch.xcch102f = l_last_xcch.xcch902f         #上期结存金额-制费三
      LET l_xcch.xcch102g = l_last_xcch.xcch902g         #上期结存金额-制费四
      LET l_xcch.xcch102h = l_last_xcch.xcch902h         #上期结存金额-制费五       
      
      LET l_xcch.xcch901  = l_xcch.xcch101               #期末结存数量
      LET l_xcch.xcch902  = l_xcch.xcch102               #期末结存金额
      LET l_xcch.xcch902a = l_xcch.xcch102a              #期末结存金额-材料
      LET l_xcch.xcch902b = l_xcch.xcch102b              #期末结存金额-人工
      LET l_xcch.xcch902c = l_xcch.xcch102c              #期末结存金额-加工
      LET l_xcch.xcch902d = l_xcch.xcch102d              #期末结存金额-制费一
      LET l_xcch.xcch902e = l_xcch.xcch102e              #期末结存金额-制费二
      LET l_xcch.xcch902f = l_xcch.xcch102f              #期末结存金额-制费三
      LET l_xcch.xcch902g = l_xcch.xcch102g              #期末结存金额-制费四
      LET l_xcch.xcch902h = l_xcch.xcch102h              #期末结存金额-制费五      
   
      LET l_xcch.xcchtime = cl_get_current()             #最近成本计算时间
      
      CALL s_axcp500_ins_or_upd_xcch(l_xcch.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF

      #拆件在制组件成本期异动统计档
      FOREACH s_axcp500_get_previous_balance_xcci_cs1 USING p_seq,l_xcch.xcch006 INTO l_last_xcci.*
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = 'FOREACH s_axcp500_get_previous_balance_xcci_cs1'
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN r_success         
         END IF   
         CALL s_axcp500_init_xcci0()
              RETURNING l_xcci.*
         LET l_xcci.xccient  = g_enterprise                 #企业编号
         LET l_xcci.xccicomp = l_last_xcci.xccicomp         #法人组织
         LET l_xcci.xccild   = l_last_xcci.xccild           #账套
         LET l_xcci.xcci001  = l_last_xcci.xcci001          #账套本位币顺序
         LET l_xcci.xcci002  = l_last_xcci.xcci002          #成本域
         LET l_xcci.xcci003  = l_last_xcci.xcci003          #成本计算类型
         LET l_xcci.xcci004  = g_yy                         #年度
         LET l_xcci.xcci005  = g_pp                         #期别
         LET l_xcci.xcci006  = l_last_xcci.xcci006          #拆件工單編號
         LET l_xcci.xcci007  = l_last_xcci.xcci007          #元件編號
         LET l_xcci.xcci008  = l_last_xcci.xcci008          #特性
         LET l_xcci.xcci009  = l_last_xcci.xcci009          #批號
         LET l_xcci.xcci010  = l_last_xcci.xcci010          #核算幣別   
   
         LET l_xcci.xcci101  = l_last_xcci.xcci901          #上期结存数量
         LET l_xcci.xcci102  = l_last_xcci.xcci902          #上期结存金额
         LET l_xcci.xcci102a = l_last_xcci.xcci902a         #上期结存金额-材料
         LET l_xcci.xcci102b = l_last_xcci.xcci902b         #上期结存金额-人工
         LET l_xcci.xcci102c = l_last_xcci.xcci902c         #上期结存金额-加工
         LET l_xcci.xcci102d = l_last_xcci.xcci902d         #上期结存金额-制费一
         LET l_xcci.xcci102e = l_last_xcci.xcci902e         #上期结存金额-制费二
         LET l_xcci.xcci102f = l_last_xcci.xcci902f         #上期结存金额-制费三
         LET l_xcci.xcci102g = l_last_xcci.xcci902g         #上期结存金额-制费四
         LET l_xcci.xcci102h = l_last_xcci.xcci902h         #上期结存金额-制费五       
         
         LET l_xcci.xcci901  = l_xcci.xcci101               #期末结存数量
         LET l_xcci.xcci902  = l_xcci.xcci102               #期末结存金额
         LET l_xcci.xcci902a = l_xcci.xcci102a              #期末结存金额-材料
         LET l_xcci.xcci902b = l_xcci.xcci102b              #期末结存金额-人工
         LET l_xcci.xcci902c = l_xcci.xcci102c              #期末结存金额-加工
         LET l_xcci.xcci902d = l_xcci.xcci102d              #期末结存金额-制费一
         LET l_xcci.xcci902e = l_xcci.xcci102e              #期末结存金额-制费二
         LET l_xcci.xcci902f = l_xcci.xcci102f              #期末结存金额-制费三
         LET l_xcci.xcci902g = l_xcci.xcci102g              #期末结存金额-制费四
         LET l_xcci.xcci902h = l_xcci.xcci102h              #期末结存金额-制费五      
      
         LET l_xcci.xccitime = cl_get_current()             #最近成本计算时间
         
         CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
              RETURNING l_success
         IF NOT l_success THEN
            RETURN r_success
         END IF
      END FOREACH

      
   END FOREACH


   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 建立临时表
# Memo...........:
# Usage..........: CALL s_axcp500_create_temp_table()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-23 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_create_temp_table()
   DEFINE r_success       LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   #检查事务中
   IF NOT s_transaction_chk('N',1) THEN
      RETURN r_success
   END IF
   
   #170601-00051#1 add start -----

   DROP TABLE xrcb_tmp; #ODI-ORA#


   CREATE TEMP TABLE xrcb_tmp(
   xrcbent     LIKE xrcb_t.xrcbent,
   xrcbld      LIKE xrcb_t.xrcbld,
   xrcb002     LIKE xrcb_t.xrcb002,
   xrcb003     LIKE xrcb_t.xrcb003,
   xrcb113     LIKE xrcb_t.xrcb113,
   xrcb022     LIKE xrcb_t.xrcb022
   ) ;

   #170601-00051#1 add end   -----   



#201012-00066#1 add  ---s
#201012-00066#1 add  ---e

   CREATE INDEX tt_xrcb_tmp_n1 ON xrcb_tmp(xrcbent,xrcbld,xrcb002,xrcb003);  #181116-00032#1 add #ODI-ORA#
   

   DROP TABLE s_axcp500_tmp; #ODI-ORA#

   DROP TABLE s_axcp500_tmp0; #ODI-ORA#


   CREATE TEMP TABLE s_axcp500_tmp(
   imaa001     LIKE imaa_t.imaa001,    #料件
   xccc007     LIKE xccc_t.xccc007,    #产品特征
   xcbb006     LIKE xcbb_t.xcbb006,    #成本阶
   imac003     LIKE imac_t.imac003,    #低阶码
   imaa004     LIKE imaa_t.imaa004,    #料件类别
   imaa011     LIKE imaa_t.imaa011,    #联产品否
   imae013     LIKE imae_t.imae013,    #重复性生产否
   xccc002     LIKE xccc_t.xccc002,    #成本域
   xccc008     LIKE xccc_t.xccc008,    #批次
   xccc003     LIKE xccc_t.xccc003,    #成本计算方式
   imag014     LIKE imag_t.imag014,    #成本单位
   imaa006     LIKE imaa_t.imaa006     #基础单位
   ) ;

   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create s_axcp500_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
   END IF


   CREATE INDEX tt_s_axcp500_tmp_n1 ON s_axcp500_tmp(imaa001);         #161114-00003#1 add #ODI-ORA#

   CREATE INDEX tt_s_axcp500_tmp_n2 ON s_axcp500_tmp(xcbb006,imaa001); #161114-00003#1 add #ODI-ORA#
   
   LET r_success = TRUE
   RETURN r_success

   
END FUNCTION

################################################################################
# Descriptions...: 成本计算的资料插入临时表
# Memo...........:
# Usage..........: CALL s_axcp500_ins_temp_table()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-23 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_temp_table()
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_success      LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE

   CASE 
        WHEN g_cost_type MATCHES '[1245]'
        WHEN g_cost_type = '3'  #批次
   END CASE
   
   IF g_cost_type MATCHES '[135]' THEN   #标准成本 & 月加权 & 批次
      MESSAGE "ins_temp_table:s_axcp500_tmp0"  
      #会使用到xcbb（成本阶） 
      #来源1：inaj异动资料
      
#      CASE g_field_type   #启用成本域
#              WHEN '1'  #组织
#                   #                           料件    产品特征        成本阶  低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,xcbb006,imac003,imaa004,imaa011,' ' imae013,xcbf001  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,xcbb_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                                   AND inaj005 = imaa001 ",
#                               "                                                   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
#                               "                             LEFT OUTER JOIN xcbf_t ON xcbfent  = inajent ",
#                               "                                                   AND xcbfcomp = '",g_comp,"'",
#                               "                                                   AND xcbf002  = inajsite "
#              WHEN '2'  #仓库
#                   #                           料件    产品特征        成本阶  低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,xcbb006,imac003,imaa004,imaa011,' ' imae013,xcbf001  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,xcbb_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                                   AND inaj005 = imaa001 ",
#                               "                                                   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
#                               "                             LEFT OUTER JOIN xcbf_t ON xcbfent  = inajent ",
#                               "                                                   AND xcbfcomp = '",g_comp,"'",
#                               "                                                   AND xcbf002  = inaj008  "
#              WHEN '3'  #库存管理特征
#                   #                           料件    产品特征        成本阶  低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj007  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,xcbb_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                                   AND inaj005 = imaa001 ",
#                               "                                                   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'"
#              OTHERWISE
#                   #                           料件    产品特征        成本阶  低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,xcbb006,imac003,imaa004,imaa011,' ' imae013,' '      xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,xcbb_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                                   AND inaj005 = imaa001 ",
#                               "                                                   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'"
#      END CASE
      #mod 150730 zhangllc --begin 料件不同产品特征，成本阶可能不一样,此处先不获取成本阶，后面update进来（这样修改后，其实跟先进先出 OR 移动加权 一样了，可以考虑取消这段了）
      #             #              料件    产品特征          成本阶  低阶码  料件类型 联产品否 重复性否    成本域           批次            计算方式   
      #LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,imag014,imaa006 ",
      #            "   FROM imac_t,xcbb_t,imag_t,imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
      #            "                                                            AND inaj005 = imaa001 ",
      #            "                                                            AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'", 
      #            "  WHERE imaaent = imacent AND imaaent = xcbbent ",
      #            "    AND imaaent = ",g_enterprise,
      #            "    AND imaa001 = imac001 AND imaa001 = xcbb003 ",
      #            "    AND xcbbcomp = '",g_comp,"'",
      #            "    AND xcbb001  = ",g_yy,
      #            "    AND xcbb002  = ",g_pp,
      #            "    AND imagent  = imaaent ",
      #            "    AND imagsite = '",g_comp,"'",
      #            "    AND imag001  = imaa001 ",
      #            "    AND ",g_wc,
      #            "    INTO TEMP s_axcp500_tmp0"

      #mod zhangllc 160528--s SBS3 提升效能 imag014已经不启用
      #             #              料件    产品特征          成本阶  低阶码  料件类型 联产品否 重复性否    成本域           批次            计算方式   
      #LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel
      #            "   FROM imac_t,imag_t,imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
      #            "                                                     AND inaj005 = imaa001 ",
      #            "                                                     AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'", 
      #            "  WHERE imaaent = imacent  ",
      #            "    AND imaaent = ",g_enterprise,
      #            "    AND imaa001 = imac001  ",
      #            "    AND imagent  = imaaent ",
      #            "    AND imagsite = '",g_comp,"'",
      #            "    AND imag001  = imaa001 ",
      #            "    AND ",g_wc,
      #            "    INTO TEMP s_axcp500_tmp0"
     #161212-00077#1-s-mark
     #LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel
     #            "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
     #            "                                        AND inaj005 = imaa001 ",
     #            "                                        AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'", 
     #            "  WHERE imaaent = imacent  ",
     #            "    AND imaaent = ",g_enterprise,
     #            "    AND imaa001 = imac001  ",
     #            "    AND ",g_wc,
     #            "    INTO TEMP s_axcp500_tmp0"     
     #161212-00077#1-e-mark    
     #161212-00077#1-s-add
#      LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,'',imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel #161220-00048#1 mark
       LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,0 imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ",   #161220-00048#1 add
                  "   FROM imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",          
                  "                                   AND inaj005 = imaa001 ",
                  "                                   AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'", 
                  "  WHERE imaaent = ",g_enterprise,
                  "    AND ",g_wc,
                  "    INTO TEMP dele"
      #161212-00077#1-e-add             
      #mod zhangllc 160528--e SBS3 提升效能
      #mod 150730 zhangllc --end 料件不同产品特征，成本阶可能不一样
#      IF g_cost_type <> '3' THEN #非批次成本
#         LET g_sql = cl_str_replace_multistr(g_sql,"inaj010 xccc008","' ' xccc008")
#      END IF
#      IF g_sys_6013 = 'N' THEN
#         LET g_sql = cl_str_replace_multistr(g_sql,"inaj006","' ' ")
#      END IF
   END IF

   IF g_cost_type = '2' OR g_cost_type = '4' THEN   #先进先出 OR 移动加权
      MESSAGE "ins_temp_table:s_axcp500_tmp0" 
#      CASE g_field_type   #启用成本域
#              WHEN '1'  #组织
#                   #                           料件    产品特征        成本阶    低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,xcbf001  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                             AND inaj005 = imaa001 ",
#                               "                                             AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
#                               "                      LEFT OUTER JOIN xcbf_t ON xcbfent  = inajent ",
#                               "                                             AND xcbfcomp = '",g_comp,"'",
#                               "                                             AND xcbf002  = inajsite "
#              WHEN '2'  #仓库
#                   #                           料件    产品特征        成本阶    低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,xcbf001  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                            AND inaj005 = imaa001 ",
#                               "                                            AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
#                               "                      LEFT OUTER JOIN xcbf_t ON xcbfent  = inajent ",
#                               "                                            AND xcbfcomp = '",g_comp,"'",
#                               "                                            AND xcbf002  = inaj008  "
#              WHEN '3'  #库存管理特征
#                   #                           料件    产品特征        成本阶    低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj007  xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                             AND inaj005 = imaa001 ",
#                               "                                             AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'"
#              OTHERWISE
#                   #                           料件    产品特征        成本阶    低阶码  料件类型 联产品否 重复性否  成本域           批次            计算方式
#                   LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,' '      xccc002,inaj010 xccc008,' ' xccc003 ",
#                               "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_t ON inajent = imaaent ",
#                               "                                             AND inaj005 = imaa001 ",
#                               "                                             AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'"
#      END CASE
    
      #                           料件    产品特征        成本阶     低阶码  料件类型 联产品否 重复性否     成本域           批次            计算方式
      #mod zhangllc 160528--s SBS3 提升效能 imag014已经不启用
      #LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel
      #            "   FROM imac_t,imag_t,imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
      #            "                                                     AND inaj005 = imaa001 ",
      #            "                                                     AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
      #            "  WHERE imaaent = imacent ",
      #            "    AND imaaent = ",g_enterprise,
      #            "    AND imaa001 = imac001 ",
      #            "    AND imagent  = imaaent ",
      #            "    AND imagsite = '",g_comp,"'",
      #            "    AND imag001  = imaa001 ",
      #            "    AND ",g_wc,
      #            "    INTO TEMP s_axcp500_tmp0"
     #161212-00077#1-s-mark 
     #LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel
     #            "   FROM imac_t,imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
     #            "                                              AND inaj005 = imaa001 ",
     #            "                                              AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
     #            "  WHERE imaaent = imacent ",
     #            "    AND imaaent = ",g_enterprise,
     #            "    AND imaa001 = imac001 ",
     #            "    AND ",g_wc,
     #            "    INTO TEMP s_axcp500_tmp0"
     #161212-00077#1-e-mark 
     #161212-00077#1-s-add 
#      LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,'',imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ",  #mod zhangllc 151109 add islevel  #161220-00048#1 mark
      LET g_sql = " SELECT UNIQUE imaa001,inaj006 xccc007,0 xcbb006,0 imac003,imaa004,imaa011,' ' imae013,inaj999 xccc002,inaj010 xccc008,' ' xccc003,' ' imag014,imaa006,'N' islevel ", #161220-00048#1 add
                  "   FROM imaa_t LEFT OUTER JOIN inaj_tmp ON inajent = imaaent ",
                  "                                              AND inaj005 = imaa001 ",
                  "                                              AND inaj022 BETWEEN '",g_bdate,"' AND '",g_edate,"'",
                  "  WHERE imaaent = ",g_enterprise,
                  "    AND ",g_wc,
                  "    INTO TEMP s_axcp500_tmp0"
     #161212-00077#1-e-add      
      #mod zhangllc 160528--e
#      IF g_cost_type <> '3' THEN #非批次成本
#         LET g_sql = cl_str_replace_multistr(g_sql,"inaj010 xccc008","' ' xccc008")
#      END IF
#      
#      IF g_sys_6013 = 'N' THEN
#         LET g_sql = cl_str_replace_multistr(g_sql,"inaj006","' ' ")
#      END IF
   END IF
   
   #执行sql的插入临时表异动
   CALL s_axcp500_ins_temp_table_execute(g_sql)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF

   MESSAGE "ins_temp_table:deal s_axcp500_tmp0"  
   #特征字段,若为NULL时,UPDATE为' '
   UPDATE s_axcp500_tmp0 SET xccc007 = ' ' WHERE xccc007 IS NULL
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE s_axcp500_tmp0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   #add zhangllc 150730--begin
   #根据料件+特征从xcbb中更新成本阶
   IF g_cost_type MATCHES '[135]' THEN   #标准成本 & 月加权 & 批次
      #170109-00008#1---s
      #LET g_sql = " MERGE INTO s_axcp500_tmp0 a",
      #            "       USING xcbb_t b ",
      #            "          ON ( b.xcbbent = ",g_enterprise,
      #            "         AND   b.xcbbcomp = '",g_comp,"'",
      #            "         AND   b.xcbb001  = ",g_yy,
      #            "         AND   b.xcbb002  = ",g_pp,
      #            "         AND   a.imaa001  = b.xcbb003  )",   #170109-00008#1 mod ")"
      #           #"         AND   a.xccc007  = b.xcbb004  )",   #170109-00008#1 mark
      #            "  WHEN MATCHED THEN    ",
      #            "     UPDATE SET a.xcbb006  = b.xcbb006,   ",
      #            "                a.islevel  = 'Y' "   #add zhanglc 151109
      #PGS(D)-00824 ---start---
      LET g_sql = " MERGE INTO s_axcp500_tmp0 a",
                  "       USING (SELECT DISTINCT xcbb003,xcbb006 FROM xcbb_t ",
                  "                 WHERE xcbbent = ",g_enterprise,
                  "                   AND xcbbcomp = '",g_comp,"'",
                  "                   AND xcbb001  = ",g_yy,
                  "                   AND xcbb002  = ",g_pp,
                  "               ) b ",
                  "          ON ( a.imaa001  = b.xcbb003  )",  
                  "  WHEN MATCHED THEN    ",
                  "     UPDATE SET a.xcbb006  = b.xcbb006,   ",
                  "                a.islevel  = 'Y' "   #add zhanglc 151109
      #PGS(D)-00824 --- end ---
      #170109-00008#1----e                  
      PREPARE s_axcp500_upd_temp_table_execute_p1 FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      EXECUTE s_axcp500_upd_temp_table_execute_p1
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      FREE s_axcp500_upd_temp_table_execute_p1 
      #add zhangllc 151109 begin
      #如果料件+特征的成本阶获取不到，就获取料件的成本阶
      #170109-00008#1----s
      #LET g_sql = " MERGE INTO s_axcp500_tmp0 a",
      #            "       USING xcbb_t b ",
      #            "          ON ( b.xcbbent = ",g_enterprise,
      #            "         AND   b.xcbbcomp = '",g_comp,"'",
      #            "         AND   b.xcbb001  = ",g_yy,
      #            "         AND   b.xcbb002  = ",g_pp,
      #            "         AND   a.imaa001  = b.xcbb003 )",   #170109-00008#1 mod ")"
      #           #"         AND   b.xcbb004  = ' '  )",        #特性为空格 #170109-00008#1 add 
      #            "  WHEN MATCHED THEN    ",
      #            "     UPDATE SET a.xcbb006  = b.xcbb006,   ",
      #            "                a.islevel  = 'Y' ",
      #            "      WHERE a.islevel = 'N' "  #更新未获取到的，不能用xcbb006=0因为可能有特征的设置过是0的，会又被盖掉              
      #PGS(D)-00824 ---start---
      LET g_sql = " MERGE INTO s_axcp500_tmp0 a",
                  "       USING (SELECT DISTINCT xcbb003,xcbb006 FROM xcbb_t ",
                  "                 WHERE xcbbent = ",g_enterprise,
                  "                   AND xcbbcomp = '",g_comp,"'",
                  "                   AND xcbb001  = ",g_yy,
                  "                   AND xcbb002  = ",g_pp,
                  "               ) b ",
                  "          ON ( a.imaa001  = b.xcbb003  )",  
                  "  WHEN MATCHED THEN    ",
                  "     UPDATE SET a.xcbb006  = b.xcbb006,   ",
                  "                a.islevel  = 'Y' " ,  
                  "      WHERE a.islevel = 'N' "  #更新未获取到的，不能用xcbb006=0因为可能有特征的设置过是0的，会又被盖掉
      #PGS(D)-00824 --- end ---
      #170109-00008#1----e      
      PREPARE s_axcp500_upd_temp_table_execute_p11 FROM g_sql
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p11"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      EXECUTE s_axcp500_upd_temp_table_execute_p11
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p11"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
      FREE s_axcp500_upd_temp_table_execute_p11
      #add zhangllc 151109 end
   END IF
   MESSAGE "ins_temp_table:deal sfac_tmp:level"  
   #更新sfac_tmp的成本阶
   #170109-00008#1----s
   #LET g_sql = " MERGE INTO sfac_tmp",
   #            "       USING xcbb_t b ",
   #            "          ON ( b.xcbbent = ",g_enterprise,
   #            "         AND   b.xcbbcomp = '",g_comp,"'",
   #            "         AND   b.xcbb001  = ",g_yy,
   #            "         AND   b.xcbb002  = ",g_pp,
   #            "         AND   b.xcbb003  = sfac001 )",    #170109-00008#1 mod ")"
   #           #"         AND   b.xcbb004  = sfac006 )",    #170109-00008#1 mark
   #            "  WHEN MATCHED THEN    ",
   #            "     UPDATE SET clevel  = b.xcbb006,  ",
   #               "             islevel = 'Y' "   #add zhanglc 151109
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO sfac_tmp ",
               "       USING (SELECT DISTINCT xcbb003,xcbb006 FROM xcbb_t ",
               "                 WHERE xcbbent = ",g_enterprise,
               "                   AND xcbbcomp = '",g_comp,"'",
               "                   AND xcbb001  = ",g_yy,
               "                   AND xcbb002  = ",g_pp,
               "               ) b ",
               "          ON ( sfac001  = b.xcbb003 ) ",                   
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET clevel  = b.xcbb006,  ",
               "                islevel  = 'Y' "   #add zhanglc 151109
   #PGS(D)-00824 --- end ---
   #170109-00008#1----e   
   PREPARE s_axcp500_upd_temp_table_execute_p2 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_upd_temp_table_execute_p2
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_upd_temp_table_execute_p2 
   #add zhangllc 151109 begin
   #如果料件+特征的成本阶获取不到，就获取料件的成本阶
    #170109-00008#1----s
   #LET g_sql = " MERGE INTO sfac_tmp",
   #            "       USING xcbb_t b ",
   #            "          ON ( b.xcbbent = ",g_enterprise,
   #            "         AND   b.xcbbcomp = '",g_comp,"'",
   #            "         AND   b.xcbb001  = ",g_yy,
   #            "         AND   b.xcbb002  = ",g_pp,
   #            "         AND   b.xcbb003  = sfac001 )",  #170109-00008#1 mod ")"
   #           #"         AND   b.xcbb004  = ' '  )",     #特性为空格 #170109-00008#1 mark
   #            "  WHEN MATCHED THEN    ",
   #            "     UPDATE SET clevel  = b.xcbb006,  ",
   #            "               islevel = 'Y' ",
   #            "      WHERE islevel = 'N' "  #更新未获取到的，不能用xcbb006=0因为可能有特征的设置过是0的，会又被盖掉
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO sfac_tmp ",
               "       USING (SELECT DISTINCT xcbb003,xcbb006 FROM xcbb_t ",
               "                 WHERE xcbbent = ",g_enterprise,
               "                   AND xcbbcomp = '",g_comp,"'",
               "                   AND xcbb001  = ",g_yy,
               "                   AND xcbb002  = ",g_pp,
               "               ) b ",
               "          ON ( sfac001  = b.xcbb003  ) ",   
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET clevel  = b.xcbb006,   ",
               "               islevel = 'Y' ",
               "      WHERE islevel = 'N' "  #更新未获取到的，不能用xcbb006=0因为可能有特征的设置过是0的，会又被盖掉
   #PGS(D)-00824 --- end ---
   #170109-00008#1----e               
   PREPARE s_axcp500_upd_temp_table_execute_p21 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p21"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_upd_temp_table_execute_p21
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p21"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   FREE s_axcp500_upd_temp_table_execute_p21
   #add zhangllc 151109 end
   
   #更新sfac_tmp2的成本阶
   UPDATE sfac_tmp2 SET clevel = (SELECT MAX(sfac_tmp.clevel) FROM sfac_tmp
                                  WHERE sfac_tmp.sfacdocno = sfac_tmp2.sfacdocno
                                 )
   #add zhangllc 150730--end
   
   #180129-00075#1---mark---s
   ##170328-00025#1---add---s
   ##整张工单的成本阶,如果是拆件式工单,则工单成本阶应是生产料号所对应的成本阶
   #LET g_sql = " MERGE INTO sfac_tmp2 a ",
   #            "       USING (SELECT DISTINCT sfac_tmp.sfacdocno sfacdocno,sfac_tmp.clevel clevel ",
   #            "                FROM sfac_tmp,sfaa_tmp ",
   #            "                 WHERE sfac_tmp.sfacdocno = sfaa_tmp.sfaadocno",
   #            "                   AND sfac_tmp.sfac001 = sfaa_tmp.sfaa010",
   #            "                   AND sfaa_tmp.sfaa003 = '3'",
   #            "               ) b ",
   #            "          ON ( a.sfacdocno  = b.sfacdocno  ) ",   
   #            "  WHEN MATCHED THEN    ",
   #            "     UPDATE SET a.clevel  = b.clevel   "             
   #PREPARE s_axcp500_upd_temp_table_execute_p22 FROM g_sql
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p22"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #EXECUTE s_axcp500_upd_temp_table_execute_p22
   #IF SQLCA.sqlcode THEN
   #   INITIALIZE g_errparam TO NULL
   #   LET g_errparam.code   = SQLCA.sqlcode
   #   LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p22"
   #   LET g_errparam.popup  = TRUE
   #   CALL cl_err()
   #   RETURN r_success
   #END IF
   #FREE s_axcp500_upd_temp_table_execute_p22    
   ##170328-00025#1---add---e
   #180129-00075#1---mark---s
   
   #成本域字段,若为NULL时,UPDATE为' '
   UPDATE s_axcp500_tmp0 SET xccc002 = ' ' WHERE xccc002 IS NULL
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE s_axcp500_tmp0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   #批次字段,若为NULL时,UPDATE为' '
   UPDATE s_axcp500_tmp0 SET xccc008 = ' ' WHERE xccc008 IS NULL
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE s_axcp500_tmp0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF


   #成本域时,每个成本域的成本计算方式可能不同,要分别取一下
   IF g_field_type MATCHES '[12]' THEN
      UPDATE s_axcp500_tmp0 SET xccc003 = (SELECT UNIQUE xcbf004 FROM xcbf_t
                                           WHERE xcbfent = g_enterprise
                                             AND xcbfcomp = g_comp
                                             AND xcbf001  = xccc002)
   ELSE
      UPDATE s_axcp500_tmp0 SET xccc003 = g_cost_type
   END IF
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE s_axcp500_tmp0"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   

   MESSAGE "ins_temp_table:s_axcp500_tmp"  
   #s_axcp500_tmp0中可能会有重复的资料,把UNIQUE后的值插入s_axcp500_tmp中
   INSERT INTO s_axcp500_tmp
   SELECT UNIQUE imaa001,xccc007,xcbb006,imac003,imaa004,imaa011,imae013,xccc002,xccc008,xccc003,imag014,imaa006 FROM s_axcp500_tmp0
#   INSERT INTO s_axcp500_tmp
#   SELECT * FROM s_axcp500_tmp0
#    GROUP BY imaa001,xccc007,xcbb006,imac003,imaa004,imaa011,imae013,xccc002,xccc008,xccc003
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT s_axcp500_tmp"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF


   #inaj_tmp中的inaj999可能被识别成char,所以要特别处理多空格的问题
   UPDATE s_axcp500_tmp SET xccc002 = ' ' WHERE xccc002 = '          '
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE s_axcp500_tmp"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   #180129-00075#1---add---s
   #整张工单的成本阶,如果是拆件式工单,则工单成本阶应是备料中成本阶数值最小的成本阶
   #PGS(D)-00824 ---start---
   LET g_sql = " MERGE INTO sfac_tmp2 a ",
               "       USING (SELECT DISTINCT sfaa_tmp.sfaadocno sfacdocno,MIN(s_axcp500_tmp.xcbb006) clevel ",
               "                FROM sfaa_tmp,sfba_tmp,s_axcp500_tmp ",
               "                 WHERE sfaa_tmp.sfaadocno = sfba_tmp.sfbadocno",
               "                   AND sfba_tmp.sfba006 = s_axcp500_tmp.imaa001",
               "                   AND sfaa_tmp.sfaa003 = '3'",
               "                   GROUP BY sfaa_tmp.sfaadocno",
               "               ) b ",
               "          ON ( a.sfacdocno  = b.sfacdocno  ) ",   
               "  WHEN MATCHED THEN    ",
               "     UPDATE SET a.clevel  = b.clevel "
   #PGS(D)-00824 --- end ---
   PREPARE s_axcp500_upd_temp_table_execute_p22 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_upd_temp_table_execute_p22"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   EXECUTE s_axcp500_upd_temp_table_execute_p22
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_upd_temp_table_execute_p22"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   FREE s_axcp500_upd_temp_table_execute_p22
   #180129-00075#1---add---s

   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 成本计算的资料插入临时表-EXECUTE
# Memo...........:
# Usage..........: CALL s_axcp500_ins_temp_table_execute(p_sql)
#                       RETURNING r_success
# Input parameter: p_sql          插入临时表的SQL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-23 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_temp_table_execute(p_sql)
   DEFINE p_sql          STRING
   DEFINE r_success      LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
       
   PREPARE s_axcp500_ins_temp_table_execute_p FROM p_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_ins_temp_table_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF
   
   EXECUTE s_axcp500_ins_temp_table_execute_p
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "EXECUTE s_axcp500_ins_temp_table_execute_p"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF  
   
   FREE s_axcp500_ins_temp_table_execute_p
                
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xccq变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xccq0()
#                       RETURNING r_xccq.*
# Input parameter: NULL
# Return code....: r_xccq         xccq_t的TABLE资料
# Date & Author..: 2015-12-15 By Carrier 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xccq0()
   #   DEFINE r_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE r_xccq              type_g_xccq   #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE
   
   INITIALIZE l_xccq.* TO NULL
       
   LET l_xccq.xccq101  = 0                   #上期结存数量        
   LET l_xccq.xccq102  = 0                   #上期结存金额        
   LET l_xccq.xccq102a = 0                   #上期结存金额-材料   
   LET l_xccq.xccq102b = 0                   #上期结存金额-人工   
   LET l_xccq.xccq102c = 0                   #上期结存金额-加工   
   LET l_xccq.xccq102d = 0                   #上期结存金额-制费一 
   LET l_xccq.xccq102e = 0                   #上期结存金额-制费二 
   LET l_xccq.xccq102f = 0                   #上期结存金额-制费三 
   LET l_xccq.xccq102g = 0                   #上期结存金额-制费四 
   LET l_xccq.xccq102h = 0                   #上期结存金额-制费五 

   LET l_xccq.xccq201  = 0                   #本期采购入库数量        
   LET l_xccq.xccq202  = 0                   #本期采购入库金额        
   LET l_xccq.xccq202a = 0                   #本期采购入库金额-材料   
   LET l_xccq.xccq202b = 0                   #本期采购入库金额-人工   
   LET l_xccq.xccq202c = 0                   #本期采购入库金额-加工   
   LET l_xccq.xccq202d = 0                   #本期采购入库金额-制费一 
   LET l_xccq.xccq202e = 0                   #本期采购入库金额-制费二 
   LET l_xccq.xccq202f = 0                   #本期采购入库金额-制费三 
   LET l_xccq.xccq202g = 0                   #本期采购入库金额-制费四 
   LET l_xccq.xccq202h = 0                   #本期采购入库金额-制费五 
   
   LET l_xccq.xccq203  = 0                   #本期委外入库数量        
   LET l_xccq.xccq204  = 0                   #本期委外入库金额        
   LET l_xccq.xccq204a = 0                   #本期委外入库金额-材料   
   LET l_xccq.xccq204b = 0                   #本期委外入库金额-人工   
   LET l_xccq.xccq204c = 0                   #本期委外入库金额-加工   
   LET l_xccq.xccq204d = 0                   #本期委外入库金额-制费一 
   LET l_xccq.xccq204e = 0                   #本期委外入库金额-制费二 
   LET l_xccq.xccq204f = 0                   #本期委外入库金额-制费三 
   LET l_xccq.xccq204g = 0                   #本期委外入库金额-制费四 
   LET l_xccq.xccq204h = 0                   #本期委外入库金额-制费五 
   
   LET l_xccq.xccq205  = 0                   #本期工单入库数量        
   LET l_xccq.xccq206  = 0                   #本期工单入库金额        
   LET l_xccq.xccq206a = 0                   #本期工单入库金额-材料  
   LET l_xccq.xccq206b = 0                   #本期工单入库金额-人工  
   LET l_xccq.xccq206c = 0                   #本期工单入库金额-加工  
   LET l_xccq.xccq206d = 0                   #本期工单入库金额-制费一
   LET l_xccq.xccq206e = 0                   #本期工单入库金额-制费二
   LET l_xccq.xccq206f = 0                   #本期工单入库金额-制费三
   LET l_xccq.xccq206g = 0                   #本期工单入库金额-制费四
   LET l_xccq.xccq206h = 0                   #本期工单入库金额-制费五
   
   LET l_xccq.xccq207  = 0                   #本期重工领出数量       
   LET l_xccq.xccq208  = 0                   #本期重工领出金额       
   LET l_xccq.xccq208a = 0                   #本期重工领出金额-材料  
   LET l_xccq.xccq208b = 0                   #本期重工领出金额-人工  
   LET l_xccq.xccq208c = 0                   #本期重工领出金额-加工  
   LET l_xccq.xccq208d = 0                   #本期重工领出金额-制费一
   LET l_xccq.xccq208e = 0                   #本期重工领出金额-制费二
   LET l_xccq.xccq208f = 0                   #本期重工领出金额-制费三
   LET l_xccq.xccq208g = 0                   #本期重工领出金额-制费四
   LET l_xccq.xccq208h = 0                   #本期重工领出金额-制费五
   
   LET l_xccq.xccq209  = 0                   #本期重工入库数量       
   LET l_xccq.xccq210  = 0                   #本期重工入库金额       
   LET l_xccq.xccq210a = 0                   #本期重工入库金额-材料  
   LET l_xccq.xccq210b = 0                   #本期重工入库金额-人工  
   LET l_xccq.xccq210c = 0                   #本期重工入库金额-加工  
   LET l_xccq.xccq210d = 0                   #本期重工入库金额-制费一
   LET l_xccq.xccq210e = 0                   #本期重工入库金额-制费二
   LET l_xccq.xccq210f = 0                   #本期重工入库金额-制费三
   LET l_xccq.xccq210g = 0                   #本期重工入库金额-制费四
   LET l_xccq.xccq210h = 0                   #本期重工入库金额-制费五
   
   LET l_xccq.xccq211  = 0                   #本期杂项入库数量       
   LET l_xccq.xccq212  = 0                   #本期杂项入库金额       
   LET l_xccq.xccq212a = 0                   #本期杂项入库金额-材料  
   LET l_xccq.xccq212b = 0                   #本期杂项入库金额-人工  
   LET l_xccq.xccq212c = 0                   #本期杂项入库金额-加工  
   LET l_xccq.xccq212d = 0                   #本期杂项入库金额-制费一
   LET l_xccq.xccq212e = 0                   #本期杂项入库金额-制费二
   LET l_xccq.xccq212f = 0                   #本期杂项入库金额-制费三
   LET l_xccq.xccq212g = 0                   #本期杂项入库金额-制费四
   LET l_xccq.xccq212h = 0                   #本期杂项入库金额-制费五
   
   LET l_xccq.xccq213  = 0                   #本期调整入库数量       
   LET l_xccq.xccq214  = 0                   #本期调整入库金额       
   LET l_xccq.xccq214a = 0                   #本期调整入库金额-材料  
   LET l_xccq.xccq214b = 0                   #本期调整入库金额-人工  
   LET l_xccq.xccq214c = 0                   #本期调整入库金额-加工  
   LET l_xccq.xccq214d = 0                   #本期调整入库金额-制费一
   LET l_xccq.xccq214e = 0                   #本期调整入库金额-制费二
   LET l_xccq.xccq214f = 0                   #本期调整入库金额-制费三
   LET l_xccq.xccq214g = 0                   #本期调整入库金额-制费四
   LET l_xccq.xccq214h = 0                   #本期调整入库金额-制费五
   
   LET l_xccq.xccq215  = 0                   #本期销退入库数量       
   LET l_xccq.xccq216  = 0                   #本期销退入库金额       
   LET l_xccq.xccq216a = 0                   #本期销退入库金额-材料  
   LET l_xccq.xccq216b = 0                   #本期销退入库金额-人工  
   LET l_xccq.xccq216c = 0                   #本期销退入库金额-加工  
   LET l_xccq.xccq216d = 0                   #本期销退入库金额-制费一
   LET l_xccq.xccq216e = 0                   #本期销退入库金额-制费二
   LET l_xccq.xccq216f = 0                   #本期销退入库金额-制费三
   LET l_xccq.xccq216g = 0                   #本期销退入库金额-制费四
   LET l_xccq.xccq216h = 0                   #本期销退入库金额-制费五
   
   LET l_xccq.xccq217  = 0                   #本期其他入库数量       
   LET l_xccq.xccq218  = 0                   #本期其他入库金额       
   LET l_xccq.xccq218a = 0                   #本期其他入库金额-材料  
   LET l_xccq.xccq218b = 0                   #本期其他入库金额-人工  
   LET l_xccq.xccq218c = 0                   #本期其他入库金额-加工  
   LET l_xccq.xccq218d = 0                   #本期其他入库金额-制费一
   LET l_xccq.xccq218e = 0                   #本期其他入库金额-制费二
   LET l_xccq.xccq218f = 0                   #本期其他入库金额-制费三
   LET l_xccq.xccq218g = 0                   #本期其他入库金额-制费四 
   LET l_xccq.xccq218h = 0                   #本期其他入库金额-制费五 
   
   LET l_xccq.xccq280  = 0                   #本期平均单价            
   LET l_xccq.xccq280a = 0                   #本期平均单价-材料       
   LET l_xccq.xccq280b = 0                   #本期平均单价-人工       
   LET l_xccq.xccq280c = 0                   #本期平均单价-加工       
   LET l_xccq.xccq280d = 0                   #本期平均单价-制费一     
   LET l_xccq.xccq280e = 0                   #本期平均单价-制费二     
   LET l_xccq.xccq280f = 0                   #本期平均单价-制费三     
   LET l_xccq.xccq280g = 0                   #本期平均单价-制费四     
   LET l_xccq.xccq280h = 0                   #本期平均单价-制费五     
   
   LET l_xccq.xccq301  = 0                   #本期工单领用数量        
   LET l_xccq.xccq302  = 0                   #本期工单领用金额        
   LET l_xccq.xccq302a = 0                   #本期工单领用金额-材料   
   LET l_xccq.xccq302b = 0                   #本期工单领用金额-人工   
   LET l_xccq.xccq302c = 0                   #本期工单领用金额-加工   
   LET l_xccq.xccq302d = 0                   #本期工单领用金额-制费一 
   LET l_xccq.xccq302e = 0                   #本期工单领用金额-制费二 
   LET l_xccq.xccq302f = 0                   #本期工单领用金额-制费三 
   LET l_xccq.xccq302g = 0                   #本期工单领用金额-制费四 
   LET l_xccq.xccq302h = 0                   #本期工单领用金额-制费五 
   
   LET l_xccq.xccq303  = 0                   #本期销货数量            
   LET l_xccq.xccq304  = 0                   #本期销货成本            
   LET l_xccq.xccq304a = 0                   #本期销货成本-材料       
   LET l_xccq.xccq304b = 0                   #本期销货成本-人工       
   LET l_xccq.xccq304c = 0                   #本期销货成本-加工       
   LET l_xccq.xccq304d = 0                   #本期销货成本-制费一     
   LET l_xccq.xccq304e = 0                   #本期销货成本-制费二     
   LET l_xccq.xccq304f = 0                   #本期销货成本-制费三     
   LET l_xccq.xccq304g = 0                   #本期销货成本-制费四     
   LET l_xccq.xccq304h = 0                   #本期销货成本-制费五   
     
   LET l_xccq.xccq305  = 0                   #本期销退数量            
   LET l_xccq.xccq306  = 0                   #本期销退成本            
   LET l_xccq.xccq306a = 0                   #本期销退成本-材料       
   LET l_xccq.xccq306b = 0                   #本期销退成本-人工       
   LET l_xccq.xccq306c = 0                   #本期销退成本-加工       
   LET l_xccq.xccq306d = 0                   #本期销退成本-制费一     
   LET l_xccq.xccq306e = 0                   #本期销退成本-制费二     
   LET l_xccq.xccq306f = 0                   #本期销退成本-制费三     
   LET l_xccq.xccq306g = 0                   #本期销退成本-制费四    
   LET l_xccq.xccq306h = 0                   #本期销退成本-制费五   
    
   LET l_xccq.xccq307  = 0                   #本期销售费用数量       
   LET l_xccq.xccq308  = 0                   #本期销售费用成本       
   LET l_xccq.xccq308a = 0                   #本期销售费用成本-材料  
   LET l_xccq.xccq308b = 0                   #本期销售费用成本-人工  
   LET l_xccq.xccq308c = 0                   #本期销售费用成本-加工  
   LET l_xccq.xccq308d = 0                   #本期销售费用成本-制费一
   LET l_xccq.xccq308e = 0                   #本期销售费用成本-制费二
   LET l_xccq.xccq308f = 0                   #本期销售费用成本-制费三
   LET l_xccq.xccq308g = 0                   #本期销售费用成本-制费四
   LET l_xccq.xccq308h = 0                   #本期销售费用成本-制费五
   
   LET l_xccq.xccq309  = 0                   #本期杂发数量           
   LET l_xccq.xccq310  = 0                   #本期杂发金额           
   LET l_xccq.xccq310a = 0                   #本期杂发金额-材料      
   LET l_xccq.xccq310b = 0                   #本期杂发金额-人工      
   LET l_xccq.xccq310c = 0                   #本期杂发金额-加工      
   LET l_xccq.xccq310d = 0                   #本期杂发金额-制费一    
   LET l_xccq.xccq310e = 0                   #本期杂发金额-制费二    
   LET l_xccq.xccq310f = 0                   #本期杂发金额-制费三    
   LET l_xccq.xccq310g = 0                   #本期杂发金额-制费四    
   LET l_xccq.xccq310h = 0                   #本期杂发金额-制费五 
      
   LET l_xccq.xccq311  = 0                   #本期盘盈亏数量         
   LET l_xccq.xccq312  = 0                   #本期盘盈亏金额         
   LET l_xccq.xccq312a = 0                   #本期盘盈亏金额-材料    
   LET l_xccq.xccq312b = 0                   #本期盘盈亏金额-人工    
   LET l_xccq.xccq312c = 0                   #本期盘盈亏金额-加工    
   LET l_xccq.xccq312d = 0                   #本期盘盈亏金额-制费一  
   LET l_xccq.xccq312e = 0                   #本期盘盈亏金额-制费二  
   LET l_xccq.xccq312f = 0                   #本期盘盈亏金额-制费三  
   LET l_xccq.xccq312g = 0                   #本期盘盈亏金额-制费四  
   LET l_xccq.xccq312h = 0                   #本期盘盈亏金额-制费五  
   
   LET l_xccq.xccq313  = 0                   #本期其他出库数量       
   LET l_xccq.xccq314  = 0                   #本期其他出库金额       
   LET l_xccq.xccq314a = 0                   #本期其他出库金额-材料  
   LET l_xccq.xccq314b = 0                   #本期其他出库金额-人工  
   LET l_xccq.xccq314c = 0                   #本期其他出库金额-加工  
   LET l_xccq.xccq314d = 0                   #本期其他出库金额-制费一
   LET l_xccq.xccq314e = 0                   #本期其他出库金额-制费二
   LET l_xccq.xccq314f = 0                   #本期其他出库金额-制费三
   LET l_xccq.xccq314g = 0                   #本期其他出库金额-制费四
   LET l_xccq.xccq314h = 0                   #本期其他出库金额-制费五
   
   LET l_xccq.xccq401  = 0                   #本期销货收入金额       
   LET l_xccq.xccq402  = 0                   #本期销退金额   
           
   LET l_xccq.xccq901  = 0                   #期末结存数量           
   LET l_xccq.xccq902  = 0                   #期末结存金额           
   LET l_xccq.xccq902a = 0                   #期末结存金额-材料      
   LET l_xccq.xccq902b = 0                   #期末结存金额-人工      
   LET l_xccq.xccq902c = 0                   #期末结存金额-加工      
   LET l_xccq.xccq902d = 0                   #期末结存金额-制费一    
   LET l_xccq.xccq902e = 0                   #期末结存金额-制费二    
   LET l_xccq.xccq902f = 0                   #期末结存金额-制费三    
   LET l_xccq.xccq902g = 0                   #期末结存金额-制费四    
   LET l_xccq.xccq902h = 0                   #期末结存金额-制费五    
   
   LET l_xccq.xccq903  = 0                   #期末结存调整金额       
   LET l_xccq.xccq903a = 0                   #期末结存调整金额-材料  
   LET l_xccq.xccq903b = 0                   #期末结存调整金额-人工  
   LET l_xccq.xccq903c = 0                   #期末结存调整金额-加工  
   LET l_xccq.xccq903d = 0                   #期末结存调整金额-制费一
   LET l_xccq.xccq903e = 0                   #期末结存调整金额-制费二
   LET l_xccq.xccq903f = 0                   #期末结存调整金额-制费三
   LET l_xccq.xccq903g = 0                   #期末结存调整金额-制费四
   LET l_xccq.xccq903h = 0                   #期末结存调整金额-制费五
   
   LET r_xccq.* = l_xccq.*
   
   RETURN r_xccq.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xccc变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xccc0()
#                       RETURNING r_xccc.*
# Input parameter: NULL
# Return code....: r_xccc         xccc_t的TABLE资料
# Date & Author..: 2014-06-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xccc0()
#   DEFINE r_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE r_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE
   
   INITIALIZE l_xccc.* TO NULL
       
   LET l_xccc.xccc101  = 0                   #上期结存数量        
   LET l_xccc.xccc102  = 0                   #上期结存金额        
   LET l_xccc.xccc102a = 0                   #上期结存金额-材料   
   LET l_xccc.xccc102b = 0                   #上期结存金额-人工   
   LET l_xccc.xccc102c = 0                   #上期结存金额-加工   
   LET l_xccc.xccc102d = 0                   #上期结存金额-制费一 
   LET l_xccc.xccc102e = 0                   #上期结存金额-制费二 
   LET l_xccc.xccc102f = 0                   #上期结存金额-制费三 
   LET l_xccc.xccc102g = 0                   #上期结存金额-制费四 
   LET l_xccc.xccc102h = 0                   #上期结存金额-制费五 

   LET l_xccc.xccc201  = 0                   #本期采购入库数量        
   LET l_xccc.xccc202  = 0                   #本期采购入库金额        
   LET l_xccc.xccc202a = 0                   #本期采购入库金额-材料   
   LET l_xccc.xccc202b = 0                   #本期采购入库金额-人工   
   LET l_xccc.xccc202c = 0                   #本期采购入库金额-加工   
   LET l_xccc.xccc202d = 0                   #本期采购入库金额-制费一 
   LET l_xccc.xccc202e = 0                   #本期采购入库金额-制费二 
   LET l_xccc.xccc202f = 0                   #本期采购入库金额-制费三 
   LET l_xccc.xccc202g = 0                   #本期采购入库金额-制费四 
   LET l_xccc.xccc202h = 0                   #本期采购入库金额-制费五 
   
   LET l_xccc.xccc203  = 0                   #本期委外入库数量        
   LET l_xccc.xccc204  = 0                   #本期委外入库金额        
   LET l_xccc.xccc204a = 0                   #本期委外入库金额-材料   
   LET l_xccc.xccc204b = 0                   #本期委外入库金额-人工   
   LET l_xccc.xccc204c = 0                   #本期委外入库金额-加工   
   LET l_xccc.xccc204d = 0                   #本期委外入库金额-制费一 
   LET l_xccc.xccc204e = 0                   #本期委外入库金额-制费二 
   LET l_xccc.xccc204f = 0                   #本期委外入库金额-制费三 
   LET l_xccc.xccc204g = 0                   #本期委外入库金额-制费四 
   LET l_xccc.xccc204h = 0                   #本期委外入库金额-制费五 
   
   LET l_xccc.xccc205  = 0                   #本期工单入库数量        
   LET l_xccc.xccc206  = 0                   #本期工单入库金额        
   LET l_xccc.xccc206a = 0                   #本期工单入库金额-材料  
   LET l_xccc.xccc206b = 0                   #本期工单入库金额-人工  
   LET l_xccc.xccc206c = 0                   #本期工单入库金额-加工  
   LET l_xccc.xccc206d = 0                   #本期工单入库金额-制费一
   LET l_xccc.xccc206e = 0                   #本期工单入库金额-制费二
   LET l_xccc.xccc206f = 0                   #本期工单入库金额-制费三
   LET l_xccc.xccc206g = 0                   #本期工单入库金额-制费四
   LET l_xccc.xccc206h = 0                   #本期工单入库金额-制费五
   
   LET l_xccc.xccc207  = 0                   #本期重工领出数量       
   LET l_xccc.xccc208  = 0                   #本期重工领出金额       
   LET l_xccc.xccc208a = 0                   #本期重工领出金额-材料  
   LET l_xccc.xccc208b = 0                   #本期重工领出金额-人工  
   LET l_xccc.xccc208c = 0                   #本期重工领出金额-加工  
   LET l_xccc.xccc208d = 0                   #本期重工领出金额-制费一
   LET l_xccc.xccc208e = 0                   #本期重工领出金额-制费二
   LET l_xccc.xccc208f = 0                   #本期重工领出金额-制费三
   LET l_xccc.xccc208g = 0                   #本期重工领出金额-制费四
   LET l_xccc.xccc208h = 0                   #本期重工领出金额-制费五
   
   LET l_xccc.xccc209  = 0                   #本期重工入库数量       
   LET l_xccc.xccc210  = 0                   #本期重工入库金额       
   LET l_xccc.xccc210a = 0                   #本期重工入库金额-材料  
   LET l_xccc.xccc210b = 0                   #本期重工入库金额-人工  
   LET l_xccc.xccc210c = 0                   #本期重工入库金额-加工  
   LET l_xccc.xccc210d = 0                   #本期重工入库金额-制费一
   LET l_xccc.xccc210e = 0                   #本期重工入库金额-制费二
   LET l_xccc.xccc210f = 0                   #本期重工入库金额-制费三
   LET l_xccc.xccc210g = 0                   #本期重工入库金额-制费四
   LET l_xccc.xccc210h = 0                   #本期重工入库金额-制费五
   
   LET l_xccc.xccc211  = 0                   #本期杂项入库数量       
   LET l_xccc.xccc212  = 0                   #本期杂项入库金额       
   LET l_xccc.xccc212a = 0                   #本期杂项入库金额-材料  
   LET l_xccc.xccc212b = 0                   #本期杂项入库金额-人工  
   LET l_xccc.xccc212c = 0                   #本期杂项入库金额-加工  
   LET l_xccc.xccc212d = 0                   #本期杂项入库金额-制费一
   LET l_xccc.xccc212e = 0                   #本期杂项入库金额-制费二
   LET l_xccc.xccc212f = 0                   #本期杂项入库金额-制费三
   LET l_xccc.xccc212g = 0                   #本期杂项入库金额-制费四
   LET l_xccc.xccc212h = 0                   #本期杂项入库金额-制费五
   
   LET l_xccc.xccc213  = 0                   #本期调整入库数量       
   LET l_xccc.xccc214  = 0                   #本期调整入库金额       
   LET l_xccc.xccc214a = 0                   #本期调整入库金额-材料  
   LET l_xccc.xccc214b = 0                   #本期调整入库金额-人工  
   LET l_xccc.xccc214c = 0                   #本期调整入库金额-加工  
   LET l_xccc.xccc214d = 0                   #本期调整入库金额-制费一
   LET l_xccc.xccc214e = 0                   #本期调整入库金额-制费二
   LET l_xccc.xccc214f = 0                   #本期调整入库金额-制费三
   LET l_xccc.xccc214g = 0                   #本期调整入库金额-制费四
   LET l_xccc.xccc214h = 0                   #本期调整入库金额-制费五
   
   LET l_xccc.xccc215  = 0                   #本期销退入库数量       
   LET l_xccc.xccc216  = 0                   #本期销退入库金额       
   LET l_xccc.xccc216a = 0                   #本期销退入库金额-材料  
   LET l_xccc.xccc216b = 0                   #本期销退入库金额-人工  
   LET l_xccc.xccc216c = 0                   #本期销退入库金额-加工  
   LET l_xccc.xccc216d = 0                   #本期销退入库金额-制费一
   LET l_xccc.xccc216e = 0                   #本期销退入库金额-制费二
   LET l_xccc.xccc216f = 0                   #本期销退入库金额-制费三
   LET l_xccc.xccc216g = 0                   #本期销退入库金额-制费四
   LET l_xccc.xccc216h = 0                   #本期销退入库金额-制费五
   
   LET l_xccc.xccc217  = 0                   #本期其他入库数量       
   LET l_xccc.xccc218  = 0                   #本期其他入库金额       
   LET l_xccc.xccc218a = 0                   #本期其他入库金额-材料  
   LET l_xccc.xccc218b = 0                   #本期其他入库金额-人工  
   LET l_xccc.xccc218c = 0                   #本期其他入库金额-加工  
   LET l_xccc.xccc218d = 0                   #本期其他入库金额-制费一
   LET l_xccc.xccc218e = 0                   #本期其他入库金额-制费二
   LET l_xccc.xccc218f = 0                   #本期其他入库金额-制费三
   LET l_xccc.xccc218g = 0                   #本期其他入库金额-制费四 
   LET l_xccc.xccc218h = 0                   #本期其他入库金额-制费五 
   
   LET l_xccc.xccc280  = 0                   #本期平均单价            
   LET l_xccc.xccc280a = 0                   #本期平均单价-材料       
   LET l_xccc.xccc280b = 0                   #本期平均单价-人工       
   LET l_xccc.xccc280c = 0                   #本期平均单价-加工       
   LET l_xccc.xccc280d = 0                   #本期平均单价-制费一     
   LET l_xccc.xccc280e = 0                   #本期平均单价-制费二     
   LET l_xccc.xccc280f = 0                   #本期平均单价-制费三     
   LET l_xccc.xccc280g = 0                   #本期平均单价-制费四     
   LET l_xccc.xccc280h = 0                   #本期平均单价-制费五     
   
   LET l_xccc.xccc301  = 0                   #本期工单领用数量        
   LET l_xccc.xccc302  = 0                   #本期工单领用金额        
   LET l_xccc.xccc302a = 0                   #本期工单领用金额-材料   
   LET l_xccc.xccc302b = 0                   #本期工单领用金额-人工   
   LET l_xccc.xccc302c = 0                   #本期工单领用金额-加工   
   LET l_xccc.xccc302d = 0                   #本期工单领用金额-制费一 
   LET l_xccc.xccc302e = 0                   #本期工单领用金额-制费二 
   LET l_xccc.xccc302f = 0                   #本期工单领用金额-制费三 
   LET l_xccc.xccc302g = 0                   #本期工单领用金额-制费四 
   LET l_xccc.xccc302h = 0                   #本期工单领用金额-制费五 
   
   LET l_xccc.xccc303  = 0                   #本期销货数量            
   LET l_xccc.xccc304  = 0                   #本期销货成本            
   LET l_xccc.xccc304a = 0                   #本期销货成本-材料       
   LET l_xccc.xccc304b = 0                   #本期销货成本-人工       
   LET l_xccc.xccc304c = 0                   #本期销货成本-加工       
   LET l_xccc.xccc304d = 0                   #本期销货成本-制费一     
   LET l_xccc.xccc304e = 0                   #本期销货成本-制费二     
   LET l_xccc.xccc304f = 0                   #本期销货成本-制费三     
   LET l_xccc.xccc304g = 0                   #本期销货成本-制费四     
   LET l_xccc.xccc304h = 0                   #本期销货成本-制费五   
     
   LET l_xccc.xccc305  = 0                   #本期销退数量            
   LET l_xccc.xccc306  = 0                   #本期销退成本            
   LET l_xccc.xccc306a = 0                   #本期销退成本-材料       
   LET l_xccc.xccc306b = 0                   #本期销退成本-人工       
   LET l_xccc.xccc306c = 0                   #本期销退成本-加工       
   LET l_xccc.xccc306d = 0                   #本期销退成本-制费一     
   LET l_xccc.xccc306e = 0                   #本期销退成本-制费二     
   LET l_xccc.xccc306f = 0                   #本期销退成本-制费三     
   LET l_xccc.xccc306g = 0                   #本期销退成本-制费四    
   LET l_xccc.xccc306h = 0                   #本期销退成本-制费五   
    
   LET l_xccc.xccc307  = 0                   #本期销售费用数量       
   LET l_xccc.xccc308  = 0                   #本期销售费用成本       
   LET l_xccc.xccc308a = 0                   #本期销售费用成本-材料  
   LET l_xccc.xccc308b = 0                   #本期销售费用成本-人工  
   LET l_xccc.xccc308c = 0                   #本期销售费用成本-加工  
   LET l_xccc.xccc308d = 0                   #本期销售费用成本-制费一
   LET l_xccc.xccc308e = 0                   #本期销售费用成本-制费二
   LET l_xccc.xccc308f = 0                   #本期销售费用成本-制费三
   LET l_xccc.xccc308g = 0                   #本期销售费用成本-制费四
   LET l_xccc.xccc308h = 0                   #本期销售费用成本-制费五
   
   LET l_xccc.xccc309  = 0                   #本期杂发数量           
   LET l_xccc.xccc310  = 0                   #本期杂发金额           
   LET l_xccc.xccc310a = 0                   #本期杂发金额-材料      
   LET l_xccc.xccc310b = 0                   #本期杂发金额-人工      
   LET l_xccc.xccc310c = 0                   #本期杂发金额-加工      
   LET l_xccc.xccc310d = 0                   #本期杂发金额-制费一    
   LET l_xccc.xccc310e = 0                   #本期杂发金额-制费二    
   LET l_xccc.xccc310f = 0                   #本期杂发金额-制费三    
   LET l_xccc.xccc310g = 0                   #本期杂发金额-制费四    
   LET l_xccc.xccc310h = 0                   #本期杂发金额-制费五 
      
   LET l_xccc.xccc311  = 0                   #本期盘盈亏数量         
   LET l_xccc.xccc312  = 0                   #本期盘盈亏金额         
   LET l_xccc.xccc312a = 0                   #本期盘盈亏金额-材料    
   LET l_xccc.xccc312b = 0                   #本期盘盈亏金额-人工    
   LET l_xccc.xccc312c = 0                   #本期盘盈亏金额-加工    
   LET l_xccc.xccc312d = 0                   #本期盘盈亏金额-制费一  
   LET l_xccc.xccc312e = 0                   #本期盘盈亏金额-制费二  
   LET l_xccc.xccc312f = 0                   #本期盘盈亏金额-制费三  
   LET l_xccc.xccc312g = 0                   #本期盘盈亏金额-制费四  
   LET l_xccc.xccc312h = 0                   #本期盘盈亏金额-制费五  
   
   LET l_xccc.xccc313  = 0                   #本期其他出库数量       
   LET l_xccc.xccc314  = 0                   #本期其他出库金额       
   LET l_xccc.xccc314a = 0                   #本期其他出库金额-材料  
   LET l_xccc.xccc314b = 0                   #本期其他出库金额-人工  
   LET l_xccc.xccc314c = 0                   #本期其他出库金额-加工  
   LET l_xccc.xccc314d = 0                   #本期其他出库金额-制费一
   LET l_xccc.xccc314e = 0                   #本期其他出库金额-制费二
   LET l_xccc.xccc314f = 0                   #本期其他出库金额-制费三
   LET l_xccc.xccc314g = 0                   #本期其他出库金额-制费四
   LET l_xccc.xccc314h = 0                   #本期其他出库金额-制费五
   
   LET l_xccc.xccc401  = 0                   #本期销货收入金额       
   LET l_xccc.xccc402  = 0                   #本期销退金额   
           
   LET l_xccc.xccc901  = 0                   #期末结存数量           
   LET l_xccc.xccc902  = 0                   #期末结存金额           
   LET l_xccc.xccc902a = 0                   #期末结存金额-材料      
   LET l_xccc.xccc902b = 0                   #期末结存金额-人工      
   LET l_xccc.xccc902c = 0                   #期末结存金额-加工      
   LET l_xccc.xccc902d = 0                   #期末结存金额-制费一    
   LET l_xccc.xccc902e = 0                   #期末结存金额-制费二    
   LET l_xccc.xccc902f = 0                   #期末结存金额-制费三    
   LET l_xccc.xccc902g = 0                   #期末结存金额-制费四    
   LET l_xccc.xccc902h = 0                   #期末结存金额-制费五    
   
   LET l_xccc.xccc903  = 0                   #期末结存调整金额       
   LET l_xccc.xccc903a = 0                   #期末结存调整金额-材料  
   LET l_xccc.xccc903b = 0                   #期末结存调整金额-人工  
   LET l_xccc.xccc903c = 0                   #期末结存调整金额-加工  
   LET l_xccc.xccc903d = 0                   #期末结存调整金额-制费一
   LET l_xccc.xccc903e = 0                   #期末结存调整金额-制费二
   LET l_xccc.xccc903f = 0                   #期末结存调整金额-制费三
   LET l_xccc.xccc903g = 0                   #期末结存调整金额-制费四
   LET l_xccc.xccc903h = 0                   #期末结存调整金额-制费五
   
   LET r_xccc.* = l_xccc.*
   
   RETURN r_xccc.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xccd变量                                             
# Memo...........:                                                              
# Usage..........: CALL s_axcp500_init_xccd0()                                     
#                       RETURNING r_xccd.*                                      
# Input parameter: NULL                                                         
# Return code....: r_xccd         xccd_t的TABLE资料                             
# Date & Author..: 2014-06-12 By Carrier                                        
# Modify.........:                                                              
################################################################################
PUBLIC FUNCTION s_axcp500_init_xccd0()
#   DEFINE r_xccd            RECORD LIKE xccd_t.*  #161124-00048#20 mark
#   DEFINE l_xccd            RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE l_xccd             type_g_xccd  #170605-00013#1-add
   DEFINE r_xccd             type_g_xccd  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   #DEFINE r_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE
   #说明:
   #xccd_t(在制元件成本期异动统计档)的来源:
   #(1)发料单--材料
   #(2)报工单--人工/制费
   #(3)完工入库单--人工/制费
   #(4)委外入库单--加工费

   INITIALIZE l_xccd.* TO NULL
       
   LET l_xccd.xccd101  = 0        #上期结存数量           
   LET l_xccd.xccd102  = 0        #上期结存金额           
   LET l_xccd.xccd102a = 0        #上期结存金额-材料      
   LET l_xccd.xccd102b = 0        #上期结存金额-人工      
   LET l_xccd.xccd102c = 0        #上期结存金额-加工      
   LET l_xccd.xccd102d = 0        #上期结存金额-制费一    
   LET l_xccd.xccd102e = 0        #上期结存金额-制费二    
   LET l_xccd.xccd102f = 0        #上期结存金额-制费三    
   LET l_xccd.xccd102g = 0        #上期结存金额-制费四    
   LET l_xccd.xccd102h = 0        #上期结存金额-制费五    
   LET l_xccd.xccd200  = 0        #本期投入工时           
   LET l_xccd.xccd201  = 0        #本期投入数量           
   LET l_xccd.xccd202  = 0        #本期本阶投入金额       
   LET l_xccd.xccd202a = 0        #本期本阶投入金额-材料  
   LET l_xccd.xccd202b = 0        #本期本阶投入金额-人工  
   LET l_xccd.xccd202c = 0        #本期本阶投入金额-加工  
   LET l_xccd.xccd202d = 0        #本期本阶投入金额-制费一
   LET l_xccd.xccd202e = 0        #本期本阶投入金额-制费二
   LET l_xccd.xccd202f = 0        #本期本阶投入金额-制费三
   LET l_xccd.xccd202g = 0        #本期本阶投入金额-制费四
   LET l_xccd.xccd202h = 0        #本期本阶投入金额-制费五
   LET l_xccd.xccd204  = 0        #本期下阶投入金额       
   LET l_xccd.xccd204a = 0        #本期下阶投入金额-材料  
   LET l_xccd.xccd204b = 0        #本期下阶投入金额-人工  
   LET l_xccd.xccd204c = 0        #本期下阶投入金额-加工  
   LET l_xccd.xccd204d = 0        #本期下阶投入金额-制费一
   LET l_xccd.xccd204e = 0        #本期下阶投入金额-制费二
   LET l_xccd.xccd204f = 0        #本期下阶投入金额-制费三
   LET l_xccd.xccd204g = 0        #本期下阶投入金额-制费四
   LET l_xccd.xccd204h = 0        #本期下阶投入金额-制费五
   LET l_xccd.xccd301  = 0        #本期转出数量           
   LET l_xccd.xccd302  = 0        #本期转出金额           
   LET l_xccd.xccd302a = 0        #本期转出金额-材料      
   LET l_xccd.xccd302b = 0        #本期转出金额-人工      
   LET l_xccd.xccd302c = 0        #本期转出金额-加工      
   LET l_xccd.xccd302d = 0        #本期转出金额-制费一    
   LET l_xccd.xccd302e = 0        #本期转出金额-制费二    
   LET l_xccd.xccd302f = 0        #本期转出金额-制费三    
   LET l_xccd.xccd302g = 0        #本期转出金额-制费四    
   LET l_xccd.xccd302h = 0        #本期转出金额-制费五    
   LET l_xccd.xccd303  = 0        #差异转出数量           
   LET l_xccd.xccd304  = 0        #差异转出金额           
   LET l_xccd.xccd304a = 0        #差异转出金额-材料      
   LET l_xccd.xccd304b = 0        #差异转出金额-人工      
   LET l_xccd.xccd304c = 0        #差异转出金额-加工      
   LET l_xccd.xccd304d = 0        #差异转出金额-制费一    
   LET l_xccd.xccd304e = 0        #差异转出金额-制费二    
   LET l_xccd.xccd304f = 0        #差异转出金额-制费三    
   LET l_xccd.xccd304g = 0        #差异转出金额-制费四    
   LET l_xccd.xccd304h = 0        #差异转出金额-制费五    
   LET l_xccd.xccd901  = 0        #期末结存数量           
   LET l_xccd.xccd902  = 0        #期末结存金额           
   LET l_xccd.xccd902a = 0        #期末结存金额-材料      
   LET l_xccd.xccd902b = 0        #期末结存金额-人工      
   LET l_xccd.xccd902c = 0        #期末结存金额-加工      
   LET l_xccd.xccd902d = 0        #期末结存金额-制费一    
   LET l_xccd.xccd902e = 0        #期末结存金额-制费二    
   LET l_xccd.xccd902f = 0        #期末结存金额-制费三    
   LET l_xccd.xccd902g = 0        #期末结存金额-制费四    
   LET l_xccd.xccd902h = 0        #期末结存金额-制费五     
      
   LET r_xccd.* = l_xccd.*
   
   RETURN r_xccd.*          

END FUNCTION

################################################################################
# Descriptions...: 初始化g_xcce变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xcce0()
#                       RETURNING r_xcce.*
# Input parameter: NULL
# Return code....: r_xcce         xcce_t的TABLE资料
# Date & Author..: 2014-06-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xcce0()
#   DEFINE r_xcce            RECORD LIKE xcce_t.*  #161124-00048#20 mark
#   DEFINE l_xcce            RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE r_xcce             type_g_xcce  #170605-00013#1-add
   DEFINE l_xcce             type_g_xcce  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xcce RECORD  #在製元件成本期異動統計檔
   #    xcceent LIKE xcce_t.xcceent, #企业编号
   #    xccecomp LIKE xcce_t.xccecomp, #法人组织
   #    xcceld LIKE xcce_t.xcceld, #账套
   #    xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
   #    xcce002 LIKE xcce_t.xcce002, #成本域
   #    xcce003 LIKE xcce_t.xcce003, #成本计算类型
   #    xcce004 LIKE xcce_t.xcce004, #年度
   #    xcce005 LIKE xcce_t.xcce005, #期别
   #    xcce006 LIKE xcce_t.xcce006, #工单编号
   #    xcce007 LIKE xcce_t.xcce007, #元件编号
   #    xcce008 LIKE xcce_t.xcce008, #产品特征
   #    xcce009 LIKE xcce_t.xcce009, #批号
   #    xcce010 LIKE xcce_t.xcce010, #核算币种
   #    xcce101 LIKE xcce_t.xcce101, #上期结存数量
   #    xcce102 LIKE xcce_t.xcce102, #上期结存金额
   #    xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
   #    xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
   #    xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
   #    xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
   #    xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
   #    xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
   #    xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
   #    xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
   #    xcce201 LIKE xcce_t.xcce201, #本期投入数量
   #    xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
   #    xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
   #    xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
   #    xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
   #    xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
   #    xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
   #    xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
   #    xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
   #    xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
   #    xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
   #    xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
   #    xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
   #    xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
   #    xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
   #    xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
   #    xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
   #    xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
   #    xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
   #    xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
   #    xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
   #    xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
   #    xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
   #    xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
   #    xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
   #    xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
   #    xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
   #    xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
   #    xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
   #    xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
   #    xcce209 LIKE xcce_t.xcce209, #本期超领退数量
   #    xcce210 LIKE xcce_t.xcce210, #本期超领退金额
   #    xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
   #    xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
   #    xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
   #    xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
   #    xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
   #    xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
   #    xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
   #    xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
   #    xcce301 LIKE xcce_t.xcce301, #本期转出数量
   #    xcce302 LIKE xcce_t.xcce302, #本期转出金额
   #    xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
   #    xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
   #    xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
   #    xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
   #    xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
   #    xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
   #    xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
   #    xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
   #    xcce303 LIKE xcce_t.xcce303, #差异转出数量
   #    xcce304 LIKE xcce_t.xcce304, #差异转出金额
   #    xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
   #    xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
   #    xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
   #    xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
   #    xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
   #    xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
   #    xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
   #    xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
   #    xcce307 LIKE xcce_t.xcce307, #盘差数量
   #    xcce308 LIKE xcce_t.xcce308, #盘差金额
   #    xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
   #    xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
   #    xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
   #    xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
   #    xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
   #    xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
   #    xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
   #    xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
   #    xcce901 LIKE xcce_t.xcce901, #期末结存数量
   #    xcce902 LIKE xcce_t.xcce902, #期末结存金额
   #    xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
   #    xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
   #    xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
   #    xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
   #    xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
   #    xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
   #    xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
   #    xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
   #    xccetime LIKE xcce_t.xccetime  #最近成本计算时间
   #END RECORD
   #DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
   #    xcceent LIKE xcce_t.xcceent, #企业编号
   #    xccecomp LIKE xcce_t.xccecomp, #法人组织
   #    xcceld LIKE xcce_t.xcceld, #账套
   #    xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
   #    xcce002 LIKE xcce_t.xcce002, #成本域
   #    xcce003 LIKE xcce_t.xcce003, #成本计算类型
   #    xcce004 LIKE xcce_t.xcce004, #年度
   #    xcce005 LIKE xcce_t.xcce005, #期别
   #    xcce006 LIKE xcce_t.xcce006, #工单编号
   #    xcce007 LIKE xcce_t.xcce007, #元件编号
   #    xcce008 LIKE xcce_t.xcce008, #产品特征
   #    xcce009 LIKE xcce_t.xcce009, #批号
   #    xcce010 LIKE xcce_t.xcce010, #核算币种
   #    xcce101 LIKE xcce_t.xcce101, #上期结存数量
   #    xcce102 LIKE xcce_t.xcce102, #上期结存金额
   #    xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
   #    xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
   #    xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
   #    xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
   #    xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
   #    xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
   #    xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
   #    xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
   #    xcce201 LIKE xcce_t.xcce201, #本期投入数量
   #    xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
   #    xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
   #    xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
   #    xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
   #    xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
   #    xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
   #    xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
   #    xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
   #    xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
   #    xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
   #    xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
   #    xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
   #    xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
   #    xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
   #    xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
   #    xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
   #    xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
   #    xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
   #    xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
   #    xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
   #    xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
   #    xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
   #    xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
   #    xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
   #    xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
   #    xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
   #    xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
   #    xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
   #    xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
   #    xcce209 LIKE xcce_t.xcce209, #本期超领退数量
   #    xcce210 LIKE xcce_t.xcce210, #本期超领退金额
   #    xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
   #    xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
   #    xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
   #    xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
   #    xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
   #    xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
   #    xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
   #    xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
   #    xcce301 LIKE xcce_t.xcce301, #本期转出数量
   #    xcce302 LIKE xcce_t.xcce302, #本期转出金额
   #    xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
   #    xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
   #    xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
   #    xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
   #    xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
   #    xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
   #    xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
   #    xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
   #    xcce303 LIKE xcce_t.xcce303, #差异转出数量
   #    xcce304 LIKE xcce_t.xcce304, #差异转出金额
   #    xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
   #    xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
   #    xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
   #    xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
   #    xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
   #    xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
   #    xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
   #    xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
   #    xcce307 LIKE xcce_t.xcce307, #盘差数量
   #    xcce308 LIKE xcce_t.xcce308, #盘差金额
   #    xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
   #    xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
   #    xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
   #    xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
   #    xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
   #    xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
   #    xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
   #    xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
   #    xcce901 LIKE xcce_t.xcce901, #期末结存数量
   #    xcce902 LIKE xcce_t.xcce902, #期末结存金额
   #    xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
   #    xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
   #    xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
   #    xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
   #    xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
   #    xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
   #    xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
   #    xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
   #    xccetime LIKE xcce_t.xccetime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE
   #说明:
   #xcce_t(在制元件成本期异动统计档)的来源:
   #(1)发料单--材料
   #(2)报工单--人工/制费
   #(3)完工入库单--人工/制费
   #(4)委外入库单--加工费

   INITIALIZE l_xcce.* TO NULL
       
   LET l_xcce.xcce101  = 0                   #上期结存数量        
   LET l_xcce.xcce102  = 0                   #上期结存金额        
   LET l_xcce.xcce102a = 0                   #上期结存金额-材料   
   LET l_xcce.xcce102b = 0                   #上期结存金额-人工   
   LET l_xcce.xcce102c = 0                   #上期结存金额-加工   
   LET l_xcce.xcce102d = 0                   #上期结存金额-制费一 
   LET l_xcce.xcce102e = 0                   #上期结存金额-制费二 
   LET l_xcce.xcce102f = 0                   #上期结存金额-制费三 
   LET l_xcce.xcce102g = 0                   #上期结存金额-制费四 
   LET l_xcce.xcce102h = 0                   #上期结存金额-制费五 
   
   LET l_xcce.xcce201  = 0                   #本期投入数量        
   LET l_xcce.xcce202  = 0                   #本期本阶投入金额        
   LET l_xcce.xcce202a = 0                   #本期本阶投入金额-材料   
   LET l_xcce.xcce202b = 0                   #本期本阶投入金额-人工   
   LET l_xcce.xcce202c = 0                   #本期本阶投入金额-加工   
   LET l_xcce.xcce202d = 0                   #本期本阶投入金额-制费一 
   LET l_xcce.xcce202e = 0                   #本期本阶投入金额-制费二 
   LET l_xcce.xcce202f = 0                   #本期本阶投入金额-制费三 
   LET l_xcce.xcce202g = 0                   #本期本阶投入金额-制费四 
   LET l_xcce.xcce202h = 0                   #本期本阶投入金额-制费五 
   
   LET l_xcce.xcce205  = 0                   #本期当站下线数量        
   LET l_xcce.xcce206  = 0                   #本期当站下线金额        
   LET l_xcce.xcce206a = 0                   #本期当站下线金额-材料   
   LET l_xcce.xcce206b = 0                   #本期当站下线金额-人工   
   LET l_xcce.xcce206c = 0                   #本期当站下线金额-加工   
   LET l_xcce.xcce206d = 0                   #本期当站下线金额-制费一 
   LET l_xcce.xcce206e = 0                   #本期当站下线金额-制费二 
   LET l_xcce.xcce206f = 0                   #本期当站下线金额-制费三 
   LET l_xcce.xcce206g = 0                   #本期当站下线金额-制费四 
   LET l_xcce.xcce206h = 0                   #本期当站下线金额-制费五 
   
   LET l_xcce.xcce207  = 0                   #本期一般退料数量        
   LET l_xcce.xcce208  = 0                   #本期一般退料金额        
   LET l_xcce.xcce208a = 0                   #本期一般退料金额-材料   
   LET l_xcce.xcce208b = 0                   #本期一般退料金额-人工   
   LET l_xcce.xcce208c = 0                   #本期一般退料金额-加工   
   LET l_xcce.xcce208d = 0                   #本期一般退料金额-制费一 
   LET l_xcce.xcce208e = 0                   #本期一般退料金额-制费二 
   LET l_xcce.xcce208f = 0                   #本期一般退料金额-制费三 
   LET l_xcce.xcce208g = 0                   #本期一般退料金额-制费四 
   LET l_xcce.xcce208h = 0                   #本期一般退料金额-制费五 

   LET l_xcce.xcce209  = 0                   #本期超领退数量            
   LET l_xcce.xcce210  = 0                   #本期超领退金额            
   LET l_xcce.xcce210a = 0                   #本期超领退金额-材料       
   LET l_xcce.xcce210b = 0                   #本期超领退金额-人工       
   LET l_xcce.xcce210c = 0                   #本期超领退金额-加工       
   LET l_xcce.xcce210d = 0                   #本期超领退金额-制费一     
   LET l_xcce.xcce210e = 0                   #本期超领退金额-制费二     
   LET l_xcce.xcce210f = 0                   #本期超领退金额-制费三     
   LET l_xcce.xcce210g = 0                   #本期超领退金额-制费四    
   LET l_xcce.xcce210h = 0                   #本期超领退金额-制费五   
    
   LET l_xcce.xcce301  = 0                   #本期转出数量        
   LET l_xcce.xcce302  = 0                   #本期转出金额        
   LET l_xcce.xcce302a = 0                   #本期转出金额-材料   
   LET l_xcce.xcce302b = 0                   #本期转出金额-人工   
   LET l_xcce.xcce302c = 0                   #本期转出金额-加工   
   LET l_xcce.xcce302d = 0                   #本期转出金额-制费一 
   LET l_xcce.xcce302e = 0                   #本期转出金额-制费二 
   LET l_xcce.xcce302f = 0                   #本期转出金额-制费三 
   LET l_xcce.xcce302g = 0                   #本期转出金额-制费四 
   LET l_xcce.xcce302h = 0                   #本期转出金额-制费五 
   
   LET l_xcce.xcce303  = 0                   #差异转出数量          
   LET l_xcce.xcce304  = 0                   #差异转出金额         
   LET l_xcce.xcce304a = 0                   #差异转出金额-材料     
   LET l_xcce.xcce304b = 0                   #差异转出金额-人工     
   LET l_xcce.xcce304c = 0                   #差异转出金额-加工     
   LET l_xcce.xcce304d = 0                   #差异转出金额-制费一   
   LET l_xcce.xcce304e = 0                   #差异转出金额-制费二   
   LET l_xcce.xcce304f = 0                   #差异转出金额-制费三   
   LET l_xcce.xcce304g = 0                   #差异转出金额-制费四   
   LET l_xcce.xcce304h = 0                   #差异转出金额-制费五   

   LET l_xcce.xcce307  = 0                   #盘差数量       
   LET l_xcce.xcce308  = 0                   #盘差金额       
   LET l_xcce.xcce308a = 0                   #盘差金额-材料  
   LET l_xcce.xcce308b = 0                   #盘差金额-人工  
   LET l_xcce.xcce308c = 0                   #盘差金额-加工  
   LET l_xcce.xcce308d = 0                   #盘差金额-制费一
   LET l_xcce.xcce308e = 0                   #盘差金额-制费二
   LET l_xcce.xcce308f = 0                   #盘差金额-制费三
   LET l_xcce.xcce308g = 0                   #盘差金额-制费四
   LET l_xcce.xcce308h = 0                   #盘差金额-制费五
   
   LET l_xcce.xcce901  = 0                   #期末结存数量           
   LET l_xcce.xcce902  = 0                   #期末结存金额           
   LET l_xcce.xcce902a = 0                   #期末结存金额-材料      
   LET l_xcce.xcce902b = 0                   #期末结存金额-人工      
   LET l_xcce.xcce902c = 0                   #期末结存金额-加工      
   LET l_xcce.xcce902d = 0                   #期末结存金额-制费一    
   LET l_xcce.xcce902e = 0                   #期末结存金额-制费二    
   LET l_xcce.xcce902f = 0                   #期末结存金额-制费三    
   LET l_xcce.xcce902g = 0                   #期末结存金额-制费四    
   LET l_xcce.xcce902h = 0                   #期末结存金额-制费五    
      
   LET r_xcce.* = l_xcce.*
   
   RETURN r_xcce.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xccg变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xccg0()
#                       RETURNING r_xccg.*
# Input parameter: NULL
# Return code....: r_xccg         xccg_t的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xccg0()
#   DEFINE r_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
#   DEFINE l_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
   DEFINE r_xccg             type_g_xccg  #170605-00013#1-add
   DEFINE l_xccg             type_g_xccg  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE l_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE l_xccg.* TO NULL
       
   LET l_xccg.xccg101  = 0                   #上期结存数量        
   LET l_xccg.xccg102  = 0                   #上期结存金额        
   LET l_xccg.xccg102a = 0                   #上期结存金额-材料   
   LET l_xccg.xccg102b = 0                   #上期结存金额-人工   
   LET l_xccg.xccg102c = 0                   #上期结存金额-加工   
   LET l_xccg.xccg102d = 0                   #上期结存金额-制费一 
   LET l_xccg.xccg102e = 0                   #上期结存金额-制费二 
   LET l_xccg.xccg102f = 0                   #上期结存金额-制费三 
   LET l_xccg.xccg102g = 0                   #上期结存金额-制费四 
   LET l_xccg.xccg102h = 0                   #上期结存金额-制费五 
      
   LET l_xccg.xccg301  = 0                   #本期转出数量        
   LET l_xccg.xccg302  = 0                   #本期转出金额        
   LET l_xccg.xccg302a = 0                   #本期转出金额-材料   
   LET l_xccg.xccg302b = 0                   #本期转出金额-人工   
   LET l_xccg.xccg302c = 0                   #本期转出金额-加工   
   LET l_xccg.xccg302d = 0                   #本期转出金额-制费一 
   LET l_xccg.xccg302e = 0                   #本期转出金额-制费二 
   LET l_xccg.xccg302f = 0                   #本期转出金额-制费三 
   LET l_xccg.xccg302g = 0                   #本期转出金额-制费四 
   LET l_xccg.xccg302h = 0                   #本期转出金额-制费五 
      
   LET l_xccg.xccg901  = 0                   #期末结存数量           
   LET l_xccg.xccg902  = 0                   #期末结存金额           
   LET l_xccg.xccg902a = 0                   #期末结存金额-材料      
   LET l_xccg.xccg902b = 0                   #期末结存金额-人工      
   LET l_xccg.xccg902c = 0                   #期末结存金额-加工      
   LET l_xccg.xccg902d = 0                   #期末结存金额-制费一    
   LET l_xccg.xccg902e = 0                   #期末结存金额-制费二    
   LET l_xccg.xccg902f = 0                   #期末结存金额-制费三    
   LET l_xccg.xccg902g = 0                   #期末结存金额-制费四    
   LET l_xccg.xccg902h = 0                   #期末结存金额-制费五    
      
   LET r_xccg.* = l_xccg.*
   
   RETURN r_xccg.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xcch变量                                             
# Memo...........:                                                              
# Usage..........: CALL s_axcp500_init_xcch0()                                     
#                       RETURNING r_xcch.*                                      
# Input parameter: NULL                                                         
# Return code....: r_xcch         xcch_t的TABLE资料                             
# Date & Author..: 2014-07-22 By Carrier                                        
# Modify.........:                                                              
################################################################################
PUBLIC FUNCTION s_axcp500_init_xcch0()
#   DEFINE r_xcch            RECORD LIKE xcch_t.*   #161124-00048#20 mark
#   DEFINE l_xcch            RECORD LIKE xcch_t.*   #161124-00048#20 mark
    DEFINE l_xcch            type_g_xcch  #170605-00013#1-add
    DEFINE r_xcch            type_g_xcch  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
#DEFINE r_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE l_xcch.* TO NULL
       
   LET l_xcch.xcch101  = 0        #上期结存数量           
   LET l_xcch.xcch102  = 0        #上期结存金额           
   LET l_xcch.xcch102a = 0        #上期结存金额-材料      
   LET l_xcch.xcch102b = 0        #上期结存金额-人工      
   LET l_xcch.xcch102c = 0        #上期结存金额-加工      
   LET l_xcch.xcch102d = 0        #上期结存金额-制费一    
   LET l_xcch.xcch102e = 0        #上期结存金额-制费二    
   LET l_xcch.xcch102f = 0        #上期结存金额-制费三    
   LET l_xcch.xcch102g = 0        #上期结存金额-制费四    
   LET l_xcch.xcch102h = 0        #上期结存金额-制费五   
    
   LET l_xcch.xcch200  = 0        #本期投入工时    
          
   LET l_xcch.xcch201  = 0        #本期投入数量           
   LET l_xcch.xcch202  = 0        #本期本阶投入金额       
   LET l_xcch.xcch202a = 0        #本期本阶投入金额-材料  
   LET l_xcch.xcch202b = 0        #本期本阶投入金额-人工  
   LET l_xcch.xcch202c = 0        #本期本阶投入金额-加工  
   LET l_xcch.xcch202d = 0        #本期本阶投入金额-制费一
   LET l_xcch.xcch202e = 0        #本期本阶投入金额-制费二
   LET l_xcch.xcch202f = 0        #本期本阶投入金额-制费三
   LET l_xcch.xcch202g = 0        #本期本阶投入金额-制费四
   LET l_xcch.xcch202h = 0        #本期本阶投入金额-制费五
   
   LET l_xcch.xcch204  = 0        #本期下阶投入金额       
   LET l_xcch.xcch204a = 0        #本期下阶投入金额-材料  
   LET l_xcch.xcch204b = 0        #本期下阶投入金额-人工  
   LET l_xcch.xcch204c = 0        #本期下阶投入金额-加工  
   LET l_xcch.xcch204d = 0        #本期下阶投入金额-制费一
   LET l_xcch.xcch204e = 0        #本期下阶投入金额-制费二
   LET l_xcch.xcch204f = 0        #本期下阶投入金额-制费三
   LET l_xcch.xcch204g = 0        #本期下阶投入金额-制费四
   LET l_xcch.xcch204h = 0        #本期下阶投入金额-制费五
   
   LET l_xcch.xcch301  = 0        #本期转出数量           
   LET l_xcch.xcch302  = 0        #本期转出金额           
   LET l_xcch.xcch302a = 0        #本期转出金额-材料      
   LET l_xcch.xcch302b = 0        #本期转出金额-人工      
   LET l_xcch.xcch302c = 0        #本期转出金额-加工      
   LET l_xcch.xcch302d = 0        #本期转出金额-制费一    
   LET l_xcch.xcch302e = 0        #本期转出金额-制费二    
   LET l_xcch.xcch302f = 0        #本期转出金额-制费三    
   LET l_xcch.xcch302g = 0        #本期转出金额-制费四    
   LET l_xcch.xcch302h = 0        #本期转出金额-制费五  
     
   LET l_xcch.xcch303  = 0        #差异转出数量           
   LET l_xcch.xcch304  = 0        #差异转出金额           
   LET l_xcch.xcch304a = 0        #差异转出金额-材料      
   LET l_xcch.xcch304b = 0        #差异转出金额-人工      
   LET l_xcch.xcch304c = 0        #差异转出金额-加工      
   LET l_xcch.xcch304d = 0        #差异转出金额-制费一    
   LET l_xcch.xcch304e = 0        #差异转出金额-制费二    
   LET l_xcch.xcch304f = 0        #差异转出金额-制费三    
   LET l_xcch.xcch304g = 0        #差异转出金额-制费四    
   LET l_xcch.xcch304h = 0        #差异转出金额-制费五  
     
   LET l_xcch.xcch901  = 0        #期末结存数量           
   LET l_xcch.xcch902  = 0        #期末结存金额           
   LET l_xcch.xcch902a = 0        #期末结存金额-材料      
   LET l_xcch.xcch902b = 0        #期末结存金额-人工      
   LET l_xcch.xcch902c = 0        #期末结存金额-加工      
   LET l_xcch.xcch902d = 0        #期末结存金额-制费一    
   LET l_xcch.xcch902e = 0        #期末结存金额-制费二    
   LET l_xcch.xcch902f = 0        #期末结存金额-制费三    
   LET l_xcch.xcch902g = 0        #期末结存金额-制费四    
   LET l_xcch.xcch902h = 0        #期末结存金额-制费五     
      
   LET r_xcch.* = l_xcch.*
   
   RETURN r_xcch.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xcci变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xcci0()
#                       RETURNING r_xcci.*
# Input parameter: NULL
# Return code....: r_xcci         xcci_t的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xcci0()
#   DEFINE r_xcci            RECORD LIKE xcci_t.*  #161124-00048#20 mark
#   DEFINE l_xcci            RECORD LIKE xcci_t.*  #161124-00048#20 mark
   DEFINE l_xcci             type_g_xcci #170605-00013#1-add
   DEFINE r_xcci             type_g_xcci #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE l_xcci.* TO NULL
       
   LET l_xcci.xcci101  = 0                   #上期结存数量        
   LET l_xcci.xcci102  = 0                   #上期结存金额        
   LET l_xcci.xcci102a = 0                   #上期结存金额-材料   
   LET l_xcci.xcci102b = 0                   #上期结存金额-人工   
   LET l_xcci.xcci102c = 0                   #上期结存金额-加工   
   LET l_xcci.xcci102d = 0                   #上期结存金额-制费一 
   LET l_xcci.xcci102e = 0                   #上期结存金额-制费二 
   LET l_xcci.xcci102f = 0                   #上期结存金额-制费三 
   LET l_xcci.xcci102g = 0                   #上期结存金额-制费四 
   LET l_xcci.xcci102h = 0                   #上期结存金额-制费五 
   
   LET l_xcci.xcci201  = 0                   #本期投入数量        
   LET l_xcci.xcci202  = 0                   #本期本阶投入金额        
   LET l_xcci.xcci202a = 0                   #本期本阶投入金额-材料   
   LET l_xcci.xcci202b = 0                   #本期本阶投入金额-人工   
   LET l_xcci.xcci202c = 0                   #本期本阶投入金额-加工   
   LET l_xcci.xcci202d = 0                   #本期本阶投入金额-制费一 
   LET l_xcci.xcci202e = 0                   #本期本阶投入金额-制费二 
   LET l_xcci.xcci202f = 0                   #本期本阶投入金额-制费三 
   LET l_xcci.xcci202g = 0                   #本期本阶投入金额-制费四 
   LET l_xcci.xcci202h = 0                   #本期本阶投入金额-制费五 
   
   LET l_xcci.xcci301  = 0                   #本期转出数量        
   LET l_xcci.xcci302  = 0                   #本期转出金额        
   LET l_xcci.xcci302a = 0                   #本期转出金额-材料   
   LET l_xcci.xcci302b = 0                   #本期转出金额-人工   
   LET l_xcci.xcci302c = 0                   #本期转出金额-加工   
   LET l_xcci.xcci302d = 0                   #本期转出金额-制费一 
   LET l_xcci.xcci302e = 0                   #本期转出金额-制费二 
   LET l_xcci.xcci302f = 0                   #本期转出金额-制费三 
   LET l_xcci.xcci302g = 0                   #本期转出金额-制费四 
   LET l_xcci.xcci302h = 0                   #本期转出金额-制费五 
   
   LET l_xcci.xcci303  = 0                   #差异转出数量          
   LET l_xcci.xcci304  = 0                   #差异转出金额         
   LET l_xcci.xcci304a = 0                   #差异转出金额-材料     
   LET l_xcci.xcci304b = 0                   #差异转出金额-人工     
   LET l_xcci.xcci304c = 0                   #差异转出金额-加工     
   LET l_xcci.xcci304d = 0                   #差异转出金额-制费一   
   LET l_xcci.xcci304e = 0                   #差异转出金额-制费二   
   LET l_xcci.xcci304f = 0                   #差异转出金额-制费三   
   LET l_xcci.xcci304g = 0                   #差异转出金额-制费四   
   LET l_xcci.xcci304h = 0                   #差异转出金额-制费五   
   
   LET l_xcci.xcci901  = 0                   #期末结存数量           
   LET l_xcci.xcci902  = 0                   #期末结存金额           
   LET l_xcci.xcci902a = 0                   #期末结存金额-材料      
   LET l_xcci.xcci902b = 0                   #期末结存金额-人工      
   LET l_xcci.xcci902c = 0                   #期末结存金额-加工      
   LET l_xcci.xcci902d = 0                   #期末结存金额-制费一    
   LET l_xcci.xcci902e = 0                   #期末结存金额-制费二    
   LET l_xcci.xcci902f = 0                   #期末结存金额-制费三    
   LET l_xcci.xcci902g = 0                   #期末结存金额-制费四    
   LET l_xcci.xcci902h = 0                   #期末结存金额-制费五    
      
   LET r_xcci.* = l_xcci.*
   
   RETURN r_xcci.*
END FUNCTION

################################################################################
# Descriptions...: 初始化g_xccz变量
# Memo...........:
# Usage..........: CALL s_axcp500_init_xccz0()
#                       RETURNING r_xccz.*
# Input parameter: NULL
# Return code....: r_xccz         xccz_t的TABLE资料
# Date & Author..: 2014-09-01 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_init_xccz0()
#   DEFINE r_xccz            RECORD LIKE xccz_t.*  #161124-00048#20 mark
#   DEFINE l_xccz            RECORD LIKE xccz_t.*  #161124-00048#20 mark
   DEFINE r_xccz             type_g_xccz  #170605-00013#1-add
   DEFINE l_xccz             type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE l_xccz.* TO NULL
       
   LET l_xccz.xccz101 = 0      #上期结存数量      
   LET l_xccz.xccz201 = 0      #本期投入数量      
   LET l_xccz.xccz205 = 0      #本期当站下线数量  
   LET l_xccz.xccz207 = 0      #本期一般退料数量  
   LET l_xccz.xccz209 = 0      #本期超领退数量    
   LET l_xccz.xccz301 = 0      #本期转出数量      
   LET l_xccz.xccz303 = 0      #差异转出数量      
   LET l_xccz.xccz307 = 0      #盘差数量          
   LET l_xccz.xccz901 = 0      #期末结存数量      
      
   LET r_xccz.* = l_xccz.*
   
   RETURN r_xccz.*
END FUNCTION

################################################################################
# Descriptions...: xccq重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccq_null_to_zero(p_xccq)
#                       RETURNING r_xccq
# Input parameter: p_xccq         xccq的TABLE资料
# Return code....: r_xccq         xccq的TABLE资料
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccq_null_to_zero(p_xccq)
#   DEFINE p_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE p_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE r_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE r_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF p_xccq.xccq002 IS NULL THEN LET p_xccq.xccq002 = ' ' END IF      #成本域            
   IF p_xccq.xccq007 IS NULL THEN LET p_xccq.xccq007 = ' ' END IF      #产品特征
   IF p_xccq.xccq008 IS NULL THEN LET p_xccq.xccq008 = ' ' END IF      #批号
   IF p_xccq.xccq009 IS NULL THEN LET p_xccq.xccq009 = ' ' END IF      #庫存管理特徵
   IF p_xccq.xccq010 IS NULL THEN LET p_xccq.xccq010 = ' ' END IF      #倉庫
   IF p_xccq.xccq011 IS NULL THEN LET p_xccq.xccq011 = ' ' END IF      #儲位
   IF p_xccq.xccq012 IS NULL THEN LET p_xccq.xccq012 = ' ' END IF      #品類

   IF cl_null(p_xccq.xccq101 ) THEN LET p_xccq.xccq101  = 0 END IF     #上期结存数量        
   IF cl_null(p_xccq.xccq102 ) THEN LET p_xccq.xccq102  = 0 END IF     #上期结存金额        
   IF cl_null(p_xccq.xccq102a) THEN LET p_xccq.xccq102a = 0 END IF     #上期结存金额-材料   
   IF cl_null(p_xccq.xccq102b) THEN LET p_xccq.xccq102b = 0 END IF     #上期结存金额-人工   
   IF cl_null(p_xccq.xccq102c) THEN LET p_xccq.xccq102c = 0 END IF     #上期结存金额-加工   
   IF cl_null(p_xccq.xccq102d) THEN LET p_xccq.xccq102d = 0 END IF     #上期结存金额-制费一 
   IF cl_null(p_xccq.xccq102e) THEN LET p_xccq.xccq102e = 0 END IF     #上期结存金额-制费二 
   IF cl_null(p_xccq.xccq102f) THEN LET p_xccq.xccq102f = 0 END IF     #上期结存金额-制费三 
   IF cl_null(p_xccq.xccq102g) THEN LET p_xccq.xccq102g = 0 END IF     #上期结存金额-制费四 
   IF cl_null(p_xccq.xccq102h) THEN LET p_xccq.xccq102h = 0 END IF     #上期结存金额-制费五 
   
   IF cl_null(p_xccq.xccq201 ) THEN LET p_xccq.xccq201  = 0 END IF     #本期采购入库数量        
   IF cl_null(p_xccq.xccq202 ) THEN LET p_xccq.xccq202  = 0 END IF     #本期采购入库金额        
   IF cl_null(p_xccq.xccq202a) THEN LET p_xccq.xccq202a = 0 END IF     #本期采购入库金额-材料   
   IF cl_null(p_xccq.xccq202b) THEN LET p_xccq.xccq202b = 0 END IF     #本期采购入库金额-人工   
   IF cl_null(p_xccq.xccq202c) THEN LET p_xccq.xccq202c = 0 END IF     #本期采购入库金额-加工   
   IF cl_null(p_xccq.xccq202d) THEN LET p_xccq.xccq202d = 0 END IF     #本期采购入库金额-制费一 
   IF cl_null(p_xccq.xccq202e) THEN LET p_xccq.xccq202e = 0 END IF     #本期采购入库金额-制费二 
   IF cl_null(p_xccq.xccq202f) THEN LET p_xccq.xccq202f = 0 END IF     #本期采购入库金额-制费三 
   IF cl_null(p_xccq.xccq202g) THEN LET p_xccq.xccq202g = 0 END IF     #本期采购入库金额-制费四 
   IF cl_null(p_xccq.xccq202h) THEN LET p_xccq.xccq202h = 0 END IF     #本期采购入库金额-制费五   
    
   IF cl_null(p_xccq.xccq203 ) THEN LET p_xccq.xccq203  = 0 END IF     #本期委外入库数量        
   IF cl_null(p_xccq.xccq204 ) THEN LET p_xccq.xccq204  = 0 END IF     #本期委外入库金额        
   IF cl_null(p_xccq.xccq204a) THEN LET p_xccq.xccq204a = 0 END IF     #本期委外入库金额-材料   
   IF cl_null(p_xccq.xccq204b) THEN LET p_xccq.xccq204b = 0 END IF     #本期委外入库金额-人工   
   IF cl_null(p_xccq.xccq204c) THEN LET p_xccq.xccq204c = 0 END IF     #本期委外入库金额-加工   
   IF cl_null(p_xccq.xccq204d) THEN LET p_xccq.xccq204d = 0 END IF     #本期委外入库金额-制费一 
   IF cl_null(p_xccq.xccq204e) THEN LET p_xccq.xccq204e = 0 END IF     #本期委外入库金额-制费二 
   IF cl_null(p_xccq.xccq204f) THEN LET p_xccq.xccq204f = 0 END IF     #本期委外入库金额-制费三 
   IF cl_null(p_xccq.xccq204g) THEN LET p_xccq.xccq204g = 0 END IF     #本期委外入库金额-制费四 
   IF cl_null(p_xccq.xccq204h) THEN LET p_xccq.xccq204h = 0 END IF     #本期委外入库金额-制费五 
      
   IF cl_null(p_xccq.xccq205 ) THEN LET p_xccq.xccq205  = 0 END IF     #本期工单入库数量        
   IF cl_null(p_xccq.xccq206 ) THEN LET p_xccq.xccq206  = 0 END IF     #本期工单入库金额        
   IF cl_null(p_xccq.xccq206a) THEN LET p_xccq.xccq206a = 0 END IF     #本期工单入库金额-材料  
   IF cl_null(p_xccq.xccq206b) THEN LET p_xccq.xccq206b = 0 END IF     #本期工单入库金额-人工  
   IF cl_null(p_xccq.xccq206c) THEN LET p_xccq.xccq206c = 0 END IF     #本期工单入库金额-加工  
   IF cl_null(p_xccq.xccq206d) THEN LET p_xccq.xccq206d = 0 END IF     #本期工单入库金额-制费一
   IF cl_null(p_xccq.xccq206e) THEN LET p_xccq.xccq206e = 0 END IF     #本期工单入库金额-制费二
   IF cl_null(p_xccq.xccq206f) THEN LET p_xccq.xccq206f = 0 END IF     #本期工单入库金额-制费三
   IF cl_null(p_xccq.xccq206g) THEN LET p_xccq.xccq206g = 0 END IF     #本期工单入库金额-制费四
   IF cl_null(p_xccq.xccq206h) THEN LET p_xccq.xccq206h = 0 END IF     #本期工单入库金额-制费五   
   
   IF cl_null(p_xccq.xccq207 ) THEN LET p_xccq.xccq207  = 0 END IF     #本期重工领出数量       
   IF cl_null(p_xccq.xccq208 ) THEN LET p_xccq.xccq208  = 0 END IF     #本期重工领出金额       
   IF cl_null(p_xccq.xccq208a) THEN LET p_xccq.xccq208a = 0 END IF     #本期重工领出金额-材料  
   IF cl_null(p_xccq.xccq208b) THEN LET p_xccq.xccq208b = 0 END IF     #本期重工领出金额-人工  
   IF cl_null(p_xccq.xccq208c) THEN LET p_xccq.xccq208c = 0 END IF     #本期重工领出金额-加工  
   IF cl_null(p_xccq.xccq208d) THEN LET p_xccq.xccq208d = 0 END IF     #本期重工领出金额-制费一
   IF cl_null(p_xccq.xccq208e) THEN LET p_xccq.xccq208e = 0 END IF     #本期重工领出金额-制费二
   IF cl_null(p_xccq.xccq208f) THEN LET p_xccq.xccq208f = 0 END IF     #本期重工领出金额-制费三
   IF cl_null(p_xccq.xccq208g) THEN LET p_xccq.xccq208g = 0 END IF     #本期重工领出金额-制费四
   IF cl_null(p_xccq.xccq208h) THEN LET p_xccq.xccq208h = 0 END IF     #本期重工领出金额-制费五   
   
   IF cl_null(p_xccq.xccq209 ) THEN LET p_xccq.xccq209  = 0 END IF     #本期重工入库数量       
   IF cl_null(p_xccq.xccq210 ) THEN LET p_xccq.xccq210  = 0 END IF     #本期重工入库金额       
   IF cl_null(p_xccq.xccq210a) THEN LET p_xccq.xccq210a = 0 END IF     #本期重工入库金额-材料  
   IF cl_null(p_xccq.xccq210b) THEN LET p_xccq.xccq210b = 0 END IF     #本期重工入库金额-人工  
   IF cl_null(p_xccq.xccq210c) THEN LET p_xccq.xccq210c = 0 END IF     #本期重工入库金额-加工  
   IF cl_null(p_xccq.xccq210d) THEN LET p_xccq.xccq210d = 0 END IF     #本期重工入库金额-制费一
   IF cl_null(p_xccq.xccq210e) THEN LET p_xccq.xccq210e = 0 END IF     #本期重工入库金额-制费二
   IF cl_null(p_xccq.xccq210f) THEN LET p_xccq.xccq210f = 0 END IF     #本期重工入库金额-制费三
   IF cl_null(p_xccq.xccq210g) THEN LET p_xccq.xccq210g = 0 END IF     #本期重工入库金额-制费四
   IF cl_null(p_xccq.xccq210h) THEN LET p_xccq.xccq210h = 0 END IF     #本期重工入库金额-制费五    
   
   IF cl_null(p_xccq.xccq211 ) THEN LET p_xccq.xccq211  = 0 END IF     #本期杂项入库数量       
   IF cl_null(p_xccq.xccq212 ) THEN LET p_xccq.xccq212  = 0 END IF     #本期杂项入库金额       
   IF cl_null(p_xccq.xccq212a) THEN LET p_xccq.xccq212a = 0 END IF     #本期杂项入库金额-材料  
   IF cl_null(p_xccq.xccq212b) THEN LET p_xccq.xccq212b = 0 END IF     #本期杂项入库金额-人工  
   IF cl_null(p_xccq.xccq212c) THEN LET p_xccq.xccq212c = 0 END IF     #本期杂项入库金额-加工  
   IF cl_null(p_xccq.xccq212d) THEN LET p_xccq.xccq212d = 0 END IF     #本期杂项入库金额-制费一
   IF cl_null(p_xccq.xccq212e) THEN LET p_xccq.xccq212e = 0 END IF     #本期杂项入库金额-制费二
   IF cl_null(p_xccq.xccq212f) THEN LET p_xccq.xccq212f = 0 END IF     #本期杂项入库金额-制费三
   IF cl_null(p_xccq.xccq212g) THEN LET p_xccq.xccq212g = 0 END IF     #本期杂项入库金额-制费四
   IF cl_null(p_xccq.xccq212h) THEN LET p_xccq.xccq212h = 0 END IF     #本期杂项入库金额-制费五  
    
   IF cl_null(p_xccq.xccq213 ) THEN LET p_xccq.xccq213  = 0 END IF     #本期调整入库数量       
   IF cl_null(p_xccq.xccq214 ) THEN LET p_xccq.xccq214  = 0 END IF     #本期调整入库金额       
   IF cl_null(p_xccq.xccq214a) THEN LET p_xccq.xccq214a = 0 END IF     #本期调整入库金额-材料  
   IF cl_null(p_xccq.xccq214b) THEN LET p_xccq.xccq214b = 0 END IF     #本期调整入库金额-人工  
   IF cl_null(p_xccq.xccq214c) THEN LET p_xccq.xccq214c = 0 END IF     #本期调整入库金额-加工  
   IF cl_null(p_xccq.xccq214d) THEN LET p_xccq.xccq214d = 0 END IF     #本期调整入库金额-制费一
   IF cl_null(p_xccq.xccq214e) THEN LET p_xccq.xccq214e = 0 END IF     #本期调整入库金额-制费二
   IF cl_null(p_xccq.xccq214f) THEN LET p_xccq.xccq214f = 0 END IF     #本期调整入库金额-制费三
   IF cl_null(p_xccq.xccq214g) THEN LET p_xccq.xccq214g = 0 END IF     #本期调整入库金额-制费四
   IF cl_null(p_xccq.xccq214h) THEN LET p_xccq.xccq214h = 0 END IF     #本期调整入库金额-制费五  
    
   IF cl_null(p_xccq.xccq215 ) THEN LET p_xccq.xccq215  = 0 END IF     #本期销退入库数量       
   IF cl_null(p_xccq.xccq216 ) THEN LET p_xccq.xccq216  = 0 END IF     #本期销退入库金额       
   IF cl_null(p_xccq.xccq216a) THEN LET p_xccq.xccq216a = 0 END IF     #本期销退入库金额-材料  
   IF cl_null(p_xccq.xccq216b) THEN LET p_xccq.xccq216b = 0 END IF     #本期销退入库金额-人工  
   IF cl_null(p_xccq.xccq216c) THEN LET p_xccq.xccq216c = 0 END IF     #本期销退入库金额-加工  
   IF cl_null(p_xccq.xccq216d) THEN LET p_xccq.xccq216d = 0 END IF     #本期销退入库金额-制费一
   IF cl_null(p_xccq.xccq216e) THEN LET p_xccq.xccq216e = 0 END IF     #本期销退入库金额-制费二
   IF cl_null(p_xccq.xccq216f) THEN LET p_xccq.xccq216f = 0 END IF     #本期销退入库金额-制费三
   IF cl_null(p_xccq.xccq216g) THEN LET p_xccq.xccq216g = 0 END IF     #本期销退入库金额-制费四
   IF cl_null(p_xccq.xccq216h) THEN LET p_xccq.xccq216h = 0 END IF     #本期销退入库金额-制费五 
    
   IF cl_null(p_xccq.xccq217 ) THEN LET p_xccq.xccq217  = 0 END IF     #本期其他入库数量       
   IF cl_null(p_xccq.xccq218 ) THEN LET p_xccq.xccq218  = 0 END IF     #本期其他入库金额       
   IF cl_null(p_xccq.xccq218a) THEN LET p_xccq.xccq218a = 0 END IF     #本期其他入库金额-材料  
   IF cl_null(p_xccq.xccq218b) THEN LET p_xccq.xccq218b = 0 END IF     #本期其他入库金额-人工  
   IF cl_null(p_xccq.xccq218c) THEN LET p_xccq.xccq218c = 0 END IF     #本期其他入库金额-加工  
   IF cl_null(p_xccq.xccq218d) THEN LET p_xccq.xccq218d = 0 END IF     #本期其他入库金额-制费一
   IF cl_null(p_xccq.xccq218e) THEN LET p_xccq.xccq218e = 0 END IF     #本期其他入库金额-制费二
   IF cl_null(p_xccq.xccq218f) THEN LET p_xccq.xccq218f = 0 END IF     #本期其他入库金额-制费三
   IF cl_null(p_xccq.xccq218g) THEN LET p_xccq.xccq218g = 0 END IF     #本期其他入库金额-制费四 
   IF cl_null(p_xccq.xccq218h) THEN LET p_xccq.xccq218h = 0 END IF     #本期其他入库金额-制费五     
   
   IF cl_null(p_xccq.xccq280 ) THEN LET p_xccq.xccq280  = 0 END IF     #本期平均单价            
   IF cl_null(p_xccq.xccq280a) THEN LET p_xccq.xccq280a = 0 END IF     #本期平均单价-材料       
   IF cl_null(p_xccq.xccq280b) THEN LET p_xccq.xccq280b = 0 END IF     #本期平均单价-人工       
   IF cl_null(p_xccq.xccq280c) THEN LET p_xccq.xccq280c = 0 END IF     #本期平均单价-加工       
   IF cl_null(p_xccq.xccq280d) THEN LET p_xccq.xccq280d = 0 END IF     #本期平均单价-制费一     
   IF cl_null(p_xccq.xccq280e) THEN LET p_xccq.xccq280e = 0 END IF     #本期平均单价-制费二     
   IF cl_null(p_xccq.xccq280f) THEN LET p_xccq.xccq280f = 0 END IF     #本期平均单价-制费三     
   IF cl_null(p_xccq.xccq280g) THEN LET p_xccq.xccq280g = 0 END IF     #本期平均单价-制费四     
   IF cl_null(p_xccq.xccq280h) THEN LET p_xccq.xccq280h = 0 END IF     #本期平均单价-制费五         
   
   IF cl_null(p_xccq.xccq301 ) THEN LET p_xccq.xccq301  = 0 END IF     #本期工单领用数量        
   IF cl_null(p_xccq.xccq302 ) THEN LET p_xccq.xccq302  = 0 END IF     #本期工单领用金额        
   IF cl_null(p_xccq.xccq302a) THEN LET p_xccq.xccq302a = 0 END IF     #本期工单领用金额-材料   
   IF cl_null(p_xccq.xccq302b) THEN LET p_xccq.xccq302b = 0 END IF     #本期工单领用金额-人工   
   IF cl_null(p_xccq.xccq302c) THEN LET p_xccq.xccq302c = 0 END IF     #本期工单领用金额-加工   
   IF cl_null(p_xccq.xccq302d) THEN LET p_xccq.xccq302d = 0 END IF     #本期工单领用金额-制费一 
   IF cl_null(p_xccq.xccq302e) THEN LET p_xccq.xccq302e = 0 END IF     #本期工单领用金额-制费二 
   IF cl_null(p_xccq.xccq302f) THEN LET p_xccq.xccq302f = 0 END IF     #本期工单领用金额-制费三 
   IF cl_null(p_xccq.xccq302g) THEN LET p_xccq.xccq302g = 0 END IF     #本期工单领用金额-制费四 
   IF cl_null(p_xccq.xccq302h) THEN LET p_xccq.xccq302h = 0 END IF     #本期工单领用金额-制费五    
   
   IF cl_null(p_xccq.xccq303 ) THEN LET p_xccq.xccq303  = 0 END IF     #本期销货数量            
   IF cl_null(p_xccq.xccq304 ) THEN LET p_xccq.xccq304  = 0 END IF     #本期销货成本            
   IF cl_null(p_xccq.xccq304a) THEN LET p_xccq.xccq304a = 0 END IF     #本期销货成本-材料       
   IF cl_null(p_xccq.xccq304b) THEN LET p_xccq.xccq304b = 0 END IF     #本期销货成本-人工       
   IF cl_null(p_xccq.xccq304c) THEN LET p_xccq.xccq304c = 0 END IF     #本期销货成本-加工       
   IF cl_null(p_xccq.xccq304d) THEN LET p_xccq.xccq304d = 0 END IF     #本期销货成本-制费一     
   IF cl_null(p_xccq.xccq304e) THEN LET p_xccq.xccq304e = 0 END IF     #本期销货成本-制费二     
   IF cl_null(p_xccq.xccq304f) THEN LET p_xccq.xccq304f = 0 END IF     #本期销货成本-制费三     
   IF cl_null(p_xccq.xccq304g) THEN LET p_xccq.xccq304g = 0 END IF     #本期销货成本-制费四     
   IF cl_null(p_xccq.xccq304h) THEN LET p_xccq.xccq304h = 0 END IF     #本期销货成本-制费五   
   
   IF cl_null(p_xccq.xccq305 ) THEN LET p_xccq.xccq305  = 0 END IF     #本期销退数量            
   IF cl_null(p_xccq.xccq306 ) THEN LET p_xccq.xccq306  = 0 END IF     #本期销退成本            
   IF cl_null(p_xccq.xccq306a) THEN LET p_xccq.xccq306a = 0 END IF     #本期销退成本-材料       
   IF cl_null(p_xccq.xccq306b) THEN LET p_xccq.xccq306b = 0 END IF     #本期销退成本-人工       
   IF cl_null(p_xccq.xccq306c) THEN LET p_xccq.xccq306c = 0 END IF     #本期销退成本-加工       
   IF cl_null(p_xccq.xccq306d) THEN LET p_xccq.xccq306d = 0 END IF     #本期销退成本-制费一     
   IF cl_null(p_xccq.xccq306e) THEN LET p_xccq.xccq306e = 0 END IF     #本期销退成本-制费二     
   IF cl_null(p_xccq.xccq306f) THEN LET p_xccq.xccq306f = 0 END IF     #本期销退成本-制费三     
   IF cl_null(p_xccq.xccq306g) THEN LET p_xccq.xccq306g = 0 END IF     #本期销退成本-制费四    
   IF cl_null(p_xccq.xccq306h) THEN LET p_xccq.xccq306h = 0 END IF     #本期销退成本-制费五     
     
   IF cl_null(p_xccq.xccq307 ) THEN LET p_xccq.xccq307  = 0 END IF     #本期销售费用数量       
   IF cl_null(p_xccq.xccq308 ) THEN LET p_xccq.xccq308  = 0 END IF     #本期销售费用成本       
   IF cl_null(p_xccq.xccq308a) THEN LET p_xccq.xccq308a = 0 END IF     #本期销售费用成本-材料  
   IF cl_null(p_xccq.xccq308b) THEN LET p_xccq.xccq308b = 0 END IF     #本期销售费用成本-人工  
   IF cl_null(p_xccq.xccq308c) THEN LET p_xccq.xccq308c = 0 END IF     #本期销售费用成本-加工  
   IF cl_null(p_xccq.xccq308d) THEN LET p_xccq.xccq308d = 0 END IF     #本期销售费用成本-制费一
   IF cl_null(p_xccq.xccq308e) THEN LET p_xccq.xccq308e = 0 END IF     #本期销售费用成本-制费二
   IF cl_null(p_xccq.xccq308f) THEN LET p_xccq.xccq308f = 0 END IF     #本期销售费用成本-制费三
   IF cl_null(p_xccq.xccq308g) THEN LET p_xccq.xccq308g = 0 END IF     #本期销售费用成本-制费四
   IF cl_null(p_xccq.xccq308h) THEN LET p_xccq.xccq308h = 0 END IF     #本期销售费用成本-制费五    
   
   IF cl_null(p_xccq.xccq309 ) THEN LET p_xccq.xccq309  = 0 END IF     #本期杂发数量           
   IF cl_null(p_xccq.xccq310 ) THEN LET p_xccq.xccq310  = 0 END IF     #本期杂发金额           
   IF cl_null(p_xccq.xccq310a) THEN LET p_xccq.xccq310a = 0 END IF     #本期杂发金额-材料      
   IF cl_null(p_xccq.xccq310b) THEN LET p_xccq.xccq310b = 0 END IF     #本期杂发金额-人工      
   IF cl_null(p_xccq.xccq310c) THEN LET p_xccq.xccq310c = 0 END IF     #本期杂发金额-加工      
   IF cl_null(p_xccq.xccq310d) THEN LET p_xccq.xccq310d = 0 END IF     #本期杂发金额-制费一    
   IF cl_null(p_xccq.xccq310e) THEN LET p_xccq.xccq310e = 0 END IF     #本期杂发金额-制费二    
   IF cl_null(p_xccq.xccq310f) THEN LET p_xccq.xccq310f = 0 END IF     #本期杂发金额-制费三    
   IF cl_null(p_xccq.xccq310g) THEN LET p_xccq.xccq310g = 0 END IF     #本期杂发金额-制费四    
   IF cl_null(p_xccq.xccq310h) THEN LET p_xccq.xccq310h = 0 END IF     #本期杂发金额-制费五      
    
   IF cl_null(p_xccq.xccq311 ) THEN LET p_xccq.xccq311  = 0 END IF     #本期盘盈亏数量         
   IF cl_null(p_xccq.xccq312 ) THEN LET p_xccq.xccq312  = 0 END IF     #本期盘盈亏金额         
   IF cl_null(p_xccq.xccq312a) THEN LET p_xccq.xccq312a = 0 END IF     #本期盘盈亏金额-材料    
   IF cl_null(p_xccq.xccq312b) THEN LET p_xccq.xccq312b = 0 END IF     #本期盘盈亏金额-人工    
   IF cl_null(p_xccq.xccq312c) THEN LET p_xccq.xccq312c = 0 END IF     #本期盘盈亏金额-加工    
   IF cl_null(p_xccq.xccq312d) THEN LET p_xccq.xccq312d = 0 END IF     #本期盘盈亏金额-制费一  
   IF cl_null(p_xccq.xccq312e) THEN LET p_xccq.xccq312e = 0 END IF     #本期盘盈亏金额-制费二  
   IF cl_null(p_xccq.xccq312f) THEN LET p_xccq.xccq312f = 0 END IF     #本期盘盈亏金额-制费三  
   IF cl_null(p_xccq.xccq312g) THEN LET p_xccq.xccq312g = 0 END IF     #本期盘盈亏金额-制费四  
   IF cl_null(p_xccq.xccq312h) THEN LET p_xccq.xccq312h = 0 END IF     #本期盘盈亏金额-制费五     
   
   IF cl_null(p_xccq.xccq313 ) THEN LET p_xccq.xccq313  = 0 END IF     #本期其他出库数量       
   IF cl_null(p_xccq.xccq314 ) THEN LET p_xccq.xccq314  = 0 END IF     #本期其他出库金额       
   IF cl_null(p_xccq.xccq314a) THEN LET p_xccq.xccq314a = 0 END IF     #本期其他出库金额-材料  
   IF cl_null(p_xccq.xccq314b) THEN LET p_xccq.xccq314b = 0 END IF     #本期其他出库金额-人工  
   IF cl_null(p_xccq.xccq314c) THEN LET p_xccq.xccq314c = 0 END IF     #本期其他出库金额-加工  
   IF cl_null(p_xccq.xccq314d) THEN LET p_xccq.xccq314d = 0 END IF     #本期其他出库金额-制费一
   IF cl_null(p_xccq.xccq314e) THEN LET p_xccq.xccq314e = 0 END IF     #本期其他出库金额-制费二
   IF cl_null(p_xccq.xccq314f) THEN LET p_xccq.xccq314f = 0 END IF     #本期其他出库金额-制费三
   IF cl_null(p_xccq.xccq314g) THEN LET p_xccq.xccq314g = 0 END IF     #本期其他出库金额-制费四
   IF cl_null(p_xccq.xccq314h) THEN LET p_xccq.xccq314h = 0 END IF     #本期其他出库金额-制费五     
   
   IF cl_null(p_xccq.xccq401 ) THEN LET p_xccq.xccq401  = 0 END IF     #本期销货收入金额       
   IF cl_null(p_xccq.xccq402 ) THEN LET p_xccq.xccq402  = 0 END IF     #本期销退金额              
   IF cl_null(p_xccq.xccq901 ) THEN LET p_xccq.xccq901  = 0 END IF     #期末结存数量           
   IF cl_null(p_xccq.xccq902 ) THEN LET p_xccq.xccq902  = 0 END IF     #期末结存金额           
   IF cl_null(p_xccq.xccq902a) THEN LET p_xccq.xccq902a = 0 END IF     #期末结存金额-材料      
   IF cl_null(p_xccq.xccq902b) THEN LET p_xccq.xccq902b = 0 END IF     #期末结存金额-人工      
   IF cl_null(p_xccq.xccq902c) THEN LET p_xccq.xccq902c = 0 END IF     #期末结存金额-加工      
   IF cl_null(p_xccq.xccq902d) THEN LET p_xccq.xccq902d = 0 END IF     #期末结存金额-制费一    
   IF cl_null(p_xccq.xccq902e) THEN LET p_xccq.xccq902e = 0 END IF     #期末结存金额-制费二    
   IF cl_null(p_xccq.xccq902f) THEN LET p_xccq.xccq902f = 0 END IF     #期末结存金额-制费三    
   IF cl_null(p_xccq.xccq902g) THEN LET p_xccq.xccq902g = 0 END IF     #期末结存金额-制费四    
   IF cl_null(p_xccq.xccq902h) THEN LET p_xccq.xccq902h = 0 END IF     #期末结存金额-制费五      
    
   IF cl_null(p_xccq.xccq903 ) THEN LET p_xccq.xccq903  = 0 END IF     #期末结存调整金额       
   IF cl_null(p_xccq.xccq903a) THEN LET p_xccq.xccq903a = 0 END IF     #期末结存调整金额-材料  
   IF cl_null(p_xccq.xccq903b) THEN LET p_xccq.xccq903b = 0 END IF     #期末结存调整金额-人工  
   IF cl_null(p_xccq.xccq903c) THEN LET p_xccq.xccq903c = 0 END IF     #期末结存调整金额-加工  
   IF cl_null(p_xccq.xccq903d) THEN LET p_xccq.xccq903d = 0 END IF     #期末结存调整金额-制费一
   IF cl_null(p_xccq.xccq903e) THEN LET p_xccq.xccq903e = 0 END IF     #期末结存调整金额-制费二
   IF cl_null(p_xccq.xccq903f) THEN LET p_xccq.xccq903f = 0 END IF     #期末结存调整金额-制费三
   IF cl_null(p_xccq.xccq903g) THEN LET p_xccq.xccq903g = 0 END IF     #期末结存调整金额-制费四
   IF cl_null(p_xccq.xccq903h) THEN LET p_xccq.xccq903h = 0 END IF     #期末结存调整金额-制费五
   
   LET r_xccq.* = p_xccq.*
   
   RETURN r_xccq.*
END FUNCTION

################################################################################
# Descriptions...: xccc重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccc_null_to_zero(p_xccc)
#                       RETURNING r_xccc
# Input parameter: p_xccc         xccc的TABLE资料
# Return code....: r_xccc         xccc的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccc_null_to_zero(p_xccc)
#   DEFINE p_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE p_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE r_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE r_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF p_xccc.xccc002 IS NULL THEN LET p_xccc.xccc002 = ' ' END IF      #成本域            
   IF p_xccc.xccc007 IS NULL THEN LET p_xccc.xccc007 = ' ' END IF      #产品特征            
   IF p_xccc.xccc008 IS NULL THEN LET p_xccc.xccc008 = ' ' END IF      #批号            

   IF cl_null(p_xccc.xccc101 ) THEN LET p_xccc.xccc101  = 0 END IF     #上期结存数量        
   IF cl_null(p_xccc.xccc102 ) THEN LET p_xccc.xccc102  = 0 END IF     #上期结存金额        
   IF cl_null(p_xccc.xccc102a) THEN LET p_xccc.xccc102a = 0 END IF     #上期结存金额-材料   
   IF cl_null(p_xccc.xccc102b) THEN LET p_xccc.xccc102b = 0 END IF     #上期结存金额-人工   
   IF cl_null(p_xccc.xccc102c) THEN LET p_xccc.xccc102c = 0 END IF     #上期结存金额-加工   
   IF cl_null(p_xccc.xccc102d) THEN LET p_xccc.xccc102d = 0 END IF     #上期结存金额-制费一 
   IF cl_null(p_xccc.xccc102e) THEN LET p_xccc.xccc102e = 0 END IF     #上期结存金额-制费二 
   IF cl_null(p_xccc.xccc102f) THEN LET p_xccc.xccc102f = 0 END IF     #上期结存金额-制费三 
   IF cl_null(p_xccc.xccc102g) THEN LET p_xccc.xccc102g = 0 END IF     #上期结存金额-制费四 
   IF cl_null(p_xccc.xccc102h) THEN LET p_xccc.xccc102h = 0 END IF     #上期结存金额-制费五 
   
   IF cl_null(p_xccc.xccc201 ) THEN LET p_xccc.xccc201  = 0 END IF     #本期采购入库数量        
   IF cl_null(p_xccc.xccc202 ) THEN LET p_xccc.xccc202  = 0 END IF     #本期采购入库金额        
   IF cl_null(p_xccc.xccc202a) THEN LET p_xccc.xccc202a = 0 END IF     #本期采购入库金额-材料   
   IF cl_null(p_xccc.xccc202b) THEN LET p_xccc.xccc202b = 0 END IF     #本期采购入库金额-人工   
   IF cl_null(p_xccc.xccc202c) THEN LET p_xccc.xccc202c = 0 END IF     #本期采购入库金额-加工   
   IF cl_null(p_xccc.xccc202d) THEN LET p_xccc.xccc202d = 0 END IF     #本期采购入库金额-制费一 
   IF cl_null(p_xccc.xccc202e) THEN LET p_xccc.xccc202e = 0 END IF     #本期采购入库金额-制费二 
   IF cl_null(p_xccc.xccc202f) THEN LET p_xccc.xccc202f = 0 END IF     #本期采购入库金额-制费三 
   IF cl_null(p_xccc.xccc202g) THEN LET p_xccc.xccc202g = 0 END IF     #本期采购入库金额-制费四 
   IF cl_null(p_xccc.xccc202h) THEN LET p_xccc.xccc202h = 0 END IF     #本期采购入库金额-制费五   
    
   IF cl_null(p_xccc.xccc203 ) THEN LET p_xccc.xccc203  = 0 END IF     #本期委外入库数量        
   IF cl_null(p_xccc.xccc204 ) THEN LET p_xccc.xccc204  = 0 END IF     #本期委外入库金额        
   IF cl_null(p_xccc.xccc204a) THEN LET p_xccc.xccc204a = 0 END IF     #本期委外入库金额-材料   
   IF cl_null(p_xccc.xccc204b) THEN LET p_xccc.xccc204b = 0 END IF     #本期委外入库金额-人工   
   IF cl_null(p_xccc.xccc204c) THEN LET p_xccc.xccc204c = 0 END IF     #本期委外入库金额-加工   
   IF cl_null(p_xccc.xccc204d) THEN LET p_xccc.xccc204d = 0 END IF     #本期委外入库金额-制费一 
   IF cl_null(p_xccc.xccc204e) THEN LET p_xccc.xccc204e = 0 END IF     #本期委外入库金额-制费二 
   IF cl_null(p_xccc.xccc204f) THEN LET p_xccc.xccc204f = 0 END IF     #本期委外入库金额-制费三 
   IF cl_null(p_xccc.xccc204g) THEN LET p_xccc.xccc204g = 0 END IF     #本期委外入库金额-制费四 
   IF cl_null(p_xccc.xccc204h) THEN LET p_xccc.xccc204h = 0 END IF     #本期委外入库金额-制费五 
      
   IF cl_null(p_xccc.xccc205 ) THEN LET p_xccc.xccc205  = 0 END IF     #本期工单入库数量        
   IF cl_null(p_xccc.xccc206 ) THEN LET p_xccc.xccc206  = 0 END IF     #本期工单入库金额        
   IF cl_null(p_xccc.xccc206a) THEN LET p_xccc.xccc206a = 0 END IF     #本期工单入库金额-材料  
   IF cl_null(p_xccc.xccc206b) THEN LET p_xccc.xccc206b = 0 END IF     #本期工单入库金额-人工  
   IF cl_null(p_xccc.xccc206c) THEN LET p_xccc.xccc206c = 0 END IF     #本期工单入库金额-加工  
   IF cl_null(p_xccc.xccc206d) THEN LET p_xccc.xccc206d = 0 END IF     #本期工单入库金额-制费一
   IF cl_null(p_xccc.xccc206e) THEN LET p_xccc.xccc206e = 0 END IF     #本期工单入库金额-制费二
   IF cl_null(p_xccc.xccc206f) THEN LET p_xccc.xccc206f = 0 END IF     #本期工单入库金额-制费三
   IF cl_null(p_xccc.xccc206g) THEN LET p_xccc.xccc206g = 0 END IF     #本期工单入库金额-制费四
   IF cl_null(p_xccc.xccc206h) THEN LET p_xccc.xccc206h = 0 END IF     #本期工单入库金额-制费五   
   
   IF cl_null(p_xccc.xccc207 ) THEN LET p_xccc.xccc207  = 0 END IF     #本期重工领出数量       
   IF cl_null(p_xccc.xccc208 ) THEN LET p_xccc.xccc208  = 0 END IF     #本期重工领出金额       
   IF cl_null(p_xccc.xccc208a) THEN LET p_xccc.xccc208a = 0 END IF     #本期重工领出金额-材料  
   IF cl_null(p_xccc.xccc208b) THEN LET p_xccc.xccc208b = 0 END IF     #本期重工领出金额-人工  
   IF cl_null(p_xccc.xccc208c) THEN LET p_xccc.xccc208c = 0 END IF     #本期重工领出金额-加工  
   IF cl_null(p_xccc.xccc208d) THEN LET p_xccc.xccc208d = 0 END IF     #本期重工领出金额-制费一
   IF cl_null(p_xccc.xccc208e) THEN LET p_xccc.xccc208e = 0 END IF     #本期重工领出金额-制费二
   IF cl_null(p_xccc.xccc208f) THEN LET p_xccc.xccc208f = 0 END IF     #本期重工领出金额-制费三
   IF cl_null(p_xccc.xccc208g) THEN LET p_xccc.xccc208g = 0 END IF     #本期重工领出金额-制费四
   IF cl_null(p_xccc.xccc208h) THEN LET p_xccc.xccc208h = 0 END IF     #本期重工领出金额-制费五   
   
   IF cl_null(p_xccc.xccc209 ) THEN LET p_xccc.xccc209  = 0 END IF     #本期重工入库数量       
   IF cl_null(p_xccc.xccc210 ) THEN LET p_xccc.xccc210  = 0 END IF     #本期重工入库金额       
   IF cl_null(p_xccc.xccc210a) THEN LET p_xccc.xccc210a = 0 END IF     #本期重工入库金额-材料  
   IF cl_null(p_xccc.xccc210b) THEN LET p_xccc.xccc210b = 0 END IF     #本期重工入库金额-人工  
   IF cl_null(p_xccc.xccc210c) THEN LET p_xccc.xccc210c = 0 END IF     #本期重工入库金额-加工  
   IF cl_null(p_xccc.xccc210d) THEN LET p_xccc.xccc210d = 0 END IF     #本期重工入库金额-制费一
   IF cl_null(p_xccc.xccc210e) THEN LET p_xccc.xccc210e = 0 END IF     #本期重工入库金额-制费二
   IF cl_null(p_xccc.xccc210f) THEN LET p_xccc.xccc210f = 0 END IF     #本期重工入库金额-制费三
   IF cl_null(p_xccc.xccc210g) THEN LET p_xccc.xccc210g = 0 END IF     #本期重工入库金额-制费四
   IF cl_null(p_xccc.xccc210h) THEN LET p_xccc.xccc210h = 0 END IF     #本期重工入库金额-制费五    
   
   IF cl_null(p_xccc.xccc211 ) THEN LET p_xccc.xccc211  = 0 END IF     #本期杂项入库数量       
   IF cl_null(p_xccc.xccc212 ) THEN LET p_xccc.xccc212  = 0 END IF     #本期杂项入库金额       
   IF cl_null(p_xccc.xccc212a) THEN LET p_xccc.xccc212a = 0 END IF     #本期杂项入库金额-材料  
   IF cl_null(p_xccc.xccc212b) THEN LET p_xccc.xccc212b = 0 END IF     #本期杂项入库金额-人工  
   IF cl_null(p_xccc.xccc212c) THEN LET p_xccc.xccc212c = 0 END IF     #本期杂项入库金额-加工  
   IF cl_null(p_xccc.xccc212d) THEN LET p_xccc.xccc212d = 0 END IF     #本期杂项入库金额-制费一
   IF cl_null(p_xccc.xccc212e) THEN LET p_xccc.xccc212e = 0 END IF     #本期杂项入库金额-制费二
   IF cl_null(p_xccc.xccc212f) THEN LET p_xccc.xccc212f = 0 END IF     #本期杂项入库金额-制费三
   IF cl_null(p_xccc.xccc212g) THEN LET p_xccc.xccc212g = 0 END IF     #本期杂项入库金额-制费四
   IF cl_null(p_xccc.xccc212h) THEN LET p_xccc.xccc212h = 0 END IF     #本期杂项入库金额-制费五  
    
   IF cl_null(p_xccc.xccc213 ) THEN LET p_xccc.xccc213  = 0 END IF     #本期调整入库数量       
   IF cl_null(p_xccc.xccc214 ) THEN LET p_xccc.xccc214  = 0 END IF     #本期调整入库金额       
   IF cl_null(p_xccc.xccc214a) THEN LET p_xccc.xccc214a = 0 END IF     #本期调整入库金额-材料  
   IF cl_null(p_xccc.xccc214b) THEN LET p_xccc.xccc214b = 0 END IF     #本期调整入库金额-人工  
   IF cl_null(p_xccc.xccc214c) THEN LET p_xccc.xccc214c = 0 END IF     #本期调整入库金额-加工  
   IF cl_null(p_xccc.xccc214d) THEN LET p_xccc.xccc214d = 0 END IF     #本期调整入库金额-制费一
   IF cl_null(p_xccc.xccc214e) THEN LET p_xccc.xccc214e = 0 END IF     #本期调整入库金额-制费二
   IF cl_null(p_xccc.xccc214f) THEN LET p_xccc.xccc214f = 0 END IF     #本期调整入库金额-制费三
   IF cl_null(p_xccc.xccc214g) THEN LET p_xccc.xccc214g = 0 END IF     #本期调整入库金额-制费四
   IF cl_null(p_xccc.xccc214h) THEN LET p_xccc.xccc214h = 0 END IF     #本期调整入库金额-制费五  
    
   IF cl_null(p_xccc.xccc215 ) THEN LET p_xccc.xccc215  = 0 END IF     #本期销退入库数量       
   IF cl_null(p_xccc.xccc216 ) THEN LET p_xccc.xccc216  = 0 END IF     #本期销退入库金额       
   IF cl_null(p_xccc.xccc216a) THEN LET p_xccc.xccc216a = 0 END IF     #本期销退入库金额-材料  
   IF cl_null(p_xccc.xccc216b) THEN LET p_xccc.xccc216b = 0 END IF     #本期销退入库金额-人工  
   IF cl_null(p_xccc.xccc216c) THEN LET p_xccc.xccc216c = 0 END IF     #本期销退入库金额-加工  
   IF cl_null(p_xccc.xccc216d) THEN LET p_xccc.xccc216d = 0 END IF     #本期销退入库金额-制费一
   IF cl_null(p_xccc.xccc216e) THEN LET p_xccc.xccc216e = 0 END IF     #本期销退入库金额-制费二
   IF cl_null(p_xccc.xccc216f) THEN LET p_xccc.xccc216f = 0 END IF     #本期销退入库金额-制费三
   IF cl_null(p_xccc.xccc216g) THEN LET p_xccc.xccc216g = 0 END IF     #本期销退入库金额-制费四
   IF cl_null(p_xccc.xccc216h) THEN LET p_xccc.xccc216h = 0 END IF     #本期销退入库金额-制费五 
    
   IF cl_null(p_xccc.xccc217 ) THEN LET p_xccc.xccc217  = 0 END IF     #本期其他入库数量       
   IF cl_null(p_xccc.xccc218 ) THEN LET p_xccc.xccc218  = 0 END IF     #本期其他入库金额       
   IF cl_null(p_xccc.xccc218a) THEN LET p_xccc.xccc218a = 0 END IF     #本期其他入库金额-材料  
   IF cl_null(p_xccc.xccc218b) THEN LET p_xccc.xccc218b = 0 END IF     #本期其他入库金额-人工  
   IF cl_null(p_xccc.xccc218c) THEN LET p_xccc.xccc218c = 0 END IF     #本期其他入库金额-加工  
   IF cl_null(p_xccc.xccc218d) THEN LET p_xccc.xccc218d = 0 END IF     #本期其他入库金额-制费一
   IF cl_null(p_xccc.xccc218e) THEN LET p_xccc.xccc218e = 0 END IF     #本期其他入库金额-制费二
   IF cl_null(p_xccc.xccc218f) THEN LET p_xccc.xccc218f = 0 END IF     #本期其他入库金额-制费三
   IF cl_null(p_xccc.xccc218g) THEN LET p_xccc.xccc218g = 0 END IF     #本期其他入库金额-制费四 
   IF cl_null(p_xccc.xccc218h) THEN LET p_xccc.xccc218h = 0 END IF     #本期其他入库金额-制费五     
   
   IF cl_null(p_xccc.xccc280 ) THEN LET p_xccc.xccc280  = 0 END IF     #本期平均单价            
   IF cl_null(p_xccc.xccc280a) THEN LET p_xccc.xccc280a = 0 END IF     #本期平均单价-材料       
   IF cl_null(p_xccc.xccc280b) THEN LET p_xccc.xccc280b = 0 END IF     #本期平均单价-人工       
   IF cl_null(p_xccc.xccc280c) THEN LET p_xccc.xccc280c = 0 END IF     #本期平均单价-加工       
   IF cl_null(p_xccc.xccc280d) THEN LET p_xccc.xccc280d = 0 END IF     #本期平均单价-制费一     
   IF cl_null(p_xccc.xccc280e) THEN LET p_xccc.xccc280e = 0 END IF     #本期平均单价-制费二     
   IF cl_null(p_xccc.xccc280f) THEN LET p_xccc.xccc280f = 0 END IF     #本期平均单价-制费三     
   IF cl_null(p_xccc.xccc280g) THEN LET p_xccc.xccc280g = 0 END IF     #本期平均单价-制费四     
   IF cl_null(p_xccc.xccc280h) THEN LET p_xccc.xccc280h = 0 END IF     #本期平均单价-制费五         
   
   IF cl_null(p_xccc.xccc301 ) THEN LET p_xccc.xccc301  = 0 END IF     #本期工单领用数量        
   IF cl_null(p_xccc.xccc302 ) THEN LET p_xccc.xccc302  = 0 END IF     #本期工单领用金额        
   IF cl_null(p_xccc.xccc302a) THEN LET p_xccc.xccc302a = 0 END IF     #本期工单领用金额-材料   
   IF cl_null(p_xccc.xccc302b) THEN LET p_xccc.xccc302b = 0 END IF     #本期工单领用金额-人工   
   IF cl_null(p_xccc.xccc302c) THEN LET p_xccc.xccc302c = 0 END IF     #本期工单领用金额-加工   
   IF cl_null(p_xccc.xccc302d) THEN LET p_xccc.xccc302d = 0 END IF     #本期工单领用金额-制费一 
   IF cl_null(p_xccc.xccc302e) THEN LET p_xccc.xccc302e = 0 END IF     #本期工单领用金额-制费二 
   IF cl_null(p_xccc.xccc302f) THEN LET p_xccc.xccc302f = 0 END IF     #本期工单领用金额-制费三 
   IF cl_null(p_xccc.xccc302g) THEN LET p_xccc.xccc302g = 0 END IF     #本期工单领用金额-制费四 
   IF cl_null(p_xccc.xccc302h) THEN LET p_xccc.xccc302h = 0 END IF     #本期工单领用金额-制费五    
   
   IF cl_null(p_xccc.xccc303 ) THEN LET p_xccc.xccc303  = 0 END IF     #本期销货数量            
   IF cl_null(p_xccc.xccc304 ) THEN LET p_xccc.xccc304  = 0 END IF     #本期销货成本            
   IF cl_null(p_xccc.xccc304a) THEN LET p_xccc.xccc304a = 0 END IF     #本期销货成本-材料       
   IF cl_null(p_xccc.xccc304b) THEN LET p_xccc.xccc304b = 0 END IF     #本期销货成本-人工       
   IF cl_null(p_xccc.xccc304c) THEN LET p_xccc.xccc304c = 0 END IF     #本期销货成本-加工       
   IF cl_null(p_xccc.xccc304d) THEN LET p_xccc.xccc304d = 0 END IF     #本期销货成本-制费一     
   IF cl_null(p_xccc.xccc304e) THEN LET p_xccc.xccc304e = 0 END IF     #本期销货成本-制费二     
   IF cl_null(p_xccc.xccc304f) THEN LET p_xccc.xccc304f = 0 END IF     #本期销货成本-制费三     
   IF cl_null(p_xccc.xccc304g) THEN LET p_xccc.xccc304g = 0 END IF     #本期销货成本-制费四     
   IF cl_null(p_xccc.xccc304h) THEN LET p_xccc.xccc304h = 0 END IF     #本期销货成本-制费五   
   
   IF cl_null(p_xccc.xccc305 ) THEN LET p_xccc.xccc305  = 0 END IF     #本期销退数量            
   IF cl_null(p_xccc.xccc306 ) THEN LET p_xccc.xccc306  = 0 END IF     #本期销退成本            
   IF cl_null(p_xccc.xccc306a) THEN LET p_xccc.xccc306a = 0 END IF     #本期销退成本-材料       
   IF cl_null(p_xccc.xccc306b) THEN LET p_xccc.xccc306b = 0 END IF     #本期销退成本-人工       
   IF cl_null(p_xccc.xccc306c) THEN LET p_xccc.xccc306c = 0 END IF     #本期销退成本-加工       
   IF cl_null(p_xccc.xccc306d) THEN LET p_xccc.xccc306d = 0 END IF     #本期销退成本-制费一     
   IF cl_null(p_xccc.xccc306e) THEN LET p_xccc.xccc306e = 0 END IF     #本期销退成本-制费二     
   IF cl_null(p_xccc.xccc306f) THEN LET p_xccc.xccc306f = 0 END IF     #本期销退成本-制费三     
   IF cl_null(p_xccc.xccc306g) THEN LET p_xccc.xccc306g = 0 END IF     #本期销退成本-制费四    
   IF cl_null(p_xccc.xccc306h) THEN LET p_xccc.xccc306h = 0 END IF     #本期销退成本-制费五     
     
   IF cl_null(p_xccc.xccc307 ) THEN LET p_xccc.xccc307  = 0 END IF     #本期销售费用数量       
   IF cl_null(p_xccc.xccc308 ) THEN LET p_xccc.xccc308  = 0 END IF     #本期销售费用成本       
   IF cl_null(p_xccc.xccc308a) THEN LET p_xccc.xccc308a = 0 END IF     #本期销售费用成本-材料  
   IF cl_null(p_xccc.xccc308b) THEN LET p_xccc.xccc308b = 0 END IF     #本期销售费用成本-人工  
   IF cl_null(p_xccc.xccc308c) THEN LET p_xccc.xccc308c = 0 END IF     #本期销售费用成本-加工  
   IF cl_null(p_xccc.xccc308d) THEN LET p_xccc.xccc308d = 0 END IF     #本期销售费用成本-制费一
   IF cl_null(p_xccc.xccc308e) THEN LET p_xccc.xccc308e = 0 END IF     #本期销售费用成本-制费二
   IF cl_null(p_xccc.xccc308f) THEN LET p_xccc.xccc308f = 0 END IF     #本期销售费用成本-制费三
   IF cl_null(p_xccc.xccc308g) THEN LET p_xccc.xccc308g = 0 END IF     #本期销售费用成本-制费四
   IF cl_null(p_xccc.xccc308h) THEN LET p_xccc.xccc308h = 0 END IF     #本期销售费用成本-制费五    
   
   IF cl_null(p_xccc.xccc309 ) THEN LET p_xccc.xccc309  = 0 END IF     #本期杂发数量           
   IF cl_null(p_xccc.xccc310 ) THEN LET p_xccc.xccc310  = 0 END IF     #本期杂发金额           
   IF cl_null(p_xccc.xccc310a) THEN LET p_xccc.xccc310a = 0 END IF     #本期杂发金额-材料      
   IF cl_null(p_xccc.xccc310b) THEN LET p_xccc.xccc310b = 0 END IF     #本期杂发金额-人工      
   IF cl_null(p_xccc.xccc310c) THEN LET p_xccc.xccc310c = 0 END IF     #本期杂发金额-加工      
   IF cl_null(p_xccc.xccc310d) THEN LET p_xccc.xccc310d = 0 END IF     #本期杂发金额-制费一    
   IF cl_null(p_xccc.xccc310e) THEN LET p_xccc.xccc310e = 0 END IF     #本期杂发金额-制费二    
   IF cl_null(p_xccc.xccc310f) THEN LET p_xccc.xccc310f = 0 END IF     #本期杂发金额-制费三    
   IF cl_null(p_xccc.xccc310g) THEN LET p_xccc.xccc310g = 0 END IF     #本期杂发金额-制费四    
   IF cl_null(p_xccc.xccc310h) THEN LET p_xccc.xccc310h = 0 END IF     #本期杂发金额-制费五      
    
   IF cl_null(p_xccc.xccc311 ) THEN LET p_xccc.xccc311  = 0 END IF     #本期盘盈亏数量         
   IF cl_null(p_xccc.xccc312 ) THEN LET p_xccc.xccc312  = 0 END IF     #本期盘盈亏金额         
   IF cl_null(p_xccc.xccc312a) THEN LET p_xccc.xccc312a = 0 END IF     #本期盘盈亏金额-材料    
   IF cl_null(p_xccc.xccc312b) THEN LET p_xccc.xccc312b = 0 END IF     #本期盘盈亏金额-人工    
   IF cl_null(p_xccc.xccc312c) THEN LET p_xccc.xccc312c = 0 END IF     #本期盘盈亏金额-加工    
   IF cl_null(p_xccc.xccc312d) THEN LET p_xccc.xccc312d = 0 END IF     #本期盘盈亏金额-制费一  
   IF cl_null(p_xccc.xccc312e) THEN LET p_xccc.xccc312e = 0 END IF     #本期盘盈亏金额-制费二  
   IF cl_null(p_xccc.xccc312f) THEN LET p_xccc.xccc312f = 0 END IF     #本期盘盈亏金额-制费三  
   IF cl_null(p_xccc.xccc312g) THEN LET p_xccc.xccc312g = 0 END IF     #本期盘盈亏金额-制费四  
   IF cl_null(p_xccc.xccc312h) THEN LET p_xccc.xccc312h = 0 END IF     #本期盘盈亏金额-制费五     
   
   IF cl_null(p_xccc.xccc313 ) THEN LET p_xccc.xccc313  = 0 END IF     #本期其他出库数量       
   IF cl_null(p_xccc.xccc314 ) THEN LET p_xccc.xccc314  = 0 END IF     #本期其他出库金额       
   IF cl_null(p_xccc.xccc314a) THEN LET p_xccc.xccc314a = 0 END IF     #本期其他出库金额-材料  
   IF cl_null(p_xccc.xccc314b) THEN LET p_xccc.xccc314b = 0 END IF     #本期其他出库金额-人工  
   IF cl_null(p_xccc.xccc314c) THEN LET p_xccc.xccc314c = 0 END IF     #本期其他出库金额-加工  
   IF cl_null(p_xccc.xccc314d) THEN LET p_xccc.xccc314d = 0 END IF     #本期其他出库金额-制费一
   IF cl_null(p_xccc.xccc314e) THEN LET p_xccc.xccc314e = 0 END IF     #本期其他出库金额-制费二
   IF cl_null(p_xccc.xccc314f) THEN LET p_xccc.xccc314f = 0 END IF     #本期其他出库金额-制费三
   IF cl_null(p_xccc.xccc314g) THEN LET p_xccc.xccc314g = 0 END IF     #本期其他出库金额-制费四
   IF cl_null(p_xccc.xccc314h) THEN LET p_xccc.xccc314h = 0 END IF     #本期其他出库金额-制费五     
   
   IF cl_null(p_xccc.xccc401 ) THEN LET p_xccc.xccc401  = 0 END IF     #本期销货收入金额       
   IF cl_null(p_xccc.xccc402 ) THEN LET p_xccc.xccc402  = 0 END IF     #本期销退金额              
   IF cl_null(p_xccc.xccc901 ) THEN LET p_xccc.xccc901  = 0 END IF     #期末结存数量           
   IF cl_null(p_xccc.xccc902 ) THEN LET p_xccc.xccc902  = 0 END IF     #期末结存金额           
   IF cl_null(p_xccc.xccc902a) THEN LET p_xccc.xccc902a = 0 END IF     #期末结存金额-材料      
   IF cl_null(p_xccc.xccc902b) THEN LET p_xccc.xccc902b = 0 END IF     #期末结存金额-人工      
   IF cl_null(p_xccc.xccc902c) THEN LET p_xccc.xccc902c = 0 END IF     #期末结存金额-加工      
   IF cl_null(p_xccc.xccc902d) THEN LET p_xccc.xccc902d = 0 END IF     #期末结存金额-制费一    
   IF cl_null(p_xccc.xccc902e) THEN LET p_xccc.xccc902e = 0 END IF     #期末结存金额-制费二    
   IF cl_null(p_xccc.xccc902f) THEN LET p_xccc.xccc902f = 0 END IF     #期末结存金额-制费三    
   IF cl_null(p_xccc.xccc902g) THEN LET p_xccc.xccc902g = 0 END IF     #期末结存金额-制费四    
   IF cl_null(p_xccc.xccc902h) THEN LET p_xccc.xccc902h = 0 END IF     #期末结存金额-制费五      
    
   IF cl_null(p_xccc.xccc903 ) THEN LET p_xccc.xccc903  = 0 END IF     #期末结存调整金额       
   IF cl_null(p_xccc.xccc903a) THEN LET p_xccc.xccc903a = 0 END IF     #期末结存调整金额-材料  
   IF cl_null(p_xccc.xccc903b) THEN LET p_xccc.xccc903b = 0 END IF     #期末结存调整金额-人工  
   IF cl_null(p_xccc.xccc903c) THEN LET p_xccc.xccc903c = 0 END IF     #期末结存调整金额-加工  
   IF cl_null(p_xccc.xccc903d) THEN LET p_xccc.xccc903d = 0 END IF     #期末结存调整金额-制费一
   IF cl_null(p_xccc.xccc903e) THEN LET p_xccc.xccc903e = 0 END IF     #期末结存调整金额-制费二
   IF cl_null(p_xccc.xccc903f) THEN LET p_xccc.xccc903f = 0 END IF     #期末结存调整金额-制费三
   IF cl_null(p_xccc.xccc903g) THEN LET p_xccc.xccc903g = 0 END IF     #期末结存调整金额-制费四
   IF cl_null(p_xccc.xccc903h) THEN LET p_xccc.xccc903h = 0 END IF     #期末结存调整金额-制费五
   
   LET r_xccc.* = p_xccc.*
   
   RETURN r_xccc.*
   
END FUNCTION

################################################################################
# Descriptions...: xccd重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccd_null_to_zero(p_xccd)
#                       RETURNING r_xccd
# Input parameter: p_xccd         xccd的TABLE资料
# Return code....: r_xccd         xccd的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccd_null_to_zero(p_xccd)
  #   DEFINE p_xccd            RECORD LIKE xccd_t.*  #161124-00048#20 mark
#   DEFINE r_xccd            RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE p_xccd             type_g_xccd  #170605-00013#1-add
   DEFINE r_xccd             type_g_xccd  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccd RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企业编号
#       xccdcomp LIKE xccd_t.xccdcomp, #法人组织
#       xccdld LIKE xccd_t.xccdld, #账套
#       xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本计算类型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期别
#       xccd006 LIKE xccd_t.xccd006, #工单编号
#       xccd007 LIKE xccd_t.xccd007, #主件料号
#       xccd008 LIKE xccd_t.xccd008, #产品特征
#       xccd009 LIKE xccd_t.xccd009, #批号
#       xccd010 LIKE xccd_t.xccd010, #项目号
#       xccd011 LIKE xccd_t.xccd011, #核算币种
#       xccd012 LIKE xccd_t.xccd012, #重复性成产否
#       xccd013 LIKE xccd_t.xccd013, #成产计划号
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期结存数量
#       xccd102 LIKE xccd_t.xccd102, #上期结存金额
#       xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
#       xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
#       xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
#       xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
#       xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工时
#       xccd201 LIKE xccd_t.xccd201, #本期投入数量
#       xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
#       xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
#       xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
#       xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
#       xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
#       xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
#       xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
#       xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
#       xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
#       xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
#       xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
#       xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
#       xccd301 LIKE xccd_t.xccd301, #本期转出数量
#       xccd302 LIKE xccd_t.xccd302, #本期转出金额
#       xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
#       xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
#       xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
#       xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
#       xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
#       xccd303 LIKE xccd_t.xccd303, #差异转出数量
#       xccd304 LIKE xccd_t.xccd304, #差异转出金额
#       xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
#       xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
#       xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
#       xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
#       xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
#       xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
#       xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
#       xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
#       xccd901 LIKE xccd_t.xccd901, #期末结存数量
#       xccd902 LIKE xccd_t.xccd902, #期末结存金额
#       xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
#       xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
#       xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
#       xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
#       xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
#END RECORD
#DEFINE r_xccd RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企业编号
#       xccdcomp LIKE xccd_t.xccdcomp, #法人组织
#       xccdld LIKE xccd_t.xccdld, #账套
#       xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本计算类型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期别
#       xccd006 LIKE xccd_t.xccd006, #工单编号
#       xccd007 LIKE xccd_t.xccd007, #主件料号
#       xccd008 LIKE xccd_t.xccd008, #产品特征
#       xccd009 LIKE xccd_t.xccd009, #批号
#       xccd010 LIKE xccd_t.xccd010, #项目号
#       xccd011 LIKE xccd_t.xccd011, #核算币种
#       xccd012 LIKE xccd_t.xccd012, #重复性成产否
#       xccd013 LIKE xccd_t.xccd013, #成产计划号
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期结存数量
#       xccd102 LIKE xccd_t.xccd102, #上期结存金额
#       xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
#       xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
#       xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
#       xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
#       xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工时
#       xccd201 LIKE xccd_t.xccd201, #本期投入数量
#       xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
#       xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
#       xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
#       xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
#       xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
#       xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
#       xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
#       xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
#       xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
#       xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
#       xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
#       xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
#       xccd301 LIKE xccd_t.xccd301, #本期转出数量
#       xccd302 LIKE xccd_t.xccd302, #本期转出金额
#       xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
#       xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
#       xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
#       xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
#       xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
#       xccd303 LIKE xccd_t.xccd303, #差异转出数量
#       xccd304 LIKE xccd_t.xccd304, #差异转出金额
#       xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
#       xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
#       xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
#       xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
#       xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
#       xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
#       xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
#       xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
#       xccd901 LIKE xccd_t.xccd901, #期末结存数量
#       xccd902 LIKE xccd_t.xccd902, #期末结存金额
#       xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
#       xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
#       xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
#       xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
#       xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF cl_null(p_xccd.xccd101 ) THEN LET p_xccd.xccd101  = 0 END IF       #上期结存数量           
   IF cl_null(p_xccd.xccd102 ) THEN LET p_xccd.xccd102  = 0 END IF       #上期结存金额           
   IF cl_null(p_xccd.xccd102a) THEN LET p_xccd.xccd102a = 0 END IF       #上期结存金额-材料      
   IF cl_null(p_xccd.xccd102b) THEN LET p_xccd.xccd102b = 0 END IF       #上期结存金额-人工      
   IF cl_null(p_xccd.xccd102c) THEN LET p_xccd.xccd102c = 0 END IF       #上期结存金额-加工      
   IF cl_null(p_xccd.xccd102d) THEN LET p_xccd.xccd102d = 0 END IF       #上期结存金额-制费一    
   IF cl_null(p_xccd.xccd102e) THEN LET p_xccd.xccd102e = 0 END IF       #上期结存金额-制费二    
   IF cl_null(p_xccd.xccd102f) THEN LET p_xccd.xccd102f = 0 END IF       #上期结存金额-制费三    
   IF cl_null(p_xccd.xccd102g) THEN LET p_xccd.xccd102g = 0 END IF       #上期结存金额-制费四    
   IF cl_null(p_xccd.xccd102h) THEN LET p_xccd.xccd102h = 0 END IF       #上期结存金额-制费五    
   IF cl_null(p_xccd.xccd200 ) THEN LET p_xccd.xccd200  = 0 END IF       #本期投入工时           
   IF cl_null(p_xccd.xccd201 ) THEN LET p_xccd.xccd201  = 0 END IF       #本期投入数量           
   IF cl_null(p_xccd.xccd202 ) THEN LET p_xccd.xccd202  = 0 END IF       #本期本阶投入金额       
   IF cl_null(p_xccd.xccd202a) THEN LET p_xccd.xccd202a = 0 END IF       #本期本阶投入金额-材料  
   IF cl_null(p_xccd.xccd202b) THEN LET p_xccd.xccd202b = 0 END IF       #本期本阶投入金额-人工  
   IF cl_null(p_xccd.xccd202c) THEN LET p_xccd.xccd202c = 0 END IF       #本期本阶投入金额-加工  
   IF cl_null(p_xccd.xccd202d) THEN LET p_xccd.xccd202d = 0 END IF       #本期本阶投入金额-制费一
   IF cl_null(p_xccd.xccd202e) THEN LET p_xccd.xccd202e = 0 END IF       #本期本阶投入金额-制费二
   IF cl_null(p_xccd.xccd202f) THEN LET p_xccd.xccd202f = 0 END IF       #本期本阶投入金额-制费三
   IF cl_null(p_xccd.xccd202g) THEN LET p_xccd.xccd202g = 0 END IF       #本期本阶投入金额-制费四
   IF cl_null(p_xccd.xccd202h) THEN LET p_xccd.xccd202h = 0 END IF       #本期本阶投入金额-制费五
   IF cl_null(p_xccd.xccd204 ) THEN LET p_xccd.xccd204  = 0 END IF       #本期下阶投入金额       
   IF cl_null(p_xccd.xccd204a) THEN LET p_xccd.xccd204a = 0 END IF       #本期下阶投入金额-材料  
   IF cl_null(p_xccd.xccd204b) THEN LET p_xccd.xccd204b = 0 END IF       #本期下阶投入金额-人工  
   IF cl_null(p_xccd.xccd204c) THEN LET p_xccd.xccd204c = 0 END IF       #本期下阶投入金额-加工  
   IF cl_null(p_xccd.xccd204d) THEN LET p_xccd.xccd204d = 0 END IF       #本期下阶投入金额-制费一
   IF cl_null(p_xccd.xccd204e) THEN LET p_xccd.xccd204e = 0 END IF       #本期下阶投入金额-制费二
   IF cl_null(p_xccd.xccd204f) THEN LET p_xccd.xccd204f = 0 END IF       #本期下阶投入金额-制费三
   IF cl_null(p_xccd.xccd204g) THEN LET p_xccd.xccd204g = 0 END IF       #本期下阶投入金额-制费四
   IF cl_null(p_xccd.xccd204h) THEN LET p_xccd.xccd204h = 0 END IF       #本期下阶投入金额-制费五
   IF cl_null(p_xccd.xccd301 ) THEN LET p_xccd.xccd301  = 0 END IF       #本期转出数量           
   IF cl_null(p_xccd.xccd302 ) THEN LET p_xccd.xccd302  = 0 END IF       #本期转出金额           
   IF cl_null(p_xccd.xccd302a) THEN LET p_xccd.xccd302a = 0 END IF       #本期转出金额-材料      
   IF cl_null(p_xccd.xccd302b) THEN LET p_xccd.xccd302b = 0 END IF       #本期转出金额-人工      
   IF cl_null(p_xccd.xccd302c) THEN LET p_xccd.xccd302c = 0 END IF       #本期转出金额-加工      
   IF cl_null(p_xccd.xccd302d) THEN LET p_xccd.xccd302d = 0 END IF       #本期转出金额-制费一    
   IF cl_null(p_xccd.xccd302e) THEN LET p_xccd.xccd302e = 0 END IF       #本期转出金额-制费二    
   IF cl_null(p_xccd.xccd302f) THEN LET p_xccd.xccd302f = 0 END IF       #本期转出金额-制费三    
   IF cl_null(p_xccd.xccd302g) THEN LET p_xccd.xccd302g = 0 END IF       #本期转出金额-制费四    
   IF cl_null(p_xccd.xccd302h) THEN LET p_xccd.xccd302h = 0 END IF       #本期转出金额-制费五    
   IF cl_null(p_xccd.xccd303 ) THEN LET p_xccd.xccd303  = 0 END IF       #差异转出数量           
   IF cl_null(p_xccd.xccd304 ) THEN LET p_xccd.xccd304  = 0 END IF       #差异转出金额           
   IF cl_null(p_xccd.xccd304a) THEN LET p_xccd.xccd304a = 0 END IF       #差异转出金额-材料      
   IF cl_null(p_xccd.xccd304b) THEN LET p_xccd.xccd304b = 0 END IF       #差异转出金额-人工      
   IF cl_null(p_xccd.xccd304c) THEN LET p_xccd.xccd304c = 0 END IF       #差异转出金额-加工      
   IF cl_null(p_xccd.xccd304d) THEN LET p_xccd.xccd304d = 0 END IF       #差异转出金额-制费一    
   IF cl_null(p_xccd.xccd304e) THEN LET p_xccd.xccd304e = 0 END IF       #差异转出金额-制费二    
   IF cl_null(p_xccd.xccd304f) THEN LET p_xccd.xccd304f = 0 END IF       #差异转出金额-制费三    
   IF cl_null(p_xccd.xccd304g) THEN LET p_xccd.xccd304g = 0 END IF       #差异转出金额-制费四    
   IF cl_null(p_xccd.xccd304h) THEN LET p_xccd.xccd304h = 0 END IF       #差异转出金额-制费五    
   IF cl_null(p_xccd.xccd901 ) THEN LET p_xccd.xccd901  = 0 END IF       #期末结存数量           
   IF cl_null(p_xccd.xccd902 ) THEN LET p_xccd.xccd902  = 0 END IF       #期末结存金额           
   IF cl_null(p_xccd.xccd902a) THEN LET p_xccd.xccd902a = 0 END IF       #期末结存金额-材料      
   IF cl_null(p_xccd.xccd902b) THEN LET p_xccd.xccd902b = 0 END IF       #期末结存金额-人工      
   IF cl_null(p_xccd.xccd902c) THEN LET p_xccd.xccd902c = 0 END IF       #期末结存金额-加工      
   IF cl_null(p_xccd.xccd902d) THEN LET p_xccd.xccd902d = 0 END IF       #期末结存金额-制费一    
   IF cl_null(p_xccd.xccd902e) THEN LET p_xccd.xccd902e = 0 END IF       #期末结存金额-制费二    
   IF cl_null(p_xccd.xccd902f) THEN LET p_xccd.xccd902f = 0 END IF       #期末结存金额-制费三    
   IF cl_null(p_xccd.xccd902g) THEN LET p_xccd.xccd902g = 0 END IF       #期末结存金额-制费四    
   IF cl_null(p_xccd.xccd902h) THEN LET p_xccd.xccd902h = 0 END IF       #期末结存金额-制费五 
   
   LET r_xccd.* = p_xccd.*
   RETURN r_xccd.*
   
END FUNCTION

################################################################################
# Descriptions...: xcce重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xcce_null_to_zero(p_xcce)
#                       RETURNING r_xcce
# Input parameter: p_xcce         xcce的TABLE资料
# Return code....: r_xcce         xcce的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xcce_null_to_zero(p_xcce)
#   DEFINE p_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
#   DEFINE r_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE p_xcce           type_g_xcce  #170605-00013#1-add
   DEFINE r_xcce           type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
#DEFINE r_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE

   IF cl_null(p_xcce.xcce101 ) THEN LET p_xcce.xcce101  = 0 END IF                  #上期结存数量        
   IF cl_null(p_xcce.xcce102 ) THEN LET p_xcce.xcce102  = 0 END IF                  #上期结存金额        
   IF cl_null(p_xcce.xcce102a) THEN LET p_xcce.xcce102a = 0 END IF                  #上期结存金额-材料   
   IF cl_null(p_xcce.xcce102b) THEN LET p_xcce.xcce102b = 0 END IF                  #上期结存金额-人工   
   IF cl_null(p_xcce.xcce102c) THEN LET p_xcce.xcce102c = 0 END IF                  #上期结存金额-加工   
   IF cl_null(p_xcce.xcce102d) THEN LET p_xcce.xcce102d = 0 END IF                  #上期结存金额-制费一 
   IF cl_null(p_xcce.xcce102e) THEN LET p_xcce.xcce102e = 0 END IF                  #上期结存金额-制费二 
   IF cl_null(p_xcce.xcce102f) THEN LET p_xcce.xcce102f = 0 END IF                  #上期结存金额-制费三 
   IF cl_null(p_xcce.xcce102g) THEN LET p_xcce.xcce102g = 0 END IF                  #上期结存金额-制费四 
   IF cl_null(p_xcce.xcce102h) THEN LET p_xcce.xcce102h = 0 END IF                  #上期结存金额-制费五   
    
   IF cl_null(p_xcce.xcce201 ) THEN LET p_xcce.xcce201  = 0 END IF                  #本期投入数量        
   IF cl_null(p_xcce.xcce202 ) THEN LET p_xcce.xcce202  = 0 END IF                  #本期本阶投入金额        
   IF cl_null(p_xcce.xcce202a) THEN LET p_xcce.xcce202a = 0 END IF                  #本期本阶投入金额-材料   
   IF cl_null(p_xcce.xcce202b) THEN LET p_xcce.xcce202b = 0 END IF                  #本期本阶投入金额-人工   
   IF cl_null(p_xcce.xcce202c) THEN LET p_xcce.xcce202c = 0 END IF                  #本期本阶投入金额-加工   
   IF cl_null(p_xcce.xcce202d) THEN LET p_xcce.xcce202d = 0 END IF                  #本期本阶投入金额-制费一 
   IF cl_null(p_xcce.xcce202e) THEN LET p_xcce.xcce202e = 0 END IF                  #本期本阶投入金额-制费二 
   IF cl_null(p_xcce.xcce202f) THEN LET p_xcce.xcce202f = 0 END IF                  #本期本阶投入金额-制费三 
   IF cl_null(p_xcce.xcce202g) THEN LET p_xcce.xcce202g = 0 END IF                  #本期本阶投入金额-制费四 
   IF cl_null(p_xcce.xcce202h) THEN LET p_xcce.xcce202h = 0 END IF                  #本期本阶投入金额-制费五  
   
   IF cl_null(p_xcce.xcce205 ) THEN LET p_xcce.xcce205  = 0 END IF                  #当站下线数量        
   IF cl_null(p_xcce.xcce206 ) THEN LET p_xcce.xcce206  = 0 END IF                  #本期当站下线金额        
   IF cl_null(p_xcce.xcce206a) THEN LET p_xcce.xcce206a = 0 END IF                  #本期当站下线金额-材料   
   IF cl_null(p_xcce.xcce206b) THEN LET p_xcce.xcce206b = 0 END IF                  #本期当站下线金额-人工   
   IF cl_null(p_xcce.xcce206c) THEN LET p_xcce.xcce206c = 0 END IF                  #本期当站下线金额-加工   
   IF cl_null(p_xcce.xcce206d) THEN LET p_xcce.xcce206d = 0 END IF                  #本期当站下线金额-制费一 
   IF cl_null(p_xcce.xcce206e) THEN LET p_xcce.xcce206e = 0 END IF                  #本期当站下线金额-制费二 
   IF cl_null(p_xcce.xcce206f) THEN LET p_xcce.xcce206f = 0 END IF                  #本期当站下线金额-制费三 
   IF cl_null(p_xcce.xcce206g) THEN LET p_xcce.xcce206g = 0 END IF                  #本期当站下线金额-制费四 
   IF cl_null(p_xcce.xcce206h) THEN LET p_xcce.xcce206h = 0 END IF                  #本期当站下线金额-制费五 
   
   IF cl_null(p_xcce.xcce207 ) THEN LET p_xcce.xcce207  = 0 END IF                  #一般退料数量        
   IF cl_null(p_xcce.xcce208 ) THEN LET p_xcce.xcce208  = 0 END IF                  #本期一般退料金额        
   IF cl_null(p_xcce.xcce208a) THEN LET p_xcce.xcce208a = 0 END IF                  #本期一般退料金额-材料   
   IF cl_null(p_xcce.xcce208b) THEN LET p_xcce.xcce208b = 0 END IF                  #本期一般退料金额-人工   
   IF cl_null(p_xcce.xcce208c) THEN LET p_xcce.xcce208c = 0 END IF                  #本期一般退料金额-加工   
   IF cl_null(p_xcce.xcce208d) THEN LET p_xcce.xcce208d = 0 END IF                  #本期一般退料金额-制费一 
   IF cl_null(p_xcce.xcce208e) THEN LET p_xcce.xcce208e = 0 END IF                  #本期一般退料金额-制费二 
   IF cl_null(p_xcce.xcce208f) THEN LET p_xcce.xcce208f = 0 END IF                  #本期一般退料金额-制费三 
   IF cl_null(p_xcce.xcce208g) THEN LET p_xcce.xcce208g = 0 END IF                  #本期一般退料金额-制费四 
   IF cl_null(p_xcce.xcce208h) THEN LET p_xcce.xcce208h = 0 END IF                  #本期一般退料金额-制费五     
       
   IF cl_null(p_xcce.xcce209 ) THEN LET p_xcce.xcce209  = 0 END IF                  #本期超领退数量            
   IF cl_null(p_xcce.xcce210 ) THEN LET p_xcce.xcce210  = 0 END IF                  #本期超领退金额            
   IF cl_null(p_xcce.xcce210a) THEN LET p_xcce.xcce210a = 0 END IF                  #本期超领退金额-材料       
   IF cl_null(p_xcce.xcce210b) THEN LET p_xcce.xcce210b = 0 END IF                  #本期超领退金额-人工       
   IF cl_null(p_xcce.xcce210c) THEN LET p_xcce.xcce210c = 0 END IF                  #本期超领退金额-加工       
   IF cl_null(p_xcce.xcce210d) THEN LET p_xcce.xcce210d = 0 END IF                  #本期超领退金额-制费一     
   IF cl_null(p_xcce.xcce210e) THEN LET p_xcce.xcce210e = 0 END IF                  #本期超领退金额-制费二     
   IF cl_null(p_xcce.xcce210f) THEN LET p_xcce.xcce210f = 0 END IF                  #本期超领退金额-制费三     
   IF cl_null(p_xcce.xcce210g) THEN LET p_xcce.xcce210g = 0 END IF                  #本期超领退金额-制费四    
   IF cl_null(p_xcce.xcce210h) THEN LET p_xcce.xcce210h = 0 END IF                  #本期超领退金额-制费五  
          
   IF cl_null(p_xcce.xcce301 ) THEN LET p_xcce.xcce301  = 0 END IF                  #本期转出数量        
   IF cl_null(p_xcce.xcce302 ) THEN LET p_xcce.xcce302  = 0 END IF                  #本期转出金额        
   IF cl_null(p_xcce.xcce302a) THEN LET p_xcce.xcce302a = 0 END IF                  #本期转出金额-材料   
   IF cl_null(p_xcce.xcce302b) THEN LET p_xcce.xcce302b = 0 END IF                  #本期转出金额-人工   
   IF cl_null(p_xcce.xcce302c) THEN LET p_xcce.xcce302c = 0 END IF                  #本期转出金额-加工   
   IF cl_null(p_xcce.xcce302d) THEN LET p_xcce.xcce302d = 0 END IF                  #本期转出金额-制费一 
   IF cl_null(p_xcce.xcce302e) THEN LET p_xcce.xcce302e = 0 END IF                  #本期转出金额-制费二 
   IF cl_null(p_xcce.xcce302f) THEN LET p_xcce.xcce302f = 0 END IF                  #本期转出金额-制费三 
   IF cl_null(p_xcce.xcce302g) THEN LET p_xcce.xcce302g = 0 END IF                  #本期转出金额-制费四 
   IF cl_null(p_xcce.xcce302h) THEN LET p_xcce.xcce302h = 0 END IF                  #本期转出金额-制费五 
      
   IF cl_null(p_xcce.xcce303 ) THEN LET p_xcce.xcce303  = 0 END IF                  #差异转出数量          
   IF cl_null(p_xcce.xcce304 ) THEN LET p_xcce.xcce304  = 0 END IF                  #差异转出金额         
   IF cl_null(p_xcce.xcce304a) THEN LET p_xcce.xcce304a = 0 END IF                  #差异转出金额-材料     
   IF cl_null(p_xcce.xcce304b) THEN LET p_xcce.xcce304b = 0 END IF                  #差异转出金额-人工     
   IF cl_null(p_xcce.xcce304c) THEN LET p_xcce.xcce304c = 0 END IF                  #差异转出金额-加工     
   IF cl_null(p_xcce.xcce304d) THEN LET p_xcce.xcce304d = 0 END IF                  #差异转出金额-制费一   
   IF cl_null(p_xcce.xcce304e) THEN LET p_xcce.xcce304e = 0 END IF                  #差异转出金额-制费二   
   IF cl_null(p_xcce.xcce304f) THEN LET p_xcce.xcce304f = 0 END IF                  #差异转出金额-制费三   
   IF cl_null(p_xcce.xcce304g) THEN LET p_xcce.xcce304g = 0 END IF                  #差异转出金额-制费四   
   IF cl_null(p_xcce.xcce304h) THEN LET p_xcce.xcce304h = 0 END IF                  #差异转出金额-制费五   
     
   IF cl_null(p_xcce.xcce307 ) THEN LET p_xcce.xcce307  = 0 END IF                  #盘差数量       
   IF cl_null(p_xcce.xcce308 ) THEN LET p_xcce.xcce308  = 0 END IF                  #盘差金额       
   IF cl_null(p_xcce.xcce308a) THEN LET p_xcce.xcce308a = 0 END IF                  #盘差金额-材料  
   IF cl_null(p_xcce.xcce308b) THEN LET p_xcce.xcce308b = 0 END IF                  #盘差金额-人工  
   IF cl_null(p_xcce.xcce308c) THEN LET p_xcce.xcce308c = 0 END IF                  #盘差金额-加工  
   IF cl_null(p_xcce.xcce308d) THEN LET p_xcce.xcce308d = 0 END IF                  #盘差金额-制费一
   IF cl_null(p_xcce.xcce308e) THEN LET p_xcce.xcce308e = 0 END IF                  #盘差金额-制费二
   IF cl_null(p_xcce.xcce308f) THEN LET p_xcce.xcce308f = 0 END IF                  #盘差金额-制费三
   IF cl_null(p_xcce.xcce308g) THEN LET p_xcce.xcce308g = 0 END IF                  #盘差金额-制费四
   IF cl_null(p_xcce.xcce308h) THEN LET p_xcce.xcce308h = 0 END IF                  #盘差金额-制费五   
   
   IF cl_null(p_xcce.xcce901 ) THEN LET p_xcce.xcce901  = 0 END IF                  #期末结存数量           
   IF cl_null(p_xcce.xcce902 ) THEN LET p_xcce.xcce902  = 0 END IF                  #期末结存金额           
   IF cl_null(p_xcce.xcce902a) THEN LET p_xcce.xcce902a = 0 END IF                  #期末结存金额-材料      
   IF cl_null(p_xcce.xcce902b) THEN LET p_xcce.xcce902b = 0 END IF                  #期末结存金额-人工      
   IF cl_null(p_xcce.xcce902c) THEN LET p_xcce.xcce902c = 0 END IF                  #期末结存金额-加工      
   IF cl_null(p_xcce.xcce902d) THEN LET p_xcce.xcce902d = 0 END IF                  #期末结存金额-制费一    
   IF cl_null(p_xcce.xcce902e) THEN LET p_xcce.xcce902e = 0 END IF                  #期末结存金额-制费二    
   IF cl_null(p_xcce.xcce902f) THEN LET p_xcce.xcce902f = 0 END IF                  #期末结存金额-制费三    
   IF cl_null(p_xcce.xcce902g) THEN LET p_xcce.xcce902g = 0 END IF                  #期末结存金额-制费四    
   IF cl_null(p_xcce.xcce902h) THEN LET p_xcce.xcce902h = 0 END IF                  #期末结存金额-制费五    
      
   LET r_xcce.* = p_xcce.*
   
   RETURN r_xcce.*   
END FUNCTION

################################################################################
# Descriptions...: xccg重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccg_null_to_zero(p_xccg)
#                       RETURNING r_xccg
# Input parameter: p_xccg         xccg的TABLE资料
# Return code....: r_xccg         xccg的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccg_null_to_zero(p_xccg)
#   DEFINE p_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
#   DEFINE r_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
    DEFINE p_xccg            type_g_xccg #170605-00013#1-add
    DEFINE r_xccg            type_g_xccg #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE r_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE

   IF cl_null(p_xccg.xccg101 ) THEN LET p_xccg.xccg101  = 0 END IF                  #上期结存数量        
   IF cl_null(p_xccg.xccg102 ) THEN LET p_xccg.xccg102  = 0 END IF                  #上期结存金额        
   IF cl_null(p_xccg.xccg102a) THEN LET p_xccg.xccg102a = 0 END IF                  #上期结存金额-材料   
   IF cl_null(p_xccg.xccg102b) THEN LET p_xccg.xccg102b = 0 END IF                  #上期结存金额-人工   
   IF cl_null(p_xccg.xccg102c) THEN LET p_xccg.xccg102c = 0 END IF                  #上期结存金额-加工   
   IF cl_null(p_xccg.xccg102d) THEN LET p_xccg.xccg102d = 0 END IF                  #上期结存金额-制费一 
   IF cl_null(p_xccg.xccg102e) THEN LET p_xccg.xccg102e = 0 END IF                  #上期结存金额-制费二 
   IF cl_null(p_xccg.xccg102f) THEN LET p_xccg.xccg102f = 0 END IF                  #上期结存金额-制费三 
   IF cl_null(p_xccg.xccg102g) THEN LET p_xccg.xccg102g = 0 END IF                  #上期结存金额-制费四 
   IF cl_null(p_xccg.xccg102h) THEN LET p_xccg.xccg102h = 0 END IF                  #上期结存金额-制费五    
   
   IF cl_null(p_xccg.xccg301 ) THEN LET p_xccg.xccg301  = 0 END IF                  #本期转出数量        
   IF cl_null(p_xccg.xccg302 ) THEN LET p_xccg.xccg302  = 0 END IF                  #本期转出金额        
   IF cl_null(p_xccg.xccg302a) THEN LET p_xccg.xccg302a = 0 END IF                  #本期转出金额-材料   
   IF cl_null(p_xccg.xccg302b) THEN LET p_xccg.xccg302b = 0 END IF                  #本期转出金额-人工   
   IF cl_null(p_xccg.xccg302c) THEN LET p_xccg.xccg302c = 0 END IF                  #本期转出金额-加工   
   IF cl_null(p_xccg.xccg302d) THEN LET p_xccg.xccg302d = 0 END IF                  #本期转出金额-制费一 
   IF cl_null(p_xccg.xccg302e) THEN LET p_xccg.xccg302e = 0 END IF                  #本期转出金额-制费二 
   IF cl_null(p_xccg.xccg302f) THEN LET p_xccg.xccg302f = 0 END IF                  #本期转出金额-制费三 
   IF cl_null(p_xccg.xccg302g) THEN LET p_xccg.xccg302g = 0 END IF                  #本期转出金额-制费四 
   IF cl_null(p_xccg.xccg302h) THEN LET p_xccg.xccg302h = 0 END IF                  #本期转出金额-制费五   
    
   IF cl_null(p_xccg.xccg901 ) THEN LET p_xccg.xccg901  = 0 END IF                  #期末结存数量           
   IF cl_null(p_xccg.xccg902 ) THEN LET p_xccg.xccg902  = 0 END IF                  #期末结存金额           
   IF cl_null(p_xccg.xccg902a) THEN LET p_xccg.xccg902a = 0 END IF                  #期末结存金额-材料      
   IF cl_null(p_xccg.xccg902b) THEN LET p_xccg.xccg902b = 0 END IF                  #期末结存金额-人工      
   IF cl_null(p_xccg.xccg902c) THEN LET p_xccg.xccg902c = 0 END IF                  #期末结存金额-加工      
   IF cl_null(p_xccg.xccg902d) THEN LET p_xccg.xccg902d = 0 END IF                  #期末结存金额-制费一    
   IF cl_null(p_xccg.xccg902e) THEN LET p_xccg.xccg902e = 0 END IF                  #期末结存金额-制费二    
   IF cl_null(p_xccg.xccg902f) THEN LET p_xccg.xccg902f = 0 END IF                  #期末结存金额-制费三    
   IF cl_null(p_xccg.xccg902g) THEN LET p_xccg.xccg902g = 0 END IF                  #期末结存金额-制费四    
   IF cl_null(p_xccg.xccg902h) THEN LET p_xccg.xccg902h = 0 END IF                  #期末结存金额-制费五    
      
   LET r_xccg.* = p_xccg.*
   RETURN r_xccg.* 
END FUNCTION

################################################################################
# Descriptions...: xcch重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xcch_null_to_zero(p_xcch)
#                       RETURNING r_xcch
# Input parameter: p_xcch         xcch的TABLE资料
# Return code....: r_xcch         xcch的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xcch_null_to_zero(p_xcch)
#   DEFINE p_xcch          RECORD LIKE xcch_t.*   #161124-00048#20 mark
#   DEFINE r_xcch          RECORD LIKE xcch_t.*   #161124-00048#20 mark
   DEFINE p_xcch           type_g_xcch #170605-00013#1-add
   DEFINE r_xcch           type_g_xcch #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE p_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF cl_null(p_xcch.xcch101 ) THEN LET p_xcch.xcch101  = 0 END IF       #上期结存数量           
   IF cl_null(p_xcch.xcch102 ) THEN LET p_xcch.xcch102  = 0 END IF       #上期结存金额           
   IF cl_null(p_xcch.xcch102a) THEN LET p_xcch.xcch102a = 0 END IF       #上期结存金额-材料      
   IF cl_null(p_xcch.xcch102b) THEN LET p_xcch.xcch102b = 0 END IF       #上期结存金额-人工      
   IF cl_null(p_xcch.xcch102c) THEN LET p_xcch.xcch102c = 0 END IF       #上期结存金额-加工      
   IF cl_null(p_xcch.xcch102d) THEN LET p_xcch.xcch102d = 0 END IF       #上期结存金额-制费一    
   IF cl_null(p_xcch.xcch102e) THEN LET p_xcch.xcch102e = 0 END IF       #上期结存金额-制费二    
   IF cl_null(p_xcch.xcch102f) THEN LET p_xcch.xcch102f = 0 END IF       #上期结存金额-制费三    
   IF cl_null(p_xcch.xcch102g) THEN LET p_xcch.xcch102g = 0 END IF       #上期结存金额-制费四    
   IF cl_null(p_xcch.xcch102h) THEN LET p_xcch.xcch102h = 0 END IF       #上期结存金额-制费五       
   IF cl_null(p_xcch.xcch200 ) THEN LET p_xcch.xcch200  = 0 END IF       #本期投入工时              
   IF cl_null(p_xcch.xcch201 ) THEN LET p_xcch.xcch201  = 0 END IF       #本期投入数量           
   IF cl_null(p_xcch.xcch202 ) THEN LET p_xcch.xcch202  = 0 END IF       #本期本阶投入金额       
   IF cl_null(p_xcch.xcch202a) THEN LET p_xcch.xcch202a = 0 END IF       #本期本阶投入金额-材料  
   IF cl_null(p_xcch.xcch202b) THEN LET p_xcch.xcch202b = 0 END IF       #本期本阶投入金额-人工  
   IF cl_null(p_xcch.xcch202c) THEN LET p_xcch.xcch202c = 0 END IF       #本期本阶投入金额-加工  
   IF cl_null(p_xcch.xcch202d) THEN LET p_xcch.xcch202d = 0 END IF       #本期本阶投入金额-制费一
   IF cl_null(p_xcch.xcch202e) THEN LET p_xcch.xcch202e = 0 END IF       #本期本阶投入金额-制费二
   IF cl_null(p_xcch.xcch202f) THEN LET p_xcch.xcch202f = 0 END IF       #本期本阶投入金额-制费三
   IF cl_null(p_xcch.xcch202g) THEN LET p_xcch.xcch202g = 0 END IF       #本期本阶投入金额-制费四
   IF cl_null(p_xcch.xcch202h) THEN LET p_xcch.xcch202h = 0 END IF       #本期本阶投入金额-制费五   
   IF cl_null(p_xcch.xcch204 ) THEN LET p_xcch.xcch204  = 0 END IF       #本期下阶投入金额       
   IF cl_null(p_xcch.xcch204a) THEN LET p_xcch.xcch204a = 0 END IF       #本期下阶投入金额-材料  
   IF cl_null(p_xcch.xcch204b) THEN LET p_xcch.xcch204b = 0 END IF       #本期下阶投入金额-人工  
   IF cl_null(p_xcch.xcch204c) THEN LET p_xcch.xcch204c = 0 END IF       #本期下阶投入金额-加工  
   IF cl_null(p_xcch.xcch204d) THEN LET p_xcch.xcch204d = 0 END IF       #本期下阶投入金额-制费一
   IF cl_null(p_xcch.xcch204e) THEN LET p_xcch.xcch204e = 0 END IF       #本期下阶投入金额-制费二
   IF cl_null(p_xcch.xcch204f) THEN LET p_xcch.xcch204f = 0 END IF       #本期下阶投入金额-制费三
   IF cl_null(p_xcch.xcch204g) THEN LET p_xcch.xcch204g = 0 END IF       #本期下阶投入金额-制费四
   IF cl_null(p_xcch.xcch204h) THEN LET p_xcch.xcch204h = 0 END IF       #本期下阶投入金额-制费五
   IF cl_null(p_xcch.xcch301 ) THEN LET p_xcch.xcch301  = 0 END IF       #本期转出数量           
   IF cl_null(p_xcch.xcch302 ) THEN LET p_xcch.xcch302  = 0 END IF       #本期转出金额           
   IF cl_null(p_xcch.xcch302a) THEN LET p_xcch.xcch302a = 0 END IF       #本期转出金额-材料      
   IF cl_null(p_xcch.xcch302b) THEN LET p_xcch.xcch302b = 0 END IF       #本期转出金额-人工      
   IF cl_null(p_xcch.xcch302c) THEN LET p_xcch.xcch302c = 0 END IF       #本期转出金额-加工      
   IF cl_null(p_xcch.xcch302d) THEN LET p_xcch.xcch302d = 0 END IF       #本期转出金额-制费一    
   IF cl_null(p_xcch.xcch302e) THEN LET p_xcch.xcch302e = 0 END IF       #本期转出金额-制费二    
   IF cl_null(p_xcch.xcch302f) THEN LET p_xcch.xcch302f = 0 END IF       #本期转出金额-制费三    
   IF cl_null(p_xcch.xcch302g) THEN LET p_xcch.xcch302g = 0 END IF       #本期转出金额-制费四    
   IF cl_null(p_xcch.xcch302h) THEN LET p_xcch.xcch302h = 0 END IF       #本期转出金额-制费五       
   IF cl_null(p_xcch.xcch303 ) THEN LET p_xcch.xcch303  = 0 END IF       #差异转出数量           
   IF cl_null(p_xcch.xcch304 ) THEN LET p_xcch.xcch304  = 0 END IF       #差异转出金额           
   IF cl_null(p_xcch.xcch304a) THEN LET p_xcch.xcch304a = 0 END IF       #差异转出金额-材料      
   IF cl_null(p_xcch.xcch304b) THEN LET p_xcch.xcch304b = 0 END IF       #差异转出金额-人工      
   IF cl_null(p_xcch.xcch304c) THEN LET p_xcch.xcch304c = 0 END IF       #差异转出金额-加工      
   IF cl_null(p_xcch.xcch304d) THEN LET p_xcch.xcch304d = 0 END IF       #差异转出金额-制费一    
   IF cl_null(p_xcch.xcch304e) THEN LET p_xcch.xcch304e = 0 END IF       #差异转出金额-制费二    
   IF cl_null(p_xcch.xcch304f) THEN LET p_xcch.xcch304f = 0 END IF       #差异转出金额-制费三    
   IF cl_null(p_xcch.xcch304g) THEN LET p_xcch.xcch304g = 0 END IF       #差异转出金额-制费四    
   IF cl_null(p_xcch.xcch304h) THEN LET p_xcch.xcch304h = 0 END IF       #差异转出金额-制费五  
   IF cl_null(p_xcch.xcch901 ) THEN LET p_xcch.xcch901  = 0 END IF       #期末结存数量           
   IF cl_null(p_xcch.xcch902 ) THEN LET p_xcch.xcch902  = 0 END IF       #期末结存金额           
   IF cl_null(p_xcch.xcch902a) THEN LET p_xcch.xcch902a = 0 END IF       #期末结存金额-材料      
   IF cl_null(p_xcch.xcch902b) THEN LET p_xcch.xcch902b = 0 END IF       #期末结存金额-人工      
   IF cl_null(p_xcch.xcch902c) THEN LET p_xcch.xcch902c = 0 END IF       #期末结存金额-加工      
   IF cl_null(p_xcch.xcch902d) THEN LET p_xcch.xcch902d = 0 END IF       #期末结存金额-制费一    
   IF cl_null(p_xcch.xcch902e) THEN LET p_xcch.xcch902e = 0 END IF       #期末结存金额-制费二    
   IF cl_null(p_xcch.xcch902f) THEN LET p_xcch.xcch902f = 0 END IF       #期末结存金额-制费三    
   IF cl_null(p_xcch.xcch902g) THEN LET p_xcch.xcch902g = 0 END IF       #期末结存金额-制费四    
   IF cl_null(p_xcch.xcch902h) THEN LET p_xcch.xcch902h = 0 END IF       #期末结存金额-制费五     
   
   LET r_xcch.* = p_xcch.*
   RETURN r_xcch.* 
END FUNCTION

################################################################################
# Descriptions...: xcci重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xcci_null_to_zero(p_xcci)
#                       RETURNING r_xcci
# Input parameter: p_xcci         xcci的TABLE资料
# Return code....: r_xcci         xcci的TABLE资料
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xcci_null_to_zero(p_xcci)
#   DEFINE p_xcci          RECORD LIKE xcci_t.*   #161124-00048#20 mark
#   DEFINE r_xcci          RECORD LIKE xcci_t.*   #161124-00048#20 mark
   DEFINE p_xcci           type_g_xcci  #170605-00013#1-add
   DEFINE r_xcci           type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF cl_null(p_xcci.xcci101 ) THEN LET p_xcci.xcci101  = 0 END IF                  #上期结存数量        
   IF cl_null(p_xcci.xcci102 ) THEN LET p_xcci.xcci102  = 0 END IF                  #上期结存金额        
   IF cl_null(p_xcci.xcci102a) THEN LET p_xcci.xcci102a = 0 END IF                  #上期结存金额-材料   
   IF cl_null(p_xcci.xcci102b) THEN LET p_xcci.xcci102b = 0 END IF                  #上期结存金额-人工   
   IF cl_null(p_xcci.xcci102c) THEN LET p_xcci.xcci102c = 0 END IF                  #上期结存金额-加工   
   IF cl_null(p_xcci.xcci102d) THEN LET p_xcci.xcci102d = 0 END IF                  #上期结存金额-制费一 
   IF cl_null(p_xcci.xcci102e) THEN LET p_xcci.xcci102e = 0 END IF                  #上期结存金额-制费二 
   IF cl_null(p_xcci.xcci102f) THEN LET p_xcci.xcci102f = 0 END IF                  #上期结存金额-制费三 
   IF cl_null(p_xcci.xcci102g) THEN LET p_xcci.xcci102g = 0 END IF                  #上期结存金额-制费四 
   IF cl_null(p_xcci.xcci102h) THEN LET p_xcci.xcci102h = 0 END IF                  #上期结存金额-制费五    
   IF cl_null(p_xcci.xcci201 ) THEN LET p_xcci.xcci201  = 0 END IF                  #本期投入数量        
   IF cl_null(p_xcci.xcci202 ) THEN LET p_xcci.xcci202  = 0 END IF                  #本期本阶投入金额        
   IF cl_null(p_xcci.xcci202a) THEN LET p_xcci.xcci202a = 0 END IF                  #本期本阶投入金额-材料   
   IF cl_null(p_xcci.xcci202b) THEN LET p_xcci.xcci202b = 0 END IF                  #本期本阶投入金额-人工   
   IF cl_null(p_xcci.xcci202c) THEN LET p_xcci.xcci202c = 0 END IF                  #本期本阶投入金额-加工   
   IF cl_null(p_xcci.xcci202d) THEN LET p_xcci.xcci202d = 0 END IF                  #本期本阶投入金额-制费一 
   IF cl_null(p_xcci.xcci202e) THEN LET p_xcci.xcci202e = 0 END IF                  #本期本阶投入金额-制费二 
   IF cl_null(p_xcci.xcci202f) THEN LET p_xcci.xcci202f = 0 END IF                  #本期本阶投入金额-制费三 
   IF cl_null(p_xcci.xcci202g) THEN LET p_xcci.xcci202g = 0 END IF                  #本期本阶投入金额-制费四 
   IF cl_null(p_xcci.xcci202h) THEN LET p_xcci.xcci202h = 0 END IF                  #本期本阶投入金额-制费五    
   IF cl_null(p_xcci.xcci301 ) THEN LET p_xcci.xcci301  = 0 END IF                  #本期转出数量        
   IF cl_null(p_xcci.xcci302 ) THEN LET p_xcci.xcci302  = 0 END IF                  #本期转出金额        
   IF cl_null(p_xcci.xcci302a) THEN LET p_xcci.xcci302a = 0 END IF                  #本期转出金额-材料   
   IF cl_null(p_xcci.xcci302b) THEN LET p_xcci.xcci302b = 0 END IF                  #本期转出金额-人工   
   IF cl_null(p_xcci.xcci302c) THEN LET p_xcci.xcci302c = 0 END IF                  #本期转出金额-加工   
   IF cl_null(p_xcci.xcci302d) THEN LET p_xcci.xcci302d = 0 END IF                  #本期转出金额-制费一 
   IF cl_null(p_xcci.xcci302e) THEN LET p_xcci.xcci302e = 0 END IF                  #本期转出金额-制费二 
   IF cl_null(p_xcci.xcci302f) THEN LET p_xcci.xcci302f = 0 END IF                  #本期转出金额-制费三 
   IF cl_null(p_xcci.xcci302g) THEN LET p_xcci.xcci302g = 0 END IF                  #本期转出金额-制费四 
   IF cl_null(p_xcci.xcci302h) THEN LET p_xcci.xcci302h = 0 END IF                  #本期转出金额-制费五    
   IF cl_null(p_xcci.xcci303 ) THEN LET p_xcci.xcci303  = 0 END IF                  #差异转出数量          
   IF cl_null(p_xcci.xcci304 ) THEN LET p_xcci.xcci304  = 0 END IF                  #差异转出金额         
   IF cl_null(p_xcci.xcci304a) THEN LET p_xcci.xcci304a = 0 END IF                  #差异转出金额-材料     
   IF cl_null(p_xcci.xcci304b) THEN LET p_xcci.xcci304b = 0 END IF                  #差异转出金额-人工     
   IF cl_null(p_xcci.xcci304c) THEN LET p_xcci.xcci304c = 0 END IF                  #差异转出金额-加工     
   IF cl_null(p_xcci.xcci304d) THEN LET p_xcci.xcci304d = 0 END IF                  #差异转出金额-制费一   
   IF cl_null(p_xcci.xcci304e) THEN LET p_xcci.xcci304e = 0 END IF                  #差异转出金额-制费二   
   IF cl_null(p_xcci.xcci304f) THEN LET p_xcci.xcci304f = 0 END IF                  #差异转出金额-制费三   
   IF cl_null(p_xcci.xcci304g) THEN LET p_xcci.xcci304g = 0 END IF                  #差异转出金额-制费四   
   IF cl_null(p_xcci.xcci304h) THEN LET p_xcci.xcci304h = 0 END IF                  #差异转出金额-制费五      
   IF cl_null(p_xcci.xcci901 ) THEN LET p_xcci.xcci901  = 0 END IF                  #期末结存数量           
   IF cl_null(p_xcci.xcci902 ) THEN LET p_xcci.xcci902  = 0 END IF                  #期末结存金额           
   IF cl_null(p_xcci.xcci902a) THEN LET p_xcci.xcci902a = 0 END IF                  #期末结存金额-材料      
   IF cl_null(p_xcci.xcci902b) THEN LET p_xcci.xcci902b = 0 END IF                  #期末结存金额-人工      
   IF cl_null(p_xcci.xcci902c) THEN LET p_xcci.xcci902c = 0 END IF                  #期末结存金额-加工      
   IF cl_null(p_xcci.xcci902d) THEN LET p_xcci.xcci902d = 0 END IF                  #期末结存金额-制费一    
   IF cl_null(p_xcci.xcci902e) THEN LET p_xcci.xcci902e = 0 END IF                  #期末结存金额-制费二    
   IF cl_null(p_xcci.xcci902f) THEN LET p_xcci.xcci902f = 0 END IF                  #期末结存金额-制费三    
   IF cl_null(p_xcci.xcci902g) THEN LET p_xcci.xcci902g = 0 END IF                  #期末结存金额-制费四    
   IF cl_null(p_xcci.xcci902h) THEN LET p_xcci.xcci902h = 0 END IF                  #期末结存金额-制费五    
   
   LET r_xcci.* = p_xcci.*
   RETURN r_xcci.*    
END FUNCTION

################################################################################
# Descriptions...: xccn重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccn_null_to_zero(p_xccn)
#                       RETURNING r_xccn
# Input parameter: p_xccn         xccn的TABLE资料
# Return code....: r_xccn         xccn的TABLE资料
# Date & Author..: 2014-09-29 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccn_null_to_zero(p_xccn)
#   DEFINE p_xccn          RECORD LIKE xccn_t.*   #161124-00048#20 mark
#   DEFINE r_xccn          RECORD LIKE xccn_t.*   #161124-00048#20 mark
   DEFINE p_xccn           type_g_xccn  #170605-00013#1-add
   DEFINE r_xccn           type_g_xccn  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccn RECORD  #本期在製轉出成本與工單入庫標準成本差異檔
#       xccnent LIKE xccn_t.xccnent, #企业编号
#       xccncomp LIKE xccn_t.xccncomp, #法人
#       xccnld LIKE xccn_t.xccnld, #账套
#       xccn001 LIKE xccn_t.xccn001, #账套本位币顺序
#       xccn002 LIKE xccn_t.xccn002, #成本域
#       xccn003 LIKE xccn_t.xccn003, #成本计算类型
#       xccn004 LIKE xccn_t.xccn004, #年度
#       xccn005 LIKE xccn_t.xccn005, #期别
#       xccn006 LIKE xccn_t.xccn006, #工单编号
#       xccn102 LIKE xccn_t.xccn102, #在制转出金额
#       xccn102a LIKE xccn_t.xccn102a, #在制转出金额-材料
#       xccn102b LIKE xccn_t.xccn102b, #在制转出金额-人工
#       xccn102c LIKE xccn_t.xccn102c, #在制转出金额-委外
#       xccn102d LIKE xccn_t.xccn102d, #在制转出金额-制费一
#       xccn102e LIKE xccn_t.xccn102e, #在制转出金额-制费二
#       xccn102f LIKE xccn_t.xccn102f, #在制转出金额-制费三
#       xccn102g LIKE xccn_t.xccn102g, #在制转出金额-制费四
#       xccn102h LIKE xccn_t.xccn102h, #在制转出金额-制费五
#       xccn202 LIKE xccn_t.xccn202, #入库标准成本金额
#       xccn202a LIKE xccn_t.xccn202a, #入库标准成本金额-材料
#       xccn202b LIKE xccn_t.xccn202b, #入库标准成本金额-人工
#       xccn202c LIKE xccn_t.xccn202c, #入库标准成本金额-委外
#       xccn202d LIKE xccn_t.xccn202d, #入库标准成本金额-制费一
#       xccn202e LIKE xccn_t.xccn202e, #入库标准成本金额-制费二
#       xccn202f LIKE xccn_t.xccn202f, #入库标准成本金额-制费三
#       xccn202g LIKE xccn_t.xccn202g, #入库标准成本金额-制费四
#       xccn202h LIKE xccn_t.xccn202h, #入库标准成本金额-制费五
#       xccn302 LIKE xccn_t.xccn302, #差异金额
#       xccn302a LIKE xccn_t.xccn302a, #差异金额-材料
#       xccn302b LIKE xccn_t.xccn302b, #差异金额-人工
#       xccn302c LIKE xccn_t.xccn302c, #差异金额-加工费
#       xccn302d LIKE xccn_t.xccn302d, #差异金额-制费一
#       xccn302e LIKE xccn_t.xccn302e, #差异金额-制费二
#       xccn302f LIKE xccn_t.xccn302f, #差异金额-制费三
#       xccn302g LIKE xccn_t.xccn302g, #差异金额-制费四
#       xccn302h LIKE xccn_t.xccn302h  #差异金额-制费五
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xccn RECORD  #本期在製轉出成本與工單入庫標準成本差異檔
#       xccnent LIKE xccn_t.xccnent, #企业编号
#       xccncomp LIKE xccn_t.xccncomp, #法人
#       xccnld LIKE xccn_t.xccnld, #账套
#       xccn001 LIKE xccn_t.xccn001, #账套本位币顺序
#       xccn002 LIKE xccn_t.xccn002, #成本域
#       xccn003 LIKE xccn_t.xccn003, #成本计算类型
#       xccn004 LIKE xccn_t.xccn004, #年度
#       xccn005 LIKE xccn_t.xccn005, #期别
#       xccn006 LIKE xccn_t.xccn006, #工单编号
#       xccn102 LIKE xccn_t.xccn102, #在制转出金额
#       xccn102a LIKE xccn_t.xccn102a, #在制转出金额-材料
#       xccn102b LIKE xccn_t.xccn102b, #在制转出金额-人工
#       xccn102c LIKE xccn_t.xccn102c, #在制转出金额-委外
#       xccn102d LIKE xccn_t.xccn102d, #在制转出金额-制费一
#       xccn102e LIKE xccn_t.xccn102e, #在制转出金额-制费二
#       xccn102f LIKE xccn_t.xccn102f, #在制转出金额-制费三
#       xccn102g LIKE xccn_t.xccn102g, #在制转出金额-制费四
#       xccn102h LIKE xccn_t.xccn102h, #在制转出金额-制费五
#       xccn202 LIKE xccn_t.xccn202, #入库标准成本金额
#       xccn202a LIKE xccn_t.xccn202a, #入库标准成本金额-材料
#       xccn202b LIKE xccn_t.xccn202b, #入库标准成本金额-人工
#       xccn202c LIKE xccn_t.xccn202c, #入库标准成本金额-委外
#       xccn202d LIKE xccn_t.xccn202d, #入库标准成本金额-制费一
#       xccn202e LIKE xccn_t.xccn202e, #入库标准成本金额-制费二
#       xccn202f LIKE xccn_t.xccn202f, #入库标准成本金额-制费三
#       xccn202g LIKE xccn_t.xccn202g, #入库标准成本金额-制费四
#       xccn202h LIKE xccn_t.xccn202h, #入库标准成本金额-制费五
#       xccn302 LIKE xccn_t.xccn302, #差异金额
#       xccn302a LIKE xccn_t.xccn302a, #差异金额-材料
#       xccn302b LIKE xccn_t.xccn302b, #差异金额-人工
#       xccn302c LIKE xccn_t.xccn302c, #差异金额-加工费
#       xccn302d LIKE xccn_t.xccn302d, #差异金额-制费一
#       xccn302e LIKE xccn_t.xccn302e, #差异金额-制费二
#       xccn302f LIKE xccn_t.xccn302f, #差异金额-制费三
#       xccn302g LIKE xccn_t.xccn302g, #差异金额-制费四
#       xccn302h LIKE xccn_t.xccn302h  #差异金额-制费五
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   IF cl_null(p_xccn.xccn102 ) THEN LET p_xccn.xccn102  = 0 END IF       #在制转出金额           
   IF cl_null(p_xccn.xccn102a) THEN LET p_xccn.xccn102a = 0 END IF       #在制转出金额-材料      
   IF cl_null(p_xccn.xccn102b) THEN LET p_xccn.xccn102b = 0 END IF       #在制转出金额-人工      
   IF cl_null(p_xccn.xccn102c) THEN LET p_xccn.xccn102c = 0 END IF       #在制转出金额-加工      
   IF cl_null(p_xccn.xccn102d) THEN LET p_xccn.xccn102d = 0 END IF       #在制转出金额-制费一    
   IF cl_null(p_xccn.xccn102e) THEN LET p_xccn.xccn102e = 0 END IF       #在制转出金额-制费二    
   IF cl_null(p_xccn.xccn102f) THEN LET p_xccn.xccn102f = 0 END IF       #在制转出金额-制费三    
   IF cl_null(p_xccn.xccn102g) THEN LET p_xccn.xccn102g = 0 END IF       #在制转出金额-制费四    
   IF cl_null(p_xccn.xccn102h) THEN LET p_xccn.xccn102h = 0 END IF       #在制转出金额-制费五    
          
   IF cl_null(p_xccn.xccn202 ) THEN LET p_xccn.xccn202  = 0 END IF       #入库标准成本金额       
   IF cl_null(p_xccn.xccn202a) THEN LET p_xccn.xccn202a = 0 END IF       #入库标准成本金额-材料  
   IF cl_null(p_xccn.xccn202b) THEN LET p_xccn.xccn202b = 0 END IF       #入库标准成本金额-人工  
   IF cl_null(p_xccn.xccn202c) THEN LET p_xccn.xccn202c = 0 END IF       #入库标准成本金额-加工  
   IF cl_null(p_xccn.xccn202d) THEN LET p_xccn.xccn202d = 0 END IF       #入库标准成本金额-制费一
   IF cl_null(p_xccn.xccn202e) THEN LET p_xccn.xccn202e = 0 END IF       #入库标准成本金额-制费二
   IF cl_null(p_xccn.xccn202f) THEN LET p_xccn.xccn202f = 0 END IF       #入库标准成本金额-制费三
   IF cl_null(p_xccn.xccn202g) THEN LET p_xccn.xccn202g = 0 END IF       #入库标准成本金额-制费四
   IF cl_null(p_xccn.xccn202h) THEN LET p_xccn.xccn202h = 0 END IF       #入库标准成本金额-制费五

   IF cl_null(p_xccn.xccn302 ) THEN LET p_xccn.xccn302  = 0 END IF       #差异金额           
   IF cl_null(p_xccn.xccn302a) THEN LET p_xccn.xccn302a = 0 END IF       #差异金额-材料      
   IF cl_null(p_xccn.xccn302b) THEN LET p_xccn.xccn302b = 0 END IF       #差异金额-人工      
   IF cl_null(p_xccn.xccn302c) THEN LET p_xccn.xccn302c = 0 END IF       #差异金额-加工      
   IF cl_null(p_xccn.xccn302d) THEN LET p_xccn.xccn302d = 0 END IF       #差异金额-制费一    
   IF cl_null(p_xccn.xccn302e) THEN LET p_xccn.xccn302e = 0 END IF       #差异金额-制费二    
   IF cl_null(p_xccn.xccn302f) THEN LET p_xccn.xccn302f = 0 END IF       #差异金额-制费三    
   IF cl_null(p_xccn.xccn302g) THEN LET p_xccn.xccn302g = 0 END IF       #差异金额-制费四    
   IF cl_null(p_xccn.xccn302h) THEN LET p_xccn.xccn302h = 0 END IF       #差异金额-制费五    

   LET r_xccn.* = p_xccn.*
   RETURN r_xccn.*
   
END FUNCTION

################################################################################
# Descriptions...: xccz重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xccz_null_to_zero(p_xccz)
#                       RETURNING r_xccz
# Input parameter: p_xccz         xccz的TABLE资料
# Return code....: r_xccz         xccz的TABLE资料
# Date & Author..: 2014-08-29 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_set_xccz_null_to_zero(p_xccz)
#   DEFINE p_xccz          RECORD LIKE xccz_t.*   #161124-00048#20 mark
#   DEFINE r_xccz          RECORD LIKE xccz_t.*   #161124-00048#20 mark
   DEFINE p_xccz           type_g_xccz  #170605-00013#1-add
   DEFINE r_xccz           type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE

   IF cl_null(p_xccz.xccz101 ) THEN LET p_xccz.xccz101  = 0 END IF                  #上期结存数量        
    
   IF cl_null(p_xccz.xccz201 ) THEN LET p_xccz.xccz201  = 0 END IF                  #本期投入数量        
    
   IF cl_null(p_xccz.xccz205 ) THEN LET p_xccz.xccz205  = 0 END IF                  #当站下线数量        
   
   IF cl_null(p_xccz.xccz207 ) THEN LET p_xccz.xccz207  = 0 END IF                  #一般退料数量        
       
   IF cl_null(p_xccz.xccz209 ) THEN LET p_xccz.xccz209  = 0 END IF                  #本期超领退数量            
          
   IF cl_null(p_xccz.xccz301 ) THEN LET p_xccz.xccz301  = 0 END IF                  #本期转出数量        
      
   IF cl_null(p_xccz.xccz303 ) THEN LET p_xccz.xccz303  = 0 END IF                  #差异转出数量          
     
   IF cl_null(p_xccz.xccz307 ) THEN LET p_xccz.xccz307  = 0 END IF                  #盘差数量       
   
   IF cl_null(p_xccz.xccz901 ) THEN LET p_xccz.xccz901  = 0 END IF                  #期末结存数量           
      
   LET r_xccz.* = p_xccz.*
   
   RETURN r_xccz.*   
END FUNCTION

################################################################################
# Descriptions...: 检查xccq资料是否存在
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccq(p_xccqsite,p_xccq001,p_xccq002,p_xccq006,p_xccq007,p_xccq008,p_xccq009,p_xccq010,p_xccq011,p_xccq012)
#                       RETURNING l_xccq
# Input parameter: p_xccqsite     營運組織    
#                : p_xccq001      记帐本位币顺序
#                : p_xccq002      成本域
#                : p_xccq006      料件编号
#                : p_xccq007      特征
#                : p_xccq008      批号
#                : p_xccq009      库存管理特征
#                : p_xccq010      倉庫
#                : p_xccq011      儲位
#                : p_xccq012      品类
# Return code....: l_xccq         xccq资料
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccq(p_xccqsite,p_xccq001,p_xccq002,p_xccq006,p_xccq007,p_xccq008,p_xccq009,p_xccq010,p_xccq011,p_xccq012)
   DEFINE p_xccqsite      LIKE xccq_t.xccqsite
   DEFINE p_xccq001       LIKE xccq_t.xccq001  #帳套本位幣順序
   DEFINE p_xccq002       LIKE xccq_t.xccq002  #成本域
   DEFINE p_xccq006       LIKE xccq_t.xccq006  #料號
   DEFINE p_xccq007       LIKE xccq_t.xccq007  #特性碼
   DEFINE p_xccq008       LIKE xccq_t.xccq008  #批號
   DEFINE p_xccq009       LIKE xccq_t.xccq009
   DEFINE p_xccq010       LIKE xccq_t.xccq010
   DEFINE p_xccq011       LIKE xccq_t.xccq011
   DEFINE p_xccq012       LIKE xccq_t.xccq012
#   DEFINE r_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE r_xccq          type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_xccq           type_g_xccq #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_t_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE l_t_xccq           type_g_xccq #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_t_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_t_xcca          RECORD LIKE xcca_t.*  #161124-00048#20 mark
   DEFINE l_t_xcca           type_g_xcca  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_t_xcca RECORD  #期初庫存數量成本開帳檔
   #    xccaent LIKE xcca_t.xccaent, #企业编号
   #    xccald LIKE xcca_t.xccald, #账套
   #    xccacomp LIKE xcca_t.xccacomp, #法人组织
   #    xcca001 LIKE xcca_t.xcca001, #账套本位币顺序
   #    xcca002 LIKE xcca_t.xcca002, #成本域
   #    xcca003 LIKE xcca_t.xcca003, #成本计算类型
   #    xcca004 LIKE xcca_t.xcca004, #年度
   #    xcca005 LIKE xcca_t.xcca005, #期别
   #    xcca006 LIKE xcca_t.xcca006, #料号
   #    xcca007 LIKE xcca_t.xcca007, #特性
   #    xcca008 LIKE xcca_t.xcca008, #批号
   #    xcca101 LIKE xcca_t.xcca101, #当月期末数量
   #    xcca102 LIKE xcca_t.xcca102, #当月期末金额-金额合计
   #    xcca102a LIKE xcca_t.xcca102a, #当月期末金额-材料
   #    xcca102b LIKE xcca_t.xcca102b, #当月期末金额-人工
   #    xcca102c LIKE xcca_t.xcca102c, #当月期末金额-委外加工
   #    xcca102d LIKE xcca_t.xcca102d, #当月期末金额-制费一
   #    xcca102e LIKE xcca_t.xcca102e, #当月期末金额-制费二
   #    xcca102f LIKE xcca_t.xcca102f, #当月期末金额-制费三
   #    xcca102g LIKE xcca_t.xcca102g, #当月期末金额-制费四
   #    xcca102h LIKE xcca_t.xcca102h, #当月期末金额-制费五
   #    xcca110 LIKE xcca_t.xcca110, #当月期末金额-平均单价
   #    xcca110a LIKE xcca_t.xcca110a, #当月期末金额-材料平均单价
   #    xcca110b LIKE xcca_t.xcca110b, #当月期末金额-人工平均单价
   #    xcca110c LIKE xcca_t.xcca110c, #当月期末金额-委外加工平均单
   #    xcca110d LIKE xcca_t.xcca110d, #当月期末金额-制费一平均单价
   #    xcca110e LIKE xcca_t.xcca110e, #当月期末金额-制费二平均单价
   #    xcca110f LIKE xcca_t.xcca110f, #当月期末金额-制费三平均单价
   #    xcca110g LIKE xcca_t.xcca110g, #当月期末金额-制费四平均单价
   #    xcca110h LIKE xcca_t.xcca110h, #当月期末金额-制费五平均单价
   #    xccaownid LIKE xcca_t.xccaownid, #资料所有者
   #    xccaowndp LIKE xcca_t.xccaowndp, #资料所有部门
   #    xccacrtid LIKE xcca_t.xccacrtid, #资料录入者
   #    xccacrtdp LIKE xcca_t.xccacrtdp, #资料录入部门
   #    xccacrtdt LIKE xcca_t.xccacrtdt, #资料创建日
   #    xccamodid LIKE xcca_t.xccamodid, #资料更改者
   #    xccamoddt LIKE xcca_t.xccamoddt, #最近更改日
   #    xccacnfid LIKE xcca_t.xccacnfid, #资料审核者
   #    xccacnfdt LIKE xcca_t.xccacnfdt, #数据审核日
   #    xccapstid LIKE xcca_t.xccapstid, #资料过账者
   #    xccapstdt LIKE xcca_t.xccapstdt, #资料过账日
   #    xccastus LIKE xcca_t.xccastus  #状态码
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_flag1         LIKE type_t.chr1
   DEFINE l_flag2         LIKE type_t.chr1
   DEFINE l_xcbz101       LIKE xcbz_t.xcbz101
   
   WHENEVER ERROR CONTINUE

   INITIALIZE l_xccq.* TO NULL
   
#   SELECT * INTO l_xccq.* FROM xccq_tmp #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xccqent,xccqcomp,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,
          xccq006,xccq007,xccq008,xccq009,xccq010,xccq011,xccq012,xccq101,xccq102,
          xccq102a,xccq102b,xccq102c,xccq102d,xccq102e,xccq102f,xccq102g,xccq102h,
          xccq201,xccq202,xccq202a,xccq202b,xccq202c,xccq202d,xccq202e,xccq202f,
          xccq202g,xccq202h,xccq203,xccq204,xccq204a,xccq204b,xccq204c,xccq204d,
          xccq204e,xccq204f,xccq204g,xccq204h,xccq205,xccq206,xccq206a,xccq206b,
          xccq206c,xccq206d,xccq206e,xccq206f,xccq206g,xccq206h,xccq207,xccq208,
          xccq208a,xccq208b,xccq208c,xccq208d,xccq208e,xccq208f,xccq208g,xccq208h,
          xccq209,xccq210,xccq210a,xccq210b,xccq210c,xccq210d,xccq210e,xccq210f,
          xccq210g,xccq210h,xccq211,xccq212,xccq212a,xccq212b,xccq212c,xccq212d,
          xccq212e,xccq212f,xccq212g,xccq212h,xccq213,xccq214,xccq214a,xccq214b,
          xccq214c,xccq214d,xccq214e,xccq214f,xccq214g,xccq214h,xccq215,xccq216,
          xccq216a,xccq216b,xccq216c,xccq216d,xccq216e,xccq216f,xccq216g,xccq216h,
          xccq217,xccq218,xccq218a,xccq218b,xccq218c,xccq218d,xccq218e,xccq218f,
          xccq218g,xccq218h,xccq280,xccq280a,xccq280b,xccq280c,xccq280d,xccq280e,
          xccq280f,xccq280g,xccq280h,xccq301,xccq302,xccq302a,xccq302b,xccq302c,
          xccq302d,xccq302e,xccq302f,xccq302g,xccq302h,xccq303,xccq304,xccq304a,
          xccq304b,xccq304c,xccq304d,xccq304e,xccq304f,xccq304g,xccq304h,xccq305,
          xccq306,xccq306a,xccq306b,xccq306c,xccq306d,xccq306e,xccq306f,xccq306g,
          xccq306h,xccq307,xccq308,xccq308a,xccq308b,xccq308c,xccq308d,xccq308e,
          xccq308f,xccq308g,xccq308h,xccq309,xccq310,xccq310a,xccq310b,xccq310c,
          xccq310d,xccq310e,xccq310f,xccq310g,xccq310h,xccq311,xccq312,xccq312a,
          xccq312b,xccq312c,xccq312d,xccq312e,xccq312f,xccq312g,xccq312h,xccq313,
          xccq314,xccq314a,xccq314b,xccq314c,xccq314d,xccq314e,xccq314f,xccq314g,
          xccq314h,xccq401,xccq402,xccq901,xccq902,xccq902a,xccq902b,xccq902c,xccq902d,
          xccq902e,xccq902f,xccq902g,xccq902h,xccq903,xccq903a,xccq903b,xccq903c,
          xccq903d,xccq903e,xccq903f,xccq903g,xccq903h,xccqtime 
     INTO l_xccq.* FROM xccq_tmp
   #161124-00048#20 add(e)
    WHERE xccqent = g_enterprise
      AND xccqld  = g_ld
      AND xccqsite= p_xccqsite
      AND xccq001 = p_xccq001
      AND xccq002 = p_xccq002
      AND xccq003 = g_xcat001
      AND xccq004 = g_yy
      AND xccq005 = g_pp
      AND xccq006 = p_xccq006
      AND xccq007 = p_xccq007
      AND xccq008 = p_xccq008
      AND xccq009 = p_xccq009
      AND xccq010 = p_xccq010
      AND xccq011 = p_xccq011
      AND xccq012 = p_xccq012
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xccq.* TO NULL
      CALL s_axcp500_init_xccq0()
           RETURNING l_xccq.*
      LET l_xccq.xccqent  = g_enterprise         #企业编号
      LET l_xccq.xccqcomp = g_comp               #法人组织
      LET l_xccq.xccqld   = g_ld                 #账套
      LET l_xccq.xccqsite = p_xccqsite           #營運組織
      LET l_xccq.xccq001  = p_xccq001            #账套本位币顺序
      LET l_xccq.xccq002  = p_xccq002            #成本域
      LET l_xccq.xccq003  = g_xcat001            #成本计算类型
      LET l_xccq.xccq004  = g_yy                 #年度
      LET l_xccq.xccq005  = g_pp                 #期别
      LET l_xccq.xccq006  = p_xccq006            #料号
      LET l_xccq.xccq007  = p_xccq007            #产品特征
      LET l_xccq.xccq008  = p_xccq008            #批号
      LET l_xccq.xccq009  = p_xccq009            #庫存管理特徵
      LET l_xccq.xccq010  = p_xccq010            #倉庫
      LET l_xccq.xccq011  = p_xccq011            #儲位
      LET l_xccq.xccq012  = p_xccq012            #品類 
      
      #上期结存
      LET l_flag1 = 'N'    #开帐xcca
      LET l_flag2 = 'N'    #上期xccq
#      SELECT 'Y',xcca_t.* INTO l_flag1,l_t_xcca.* FROM xcca_t #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xccaent,xccald,xccacomp,xcca001,xcca002,xcca003,xcca004,xcca005,
             xcca006,xcca007,xcca008,xcca101,xcca102,xcca102a,xcca102b,xcca102c,
             xcca102d,xcca102e,xcca102f,xcca102g,xcca102h,xcca110,xcca110a,xcca110b,
             xcca110c,xcca110d,xcca110e,xcca110f,xcca110g,xcca110h,xccaownid,xccaowndp,
             xccacrtid,xccacrtdp,xccacrtdt,xccamodid,xccamoddt,xccacnfid,xccacnfdt,
             xccapstid,xccapstdt,xccastus 
        INTO l_flag1,l_t_xcca.* FROM xcca_t
      #161124-00048#20 add(e)
       WHERE xccaent = g_enterprise
         AND xccald  = g_ld
         AND xcca001 = p_xccq001                #账套本位币顺序      
         AND xcca002 = p_xccq002                #成本域           
         AND xcca003 = g_xcat001                #成本计算类型    
         AND xcca004 = g_last_yy                     
         AND xcca005 = g_last_pp                     
         AND xcca006 = p_xccq006                #料号     
         AND xcca007 = p_xccq007                #产品特征        
         AND xcca008 = p_xccq008                #批号
         
#      SELECT 'Y',xccq_t.* INTO l_flag2,l_t_xccq.* FROM xccq_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xccqent,xccqcomp,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,
              xccq006,xccq007,xccq008,xccq009,xccq010,xccq011,xccq012,xccq101,xccq102,xccq102a,
              xccq102b,xccq102c,xccq102d,xccq102e,xccq102f,xccq102g,xccq102h,xccq201,xccq202,
              xccq202a,xccq202b,xccq202c,xccq202d,xccq202e,xccq202f,xccq202g,xccq202h,xccq203,
              xccq204,xccq204a,xccq204b,xccq204c,xccq204d,xccq204e,xccq204f,xccq204g,xccq204h,
              xccq205,xccq206,xccq206a,xccq206b,xccq206c,xccq206d,xccq206e,xccq206f,xccq206g,
              xccq206h,xccq207,xccq208,xccq208a,xccq208b,xccq208c,xccq208d,xccq208e,xccq208f,
              xccq208g,xccq208h,xccq209,xccq210,xccq210a,xccq210b,xccq210c,xccq210d,xccq210e,
              xccq210f,xccq210g,xccq210h,xccq211,xccq212,xccq212a,xccq212b,xccq212c,xccq212d,
              xccq212e,xccq212f,xccq212g,xccq212h,xccq213,xccq214,xccq214a,xccq214b,xccq214c,
              xccq214d,xccq214e,xccq214f,xccq214g,xccq214h,xccq215,xccq216,xccq216a,xccq216b,
              xccq216c,xccq216d,xccq216e,xccq216f,xccq216g,xccq216h,xccq217,xccq218,xccq218a,
              xccq218b,xccq218c,xccq218d,xccq218e,xccq218f,xccq218g,xccq218h,xccq280,xccq280a,
              xccq280b,xccq280c,xccq280d,xccq280e,xccq280f,xccq280g,xccq280h,xccq301,xccq302,
              xccq302a,xccq302b,xccq302c,xccq302d,xccq302e,xccq302f,xccq302g,xccq302h,xccq303,
              xccq304,xccq304a,xccq304b,xccq304c,xccq304d,xccq304e,xccq304f,xccq304g,xccq304h,
              xccq305,xccq306,xccq306a,xccq306b,xccq306c,xccq306d,xccq306e,xccq306f,xccq306g,
              xccq306h,xccq307,xccq308,xccq308a,xccq308b,xccq308c,xccq308d,xccq308e,xccq308f,
              xccq308g,xccq308h,xccq309,xccq310,xccq310a,xccq310b,xccq310c,xccq310d,xccq310e,
              xccq310f,xccq310g,xccq310h,xccq311,xccq312,xccq312a,xccq312b,xccq312c,xccq312d,
              xccq312e,xccq312f,xccq312g,xccq312h,xccq313,xccq314,xccq314a,xccq314b,xccq314c,
              xccq314d,xccq314e,xccq314f,xccq314g,xccq314h,xccq401,xccq402,xccq901,xccq902,
              xccq902a,xccq902b,xccq902c,xccq902d,xccq902e,xccq902f,xccq902g,xccq902h,xccq903,
              xccq903a,xccq903b,xccq903c,xccq903d,xccq903e,xccq903f,xccq903g,xccq903h,xccqtime 
         INTO l_flag2,l_t_xccq.* FROM xccq_t  
      #161124-00048#20 add(e)
       WHERE xccqent = g_enterprise
         AND xccqld  = g_ld
         AND xccqsite= p_xccqsite
         AND xccq001 = p_xccq001                #账套本位币顺序      
         AND xccq002 = p_xccq002                #成本域           
         AND xccq003 = g_xcat001                #成本计算类型    
         AND xccq004 = g_last_yy                     
         AND xccq005 = g_last_pp                     
         AND xccq006 = p_xccq006                #料号     
         AND xccq007 = p_xccq007                #产品特征        
         AND xccq008 = p_xccq008                #批号
         AND xccq009 = p_xccq009
         AND xccq010 = p_xccq010
         AND xccq011 = p_xccq011
         AND xccq012 = p_xccq012
     
      CASE
         WHEN l_flag1 = 'Y' 
              IF cl_null(l_t_xcca.xcca102a) THEN LET l_t_xcca.xcca102a = 0 END IF
              IF cl_null(l_t_xcca.xcca102b) THEN LET l_t_xcca.xcca102b = 0 END IF
              IF cl_null(l_t_xcca.xcca102c) THEN LET l_t_xcca.xcca102c = 0 END IF
              IF cl_null(l_t_xcca.xcca102d) THEN LET l_t_xcca.xcca102d = 0 END IF
              IF cl_null(l_t_xcca.xcca102e) THEN LET l_t_xcca.xcca102e = 0 END IF
              IF cl_null(l_t_xcca.xcca102f) THEN LET l_t_xcca.xcca102f = 0 END IF
              IF cl_null(l_t_xcca.xcca102g) THEN LET l_t_xcca.xcca102g = 0 END IF
              IF cl_null(l_t_xcca.xcca102h) THEN LET l_t_xcca.xcca102h = 0 END IF
       
              LET l_t_xcca.xcca102 = l_t_xcca.xcca102a + l_t_xcca.xcca102b + l_t_xcca.xcca102c + l_t_xcca.xcca102d +
                                     l_t_xcca.xcca102e + l_t_xcca.xcca102f + l_t_xcca.xcca102g + l_t_xcca.xcca102h

              #获取xcbz101(xcbz009单位都是基础单位了)
              SELECT NVL(SUM(xcbz101),0) INTO l_xcbz101 FROM xcbz_t
               WHERE xcbzent  = l_xccq.xccqent
                 AND xcbzcomp = l_xccq.xccqcomp  #法人组织
                 AND xcbzld   = l_xccq.xccqld
                 AND xcbzsite = l_xccq.xccqsite
                 AND xcbz001  = g_yy  #年
                 AND xcbz002  = g_pp  #期
                 AND xcbz003  = l_xccq.xccq006  #料件
                 AND xcbz004  = l_xccq.xccq007  #特性
                 AND xcbz008  = l_xccq.xccq008 #批
                 AND xcbz005  = l_xccq.xccq009 #庫存管理特徵
                 AND xcbz006  = l_xccq.xccq010 #仓
                 AND xcbz007  = l_xccq.xccq011 #储
              LET l_xccq.xccq101  = l_xcbz101          #上期结存数量
              #170705-00006#1 mark(S)              
              #LET l_xccq.xccq102 = (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102       #上期结存金额  
              #LET l_xccq.xccq102b= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102b      #上期结存金额-人工  
              #LET l_xccq.xccq102c= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102c      #上期结存金额-加工  
              #LET l_xccq.xccq102d= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102d      #上期结存金额-制费一
              #LET l_xccq.xccq102e= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102e      #上期结存金额-制费二
              #LET l_xccq.xccq102f= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102f      #上期结存金额-制费三
              #LET l_xccq.xccq102g= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102g      #上期结存金额-制费四
              #LET l_xccq.xccq102h= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102h      #上期结存金额-制费五
              #170705-00006#1 mark(E)
              #170705-00006#1 add(S)
              IF l_t_xcca.xcca101 <> 0 THEN
                 LET l_xccq.xccq102 = (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102       #上期结存金额  
                 LET l_xccq.xccq102b= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102b      #上期结存金额-人工  
                 LET l_xccq.xccq102c= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102c      #上期结存金额-加工  
                 LET l_xccq.xccq102d= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102d      #上期结存金额-制费一
                 LET l_xccq.xccq102e= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102e      #上期结存金额-制费二
                 LET l_xccq.xccq102f= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102f      #上期结存金额-制费三
                 LET l_xccq.xccq102g= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102g      #上期结存金额-制费四
                 LET l_xccq.xccq102h= (l_xccq.xccq101/l_t_xcca.xcca101)*l_t_xcca.xcca102h      #上期结存金额-制费五
              ELSE
                 LET l_xccq.xccq102 = 0       #上期结存金额  
                 LET l_xccq.xccq102b= 0      #上期结存金额-人工  
                 LET l_xccq.xccq102c= 0      #上期结存金额-加工  
                 LET l_xccq.xccq102d= 0      #上期结存金额-制费一
                 LET l_xccq.xccq102e= 0      #上期结存金额-制费二
                 LET l_xccq.xccq102f= 0      #上期结存金额-制费三
                 LET l_xccq.xccq102g= 0      #上期结存金额-制费四
                 LET l_xccq.xccq102h= 0      #上期结存金额-制费五 
              END IF
              #170705-00006#1 add(E)              
              LET l_xccq.xccq102a= l_xccq.xccq102 - l_xccq.xccq102b- l_xccq.xccq102c- l_xccq.xccq102d-
                                   l_xccq.xccq102e- l_xccq.xccq102f- l_xccq.xccq102g- l_xccq.xccq102h   
         WHEN l_flag2 = 'Y'
              LET l_xccq.xccq101  = l_t_xccq.xccq901          #上期结存数量       
              LET l_xccq.xccq102  = l_t_xccq.xccq902          #上期结存金额       
              LET l_xccq.xccq102a = l_t_xccq.xccq902a         #上期结存金额-材料  
              LET l_xccq.xccq102b = l_t_xccq.xccq902b         #上期结存金额-人工  
              LET l_xccq.xccq102c = l_t_xccq.xccq902c         #上期结存金额-加工  
              LET l_xccq.xccq102d = l_t_xccq.xccq902d         #上期结存金额-制费一
              LET l_xccq.xccq102e = l_t_xccq.xccq902e         #上期结存金额-制费二
              LET l_xccq.xccq102f = l_t_xccq.xccq902f         #上期结存金额-制费三
              LET l_xccq.xccq102g = l_t_xccq.xccq902g         #上期结存金额-制费四
              LET l_xccq.xccq102h = l_t_xccq.xccq902h         #上期结存金额-制费五               
      END CASE          
   
      LET l_xccq.xccqtime = cl_get_current()     #最近成本计算时间  
         
   END IF
   LET r_xccq.* = l_xccq.*
   RETURN r_xccq.*
END FUNCTION

################################################################################
# Descriptions...: 检查xccc资料是否存在
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccc(p_xccc001,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
#                       RETURNING l_xccc
# Input parameter: p_xccc001      本位币顺序
#                : p_xccc002      成本域
#                : p_xccc006      料件
#                : p_xccc007      特征
#                : p_xccc008      批次
# Return code....: l_xccc         xccc资料
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccc(p_xccc001,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
   DEFINE p_xccc001       LIKE xccc_t.xccc001
   DEFINE p_xccc002       LIKE xccc_t.xccc002
   DEFINE p_xccc006       LIKE xccc_t.xccc006
   DEFINE p_xccc007       LIKE xccc_t.xccc007
   DEFINE p_xccc008       LIKE xccc_t.xccc008
#   DEFINE r_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE r_xccc          type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_xccc           type_g_xccc #170605-00013#1-add   
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_t_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE l_t_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_t_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE l_t_xcca          RECORD LIKE xcca_t.*  #161124-00048#20 mark
   DEFINE l_t_xcca           type_g_xcca  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_t_xcca RECORD  #期初庫存數量成本開帳檔
   #    xccaent LIKE xcca_t.xccaent, #企业编号
   #    xccald LIKE xcca_t.xccald, #账套
   #    xccacomp LIKE xcca_t.xccacomp, #法人组织
   #    xcca001 LIKE xcca_t.xcca001, #账套本位币顺序
   #    xcca002 LIKE xcca_t.xcca002, #成本域
   #    xcca003 LIKE xcca_t.xcca003, #成本计算类型
   #    xcca004 LIKE xcca_t.xcca004, #年度
   #    xcca005 LIKE xcca_t.xcca005, #期别
   #    xcca006 LIKE xcca_t.xcca006, #料号
   #    xcca007 LIKE xcca_t.xcca007, #特性
   #    xcca008 LIKE xcca_t.xcca008, #批号
   #    xcca101 LIKE xcca_t.xcca101, #当月期末数量
   #    xcca102 LIKE xcca_t.xcca102, #当月期末金额-金额合计
   #    xcca102a LIKE xcca_t.xcca102a, #当月期末金额-材料
   #    xcca102b LIKE xcca_t.xcca102b, #当月期末金额-人工
   #    xcca102c LIKE xcca_t.xcca102c, #当月期末金额-委外加工
   #    xcca102d LIKE xcca_t.xcca102d, #当月期末金额-制费一
   #    xcca102e LIKE xcca_t.xcca102e, #当月期末金额-制费二
   #    xcca102f LIKE xcca_t.xcca102f, #当月期末金额-制费三
   #    xcca102g LIKE xcca_t.xcca102g, #当月期末金额-制费四
   #    xcca102h LIKE xcca_t.xcca102h, #当月期末金额-制费五
   #    xcca110 LIKE xcca_t.xcca110, #当月期末金额-平均单价
   #    xcca110a LIKE xcca_t.xcca110a, #当月期末金额-材料平均单价
   #    xcca110b LIKE xcca_t.xcca110b, #当月期末金额-人工平均单价
   #    xcca110c LIKE xcca_t.xcca110c, #当月期末金额-委外加工平均单
   #    xcca110d LIKE xcca_t.xcca110d, #当月期末金额-制费一平均单价
   #    xcca110e LIKE xcca_t.xcca110e, #当月期末金额-制费二平均单价
   #    xcca110f LIKE xcca_t.xcca110f, #当月期末金额-制费三平均单价
   #    xcca110g LIKE xcca_t.xcca110g, #当月期末金额-制费四平均单价
   #    xcca110h LIKE xcca_t.xcca110h, #当月期末金额-制费五平均单价
   #    xccaownid LIKE xcca_t.xccaownid, #资料所有者
   #    xccaowndp LIKE xcca_t.xccaowndp, #资料所有部门
   #    xccacrtid LIKE xcca_t.xccacrtid, #资料录入者
   #    xccacrtdp LIKE xcca_t.xccacrtdp, #资料录入部门
   #    xccacrtdt LIKE xcca_t.xccacrtdt, #资料创建日
   #    xccamodid LIKE xcca_t.xccamodid, #资料更改者
   #    xccamoddt LIKE xcca_t.xccamoddt, #最近更改日
   #    xccacnfid LIKE xcca_t.xccacnfid, #资料审核者
   #    xccacnfdt LIKE xcca_t.xccacnfdt, #数据审核日
   #    xccapstid LIKE xcca_t.xccapstid, #资料过账者
   #    xccapstdt LIKE xcca_t.xccapstdt, #资料过账日
   #    xccastus LIKE xcca_t.xccastus  #状态码
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_flag1         LIKE type_t.chr1
   DEFINE l_flag2         LIKE type_t.chr1
   
   WHENEVER ERROR CONTINUE

   INITIALIZE l_xccc.* TO NULL
   
#   SELECT * INTO l_xccc.* FROM xccc_tmp  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xcccent,xccccomp,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,
          xccc006,xccc007,xccc008,xccc010,xccc101,xccc102,xccc102a,xccc102b,
          xccc102c,xccc102d,xccc102e,xccc102f,xccc102g,xccc102h,xccc201,xccc202,
          xccc202a,xccc202b,xccc202c,xccc202d,xccc202e,xccc202f,xccc202g,xccc202h,
          xccc203,xccc204,xccc204a,xccc204b,xccc204c,xccc204d,xccc204e,xccc204f,
          xccc204g,xccc204h,xccc205,xccc206,xccc206a,xccc206b,xccc206c,xccc206d,
          xccc206e,xccc206f,xccc206g,xccc206h,xccc207,xccc208,xccc208a,xccc208b,
          xccc208c,xccc208d,xccc208e,xccc208f,xccc208g,xccc208h,xccc209,xccc210,
          xccc210a,xccc210b,xccc210c,xccc210d,xccc210e,xccc210f,xccc210g,xccc210h,
          xccc211,xccc212,xccc212a,xccc212b,xccc212c,xccc212d,xccc212e,xccc212f,
          xccc212g,xccc212h,xccc213,xccc214,xccc214a,xccc214b,xccc214c,xccc214d,
          xccc214e,xccc214f,xccc214g,xccc214h,xccc215,xccc216,xccc216a,xccc216b,
          xccc216c,xccc216d,xccc216e,xccc216f,xccc216g,xccc216h,xccc217,xccc218,
          xccc218a,xccc218b,xccc218c,xccc218d,xccc218e,xccc218f,xccc218g,xccc218h,
          xccc280,xccc280a,xccc280b,xccc280c,xccc280d,xccc280e,xccc280f,xccc280g,
          xccc280h,xccc301,xccc302,xccc302a,xccc302b,xccc302c,xccc302d,xccc302e,
          xccc302f,xccc302g,xccc302h,xccc303,xccc304,xccc304a,xccc304b,xccc304c,
          xccc304d,xccc304e,xccc304f,xccc304g,xccc304h,xccc305,xccc306,xccc306a,
          xccc306b,xccc306c,xccc306d,xccc306e,xccc306f,xccc306g,xccc306h,xccc307,
          xccc308,xccc308a,xccc308b,xccc308c,xccc308d,xccc308e,xccc308f,xccc308g,
          xccc308h,xccc309,xccc310,xccc310a,xccc310b,xccc310c,xccc310d,xccc310e,
          xccc310f,xccc310g,xccc310h,xccc311,xccc312,xccc312a,xccc312b,xccc312c,
          xccc312d,xccc312e,xccc312f,xccc312g,xccc312h,xccc313,xccc314,xccc314a,
          xccc314b,xccc314c,xccc314d,xccc314e,xccc314f,xccc314g,xccc314h,xccc401,
          xccc402,xccc901,xccc902,xccc902a,xccc902b,xccc902c,xccc902d,xccc902e,
          xccc902f,xccc902g,xccc902h,xccc903,xccc903a,xccc903b,xccc903c,xccc903d,
          xccc903e,xccc903f,xccc903g,xccc903h,xccctime 
     INTO l_xccc.* FROM xccc_tmp
   #161124-00048#20 add(e)
    WHERE xcccent = g_enterprise
      AND xcccld  = g_ld
      AND xccc001 = p_xccc001
      AND xccc002 = p_xccc002
      AND xccc003 = g_xcat001
      AND xccc004 = g_yy
      AND xccc005 = g_pp
      AND xccc006 = p_xccc006
      AND xccc007 = p_xccc007
      AND xccc008 = p_xccc008
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xccc.* TO NULL
      CALL s_axcp500_init_xccc0()
           RETURNING l_xccc.*
      LET l_xccc.xcccent  = g_enterprise         #企业编号
      LET l_xccc.xccccomp = g_comp               #法人组织
      LET l_xccc.xcccld   = g_ld                 #账套
      LET l_xccc.xccc001  = p_xccc001            #账套本位币顺序
      LET l_xccc.xccc002  = p_xccc002            #成本域
      LET l_xccc.xccc003  = g_xcat001            #成本计算类型
      LET l_xccc.xccc004  = g_yy                 #年度
      LET l_xccc.xccc005  = g_pp                 #期别
      LET l_xccc.xccc006  = p_xccc006            #料号
      LET l_xccc.xccc007  = p_xccc007            #产品特征
      LET l_xccc.xccc008  = p_xccc008            #批号
      LET l_xccc.xccc010  = g_curr[p_xccc001].curr   #核算币别  
      
      #上期结存
      LET l_flag1 = 'N'    #开帐xcca
      LET l_flag2 = 'N'    #上期xccc
#      SELECT 'Y',xcca_t.* INTO l_flag1,l_t_xcca.* FROM xcca_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xccaent,xccald,xccacomp,xcca001,xcca002,xcca003,xcca004,xcca005,
             xcca006,xcca007,xcca008,xcca101,xcca102,xcca102a,xcca102b,xcca102c,
             xcca102d,xcca102e,xcca102f,xcca102g,xcca102h,xcca110,xcca110a,xcca110b,
             xcca110c,xcca110d,xcca110e,xcca110f,xcca110g,xcca110h,xccaownid,xccaowndp,
             xccacrtid,xccacrtdp,xccacrtdt,xccamodid,xccamoddt,xccacnfid,xccacnfdt,
             xccapstid,xccapstdt,xccastus 
        INTO l_flag1,l_t_xcca.* FROM xcca_t 
      #161124-00048#20 add(e)
       WHERE xccaent = g_enterprise
         AND xccald  = g_ld
         AND xcca001 = p_xccc001                #账套本位币顺序      
         AND xcca002 = p_xccc002                #成本域           
         AND xcca003 = g_xcat001                #成本计算类型    
         AND xcca004 = g_last_yy                     
         AND xcca005 = g_last_pp                     
         AND xcca006 = p_xccc006                #料号     
         AND xcca007 = p_xccc007                #产品特征        
         AND xcca008 = p_xccc008                #批号
         
#      SELECT 'Y',xccc_t.* INTO l_flag2,l_t_xccc.* FROM xccc_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xcccent,xccccomp,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,
             xccc006,xccc007,xccc008,xccc010,xccc101,xccc102,xccc102a,xccc102b,xccc102c,
             xccc102d,xccc102e,xccc102f,xccc102g,xccc102h,xccc201,xccc202,xccc202a,xccc202b,
             xccc202c,xccc202d,xccc202e,xccc202f,xccc202g,xccc202h,xccc203,xccc204,xccc204a,
             xccc204b,xccc204c,xccc204d,xccc204e,xccc204f,xccc204g,xccc204h,xccc205,xccc206,
             xccc206a,xccc206b,xccc206c,xccc206d,xccc206e,xccc206f,xccc206g,xccc206h,xccc207,
             xccc208,xccc208a,xccc208b,xccc208c,xccc208d,xccc208e,xccc208f,xccc208g,xccc208h,
             xccc209,xccc210,xccc210a,xccc210b,xccc210c,xccc210d,xccc210e,xccc210f,xccc210g,
             xccc210h,xccc211,xccc212,xccc212a,xccc212b,xccc212c,xccc212d,xccc212e,xccc212f,
             xccc212g,xccc212h,xccc213,xccc214,xccc214a,xccc214b,xccc214c,xccc214d,xccc214e,
             xccc214f,xccc214g,xccc214h,xccc215,xccc216,xccc216a,xccc216b,xccc216c,xccc216d,
             xccc216e,xccc216f,xccc216g,xccc216h,xccc217,xccc218,xccc218a,xccc218b,xccc218c,
             xccc218d,xccc218e,xccc218f,xccc218g,xccc218h,xccc280,xccc280a,xccc280b,xccc280c,
             xccc280d,xccc280e,xccc280f,xccc280g,xccc280h,xccc301,xccc302,xccc302a,xccc302b,
             xccc302c,xccc302d,xccc302e,xccc302f,xccc302g,xccc302h,xccc303,xccc304,xccc304a,
             xccc304b,xccc304c,xccc304d,xccc304e,xccc304f,xccc304g,xccc304h,xccc305,xccc306,
             xccc306a,xccc306b,xccc306c,xccc306d,xccc306e,xccc306f,xccc306g,xccc306h,xccc307,
             xccc308,xccc308a,xccc308b,xccc308c,xccc308d,xccc308e,xccc308f,xccc308g,xccc308h,
             xccc309,xccc310,xccc310a,xccc310b,xccc310c,xccc310d,xccc310e,xccc310f,xccc310g,
             xccc310h,xccc311,xccc312,xccc312a,xccc312b,xccc312c,xccc312d,xccc312e,xccc312f,
             xccc312g,xccc312h,xccc313,xccc314,xccc314a,xccc314b,xccc314c,xccc314d,xccc314e,
             xccc314f,xccc314g,xccc314h,xccc401,xccc402,xccc901,xccc902,xccc902a,xccc902b,
             xccc902c,xccc902d,xccc902e,xccc902f,xccc902g,xccc902h,xccc903,xccc903a,xccc903b,
             xccc903c,xccc903d,xccc903e,xccc903f,xccc903g,xccc903h,xccctime 
        INTO l_flag2,l_t_xccc.* FROM xccc_t
      #161124-00048#20 add(e)
       WHERE xcccent = g_enterprise
         AND xcccld  = g_ld
         AND xccc001 = p_xccc001                #账套本位币顺序      
         AND xccc002 = p_xccc002                #成本域           
         AND xccc003 = g_xcat001                #成本计算类型    
         AND xccc004 = g_last_yy                     
         AND xccc005 = g_last_pp                     
         AND xccc006 = p_xccc006                #料号     
         AND xccc007 = p_xccc007                #产品特征        
         AND xccc008 = p_xccc008                #批号
     
      CASE
         WHEN l_flag1 = 'Y' 
              IF cl_null(l_t_xcca.xcca102a) THEN LET l_t_xcca.xcca102a = 0 END IF
              IF cl_null(l_t_xcca.xcca102b) THEN LET l_t_xcca.xcca102b = 0 END IF
              IF cl_null(l_t_xcca.xcca102c) THEN LET l_t_xcca.xcca102c = 0 END IF
              IF cl_null(l_t_xcca.xcca102d) THEN LET l_t_xcca.xcca102d = 0 END IF
              IF cl_null(l_t_xcca.xcca102e) THEN LET l_t_xcca.xcca102e = 0 END IF
              IF cl_null(l_t_xcca.xcca102f) THEN LET l_t_xcca.xcca102f = 0 END IF
              IF cl_null(l_t_xcca.xcca102g) THEN LET l_t_xcca.xcca102g = 0 END IF
              IF cl_null(l_t_xcca.xcca102h) THEN LET l_t_xcca.xcca102h = 0 END IF
       
              LET l_t_xcca.xcca102 = l_t_xcca.xcca102a + l_t_xcca.xcca102b + l_t_xcca.xcca102c + l_t_xcca.xcca102d +
                                     l_t_xcca.xcca102e + l_t_xcca.xcca102f + l_t_xcca.xcca102g + l_t_xcca.xcca102h


              LET l_xccc.xccc101  = l_t_xcca.xcca101          #上期结存数量       
              LET l_xccc.xccc102  = l_t_xcca.xcca102          #上期结存金额       
              LET l_xccc.xccc102a = l_t_xcca.xcca102a         #上期结存金额-材料  
              LET l_xccc.xccc102b = l_t_xcca.xcca102b         #上期结存金额-人工  
              LET l_xccc.xccc102c = l_t_xcca.xcca102c         #上期结存金额-加工  
              LET l_xccc.xccc102d = l_t_xcca.xcca102d         #上期结存金额-制费一
              LET l_xccc.xccc102e = l_t_xcca.xcca102e         #上期结存金额-制费二
              LET l_xccc.xccc102f = l_t_xcca.xcca102f         #上期结存金额-制费三
              LET l_xccc.xccc102g = l_t_xcca.xcca102g         #上期结存金额-制费四
              LET l_xccc.xccc102h = l_t_xcca.xcca102h         #上期结存金额-制费五                
         WHEN l_flag2 = 'Y'
              LET l_xccc.xccc101  = l_t_xccc.xccc901          #上期结存数量       
              LET l_xccc.xccc102  = l_t_xccc.xccc902          #上期结存金额       
              LET l_xccc.xccc102a = l_t_xccc.xccc902a         #上期结存金额-材料  
              LET l_xccc.xccc102b = l_t_xccc.xccc902b         #上期结存金额-人工  
              LET l_xccc.xccc102c = l_t_xccc.xccc902c         #上期结存金额-加工  
              LET l_xccc.xccc102d = l_t_xccc.xccc902d         #上期结存金额-制费一
              LET l_xccc.xccc102e = l_t_xccc.xccc902e         #上期结存金额-制费二
              LET l_xccc.xccc102f = l_t_xccc.xccc902f         #上期结存金额-制费三
              LET l_xccc.xccc102g = l_t_xccc.xccc902g         #上期结存金额-制费四
              LET l_xccc.xccc102h = l_t_xccc.xccc902h         #上期结存金额-制费五               
      END CASE          
   
      LET l_xccc.xccctime = cl_get_current()     #最近成本计算时间  
         
   END IF
   LET r_xccc.* = l_xccc.*
   RETURN r_xccc.*
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 取当期xccd资料
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccd(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_site         工单SITE
#                : p_xcck047      工单单号
#                : p_xcck048      重复性生产-计划编号
#                : p_xcck049      重复性生产-生产料号
#                : p_xcck050      重复性生产-生产BOM特性
#                : p_xcck051      重复性生产-生产料号产品特征
#                : p_sfaa010      主件编号
# Return code....: r_xccd         xccd_t的资料
# Date & Author..: 2014-10-14 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccd(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_site          LIKE sfaa_t.sfaasite
   DEFINE p_xcck047       LIKE xcck_t.xcck047
   DEFINE p_xcck048       LIKE xcck_t.xcck048
   DEFINE p_xcck049       LIKE xcck_t.xcck049
   DEFINE p_xcck050       LIKE xcck_t.xcck050
   DEFINE p_xcck051       LIKE xcck_t.xcck051
   DEFINE p_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE r_success       LIKE type_t.num5
#   DEFINE r_xccd          RECORD LIKE xccd_t.* #161124-00048#20 mark
   DEFINE l_xccd006       LIKE xccd_t.xccd006
   DEFINE l_xccd002       LIKE xccd_t.xccd002
   DEFINE l_xccd012       LIKE xccd_t.xccd012    #重复性生产否 
#   DEFINE l_xccd          RECORD LIKE xccd_t.* #161124-00048#20 mark
#   DEFINE l_t_xccd        RECORD LIKE xccd_t.* #161124-00048#20 mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE r_xccd          type_g_xccd  #170605-00013#1-add
   DEFINE l_xccd          type_g_xccd  #170605-00013#1-add
   DEFINE l_t_xccd        type_g_xccd  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   #DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   #DEFINE l_t_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
     
   WHENEVER ERROR CONTINUE
   INITIALIZE r_xccd.* TO NULL

   #工单号码
   LET l_xccd006 = p_xcck047

   IF cl_null(p_xcck048) THEN         #无计划编号
      LET l_xccd012 = 'N'
   ELSE                               #重复性生产
      LET l_xccd012 = 'Y'    
   END IF

   #成本域
   IF g_field_type = '1' THEN
      SELECT xcbf001 INTO l_xccd002 FROM xcbf_t
       WHERE xcbfent  = g_enterprise
         AND xcbfcomp = g_comp
         AND xcbf002  = p_site
      IF l_xccd002 IS NULL THEN
         LET l_xccd002 = ' '
      END IF
   ELSE
      LET l_xccd002 = ' '
   END IF 
   
#   SELECT * INTO l_xccd.* FROM xccd_tmp  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,
          xccd006,xccd007,xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,
          xccd014,xccd101,xccd102,xccd102a,xccd102b,xccd102c,xccd102d,xccd102e,
          xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,xccd202a,xccd202b,
          xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,
          xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,
          xccd302,xccd302a,xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,
          xccd302h,xccd303,xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,
          xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,xccd902b,xccd902c,
          xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime 
     INTO l_xccd.* FROM xccd_tmp
   #161124-00048#20 add(e)
    WHERE xccdent = g_enterprise
      AND xccdld  = g_ld
      AND xccd001 = p_seq
      AND xccd002 = l_xccd002
      AND xccd003 = g_xcat001
      AND xccd004 = g_yy
      AND xccd005 = g_pp
      AND xccd006 = l_xccd006 
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xccd.* TO NULL
      CALL s_axcp500_init_xccd0()
           RETURNING l_xccd.*
      LET l_xccd.xccdent  = g_enterprise         #企業編號
      LET l_xccd.xccdcomp = g_comp               #法人組織
      LET l_xccd.xccdld   = g_ld                 #帳套
      LET l_xccd.xccd001  = p_seq                #帳套本位幣順序
      LET l_xccd.xccd002  = l_xccd002            #成本域
      LET l_xccd.xccd003  = g_xcat001            #成本計算類型
      LET l_xccd.xccd004  = g_yy                 #年度
      LET l_xccd.xccd005  = g_pp                 #期別
      LET l_xccd.xccd006  = l_xccd006            #工單編號
      
      IF l_xccd012 = 'N' THEN   #一般性生产
         LET l_xccd.xccd007  = p_sfaa010         #主件料號
         LET l_xccd.xccd008  = ' '               #产品特征
         LET l_xccd.xccd009  = ' '               #批號      
         #項目號
#wujie 160522 --begin  #wujie g_sfaa028不等于空的时候，代表是s_axcp500_avg1_wip和s_axcp500_avg1_rework进来的，不需要重复抓sfaa028
         IF g_sfaa028 IS NOT NULL THEN
            IF g_sfaa028 = ' ' THEN    #表示s_axcp500_avg1_wip和s_axcp500_avg1_rework进来，但是那里也没有取到sfaa028的值，但是要用空格与非s_axcp500_avg1_wip进来的区分
               LET l_xccd.xccd010 = ''
            ELSE 
               LET l_xccd.xccd010 = g_sfaa028
            END IF
         ELSE
            SELECT sfaa028 INTO l_xccd.xccd010 FROM sfaa_tmp
             WHERE sfaaent   = g_enterprise
               AND sfaadocno = l_xccd.xccd006
         END IF
#         SELECT sfaa028 INTO l_xccd.xccd010 FROM sfaa_tmp
#          WHERE sfaaent   = g_enterprise
#            AND sfaadocno = l_xccd.xccd006
#wujie 160522 --end
         LET l_xccd.xccd011  = g_curr[p_seq].curr   #核算幣別
         LET l_xccd.xccd012  = 'N'                  #重複性成產否
         LET l_xccd.xccd013  = ''                   #成產計劃號
         LET l_xccd.xccd014  = ''                   #BOM特性
      
      ELSE                      #重复性生产
         LET l_xccd.xccd007  = p_xcck049            #主件料號
         LET l_xccd.xccd008  = p_xcck051            #特性
         LET l_xccd.xccd009  = ' '                  #批號  
         LET l_xccd.xccd010  = ''                   #項目號     
         LET l_xccd.xccd011  = g_curr[p_seq].curr   #核算幣別
         LET l_xccd.xccd012  = 'Y'                  #重複性成產否
         LET l_xccd.xccd013  = p_xcck048            #成產計劃號
         LET l_xccd.xccd014  = p_xcck050            #BOM特性
      
      END IF

      #新增xccd_t时,要把上期的"结余资料"放在本期"上期期初"字段中
#      SELECT xccd_t.* INTO l_t_xccd.* FROM xccd_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,
             xccd006,xccd007,xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,
             xccd014,xccd101,xccd102,xccd102a,xccd102b,xccd102c,xccd102d,xccd102e,
             xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,xccd202a,xccd202b,
             xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,
             xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,
             xccd302,xccd302a,xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,
             xccd302h,xccd303,xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,
             xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,xccd902b,xccd902c,
             xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime 
        INTO l_t_xccd.* FROM xccd_t 
      #161124-00048#20 add(e)
       WHERE xccdent = g_enterprise
         AND xccdld  = g_ld
         AND xccd001 = p_seq
         AND xccd002 = l_xccd002
         AND xccd003 = g_xcat001
         AND xccd004 = g_last_yy
         AND xccd005 = g_last_pp
         AND xccd006 = l_xccd.xccd006
      IF SQLCA.sqlcode = 0 THEN
         LET l_xccd.xccd101  = l_t_xccd.xccd901          #上期结存数量       
         LET l_xccd.xccd102  = l_t_xccd.xccd902          #上期结存金额       
         LET l_xccd.xccd102a = l_t_xccd.xccd902a         #上期结存金额-材料  
         LET l_xccd.xccd102b = l_t_xccd.xccd902b         #上期结存金额-人工  
         LET l_xccd.xccd102c = l_t_xccd.xccd902c         #上期结存金额-加工  
         LET l_xccd.xccd102d = l_t_xccd.xccd902d         #上期结存金额-制费一
         LET l_xccd.xccd102e = l_t_xccd.xccd902e         #上期结存金额-制费二
         LET l_xccd.xccd102f = l_t_xccd.xccd902f         #上期结存金额-制费三
         LET l_xccd.xccd102g = l_t_xccd.xccd902g         #上期结存金额-制费四
         LET l_xccd.xccd102h = l_t_xccd.xccd902h         #上期结存金额-制费五               
      END IF
      LET l_xccd.xccdtime = cl_get_current()     #最近成本計算時間
   END IF
        
   LET r_xccd.* = l_xccd.*
   RETURN r_xccd.*

END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 取当期的xcce的值
# Memo...........: 与s_cost_realtime_get_xcce函数完全一样，差异只有此处从临时表xcce_tmp中判断，而对方是从xcce_t中判断
# Usage..........: CALL s_axcp500_get_xcce(p_xcce001,p_xcce002,p_xcce006,p_xcce007,p_xcce008,p_xcce009)
#                       RETURNING r_xcce
# Input parameter: p_xcce001      记帐本位币顺序
#                : p_xcce002      成本域
#                : p_xcce006      工单单号
#                : p_xcce007      元件料号
#                : p_xcce008      元件产品特征
#                : p_xcce009      元件批号
# Return code....: r_xcce         xcce_t的资料
# Date & Author..: 2014-08-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xcce(p_xcce001,p_xcce002,p_xcce006,p_xcce007,p_xcce008,p_xcce009)
   DEFINE p_xcce001       LIKE xcce_t.xcce001
   DEFINE p_xcce002       LIKE xcce_t.xcce002
   DEFINE p_xcce006       LIKE xcce_t.xcce006
   DEFINE p_xcce007       LIKE xcce_t.xcce007
   DEFINE p_xcce008       LIKE xcce_t.xcce008
   DEFINE p_xcce009       LIKE xcce_t.xcce009
#   DEFINE r_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
#   DEFINE l_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
#   DEFINE l_t_xcce        RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE r_xcce           type_g_xcce  #170605-00013#1-add
   DEFINE l_xcce           type_g_xcce  #170605-00013#1-add
   DEFINE l_t_xcce         type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_t_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_t_xccb        RECORD LIKE xccb_t.*   #161124-00048#20 mark
   DEFINE l_t_xccb         type_g_xccb  #170605-00013#1-add  
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#   DEFINE l_t_xccb RECORD  #期初在製數量成本開帳檔
#       xccbent LIKE xccb_t.xccbent, #企业编号
#       xccbld LIKE xccb_t.xccbld, #账套
#       xccbcomp LIKE xccb_t.xccbcomp, #法人组织
#       xccb001 LIKE xccb_t.xccb001, #账套本位币顺序
#       xccb002 LIKE xccb_t.xccb002, #成本域
#       xccb003 LIKE xccb_t.xccb003, #成本计算类型
#       xccb004 LIKE xccb_t.xccb004, #年度
#       xccb005 LIKE xccb_t.xccb005, #期别
#       xccb006 LIKE xccb_t.xccb006, #工单编号
#       xccb007 LIKE xccb_t.xccb007, #元件编号
#       xccb008 LIKE xccb_t.xccb008, #特性
#       xccb009 LIKE xccb_t.xccb009, #批号
#       xccb010 LIKE xccb_t.xccb010, #元件类型
#       xccb101 LIKE xccb_t.xccb101, #当月期末数量
#       xccb102 LIKE xccb_t.xccb102, #当月期末金额-金额合计
#       xccb102a LIKE xccb_t.xccb102a, #当月期末金额-材料
#       xccb102b LIKE xccb_t.xccb102b, #当月期末金额-人工
#       xccb102c LIKE xccb_t.xccb102c, #当月期末金额-委外加工
#       xccb102d LIKE xccb_t.xccb102d, #当月期末金额-制费一
#       xccb102e LIKE xccb_t.xccb102e, #当月期末金额-制费二
#       xccb102f LIKE xccb_t.xccb102f, #当月期末金额-制费三
#       xccb102g LIKE xccb_t.xccb102g, #当月期末金额-制费四
#       xccb102h LIKE xccb_t.xccb102h, #当月期末金额-制费五
#       xccbownid LIKE xccb_t.xccbownid, #资料所有者
#       xccbowndp LIKE xccb_t.xccbowndp, #资料所有部门
#       xccbcrtid LIKE xccb_t.xccbcrtid, #资料录入者
#       xccbcrtdp LIKE xccb_t.xccbcrtdp, #资料录入部门
#       xccbcrtdt LIKE xccb_t.xccbcrtdt, #资料创建日
#       xccbmodid LIKE xccb_t.xccbmodid, #资料更改者
#       xccbmoddt LIKE xccb_t.xccbmoddt, #最近更改日
#       xccbcnfid LIKE xccb_t.xccbcnfid, #资料审核者
#       xccbcnfdt LIKE xccb_t.xccbcnfdt, #数据审核日
#       xccbpstid LIKE xccb_t.xccbpstid, #资料过账者
#       xccbpstdt LIKE xccb_t.xccbpstdt, #资料过账日
#       xccbstus LIKE xccb_t.xccbstus  #状态码
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_flag1         LIKE type_t.chr1
   DEFINE l_flag2         LIKE type_t.chr1
   DEFINE l_seq           LIKE xccc_t.xccc001

   WHENEVER ERROR CONTINUE

   LET l_seq = p_xcce001
   INITIALIZE r_xcce.* TO NULL
   
#   SELECT * INTO l_xcce.* FROM xcce_tmp  #161124-00048#20 mrak
   #161124-00048#20 add(s)
   SELECT xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,
          xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,
          xcce102b,xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,
          xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,
          xcce202f,xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,
          xcce206c,xcce206d,xcce206e,xcce206f,xcce206g,xcce206h,xcce207,
          xcce208,xcce208a,xcce208b,xcce208c,xcce208d,xcce208e,xcce208f,
          xcce208g,xcce208h,xcce209,xcce210,xcce210a,xcce210b,xcce210c,
          xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,xcce301,xcce302,
          xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,xcce302g,
          xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,
          xcce304e,xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,
          xcce308b,xcce308c,xcce308d,xcce308e,xcce308f,xcce308g,xcce308h,
          xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,
          xcce902f,xcce902g,xcce902h,xccetime 
     INTO l_xcce.* FROM xcce_tmp
   #161124-00048#20 add(e)
    WHERE xcceent = g_enterprise
      AND xcceld  = g_ld
      AND xcce001 = p_xcce001
      AND xcce002 = p_xcce002
      AND xcce003 = g_xcat001
      AND xcce004 = g_yy
      AND xcce005 = g_pp
      AND xcce006 = p_xcce006
      AND xcce007 = p_xcce007
      AND xcce008 = p_xcce008
      AND xcce009 = p_xcce009
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xcce.* TO NULL
      CALL s_axcp500_init_xcce0()
           RETURNING l_xcce.*       
      LET l_xcce.xcceent  = g_enterprise               #企業編號
      LET l_xcce.xccecomp = g_comp                     #法人組織
      LET l_xcce.xcceld   = g_ld                       #帳套
      LET l_xcce.xcce001  = p_xcce001                  #帳套本位幣順序
      LET l_xcce.xcce002  = p_xcce002                  #成本域
      LET l_xcce.xcce003  = g_xcat001                  #成本計算類型
      LET l_xcce.xcce004  = g_yy                       #年度
      LET l_xcce.xcce005  = g_pp                       #期別
      LET l_xcce.xcce006  = p_xcce006                  #工單編號
      LET l_xcce.xcce007  = p_xcce007                  #主件料號
      LET l_xcce.xcce008  = p_xcce008                  #特性
      LET l_xcce.xcce009  = p_xcce009                  #批號  
      LET l_xcce.xcce010  = g_curr[l_seq].curr         #核算幣別
      
#200120-00015#1---mark---s
#      #新增xcce_t时,要把上期的"结余资料"放在本期"上期期初"字段中
#      LET l_flag1 = 'N'    #开帐xccb
#      LET l_flag2 = 'N'    #上期xcce
##      SELECT 'Y',xccb_t.* INTO l_flag1,l_t_xccb.* FROM xccb_t  #161124-00048#20 mark
#      #161124-00048#20 add(s)
#      SELECT 'Y',xccbent,xccbld,xccbcomp,xccb001,xccb002,xccb003,xccb004,xccb005,
#             xccb006,xccb007,xccb008,xccb009,xccb010,xccb101,xccb102,xccb102a,xccb102b,
#             xccb102c,xccb102d,xccb102e,xccb102f,xccb102g,xccb102h,xccbownid,xccbowndp,
#             xccbcrtid,xccbcrtdp,xccbcrtdt,xccbmodid,xccbmoddt,xccbcnfid,xccbcnfdt,
#             xccbpstid,xccbpstdt,xccbstus 
#        INTO l_flag1,l_t_xccb.* FROM xccb_t
#      #161124-00048#20 add(e)
#       WHERE xccbent = g_enterprise
#         AND xccbld  = g_ld
#         AND xccb001 = p_xcce001
#         AND xccb002 = p_xcce002
#         AND xccb003 = g_xcat001
#         AND xccb004 = g_last_yy
#         AND xccb005 = g_last_pp
#         AND xccb006 = p_xcce006
#         AND xccb007 = p_xcce007
#         AND xccb008 = p_xcce008
#         AND xccb009 = p_xcce009
#         
##      SELECT 'Y',xcce_t.* INTO l_flag2,l_t_xcce.* FROM xcce_t  #161124-00048#20 mark
#      #161124-00048#20 add(s)
#      SELECT 'Y',xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,
#              xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,xcce102b,
#              xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,xcce201,xcce202,
#              xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,xcce202f,xcce202g,xcce202h,
#              xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,xcce206e,xcce206f,
#              xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,xcce208c,xcce208d,
#              xcce208e,xcce208f,xcce208g,xcce208h,xcce209,xcce210,xcce210a,xcce210b,
#              xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,xcce301,xcce302,
#              xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,xcce302g,xcce302h,
#              xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,xcce304e,xcce304f,
#              xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,xcce308c,xcce308d,
#              xcce308e,xcce308f,xcce308g,xcce308h,xcce901,xcce902,xcce902a,xcce902b,
#              xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h,xccetime 
#         INTO l_flag2,l_t_xcce.* FROM xcce_t
#      #161124-00048#20 add(e)
#       WHERE xcceent = g_enterprise
#         AND xcceld  = g_ld
#         AND xcce001 = p_xcce001
#         AND xcce002 = p_xcce002
#         AND xcce003 = g_xcat001
#         AND xcce004 = g_last_yy
#         AND xcce005 = g_last_pp
#         AND xcce006 = p_xcce006
#         AND xcce007 = p_xcce007
#         AND xcce008 = p_xcce008
#         AND xcce009 = p_xcce009
#
#      CASE
#         WHEN l_flag1 = 'Y' 
#              LET l_xcce.xcce101  = l_t_xccb.xccb101          #上期结存数量       
#              LET l_xcce.xcce102  = l_t_xccb.xccb102          #上期结存金额       
#              LET l_xcce.xcce102a = l_t_xccb.xccb102a         #上期结存金额-材料  
#              LET l_xcce.xcce102b = l_t_xccb.xccb102b         #上期结存金额-人工  
#              LET l_xcce.xcce102c = l_t_xccb.xccb102c         #上期结存金额-加工  
#              LET l_xcce.xcce102d = l_t_xccb.xccb102d         #上期结存金额-制费一
#              LET l_xcce.xcce102e = l_t_xccb.xccb102e         #上期结存金额-制费二
#              LET l_xcce.xcce102f = l_t_xccb.xccb102f         #上期结存金额-制费三
#              LET l_xcce.xcce102g = l_t_xccb.xccb102g         #上期结存金额-制费四
#              LET l_xcce.xcce102h = l_t_xccb.xccb102h         #上期结存金额-制费五                
#         WHEN l_flag2 = 'Y'
#              LET l_xcce.xcce101  = l_t_xcce.xcce901          #上期结存数量       
#              LET l_xcce.xcce102  = l_t_xcce.xcce902          #上期结存金额       
#              LET l_xcce.xcce102a = l_t_xcce.xcce902a         #上期结存金额-材料  
#              LET l_xcce.xcce102b = l_t_xcce.xcce902b         #上期结存金额-人工  
#              LET l_xcce.xcce102c = l_t_xcce.xcce902c         #上期结存金额-加工  
#              LET l_xcce.xcce102d = l_t_xcce.xcce902d         #上期结存金额-制费一
#              LET l_xcce.xcce102e = l_t_xcce.xcce902e         #上期结存金额-制费二
#              LET l_xcce.xcce102f = l_t_xcce.xcce902f         #上期结存金额-制费三
#              LET l_xcce.xcce102g = l_t_xcce.xcce902g         #上期结存金额-制费四
#              LET l_xcce.xcce102h = l_t_xcce.xcce902h         #上期结存金额-制费五               
#      END CASE  
#200120-00015#1---mark---e      
      #200120-00015#1---add---s
      #新增xcce_t时,要把上期的"结余资料"放在本期"上期期初"字段中
      SELECT xccb101,xccb102,xccb102a,xccb102b,
             xccb102c,xccb102d,xccb102e,xccb102f,xccb102g,xccb102h
        INTO l_xcce.xcce101 ,l_xcce.xcce102 ,l_xcce.xcce102a,l_xcce.xcce102b,l_xcce.xcce102c,
             l_xcce.xcce102d,l_xcce.xcce102e,l_xcce.xcce102f,l_xcce.xcce102g,l_xcce.xcce102h
        FROM xccb_t
       WHERE xccbent = g_enterprise
         AND xccbld  = g_ld
         AND xccb001 = p_xcce001
         AND xccb002 = p_xcce002
         AND xccb003 = g_xcat001
         AND xccb004 = g_last_yy
         AND xccb005 = g_last_pp
         AND xccb006 = p_xcce006
         AND xccb007 = p_xcce007
         AND xccb008 = p_xcce008
         AND xccb009 = p_xcce009
      IF SQLCA.sqlcode = 100 THEN             
         SELECT xcce901,xcce902,xcce902a,xcce902b,
                xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h 
           INTO l_xcce.xcce101 ,l_xcce.xcce102 ,l_xcce.xcce102a,l_xcce.xcce102b,l_xcce.xcce102c,
                l_xcce.xcce102d,l_xcce.xcce102e,l_xcce.xcce102f,l_xcce.xcce102g,l_xcce.xcce102h
           FROM xcce_t 
          WHERE xcceent = g_enterprise
            AND xcceld  = g_ld
            AND xcce001 = p_xcce001
            AND xcce002 = p_xcce002
            AND xcce003 = g_xcat001
            AND xcce004 = g_last_yy
            AND xcce005 = g_last_pp
            AND xcce006 = p_xcce006
            AND xcce007 = p_xcce007
            AND xcce008 = p_xcce008
            AND xcce009 = p_xcce009
      END IF   
      #200120-00015#1---add---e       
      LET l_xcce.xccetime = cl_get_current()           #最近成本計算時間
   END IF 

   LET r_xcce.* = l_xcce.*
   RETURN r_xcce.*
   
   
END FUNCTION

################################################################################
# Descriptions...: 联产品成本计算 - 取当期xccg资料
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccg(p_xccg001,p_xccg002,p_xccg006,p_xccg007,p_xccg008,p_xccg009)
#                       RETURNING r_xccg
# Input parameter: p_xccg001      记帐本位币顺序
#                : p_xccg002      成本域
#                : p_xccg006      工单单号
#                : p_xccg007      联产品料号
#                : p_xccg008      特征
#                : p_xccg009      批号
# Return code....: r_xccg         xccg的值
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccg(p_xccg001,p_xccg002,p_xccg006,p_xccg007,p_xccg008,p_xccg009)
   DEFINE p_xccg001       LIKE xccg_t.xccg001
   DEFINE p_xccg002       LIKE xccg_t.xccg002
   DEFINE p_xccg006       LIKE xccg_t.xccg006
   DEFINE p_xccg007       LIKE xccg_t.xccg007
   DEFINE p_xccg008       LIKE xccg_t.xccg008
   DEFINE p_xccg009       LIKE xccg_t.xccg009
#   DEFINE r_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
#   DEFINE l_xccg            RECORD LIKE xccg_t.*  #161124-00048#20 mark
#   DEFINE l_t_xccg          RECORD LIKE xccg_t.*  #161124-00048#20 mark
   DEFINE r_xccg             type_g_xccg  #170605-00013#1-add
   DEFINE l_xccg             type_g_xccg  #170605-00013#1-add
   DEFINE l_t_xccg           type_g_xccg  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE l_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#END RECORD
#DEFINE l_t_xccg RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企业编号
#       xccgcomp LIKE xccg_t.xccgcomp, #法人组织
#       xccgld LIKE xccg_t.xccgld, #账套
#       xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本计算类型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期别
#       xccg006 LIKE xccg_t.xccg006, #工单编号
#       xccg007 LIKE xccg_t.xccg007, #联产品料号
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批号
#       xccg010 LIKE xccg_t.xccg010, #核算币种
#       xccg101 LIKE xccg_t.xccg101, #上期结存数量
#       xccg102 LIKE xccg_t.xccg102, #上期结存金额
#       xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
#       xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
#       xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
#       xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
#       xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
#       xccg301 LIKE xccg_t.xccg301, #本期转出数量
#       xccg302 LIKE xccg_t.xccg302, #本期转出金额
#       xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
#       xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
#       xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
#       xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
#       xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
#       xccg901 LIKE xccg_t.xccg901, #期末结存数量
#       xccg902 LIKE xccg_t.xccg902, #期末结存金额
#       xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
#       xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
#       xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
#       xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
#       xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
#       xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
#
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE r_xccg.* TO NULL
   
#   SELECT * INTO l_xccg.* FROM xccg_tmp  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xccgent,xccgcomp,xccgld,xccg001,xccg002,xccg003,xccg004,
          xccg005,xccg006,xccg007,xccg008,xccg009,xccg010,xccg101,
          xccg102,xccg102a,xccg102b,xccg102c,xccg102d,xccg102e,xccg102f,
          xccg102g,xccg102h,xccg301,xccg302,xccg302a,xccg302b,xccg302c,
          xccg302d,xccg302e,xccg302f,xccg302g,xccg302h,xccg901,xccg902,
          xccg902a,xccg902b,xccg902c,xccg902d,xccg902e,xccg902f,xccg902g,
          xccg902h,xccgtime 
     INTO l_xccg.* FROM xccg_tmp
   #161124-00048#20 add(e)
    WHERE xccgent = g_enterprise
      AND xccgld  = g_ld
      AND xccg001 = p_xccg001
      AND xccg002 = p_xccg002
      AND xccg003 = g_xcat001
      AND xccg004 = g_yy
      AND xccg005 = g_pp
      AND xccg006 = p_xccg006
      AND xccg007 = p_xccg007
      AND xccg008 = p_xccg008
      AND xccg009 = p_xccg009
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xccg.* TO NULL
      CALL s_axcp500_init_xccg0()
           RETURNING l_xccg.*
      LET l_xccg.xccgent  = g_enterprise         #企業編號
      LET l_xccg.xccgcomp = g_comp               #法人組織
      LET l_xccg.xccgld   = g_ld                 #帳套
      LET l_xccg.xccg001  = p_xccg001            #帳套本位幣順序
      LET l_xccg.xccg002  = p_xccg002            #成本域
      LET l_xccg.xccg003  = g_xcat001            #成本計算類型
      LET l_xccg.xccg004  = g_yy                 #年度
      LET l_xccg.xccg005  = g_pp                 #期別
      LET l_xccg.xccg006  = p_xccg006            #工單編號
      LET l_xccg.xccg007  = p_xccg007            #主件料號
      LET l_xccg.xccg008  = p_xccg008            #特性
      LET l_xccg.xccg009  = p_xccg009            #批號
      LET l_xccg.xccg010  = g_curr[p_xccg001].curr  #核算幣別

      #新增xccg_t时,要把上期的"结余资料"放在本期"上期期初"字段中
#      SELECT xccg_t.* INTO l_t_xccg.* FROM xccg_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT xccgent,xccgcomp,xccgld,xccg001,xccg002,xccg003,xccg004,xccg005,
             xccg006,xccg007,xccg008,xccg009,xccg010,xccg101,xccg102,xccg102a,
             xccg102b,xccg102c,xccg102d,xccg102e,xccg102f,xccg102g,xccg102h,
             xccg301,xccg302,xccg302a,xccg302b,xccg302c,xccg302d,xccg302e,
             xccg302f,xccg302g,xccg302h,xccg901,xccg902,xccg902a,xccg902b,
             xccg902c,xccg902d,xccg902e,xccg902f,xccg902g,xccg902h,xccgtime 
        INTO l_t_xccg.* FROM xccg_t
      #161124-00048#20 add(e)
       WHERE xccgent = g_enterprise
         AND xccgld  = g_ld
         AND xccg001 = p_xccg001
         AND xccg002 = p_xccg002
         AND xccg003 = g_xcat001
         AND xccg004 = g_last_yy
         AND xccg005 = g_last_pp
         AND xccg006 = p_xccg006
         AND xccg007 = p_xccg007
         AND xccg008 = p_xccg008
         AND xccg009 = p_xccg009
         
      LET l_xccg.xccg101  = l_t_xccg.xccg901          #上期结存数量       
      LET l_xccg.xccg102  = l_t_xccg.xccg902          #上期结存金额       
      LET l_xccg.xccg102a = l_t_xccg.xccg902a         #上期结存金额-材料  
      LET l_xccg.xccg102b = l_t_xccg.xccg902b         #上期结存金额-人工  
      LET l_xccg.xccg102c = l_t_xccg.xccg902c         #上期结存金额-加工  
      LET l_xccg.xccg102d = l_t_xccg.xccg902d         #上期结存金额-制费一
      LET l_xccg.xccg102e = l_t_xccg.xccg902e         #上期结存金额-制费二
      LET l_xccg.xccg102f = l_t_xccg.xccg902f         #上期结存金额-制费三
      LET l_xccg.xccg102g = l_t_xccg.xccg902g         #上期结存金额-制费四
      LET l_xccg.xccg102h = l_t_xccg.xccg902h         #上期结存金额-制费五               
      LET l_xccg.xccgtime = cl_get_current()     #最近成本計算時間
   END IF
        
   LET r_xccg.* = l_xccg.*
   RETURN r_xccg.*
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 取当期xcch资料
# Memo...........:
# Usage..........: CALL s_axcp500_get_xcch(p_xcch001,p_xcch002,p_xcch006,p_xcch007,p_xcch008,p_xcch009)
#                       RETURNING r_xcch
# Input parameter: p_xcch001      记帐本位币顺序
#                : p_xcch002      成本域
#                : p_xcch006      工单单号
#                : p_xcch007      料件编号
#                : p_xcch008      产品特征
#                : p_xcch009      批号
# Return code....: r_xcch         xcch的值
# Date & Author..: 2014-08-04 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xcch(p_xcch001,p_xcch002,p_xcch006,p_xcch007,p_xcch008,p_xcch009)
   DEFINE p_xcch001       LIKE xccc_t.xccc001
   DEFINE p_xcch002       LIKE xcch_t.xcch002
   DEFINE p_xcch006       LIKE xcch_t.xcch006
   DEFINE p_xcch007       LIKE xcch_t.xcch007
   DEFINE p_xcch008       LIKE xcch_t.xcch008
   DEFINE p_xcch009       LIKE xcch_t.xcch009
#   DEFINE r_xcch          RECORD LIKE xcch_t.*   #161124-00048#20 mark
#   DEFINE l_xcch          RECORD LIKE xcch_t.*   #161124-00048#20 mark
#   DEFINE l_t_xcch        RECORD LIKE xcch_t.*   #161124-00048#20 mark
   DEFINE r_xcch           type_g_xcch  #170605-00013#1-add
   DEFINE l_xcch           type_g_xcch  #170605-00013#1-add
   DEFINE l_t_xcch         type_g_xcch  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#
##161124-00048#20 add(s)
#DEFINE l_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#
##161124-00048#20 add(s)
#DEFINE l_t_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE

   INITIALIZE r_xcch.* TO NULL
   
#   SELECT * INTO l_xcch.* FROM xcch_t  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xcchent,xcchcomp,xcchld,xcch001,xcch002,xcch003,xcch004,xcch005,
          xcch006,xcch007,xcch008,xcch009,xcch010,xcch011,xcch101,xcch102,
          xcch102a,xcch102b,xcch102c,xcch102d,xcch102e,xcch102f,xcch102g,
          xcch102h,xcch200,xcch201,xcch202,xcch202a,xcch202b,xcch202c,xcch202d,
          xcch202e,xcch202f,xcch202g,xcch202h,xcch204,xcch204a,xcch204b,xcch204c,
          xcch204d,xcch204e,xcch204f,xcch204g,xcch204h,xcch301,xcch302,xcch302a,
          xcch302b,xcch302c,xcch302d,xcch302e,xcch302f,xcch302g,xcch302h,xcch303,
          xcch304,xcch304a,xcch304b,xcch304c,xcch304d,xcch304e,xcch304f,xcch304g,
          xcch304h,xcch901,xcch902,xcch902a,xcch902b,xcch902c,xcch902d,xcch902e,
          xcch902f,xcch902g,xcch902h,xcchtime 
     INTO l_xcch.* FROM xcch_t 
   #161124-00048#20 add(e)
    WHERE xcchent = g_enterprise
      AND xcchld  = g_ld
      AND xcch001 = p_xcch001
      AND xcch002 = p_xcch002
      AND xcch003 = g_xcat001
      AND xcch004 = g_yy
      AND xcch005 = g_pp
      AND xcch006 = p_xcch006
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xcch.* TO NULL
      CALL s_axcp500_init_xcch0()
           RETURNING l_xcch.*
      LET l_xcch.xcchent  = g_enterprise         #企業編號
      LET l_xcch.xcchcomp = g_comp               #法人組織
      LET l_xcch.xcchld   = g_ld                 #帳套
      LET l_xcch.xcch001  = p_xcch001            #帳套本位幣順序
      LET l_xcch.xcch002  = p_xcch002            #成本域
      LET l_xcch.xcch003  = g_xcat001            #成本計算類型
      LET l_xcch.xcch004  = g_yy                 #年度
      LET l_xcch.xcch005  = g_pp                 #期別
      LET l_xcch.xcch006  = p_xcch006            #工單編號
      LET l_xcch.xcch007  = p_xcch007            #主件料號
      LET l_xcch.xcch008  = p_xcch008            #特性
      LET l_xcch.xcch009  = p_xcch009            #批號
      #項目號
      SELECT sfaa028 INTO l_xcch.xcch010 FROM sfaa_tmp
       WHERE sfaaent   = g_enterprise
         AND sfaadocno = p_xcch006
      LET l_xcch.xcch011  = g_curr[p_xcch001].curr   #核算幣別

      #新增xcch_t时,要把上期的"结余资料"放在本期"上期期初"字段中
#      SELECT xcch_t.* INTO l_t_xcch.* FROM xcch_t  #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT xcchent,xcchcomp,xcchld,xcch001,xcch002,xcch003,xcch004,xcch005,
             xcch006,xcch007,xcch008,xcch009,xcch010,xcch011,xcch101,xcch102,
             xcch102a,xcch102b,xcch102c,xcch102d,xcch102e,xcch102f,xcch102g,
             xcch102h,xcch200,xcch201,xcch202,xcch202a,xcch202b,xcch202c,xcch202d,
             xcch202e,xcch202f,xcch202g,xcch202h,xcch204,xcch204a,xcch204b,xcch204c,
             xcch204d,xcch204e,xcch204f,xcch204g,xcch204h,xcch301,xcch302,xcch302a,
             xcch302b,xcch302c,xcch302d,xcch302e,xcch302f,xcch302g,xcch302h,xcch303,
             xcch304,xcch304a,xcch304b,xcch304c,xcch304d,xcch304e,xcch304f,xcch304g,
             xcch304h,xcch901,xcch902,xcch902a,xcch902b,xcch902c,xcch902d,xcch902e,
             xcch902f,xcch902g,xcch902h,xcchtime 
        INTO l_t_xcch.* FROM xcch_t
      #161124-00048#20 add(e)
       WHERE xcchent = g_enterprise
         AND xcchld  = g_ld
         AND xcch001 = p_xcch001
         AND xcch002 = p_xcch002
         AND xcch003 = g_xcat001
         AND xcch004 = g_last_yy
         AND xcch005 = g_last_pp
         AND xcch006 = p_xcch006      
      IF SQLCA.sqlcode = 0 THEN
         LET l_xcch.xcch101  = l_t_xcch.xcch901          #上期结存数量       
         LET l_xcch.xcch102  = l_t_xcch.xcch902          #上期结存金额       
         LET l_xcch.xcch102a = l_t_xcch.xcch902a         #上期结存金额-材料  
         LET l_xcch.xcch102b = l_t_xcch.xcch902b         #上期结存金额-人工  
         LET l_xcch.xcch102c = l_t_xcch.xcch902c         #上期结存金额-加工  
         LET l_xcch.xcch102d = l_t_xcch.xcch902d         #上期结存金额-制费一
         LET l_xcch.xcch102e = l_t_xcch.xcch902e         #上期结存金额-制费二
         LET l_xcch.xcch102f = l_t_xcch.xcch902f         #上期结存金额-制费三
         LET l_xcch.xcch102g = l_t_xcch.xcch902g         #上期结存金额-制费四
         LET l_xcch.xcch102h = l_t_xcch.xcch902h         #上期结存金额-制费五               
      END IF
      LET l_xcch.xcchtime = cl_get_current()     #最近成本計算時間
   END IF
        
   LET r_xcch.* = l_xcch.*
   RETURN r_xcch.*
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 取当期的xcci的值
# Memo...........:
# Usage..........: CALL s_axcp500_get_xcci(p_xcci001,p_xcci002,p_xcci006,p_xcci007,p_xcci008,p_xcci009)
#                       RETURNING r_xcci
# Input parameter: p_xcci001      记帐本位币顺序
#                : p_xcci002      成本域
#                : p_xcci006      拆件工单
#                : p_xcci007      元件料号
#                : p_xcci008      元件产品特征
#                : p_xcci009      元件批号
# Return code....: r_xcci         xcci_t的资料
# Date & Author..: 2014-08-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xcci(p_xcci001,p_xcci002,p_xcci006,p_xcci007,p_xcci008,p_xcci009)
   DEFINE p_xcci001       LIKE xccc_t.xccc001  
   DEFINE p_xcci002       LIKE xcci_t.xcci002
   DEFINE p_xcci006       LIKE xcci_t.xcci006
   DEFINE p_xcci007       LIKE xcci_t.xcci007
   DEFINE p_xcci008       LIKE xcci_t.xcci008
   DEFINE p_xcci009       LIKE xcci_t.xcci009
#   DEFINE r_xcci          RECORD LIKE xcci_t.*  #161124-00048#20 mark
#   DEFINE l_xcci          RECORD LIKE xcci_t.*  #161124-00048#20 mark
#   DEFINE l_t_xcci        RECORD LIKE xcci_t.*  #161124-00048#20 mark
   DEFINE r_xcci           type_g_xcci  #170605-00013#1-add
   DEFINE l_xcci           type_g_xcci  #170605-00013#1-add
   DEFINE l_t_xcci         type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE r_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_t_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_t_xccb        RECORD LIKE xccb_t.*  #161124-00048#20 mark
   DEFINE l_t_xccb         type_g_xccb  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_t_xccb RECORD  #期初在製數量成本開帳檔
   #    xccbent LIKE xccb_t.xccbent, #企业编号
   #    xccbld LIKE xccb_t.xccbld, #账套
   #    xccbcomp LIKE xccb_t.xccbcomp, #法人组织
   #    xccb001 LIKE xccb_t.xccb001, #账套本位币顺序
   #    xccb002 LIKE xccb_t.xccb002, #成本域
   #    xccb003 LIKE xccb_t.xccb003, #成本计算类型
   #    xccb004 LIKE xccb_t.xccb004, #年度
   #    xccb005 LIKE xccb_t.xccb005, #期别
   #    xccb006 LIKE xccb_t.xccb006, #工单编号
   #    xccb007 LIKE xccb_t.xccb007, #元件编号
   #    xccb008 LIKE xccb_t.xccb008, #特性
   #    xccb009 LIKE xccb_t.xccb009, #批号
   #    xccb010 LIKE xccb_t.xccb010, #元件类型
   #    xccb101 LIKE xccb_t.xccb101, #当月期末数量
   #    xccb102 LIKE xccb_t.xccb102, #当月期末金额-金额合计
   #    xccb102a LIKE xccb_t.xccb102a, #当月期末金额-材料
   #    xccb102b LIKE xccb_t.xccb102b, #当月期末金额-人工
   #    xccb102c LIKE xccb_t.xccb102c, #当月期末金额-委外加工
   #    xccb102d LIKE xccb_t.xccb102d, #当月期末金额-制费一
   #    xccb102e LIKE xccb_t.xccb102e, #当月期末金额-制费二
   #    xccb102f LIKE xccb_t.xccb102f, #当月期末金额-制费三
   #    xccb102g LIKE xccb_t.xccb102g, #当月期末金额-制费四
   #    xccb102h LIKE xccb_t.xccb102h, #当月期末金额-制费五
   #    xccbownid LIKE xccb_t.xccbownid, #资料所有者
   #    xccbowndp LIKE xccb_t.xccbowndp, #资料所有部门
   #    xccbcrtid LIKE xccb_t.xccbcrtid, #资料录入者
   #    xccbcrtdp LIKE xccb_t.xccbcrtdp, #资料录入部门
   #    xccbcrtdt LIKE xccb_t.xccbcrtdt, #资料创建日
   #    xccbmodid LIKE xccb_t.xccbmodid, #资料更改者
   #    xccbmoddt LIKE xccb_t.xccbmoddt, #最近更改日
   #    xccbcnfid LIKE xccb_t.xccbcnfid, #资料审核者
   #    xccbcnfdt LIKE xccb_t.xccbcnfdt, #数据审核日
   #    xccbpstid LIKE xccb_t.xccbpstid, #资料过账者
   #    xccbpstdt LIKE xccb_t.xccbpstdt, #资料过账日
   #    xccbstus LIKE xccb_t.xccbstus  #状态码
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_flag1         LIKE type_t.chr1
   DEFINE l_flag2         LIKE type_t.chr1


   WHENEVER ERROR CONTINUE

   INITIALIZE r_xcci.* TO NULL
   
#   SELECT * INTO l_xcci.* FROM xcci_t  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,
          xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,
          xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,
          xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,xcci202f,
          xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,xcci302c,xcci302d,
          xcci302e,xcci302f,xcci302g,xcci302h,xcci303,xcci304,xcci304a,xcci304b,
          xcci304c,xcci304d,xcci304e,xcci304f,xcci304g,xcci304h,xcci901,xcci902,
          xcci902a,xcci902b,xcci902c,xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,
          xccitime INTO l_xcci.* 
      FROM xcci_t    
   #161124-00048#20 add(e)
    WHERE xccient = g_enterprise
      AND xccild  = g_ld
      AND xcci001 = p_xcci001
      AND xcci002 = p_xcci002
      AND xcci003 = g_xcat001
      AND xcci004 = g_yy
      AND xcci005 = g_pp
      AND xcci006 = p_xcci006
      AND xcci007 = p_xcci007
      AND xcci008 = p_xcci008
      AND xcci009 = p_xcci009
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xcci.* TO NULL
      CALL s_axcp500_init_xcci0()
           RETURNING l_xcci.*       
      LET l_xcci.xccient  = g_enterprise               #企業編號
      LET l_xcci.xccicomp = g_comp                     #法人組織
      LET l_xcci.xccild   = g_ld                       #帳套
      LET l_xcci.xcci001  = p_xcci001                  #帳套本位幣順序
      LET l_xcci.xcci002  = p_xcci002                  #成本域
      LET l_xcci.xcci003  = g_xcat001                  #成本計算類型
      LET l_xcci.xcci004  = g_yy                       #年度
      LET l_xcci.xcci005  = g_pp                       #期別
      LET l_xcci.xcci006  = p_xcci006                  #工單編號
      LET l_xcci.xcci007  = p_xcci007                  #主件料號
      LET l_xcci.xcci008  = p_xcci008                  #特性
      LET l_xcci.xcci009  = p_xcci009                  #批號  
      LET l_xcci.xcci010  = g_curr[p_xcci001].curr     #核算幣別

      #新增xcci_t时,要把上期的"结余资料"放在本期"上期期初"字段中
      LET l_flag1 = 'N'    #开帐xccb
      LET l_flag2 = 'N'    #上期xcci
#      SELECT 'Y',xccb_t.* INTO l_flag1,l_t_xccb.* FROM xccb_t #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xccbent,xccbld,xccbcomp,xccb001,xccb002,xccb003,xccb004,xccb005,
             xccb006,xccb007,xccb008,xccb009,xccb010,xccb101,xccb102,xccb102a,xccb102b,
             xccb102c,xccb102d,xccb102e,xccb102f,xccb102g,xccb102h,xccbownid,xccbowndp,
             xccbcrtid,xccbcrtdp,xccbcrtdt,xccbmodid,xccbmoddt,xccbcnfid,xccbcnfdt,
             xccbpstid,xccbpstdt,xccbstus 
        INTO l_flag1,l_t_xccb.* FROM xccb_t
      #161124-00048#20 add(e)
       WHERE xccbent = g_enterprise
         AND xccbld  = g_ld
         AND xccb001 = p_xcci001
         AND xccb002 = p_xcci002
         AND xccb003 = g_xcat001
         AND xccb004 = g_last_yy
         AND xccb005 = g_last_pp
         AND xccb006 = p_xcci006
         AND xccb007 = p_xcci007
         AND xccb008 = p_xcci008
         AND xccb009 = p_xcci009
         
#      SELECT 'Y',xcci_t.* INTO l_flag2,l_t_xcci.* FROM xcci_t #161124-00048#20 mark
      #161124-00048#20 add(s)
      SELECT 'Y',xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,
             xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,
             xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,
             xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,
             xcci202f,xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,
             xcci302c,xcci302d,xcci302e,xcci302f,xcci302g,xcci302h,xcci303,
             xcci304,xcci304a,xcci304b,xcci304c,xcci304d,xcci304e,xcci304f,
             xcci304g,xcci304h,xcci901,xcci902,xcci902a,xcci902b,xcci902c,
             xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,xccitime 
        INTO l_flag2,l_t_xcci.* FROM xcci_t
      #161124-00048#20 add(e)
       WHERE xccient = g_enterprise
         AND xccild  = g_ld
         AND xcci001 = p_xcci001
         AND xcci002 = p_xcci002
         AND xcci003 = g_xcat001
         AND xcci004 = g_last_yy
         AND xcci005 = g_last_pp
         AND xcci006 = p_xcci006
         AND xcci007 = p_xcci007
         AND xcci008 = p_xcci008
         AND xcci009 = p_xcci009

      CASE
         WHEN l_flag1 = 'Y' 
              LET l_xcci.xcci101  = l_t_xccb.xccb101          #上期结存数量       
              LET l_xcci.xcci102  = l_t_xccb.xccb102          #上期结存金额       
              LET l_xcci.xcci102a = l_t_xccb.xccb102a         #上期结存金额-材料  
              LET l_xcci.xcci102b = l_t_xccb.xccb102b         #上期结存金额-人工  
              LET l_xcci.xcci102c = l_t_xccb.xccb102c         #上期结存金额-加工  
              LET l_xcci.xcci102d = l_t_xccb.xccb102d         #上期结存金额-制费一
              LET l_xcci.xcci102e = l_t_xccb.xccb102e         #上期结存金额-制费二
              LET l_xcci.xcci102f = l_t_xccb.xccb102f         #上期结存金额-制费三
              LET l_xcci.xcci102g = l_t_xccb.xccb102g         #上期结存金额-制费四
              LET l_xcci.xcci102h = l_t_xccb.xccb102h         #上期结存金额-制费五                
         WHEN l_flag2 = 'Y'
              LET l_xcci.xcci101  = l_t_xcci.xcci901          #上期结存数量       
              LET l_xcci.xcci102  = l_t_xcci.xcci902          #上期结存金额       
              LET l_xcci.xcci102a = l_t_xcci.xcci902a         #上期结存金额-材料  
              LET l_xcci.xcci102b = l_t_xcci.xcci902b         #上期结存金额-人工  
              LET l_xcci.xcci102c = l_t_xcci.xcci902c         #上期结存金额-加工  
              LET l_xcci.xcci102d = l_t_xcci.xcci902d         #上期结存金额-制费一
              LET l_xcci.xcci102e = l_t_xcci.xcci902e         #上期结存金额-制费二
              LET l_xcci.xcci102f = l_t_xcci.xcci902f         #上期结存金额-制费三
              LET l_xcci.xcci102g = l_t_xcci.xcci902g         #上期结存金额-制费四
              LET l_xcci.xcci102h = l_t_xcci.xcci902h         #上期结存金额-制费五               
      END CASE  
      LET l_xcci.xccitime = cl_get_current()           #最近成本計算時間
   END IF 

   LET r_xcci.* = l_xcci.*
   RETURN r_xcci.*
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 取当期xccz资料
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccz(p_xccz001,p_xccz002,p_xccz006,p_xccz007,p_xccz008,p_xccz009,p_seq,p_seq1)
#                       RETURNING r_xccz
# Input parameter: p_xccz001      记帐本位币顺序
#                : p_xccz002      成本域
#                : p_xccz006      工单单号
#                : p_xccz007      元件料号
#                : p_xccz008      元件-产品特征
#                : p_xccz009      元件-批次
#                : p_seq          项次
#                : p_seq1         项序
# Return code....: r_xccz         xccz的值
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccz(p_xccz001,p_xccz002,p_xccz006,p_xccz007,p_xccz008,p_xccz009,p_seq,p_seq1)
   DEFINE p_xccz001       LIKE xccc_t.xccc001
   DEFINE p_xccz002       LIKE xccz_t.xccz002
   DEFINE p_xccz006       LIKE xccz_t.xccz006
   DEFINE p_xccz007       LIKE xccz_t.xccz007
   DEFINE p_xccz008       LIKE xccz_t.xccz008
   DEFINE p_xccz009       LIKE xccz_t.xccz009
   DEFINE p_seq           LIKE sfba_t.sfbaseq
   DEFINE p_seq1          LIKE sfba_t.sfbaseq1
#   DEFINE r_xccz          RECORD LIKE xccz_t.*  #161124-00048#20 mark
#   DEFINE l_xccz          RECORD LIKE xccz_t.*  #161124-00048#20 mark
   DEFINE r_xccz           type_g_xccz  #170605-00013#1-add
   DEFINE l_xccz           type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE r_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_xccz901       LIKE xccz_t.xccz901
   
   WHENEVER ERROR CONTINUE

   INITIALIZE r_xccz.* TO NULL
   
#   SELECT * INTO l_xccz.* FROM xccz_tmp  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,
          xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,
          xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901 
     INTO l_xccz.* FROM xccz_tmp
   #161124-00048#20 add(e)
    WHERE xcczent = g_enterprise
      AND xcczld  = g_ld
      AND xccz001 = p_xccz001
      AND xccz002 = p_xccz002
      AND xccz003 = g_xcat001
      AND xccz004 = g_yy
      AND xccz005 = g_pp
      AND xccz006 = p_xccz006
      AND xccz007 = p_xccz007
      AND xccz008 = p_xccz008
      AND xccz009 = p_xccz009
      AND xccz010 = p_seq
      AND xccz011 = p_seq1
      
   IF SQLCA.sqlcode = 100 THEN
      INITIALIZE l_xccz.* TO NULL
      CALL s_axcp500_init_xccz0()
           RETURNING l_xccz.*       
      LET l_xccz.xcczent  = g_enterprise         #企業編號
      LET l_xccz.xcczcomp = g_comp               #法人組織
      LET l_xccz.xcczld   = g_ld                 #帳套
      LET l_xccz.xccz001  = p_xccz001            #帳套本位幣順序
      LET l_xccz.xccz002  = p_xccz002            #成本域
      LET l_xccz.xccz003  = g_xcat001            #成本計算類型
      LET l_xccz.xccz004  = g_yy                 #年度
      LET l_xccz.xccz005  = g_pp                 #期別
      LET l_xccz.xccz006  = p_xccz006            #工單編號
      LET l_xccz.xccz007  = p_xccz007            #主件料號
      LET l_xccz.xccz008  = p_xccz008            #特性
      LET l_xccz.xccz009  = p_xccz009            #批號
      LET l_xccz.xccz010  = p_seq                #項次
      LET l_xccz.xccz011  = p_seq1               #項序  

      #新增xccz_t时,要把上期的"结余资料"放在本期"上期期初"字段中
      SELECT xccz901 INTO l_xccz901 FROM xccz_t
       WHERE xcczent = g_enterprise
         AND xcczld  = g_ld
         AND xccz001 = p_xccz001
         AND xccz002 = p_xccz002
         AND xccz003 = g_xcat001
         AND xccz004 = g_last_yy
         AND xccz005 = g_last_pp
         AND xccz006 = p_xccz006
         AND xccz007 = p_xccz007
         AND xccz008 = p_xccz008
         AND xccz009 = p_xccz009
         AND xccz010 = p_seq
         AND xccz011 = p_seq1    
      IF SQLCA.sqlcode = 0 THEN
         LET l_xccz.xccz101  = l_xccz901            #上期結存數量  
         LET l_xccz.xccz901  = l_xccz901            #期末結存數量                
      END IF
   END IF

   LET r_xccz.* = l_xccz.*
   RETURN r_xccz.*
END FUNCTION

################################################################################
# Descriptions...: 对xccq_t中的资料做SUM/算平均单价等
# Memo...........:
# Usage..........: CALL s_axcp500_sum_xccq(p_xccq)
#                       RETURNING r_xccq
# Input parameter: p_xccq         来源值
# Return code....: r_xccq         FORMAT后的值
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_sum_xccq(p_xccq)
#   DEFINE p_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE p_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE r_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE r_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_seq        LIKE xccq_t.xccq001
   DEFINE l_qty        LIKE xccq_t.xccq201
   DEFINE l_xccq902    type_g_std_cost   
   
   LET l_seq = p_xccq.xccq001

   WHENEVER ERROR CONTINUE

#  CALL s_axcp500_get_round_setting(p_xccq.xccq006)
   #上期结存
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq101,g_unit_round_digit) RETURNING p_xccq.xccq101
   CALL s_num_round(g_round_type,p_xccq.xccq102a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102a
   CALL s_num_round(g_round_type,p_xccq.xccq102b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102b
   CALL s_num_round(g_round_type,p_xccq.xccq102c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102c
   CALL s_num_round(g_round_type,p_xccq.xccq102d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102d
   CALL s_num_round(g_round_type,p_xccq.xccq102e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102e
   CALL s_num_round(g_round_type,p_xccq.xccq102f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102f
   CALL s_num_round(g_round_type,p_xccq.xccq102g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102g
   CALL s_num_round(g_round_type,p_xccq.xccq102h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102h

   #上期结存金额
   LET p_xccq.xccq102  = p_xccq.xccq102a + p_xccq.xccq102b + p_xccq.xccq102c +
                         p_xccq.xccq102d + p_xccq.xccq102e + p_xccq.xccq102f +
                         p_xccq.xccq102g + p_xccq.xccq102h
   CALL s_num_round(g_round_type,p_xccq.xccq102 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq102


   #本期采购入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq201,g_unit_round_digit) RETURNING p_xccq.xccq201
   CALL s_num_round(g_round_type,p_xccq.xccq202a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202a
   CALL s_num_round(g_round_type,p_xccq.xccq202b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202b
   CALL s_num_round(g_round_type,p_xccq.xccq202c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202c
   CALL s_num_round(g_round_type,p_xccq.xccq202d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202d
   CALL s_num_round(g_round_type,p_xccq.xccq202e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202e
   CALL s_num_round(g_round_type,p_xccq.xccq202f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202f
   CALL s_num_round(g_round_type,p_xccq.xccq202g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202g
   CALL s_num_round(g_round_type,p_xccq.xccq202h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202h

   #本期采购入库金额
   LET p_xccq.xccq202  = p_xccq.xccq202a + p_xccq.xccq202b + p_xccq.xccq202c +
                         p_xccq.xccq202d + p_xccq.xccq202e + p_xccq.xccq202f +
                         p_xccq.xccq202g + p_xccq.xccq202h
   CALL s_num_round(g_round_type,p_xccq.xccq202 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq202

   #本期委外入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq203,g_unit_round_digit) RETURNING p_xccq.xccq203
   CALL s_num_round(g_round_type,p_xccq.xccq204a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204a
   CALL s_num_round(g_round_type,p_xccq.xccq204b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204b
   CALL s_num_round(g_round_type,p_xccq.xccq204c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204c
   CALL s_num_round(g_round_type,p_xccq.xccq204d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204d
   CALL s_num_round(g_round_type,p_xccq.xccq204e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204e
   CALL s_num_round(g_round_type,p_xccq.xccq204f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204f
   CALL s_num_round(g_round_type,p_xccq.xccq204g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204g
   CALL s_num_round(g_round_type,p_xccq.xccq204h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204h

   #本期委外入库金额
   LET p_xccq.xccq204  = p_xccq.xccq204a + p_xccq.xccq204b + p_xccq.xccq204c +
                         p_xccq.xccq204d + p_xccq.xccq204e + p_xccq.xccq204f +
                         p_xccq.xccq204g + p_xccq.xccq204h
   CALL s_num_round(g_round_type,p_xccq.xccq204 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq204


   #本期工单入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq205,g_unit_round_digit) RETURNING p_xccq.xccq205
   CALL s_num_round(g_round_type,p_xccq.xccq206a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206a
   CALL s_num_round(g_round_type,p_xccq.xccq206b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206b
   CALL s_num_round(g_round_type,p_xccq.xccq206c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206c
   CALL s_num_round(g_round_type,p_xccq.xccq206d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206d
   CALL s_num_round(g_round_type,p_xccq.xccq206e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206e
   CALL s_num_round(g_round_type,p_xccq.xccq206f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206f
   CALL s_num_round(g_round_type,p_xccq.xccq206g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206g
   CALL s_num_round(g_round_type,p_xccq.xccq206h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206h

   #本期工单入库金额
   LET p_xccq.xccq206  = p_xccq.xccq206a + p_xccq.xccq206b + p_xccq.xccq206c +
                         p_xccq.xccq206d + p_xccq.xccq206e + p_xccq.xccq206f +
                         p_xccq.xccq206g + p_xccq.xccq206h
   CALL s_num_round(g_round_type,p_xccq.xccq206 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq206
   #本期重工领出
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq207,g_unit_round_digit) RETURNING p_xccq.xccq207
   CALL s_num_round(g_round_type,p_xccq.xccq208a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208a
   CALL s_num_round(g_round_type,p_xccq.xccq208b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208b
   CALL s_num_round(g_round_type,p_xccq.xccq208c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208c
   CALL s_num_round(g_round_type,p_xccq.xccq208d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208d
   CALL s_num_round(g_round_type,p_xccq.xccq208e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208e
   CALL s_num_round(g_round_type,p_xccq.xccq208f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208f
   CALL s_num_round(g_round_type,p_xccq.xccq208g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208g
   CALL s_num_round(g_round_type,p_xccq.xccq208h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208h

   #本期重工领出金额
   LET p_xccq.xccq208  = p_xccq.xccq208a + p_xccq.xccq208b + p_xccq.xccq208c +
                         p_xccq.xccq208d + p_xccq.xccq208e + p_xccq.xccq208f +
                         p_xccq.xccq208g + p_xccq.xccq208h
   CALL s_num_round(g_round_type,p_xccq.xccq208 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq208

   #本期重工入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq209,g_unit_round_digit) RETURNING p_xccq.xccq209
   CALL s_num_round(g_round_type,p_xccq.xccq210a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210a
   CALL s_num_round(g_round_type,p_xccq.xccq210b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210b
   CALL s_num_round(g_round_type,p_xccq.xccq210c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210c
   CALL s_num_round(g_round_type,p_xccq.xccq210d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210d
   CALL s_num_round(g_round_type,p_xccq.xccq210e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210e
   CALL s_num_round(g_round_type,p_xccq.xccq210f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210f
   CALL s_num_round(g_round_type,p_xccq.xccq210g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210g
   CALL s_num_round(g_round_type,p_xccq.xccq210h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210h

   #本期重工入库金额
   LET p_xccq.xccq210  = p_xccq.xccq210a + p_xccq.xccq210b + p_xccq.xccq210c +
                         p_xccq.xccq210d + p_xccq.xccq210e + p_xccq.xccq210f +
                         p_xccq.xccq210g + p_xccq.xccq210h
   CALL s_num_round(g_round_type,p_xccq.xccq210 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq210

   #本期杂项入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq211,g_unit_round_digit) RETURNING p_xccq.xccq211
   CALL s_num_round(g_round_type,p_xccq.xccq212a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212a
   CALL s_num_round(g_round_type,p_xccq.xccq212b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212b
   CALL s_num_round(g_round_type,p_xccq.xccq212c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212c
   CALL s_num_round(g_round_type,p_xccq.xccq212d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212d
   CALL s_num_round(g_round_type,p_xccq.xccq212e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212e
   CALL s_num_round(g_round_type,p_xccq.xccq212f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212f
   CALL s_num_round(g_round_type,p_xccq.xccq212g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212g
   CALL s_num_round(g_round_type,p_xccq.xccq212h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212h

   #本期杂项入库金额
   LET p_xccq.xccq212  = p_xccq.xccq212a + p_xccq.xccq212b + p_xccq.xccq212c +
                         p_xccq.xccq212d + p_xccq.xccq212e + p_xccq.xccq212f +
                         p_xccq.xccq212g + p_xccq.xccq212h
   CALL s_num_round(g_round_type,p_xccq.xccq212 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq212

   #本期调整入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq213,g_unit_round_digit) RETURNING p_xccq.xccq213
   CALL s_num_round(g_round_type,p_xccq.xccq214a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214a
   CALL s_num_round(g_round_type,p_xccq.xccq214b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214b
   CALL s_num_round(g_round_type,p_xccq.xccq214c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214c
   CALL s_num_round(g_round_type,p_xccq.xccq214d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214d
   CALL s_num_round(g_round_type,p_xccq.xccq214e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214e
   CALL s_num_round(g_round_type,p_xccq.xccq214f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214f
   CALL s_num_round(g_round_type,p_xccq.xccq214g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214g
   CALL s_num_round(g_round_type,p_xccq.xccq214h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214h

   #本期调整入库金额
   LET p_xccq.xccq214  = p_xccq.xccq214a + p_xccq.xccq214b + p_xccq.xccq214c +
                         p_xccq.xccq214d + p_xccq.xccq214e + p_xccq.xccq214f +
                         p_xccq.xccq214g + p_xccq.xccq214h
   CALL s_num_round(g_round_type,p_xccq.xccq214 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq214

   #本期销退入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq215,g_unit_round_digit) RETURNING p_xccq.xccq215
   CALL s_num_round(g_round_type,p_xccq.xccq216a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216a
   CALL s_num_round(g_round_type,p_xccq.xccq216b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216b
   CALL s_num_round(g_round_type,p_xccq.xccq216c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216c
   CALL s_num_round(g_round_type,p_xccq.xccq216d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216d
   CALL s_num_round(g_round_type,p_xccq.xccq216e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216e
   CALL s_num_round(g_round_type,p_xccq.xccq216f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216f
   CALL s_num_round(g_round_type,p_xccq.xccq216g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216g
   CALL s_num_round(g_round_type,p_xccq.xccq216h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216h

   #本期销退入库金额
   LET p_xccq.xccq216  = p_xccq.xccq216a + p_xccq.xccq216b + p_xccq.xccq216c +
                         p_xccq.xccq216d + p_xccq.xccq216e + p_xccq.xccq216f +
                         p_xccq.xccq216g + p_xccq.xccq216h
   CALL s_num_round(g_round_type,p_xccq.xccq216 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq216

   #本期其他入库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq217,g_unit_round_digit) RETURNING p_xccq.xccq217
   CALL s_num_round(g_round_type,p_xccq.xccq218a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218a
   CALL s_num_round(g_round_type,p_xccq.xccq218b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218b
   CALL s_num_round(g_round_type,p_xccq.xccq218c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218c
   CALL s_num_round(g_round_type,p_xccq.xccq218d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218d
   CALL s_num_round(g_round_type,p_xccq.xccq218e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218e
   CALL s_num_round(g_round_type,p_xccq.xccq218f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218f
   CALL s_num_round(g_round_type,p_xccq.xccq218g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218g
   CALL s_num_round(g_round_type,p_xccq.xccq218h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218h

   #本期其他入库金额
   LET p_xccq.xccq218  = p_xccq.xccq218a + p_xccq.xccq218b + p_xccq.xccq218c +
                         p_xccq.xccq218d + p_xccq.xccq218e + p_xccq.xccq218f +
                         p_xccq.xccq218g + p_xccq.xccq218h
   CALL s_num_round(g_round_type,p_xccq.xccq218 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq218

   #本期工单领用
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq301,g_unit_round_digit) RETURNING p_xccq.xccq301
   CALL s_num_round(g_round_type,p_xccq.xccq302a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302a
   CALL s_num_round(g_round_type,p_xccq.xccq302b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302b
   CALL s_num_round(g_round_type,p_xccq.xccq302c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302c
   CALL s_num_round(g_round_type,p_xccq.xccq302d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302d
   CALL s_num_round(g_round_type,p_xccq.xccq302e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302e
   CALL s_num_round(g_round_type,p_xccq.xccq302f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302f
   CALL s_num_round(g_round_type,p_xccq.xccq302g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302g
   CALL s_num_round(g_round_type,p_xccq.xccq302h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302h

   #本期工单领用金额
   LET p_xccq.xccq302  = p_xccq.xccq302a + p_xccq.xccq302b + p_xccq.xccq302c +
                         p_xccq.xccq302d + p_xccq.xccq302e + p_xccq.xccq302f +
                         p_xccq.xccq302g + p_xccq.xccq302h
   CALL s_num_round(g_round_type,p_xccq.xccq302 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq302

   #本期销货
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq303,g_unit_round_digit) RETURNING p_xccq.xccq303
   CALL s_num_round(g_round_type,p_xccq.xccq304a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304a
   CALL s_num_round(g_round_type,p_xccq.xccq304b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304b
   CALL s_num_round(g_round_type,p_xccq.xccq304c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304c
   CALL s_num_round(g_round_type,p_xccq.xccq304d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304d
   CALL s_num_round(g_round_type,p_xccq.xccq304e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304e
   CALL s_num_round(g_round_type,p_xccq.xccq304f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304f
   CALL s_num_round(g_round_type,p_xccq.xccq304g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304g
   CALL s_num_round(g_round_type,p_xccq.xccq304h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304h

   #本期销货成本
   LET p_xccq.xccq304  = p_xccq.xccq304a + p_xccq.xccq304b + p_xccq.xccq304c +
                         p_xccq.xccq304d + p_xccq.xccq304e + p_xccq.xccq304f +
                         p_xccq.xccq304g + p_xccq.xccq304h
   CALL s_num_round(g_round_type,p_xccq.xccq304 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq304

   #本期销退
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq305,g_unit_round_digit) RETURNING p_xccq.xccq305
   CALL s_num_round(g_round_type,p_xccq.xccq306a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306a
   CALL s_num_round(g_round_type,p_xccq.xccq306b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306b
   CALL s_num_round(g_round_type,p_xccq.xccq306c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306c
   CALL s_num_round(g_round_type,p_xccq.xccq306d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306d
   CALL s_num_round(g_round_type,p_xccq.xccq306e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306e
   CALL s_num_round(g_round_type,p_xccq.xccq306f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306f
   CALL s_num_round(g_round_type,p_xccq.xccq306g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306g
   CALL s_num_round(g_round_type,p_xccq.xccq306h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306h

   #本期销退成本
   LET p_xccq.xccq306  = p_xccq.xccq306a + p_xccq.xccq306b + p_xccq.xccq306c +
                         p_xccq.xccq306d + p_xccq.xccq306e + p_xccq.xccq306f +
                         p_xccq.xccq306g + p_xccq.xccq306h
   CALL s_num_round(g_round_type,p_xccq.xccq306 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq306

   #本期销售费用
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq307,g_unit_round_digit) RETURNING p_xccq.xccq307
   CALL s_num_round(g_round_type,p_xccq.xccq308a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308a
   CALL s_num_round(g_round_type,p_xccq.xccq308b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308b
   CALL s_num_round(g_round_type,p_xccq.xccq308c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308c
   CALL s_num_round(g_round_type,p_xccq.xccq308d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308d
   CALL s_num_round(g_round_type,p_xccq.xccq308e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308e
   CALL s_num_round(g_round_type,p_xccq.xccq308f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308f
   CALL s_num_round(g_round_type,p_xccq.xccq308g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308g
   CALL s_num_round(g_round_type,p_xccq.xccq308h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308h

   #本期销售费用成本
   LET p_xccq.xccq308  = p_xccq.xccq308a + p_xccq.xccq308b + p_xccq.xccq308c +
                         p_xccq.xccq308d + p_xccq.xccq308e + p_xccq.xccq308f +
                         p_xccq.xccq308g + p_xccq.xccq308h
   CALL s_num_round(g_round_type,p_xccq.xccq308 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq308

   #本期杂发
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq309,g_unit_round_digit) RETURNING p_xccq.xccq309
   CALL s_num_round(g_round_type,p_xccq.xccq310a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310a
   CALL s_num_round(g_round_type,p_xccq.xccq310b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310b
   CALL s_num_round(g_round_type,p_xccq.xccq310c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310c
   CALL s_num_round(g_round_type,p_xccq.xccq310d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310d
   CALL s_num_round(g_round_type,p_xccq.xccq310e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310e
   CALL s_num_round(g_round_type,p_xccq.xccq310f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310f
   CALL s_num_round(g_round_type,p_xccq.xccq310g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310g
   CALL s_num_round(g_round_type,p_xccq.xccq310h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310h
   #本期杂发金额
   LET p_xccq.xccq310  = p_xccq.xccq310a + p_xccq.xccq310b + p_xccq.xccq310c +
                         p_xccq.xccq310d + p_xccq.xccq310e + p_xccq.xccq310f +
                         p_xccq.xccq310g + p_xccq.xccq310h
   CALL s_num_round(g_round_type,p_xccq.xccq310 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq310


   #本期盘盈亏
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq311,g_unit_round_digit) RETURNING p_xccq.xccq311
   CALL s_num_round(g_round_type,p_xccq.xccq312a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312a
   CALL s_num_round(g_round_type,p_xccq.xccq312b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312b
   CALL s_num_round(g_round_type,p_xccq.xccq312c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312c
   CALL s_num_round(g_round_type,p_xccq.xccq312d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312d
   CALL s_num_round(g_round_type,p_xccq.xccq312e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312e
   CALL s_num_round(g_round_type,p_xccq.xccq312f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312f
   CALL s_num_round(g_round_type,p_xccq.xccq312g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312g
   CALL s_num_round(g_round_type,p_xccq.xccq312h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312h

   #本期盘盈亏金额
   LET p_xccq.xccq312  = p_xccq.xccq312a + p_xccq.xccq312b + p_xccq.xccq312c +
                         p_xccq.xccq312d + p_xccq.xccq312e + p_xccq.xccq312f +
                         p_xccq.xccq312g + p_xccq.xccq312h
   CALL s_num_round(g_round_type,p_xccq.xccq312 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq312

   #本期其他出库
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq313,g_unit_round_digit) RETURNING p_xccq.xccq313
   CALL s_num_round(g_round_type,p_xccq.xccq314a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314a
   CALL s_num_round(g_round_type,p_xccq.xccq314b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314b
   CALL s_num_round(g_round_type,p_xccq.xccq314c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314c
   CALL s_num_round(g_round_type,p_xccq.xccq314d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314d
   CALL s_num_round(g_round_type,p_xccq.xccq314e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314e
   CALL s_num_round(g_round_type,p_xccq.xccq314f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314f
   CALL s_num_round(g_round_type,p_xccq.xccq314g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314g
   CALL s_num_round(g_round_type,p_xccq.xccq314h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314h

   #本期其他出库金额
   LET p_xccq.xccq314  = p_xccq.xccq314a + p_xccq.xccq314b + p_xccq.xccq314c +
                         p_xccq.xccq314d + p_xccq.xccq314e + p_xccq.xccq314f +
                         p_xccq.xccq314g + p_xccq.xccq314h
   CALL s_num_round(g_round_type,p_xccq.xccq314 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq314

   #期末结存数量        = 上期结存数量    + 采购入库        + 委外入库         + 工单入库
   LET p_xccq.xccq901  = p_xccq.xccq101 + p_xccq.xccq201 + p_xccq.xccq203 + p_xccq.xccq205 +
   #                     重工领出         + 重工入库        + 杂项入库
                         p_xccq.xccq207 + p_xccq.xccq209 + p_xccq.xccq211 +
   #                     调整入库         + 销退入库        + 其他入库
                         p_xccq.xccq213 + p_xccq.xccq215 + p_xccq.xccq217 +
   #                     工单领用         + 销货            + 销退
                         p_xccq.xccq301 + p_xccq.xccq303 + p_xccq.xccq305 +
   #                     销售费用         + 杂发            + 盘盈亏
                         p_xccq.xccq307 + p_xccq.xccq309 + p_xccq.xccq311 +
   #                     其他出库
                         p_xccq.xccq313
                         
   #期末成本
   LET p_xccq.xccq902  = p_xccq.xccq901 * p_xccq.xccq280
   LET p_xccq.xccq902a = p_xccq.xccq901 * p_xccq.xccq280a
   LET p_xccq.xccq902b = p_xccq.xccq901 * p_xccq.xccq280b
   LET p_xccq.xccq902c = p_xccq.xccq901 * p_xccq.xccq280c
   LET p_xccq.xccq902d = p_xccq.xccq901 * p_xccq.xccq280d
   LET p_xccq.xccq902e = p_xccq.xccq901 * p_xccq.xccq280e
   LET p_xccq.xccq902f = p_xccq.xccq901 * p_xccq.xccq280f
   LET p_xccq.xccq902g = p_xccq.xccq901 * p_xccq.xccq280g
   LET p_xccq.xccq902h = p_xccq.xccq901 * p_xccq.xccq280h
   
#  CALL s_num_round(g_unit_round_type,p_xccq.xccq901,g_unit_round_digit) RETURNING p_xccq.xccq901
   CALL s_num_round(g_round_type,p_xccq.xccq902 ,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902 
   CALL s_num_round(g_round_type,p_xccq.xccq902a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902a
   CALL s_num_round(g_round_type,p_xccq.xccq902b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902b
   CALL s_num_round(g_round_type,p_xccq.xccq902c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902c
   CALL s_num_round(g_round_type,p_xccq.xccq902d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902d
   CALL s_num_round(g_round_type,p_xccq.xccq902e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902e
   CALL s_num_round(g_round_type,p_xccq.xccq902f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902f
   CALL s_num_round(g_round_type,p_xccq.xccq902g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902g
   CALL s_num_round(g_round_type,p_xccq.xccq902h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq902h
   
   LET p_xccq.xccq902a  = p_xccq.xccq902 - (p_xccq.xccq902b + p_xccq.xccq902c +
                          p_xccq.xccq902d + p_xccq.xccq902e + p_xccq.xccq902f +
                          p_xccq.xccq902g + p_xccq.xccq902h )

   #本期没有数量,但有金额,则把金额转至结余调整中
   IF p_xccq.xccq901 = 0 AND (p_xccq.xccq902  <> 0 OR p_xccq.xccq902a <> 0 OR p_xccq.xccq902b <> 0 OR p_xccq.xccq902d <> 0 OR 
                              p_xccq.xccq902d <> 0 OR p_xccq.xccq902e <> 0 OR p_xccq.xccq902f <> 0 OR p_xccq.xccq902g <> 0 OR
                              p_xccq.xccq902h <> 0 ) THEN

      LET p_xccq.xccq903  =  p_xccq.xccq903  + p_xccq.xccq902  * -1    #期末結存調整金額
      LET p_xccq.xccq903a =  p_xccq.xccq903a + p_xccq.xccq902a * -1    #期末結存調整金額-材料
      LET p_xccq.xccq903b =  p_xccq.xccq903b + p_xccq.xccq902b * -1    #期末結存調整金額-人工
      LET p_xccq.xccq903c =  p_xccq.xccq903c + p_xccq.xccq902c * -1    #期末結存調整金額-加工
      LET p_xccq.xccq903d =  p_xccq.xccq903d + p_xccq.xccq902d * -1    #期末結存調整金額-製費一
      LET p_xccq.xccq903e =  p_xccq.xccq903e + p_xccq.xccq902e * -1    #期末結存調整金額-製費二
      LET p_xccq.xccq903f =  p_xccq.xccq903f + p_xccq.xccq902f * -1    #期末結存調整金額-製費三
      LET p_xccq.xccq903g =  p_xccq.xccq903g + p_xccq.xccq902g * -1    #期末結存調整金額-製費四
      LET p_xccq.xccq903h =  p_xccq.xccq903h + p_xccq.xccq902h * -1    #期末結存調整金額-製費五

      LET p_xccq.xccq902  = 0
      LET p_xccq.xccq902a = 0
      LET p_xccq.xccq902b = 0
      LET p_xccq.xccq902c = 0
      LET p_xccq.xccq902d = 0
      LET p_xccq.xccq902e = 0
      LET p_xccq.xccq902f = 0
      LET p_xccq.xccq902g = 0
      LET p_xccq.xccq902h = 0
      
   END IF
   
   #xccq902(结余金额)是用 期初 + 本期入 - 本期出得到的,但是不一定等于 xccq901(结余数量) * 平均单价
   #则要把这两个的差额记录至xccq903(结余调整)中
   IF p_xccq.xccq901 <> 0 THEN
      LET l_xccq902.a     = p_xccq.xccq102a + p_xccq.xccq202a + p_xccq.xccq204a + p_xccq.xccq206a +
                            p_xccq.xccq208a + p_xccq.xccq210a + p_xccq.xccq212a +
                            p_xccq.xccq214a + p_xccq.xccq216a + p_xccq.xccq218a +
                            p_xccq.xccq302a + p_xccq.xccq304a + p_xccq.xccq306a +
                            p_xccq.xccq308a + p_xccq.xccq310a + p_xccq.xccq312a +
                            p_xccq.xccq314a
      LET l_xccq902.b     = p_xccq.xccq102b + p_xccq.xccq202b + p_xccq.xccq204b + p_xccq.xccq206b +
                            p_xccq.xccq208b + p_xccq.xccq210b + p_xccq.xccq212b +
                            p_xccq.xccq214b + p_xccq.xccq216b + p_xccq.xccq218b +
                            p_xccq.xccq302b + p_xccq.xccq304b + p_xccq.xccq306b +
                            p_xccq.xccq308b + p_xccq.xccq310b + p_xccq.xccq312b +
                            p_xccq.xccq314b
      LET l_xccq902.c     = p_xccq.xccq102c + p_xccq.xccq202c + p_xccq.xccq204c + p_xccq.xccq206c +
                            p_xccq.xccq208c + p_xccq.xccq210c + p_xccq.xccq212c +
                            p_xccq.xccq214c + p_xccq.xccq216c + p_xccq.xccq218c +
                            p_xccq.xccq302c + p_xccq.xccq304c + p_xccq.xccq306c +
                            p_xccq.xccq308c + p_xccq.xccq310c + p_xccq.xccq312c +
                            p_xccq.xccq314c
      LET l_xccq902.d     = p_xccq.xccq102d + p_xccq.xccq202d + p_xccq.xccq204d + p_xccq.xccq206d +
                            p_xccq.xccq208d + p_xccq.xccq210d + p_xccq.xccq212d +
                            p_xccq.xccq214d + p_xccq.xccq216d + p_xccq.xccq218d +
                            p_xccq.xccq302d + p_xccq.xccq304d + p_xccq.xccq306d +
                            p_xccq.xccq308d + p_xccq.xccq310d + p_xccq.xccq312d +
                            p_xccq.xccq314d
      LET l_xccq902.e     = p_xccq.xccq102e + p_xccq.xccq202e + p_xccq.xccq204e + p_xccq.xccq206e +
                            p_xccq.xccq208e + p_xccq.xccq210e + p_xccq.xccq212e +
                            p_xccq.xccq214e + p_xccq.xccq216e + p_xccq.xccq218e +
                            p_xccq.xccq302e + p_xccq.xccq304e + p_xccq.xccq306e +
                            p_xccq.xccq308e + p_xccq.xccq310e + p_xccq.xccq312e +
                            p_xccq.xccq314e
      LET l_xccq902.f     = p_xccq.xccq102f + p_xccq.xccq202f + p_xccq.xccq204f + p_xccq.xccq206f +
                            p_xccq.xccq208f + p_xccq.xccq210f + p_xccq.xccq212f +
                            p_xccq.xccq214f + p_xccq.xccq216f + p_xccq.xccq218f +
                            p_xccq.xccq302f + p_xccq.xccq304f + p_xccq.xccq306f +
                            p_xccq.xccq308f + p_xccq.xccq310f + p_xccq.xccq312f +
                            p_xccq.xccq314f
      LET l_xccq902.g     = p_xccq.xccq102g + p_xccq.xccq202g + p_xccq.xccq204g + p_xccq.xccq206g +
                            p_xccq.xccq208g + p_xccq.xccq210g + p_xccq.xccq212g +
                            p_xccq.xccq214g + p_xccq.xccq216g + p_xccq.xccq218g +
                            p_xccq.xccq302g + p_xccq.xccq304g + p_xccq.xccq306g +
                            p_xccq.xccq308g + p_xccq.xccq310g + p_xccq.xccq312g +
                            p_xccq.xccq314g
      LET l_xccq902.h     = p_xccq.xccq102h + p_xccq.xccq202h + p_xccq.xccq204h + p_xccq.xccq206h +
                            p_xccq.xccq208h + p_xccq.xccq210h + p_xccq.xccq212h +
                            p_xccq.xccq214h + p_xccq.xccq216h + p_xccq.xccq218h +
                            p_xccq.xccq302h + p_xccq.xccq304h + p_xccq.xccq306h +
                            p_xccq.xccq308h + p_xccq.xccq310h + p_xccq.xccq312h +
                            p_xccq.xccq314h
      LET l_xccq902.sum   = p_xccq.xccq102 + p_xccq.xccq202 + p_xccq.xccq204 + p_xccq.xccq206 +
                            p_xccq.xccq208 + p_xccq.xccq210 + p_xccq.xccq212 +
                            p_xccq.xccq214 + p_xccq.xccq216 + p_xccq.xccq218 +
                            p_xccq.xccq302 + p_xccq.xccq304 + p_xccq.xccq306 +
                            p_xccq.xccq308 + p_xccq.xccq310 + p_xccq.xccq312 +
                            p_xccq.xccq314

      LET p_xccq.xccq903  = p_xccq.xccq902  - l_xccq902.sum
      LET p_xccq.xccq903a = p_xccq.xccq902a - l_xccq902.a     #期末結存調整金額-材料
      LET p_xccq.xccq903b = p_xccq.xccq902b - l_xccq902.b     #期末結存調整金額-人工
      LET p_xccq.xccq903c = p_xccq.xccq902c - l_xccq902.c     #期末結存調整金額-加工
      LET p_xccq.xccq903d = p_xccq.xccq902d - l_xccq902.d     #期末結存調整金額-製費一
      LET p_xccq.xccq903e = p_xccq.xccq902e - l_xccq902.e     #期末結存調整金額-製費二
      LET p_xccq.xccq903f = p_xccq.xccq902f - l_xccq902.f     #期末結存調整金額-製費三
      LET p_xccq.xccq903g = p_xccq.xccq902g - l_xccq902.g     #期末結存調整金額-製費四
      LET p_xccq.xccq903h = p_xccq.xccq902h - l_xccq902.h     #期末結存調整金額-製費五
      
      #調整
      LET p_xccq.xccq903a  = p_xccq.xccq903 - (p_xccq.xccq903b + p_xccq.xccq903c + p_xccq.xccq903d +
                             p_xccq.xccq903e + p_xccq.xccq903f + p_xccq.xccq903g + p_xccq.xccq903h)
                            
      CALL s_num_round(g_round_type,p_xccq.xccq903a,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903a
      CALL s_num_round(g_round_type,p_xccq.xccq903b,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903b
      CALL s_num_round(g_round_type,p_xccq.xccq903c,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903c
      CALL s_num_round(g_round_type,p_xccq.xccq903d,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903d
      CALL s_num_round(g_round_type,p_xccq.xccq903e,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903e
      CALL s_num_round(g_round_type,p_xccq.xccq903f,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903f
      CALL s_num_round(g_round_type,p_xccq.xccq903g,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903g
      CALL s_num_round(g_round_type,p_xccq.xccq903h,g_curr[l_seq].digit2)   RETURNING p_xccq.xccq903h   
      
   END IF

   LET r_xccq.* = p_xccq.*

   RETURN r_xccq.*
END FUNCTION

################################################################################
# Descriptions...: 对xccc_t中的资料做SUM/算平均单价等
# Memo...........:
# Usage..........: CALL s_axcp500_sum_xccc(p_xccc)
#                       RETURNING r_xccc
# Input parameter: p_xccc         来源值
# Return code....: r_xccc         FORMAT后的值
# Date & Author..: 2014-08-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_sum_xccc(p_xccc)
#   DEFINE p_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE p_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
#   DEFINE r_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE r_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE r_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_seq        LIKE xccc_t.xccc001
   DEFINE l_qty        LIKE xccc_t.xccc201
   DEFINE l_xccc902    type_g_std_cost   
   
   LET l_seq = p_xccc.xccc001

   WHENEVER ERROR CONTINUE

#  CALL s_axcp500_get_round_setting(p_xccc.xccc006)
   #上期结存
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc101,g_unit_round_digit) RETURNING p_xccc.xccc101
   CALL s_num_round(g_round_type,p_xccc.xccc102a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102a
   CALL s_num_round(g_round_type,p_xccc.xccc102b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102b
   CALL s_num_round(g_round_type,p_xccc.xccc102c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102c
   CALL s_num_round(g_round_type,p_xccc.xccc102d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102d
   CALL s_num_round(g_round_type,p_xccc.xccc102e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102e
   CALL s_num_round(g_round_type,p_xccc.xccc102f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102f
   CALL s_num_round(g_round_type,p_xccc.xccc102g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102g
   CALL s_num_round(g_round_type,p_xccc.xccc102h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102h

   #上期结存金额
   LET p_xccc.xccc102  = p_xccc.xccc102a + p_xccc.xccc102b + p_xccc.xccc102c +
                         p_xccc.xccc102d + p_xccc.xccc102e + p_xccc.xccc102f +
                         p_xccc.xccc102g + p_xccc.xccc102h
   CALL s_num_round(g_round_type,p_xccc.xccc102 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc102


   #本期采购入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc201,g_unit_round_digit) RETURNING p_xccc.xccc201
   CALL s_num_round(g_round_type,p_xccc.xccc202a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202a
   CALL s_num_round(g_round_type,p_xccc.xccc202b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202b
   CALL s_num_round(g_round_type,p_xccc.xccc202c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202c
   CALL s_num_round(g_round_type,p_xccc.xccc202d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202d
   CALL s_num_round(g_round_type,p_xccc.xccc202e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202e
   CALL s_num_round(g_round_type,p_xccc.xccc202f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202f
   CALL s_num_round(g_round_type,p_xccc.xccc202g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202g
   CALL s_num_round(g_round_type,p_xccc.xccc202h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202h

   #本期采购入库金额
   LET p_xccc.xccc202  = p_xccc.xccc202a + p_xccc.xccc202b + p_xccc.xccc202c +
                         p_xccc.xccc202d + p_xccc.xccc202e + p_xccc.xccc202f +
                         p_xccc.xccc202g + p_xccc.xccc202h
   CALL s_num_round(g_round_type,p_xccc.xccc202 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc202

   #本期委外入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc203,g_unit_round_digit) RETURNING p_xccc.xccc203
   CALL s_num_round(g_round_type,p_xccc.xccc204a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204a
   CALL s_num_round(g_round_type,p_xccc.xccc204b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204b
   CALL s_num_round(g_round_type,p_xccc.xccc204c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204c
   CALL s_num_round(g_round_type,p_xccc.xccc204d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204d
   CALL s_num_round(g_round_type,p_xccc.xccc204e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204e
   CALL s_num_round(g_round_type,p_xccc.xccc204f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204f
   CALL s_num_round(g_round_type,p_xccc.xccc204g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204g
   CALL s_num_round(g_round_type,p_xccc.xccc204h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204h

   #本期委外入库金额
   LET p_xccc.xccc204  = p_xccc.xccc204a + p_xccc.xccc204b + p_xccc.xccc204c +
                         p_xccc.xccc204d + p_xccc.xccc204e + p_xccc.xccc204f +
                         p_xccc.xccc204g + p_xccc.xccc204h
   CALL s_num_round(g_round_type,p_xccc.xccc204 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc204


   #本期工单入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc205,g_unit_round_digit) RETURNING p_xccc.xccc205
   CALL s_num_round(g_round_type,p_xccc.xccc206a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206a
   CALL s_num_round(g_round_type,p_xccc.xccc206b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206b
   CALL s_num_round(g_round_type,p_xccc.xccc206c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206c
   CALL s_num_round(g_round_type,p_xccc.xccc206d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206d
   CALL s_num_round(g_round_type,p_xccc.xccc206e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206e
   CALL s_num_round(g_round_type,p_xccc.xccc206f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206f
   CALL s_num_round(g_round_type,p_xccc.xccc206g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206g
   CALL s_num_round(g_round_type,p_xccc.xccc206h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206h

   #本期工单入库金额
   LET p_xccc.xccc206  = p_xccc.xccc206a + p_xccc.xccc206b + p_xccc.xccc206c +
                         p_xccc.xccc206d + p_xccc.xccc206e + p_xccc.xccc206f +
                         p_xccc.xccc206g + p_xccc.xccc206h
   CALL s_num_round(g_round_type,p_xccc.xccc206 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc206
   #本期重工领出
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc207,g_unit_round_digit) RETURNING p_xccc.xccc207
   CALL s_num_round(g_round_type,p_xccc.xccc208a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208a
   CALL s_num_round(g_round_type,p_xccc.xccc208b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208b
   CALL s_num_round(g_round_type,p_xccc.xccc208c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208c
   CALL s_num_round(g_round_type,p_xccc.xccc208d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208d
   CALL s_num_round(g_round_type,p_xccc.xccc208e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208e
   CALL s_num_round(g_round_type,p_xccc.xccc208f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208f
   CALL s_num_round(g_round_type,p_xccc.xccc208g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208g
   CALL s_num_round(g_round_type,p_xccc.xccc208h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208h

   #本期重工领出金额
   LET p_xccc.xccc208  = p_xccc.xccc208a + p_xccc.xccc208b + p_xccc.xccc208c +
                         p_xccc.xccc208d + p_xccc.xccc208e + p_xccc.xccc208f +
                         p_xccc.xccc208g + p_xccc.xccc208h
   CALL s_num_round(g_round_type,p_xccc.xccc208 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc208

   #本期重工入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc209,g_unit_round_digit) RETURNING p_xccc.xccc209
   CALL s_num_round(g_round_type,p_xccc.xccc210a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210a
   CALL s_num_round(g_round_type,p_xccc.xccc210b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210b
   CALL s_num_round(g_round_type,p_xccc.xccc210c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210c
   CALL s_num_round(g_round_type,p_xccc.xccc210d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210d
   CALL s_num_round(g_round_type,p_xccc.xccc210e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210e
   CALL s_num_round(g_round_type,p_xccc.xccc210f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210f
   CALL s_num_round(g_round_type,p_xccc.xccc210g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210g
   CALL s_num_round(g_round_type,p_xccc.xccc210h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210h

   #本期重工入库金额
   LET p_xccc.xccc210  = p_xccc.xccc210a + p_xccc.xccc210b + p_xccc.xccc210c +
                         p_xccc.xccc210d + p_xccc.xccc210e + p_xccc.xccc210f +
                         p_xccc.xccc210g + p_xccc.xccc210h
   CALL s_num_round(g_round_type,p_xccc.xccc210 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc210

   #本期杂项入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc211,g_unit_round_digit) RETURNING p_xccc.xccc211
   CALL s_num_round(g_round_type,p_xccc.xccc212a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212a
   CALL s_num_round(g_round_type,p_xccc.xccc212b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212b
   CALL s_num_round(g_round_type,p_xccc.xccc212c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212c
   CALL s_num_round(g_round_type,p_xccc.xccc212d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212d
   CALL s_num_round(g_round_type,p_xccc.xccc212e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212e
   CALL s_num_round(g_round_type,p_xccc.xccc212f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212f
   CALL s_num_round(g_round_type,p_xccc.xccc212g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212g
   CALL s_num_round(g_round_type,p_xccc.xccc212h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212h

   #本期杂项入库金额
   LET p_xccc.xccc212  = p_xccc.xccc212a + p_xccc.xccc212b + p_xccc.xccc212c +
                         p_xccc.xccc212d + p_xccc.xccc212e + p_xccc.xccc212f +
                         p_xccc.xccc212g + p_xccc.xccc212h
   CALL s_num_round(g_round_type,p_xccc.xccc212 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc212

   #本期调整入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc213,g_unit_round_digit) RETURNING p_xccc.xccc213
   CALL s_num_round(g_round_type,p_xccc.xccc214a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214a
   CALL s_num_round(g_round_type,p_xccc.xccc214b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214b
   CALL s_num_round(g_round_type,p_xccc.xccc214c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214c
   CALL s_num_round(g_round_type,p_xccc.xccc214d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214d
   CALL s_num_round(g_round_type,p_xccc.xccc214e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214e
   CALL s_num_round(g_round_type,p_xccc.xccc214f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214f
   CALL s_num_round(g_round_type,p_xccc.xccc214g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214g
   CALL s_num_round(g_round_type,p_xccc.xccc214h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214h

   #本期调整入库金额
   LET p_xccc.xccc214  = p_xccc.xccc214a + p_xccc.xccc214b + p_xccc.xccc214c +
                         p_xccc.xccc214d + p_xccc.xccc214e + p_xccc.xccc214f +
                         p_xccc.xccc214g + p_xccc.xccc214h
   CALL s_num_round(g_round_type,p_xccc.xccc214 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc214

   #本期销退入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc215,g_unit_round_digit) RETURNING p_xccc.xccc215
   CALL s_num_round(g_round_type,p_xccc.xccc216a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216a
   CALL s_num_round(g_round_type,p_xccc.xccc216b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216b
   CALL s_num_round(g_round_type,p_xccc.xccc216c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216c
   CALL s_num_round(g_round_type,p_xccc.xccc216d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216d
   CALL s_num_round(g_round_type,p_xccc.xccc216e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216e
   CALL s_num_round(g_round_type,p_xccc.xccc216f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216f
   CALL s_num_round(g_round_type,p_xccc.xccc216g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216g
   CALL s_num_round(g_round_type,p_xccc.xccc216h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216h

   #本期销退入库金额
   LET p_xccc.xccc216  = p_xccc.xccc216a + p_xccc.xccc216b + p_xccc.xccc216c +
                         p_xccc.xccc216d + p_xccc.xccc216e + p_xccc.xccc216f +
                         p_xccc.xccc216g + p_xccc.xccc216h
   CALL s_num_round(g_round_type,p_xccc.xccc216 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc216

   #本期其他入库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc217,g_unit_round_digit) RETURNING p_xccc.xccc217
   CALL s_num_round(g_round_type,p_xccc.xccc218a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218a
   CALL s_num_round(g_round_type,p_xccc.xccc218b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218b
   CALL s_num_round(g_round_type,p_xccc.xccc218c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218c
   CALL s_num_round(g_round_type,p_xccc.xccc218d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218d
   CALL s_num_round(g_round_type,p_xccc.xccc218e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218e
   CALL s_num_round(g_round_type,p_xccc.xccc218f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218f
   CALL s_num_round(g_round_type,p_xccc.xccc218g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218g
   CALL s_num_round(g_round_type,p_xccc.xccc218h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218h

   #本期其他入库金额
   LET p_xccc.xccc218  = p_xccc.xccc218a + p_xccc.xccc218b + p_xccc.xccc218c +
                         p_xccc.xccc218d + p_xccc.xccc218e + p_xccc.xccc218f +
                         p_xccc.xccc218g + p_xccc.xccc218h
   CALL s_num_round(g_round_type,p_xccc.xccc218 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc218

   #本期工单领用
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc301,g_unit_round_digit) RETURNING p_xccc.xccc301
   CALL s_num_round(g_round_type,p_xccc.xccc302a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302a
   CALL s_num_round(g_round_type,p_xccc.xccc302b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302b
   CALL s_num_round(g_round_type,p_xccc.xccc302c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302c
   CALL s_num_round(g_round_type,p_xccc.xccc302d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302d
   CALL s_num_round(g_round_type,p_xccc.xccc302e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302e
   CALL s_num_round(g_round_type,p_xccc.xccc302f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302f
   CALL s_num_round(g_round_type,p_xccc.xccc302g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302g
   CALL s_num_round(g_round_type,p_xccc.xccc302h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302h

   #本期工单领用金额
   LET p_xccc.xccc302  = p_xccc.xccc302a + p_xccc.xccc302b + p_xccc.xccc302c +
                         p_xccc.xccc302d + p_xccc.xccc302e + p_xccc.xccc302f +
                         p_xccc.xccc302g + p_xccc.xccc302h
   CALL s_num_round(g_round_type,p_xccc.xccc302 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc302

   #本期销货
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc303,g_unit_round_digit) RETURNING p_xccc.xccc303
   CALL s_num_round(g_round_type,p_xccc.xccc304a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304a
   CALL s_num_round(g_round_type,p_xccc.xccc304b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304b
   CALL s_num_round(g_round_type,p_xccc.xccc304c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304c
   CALL s_num_round(g_round_type,p_xccc.xccc304d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304d
   CALL s_num_round(g_round_type,p_xccc.xccc304e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304e
   CALL s_num_round(g_round_type,p_xccc.xccc304f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304f
   CALL s_num_round(g_round_type,p_xccc.xccc304g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304g
   CALL s_num_round(g_round_type,p_xccc.xccc304h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304h

   #本期销货成本
   LET p_xccc.xccc304  = p_xccc.xccc304a + p_xccc.xccc304b + p_xccc.xccc304c +
                         p_xccc.xccc304d + p_xccc.xccc304e + p_xccc.xccc304f +
                         p_xccc.xccc304g + p_xccc.xccc304h
   CALL s_num_round(g_round_type,p_xccc.xccc304 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc304

   #本期销退
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc305,g_unit_round_digit) RETURNING p_xccc.xccc305
   CALL s_num_round(g_round_type,p_xccc.xccc306a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306a
   CALL s_num_round(g_round_type,p_xccc.xccc306b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306b
   CALL s_num_round(g_round_type,p_xccc.xccc306c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306c
   CALL s_num_round(g_round_type,p_xccc.xccc306d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306d
   CALL s_num_round(g_round_type,p_xccc.xccc306e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306e
   CALL s_num_round(g_round_type,p_xccc.xccc306f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306f
   CALL s_num_round(g_round_type,p_xccc.xccc306g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306g
   CALL s_num_round(g_round_type,p_xccc.xccc306h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306h

   #本期销退成本
   LET p_xccc.xccc306  = p_xccc.xccc306a + p_xccc.xccc306b + p_xccc.xccc306c +
                         p_xccc.xccc306d + p_xccc.xccc306e + p_xccc.xccc306f +
                         p_xccc.xccc306g + p_xccc.xccc306h
   CALL s_num_round(g_round_type,p_xccc.xccc306 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc306

   #本期销售费用
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc307,g_unit_round_digit) RETURNING p_xccc.xccc307
   CALL s_num_round(g_round_type,p_xccc.xccc308a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308a
   CALL s_num_round(g_round_type,p_xccc.xccc308b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308b
   CALL s_num_round(g_round_type,p_xccc.xccc308c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308c
   CALL s_num_round(g_round_type,p_xccc.xccc308d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308d
   CALL s_num_round(g_round_type,p_xccc.xccc308e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308e
   CALL s_num_round(g_round_type,p_xccc.xccc308f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308f
   CALL s_num_round(g_round_type,p_xccc.xccc308g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308g
   CALL s_num_round(g_round_type,p_xccc.xccc308h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308h

   #本期销售费用成本
   LET p_xccc.xccc308  = p_xccc.xccc308a + p_xccc.xccc308b + p_xccc.xccc308c +
                         p_xccc.xccc308d + p_xccc.xccc308e + p_xccc.xccc308f +
                         p_xccc.xccc308g + p_xccc.xccc308h
   CALL s_num_round(g_round_type,p_xccc.xccc308 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc308

   #本期杂发
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc309,g_unit_round_digit) RETURNING p_xccc.xccc309
   CALL s_num_round(g_round_type,p_xccc.xccc310a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310a
   CALL s_num_round(g_round_type,p_xccc.xccc310b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310b
   CALL s_num_round(g_round_type,p_xccc.xccc310c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310c
   CALL s_num_round(g_round_type,p_xccc.xccc310d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310d
   CALL s_num_round(g_round_type,p_xccc.xccc310e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310e
   CALL s_num_round(g_round_type,p_xccc.xccc310f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310f
   CALL s_num_round(g_round_type,p_xccc.xccc310g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310g
   CALL s_num_round(g_round_type,p_xccc.xccc310h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310h
   #本期杂发金额
   LET p_xccc.xccc310  = p_xccc.xccc310a + p_xccc.xccc310b + p_xccc.xccc310c +
                         p_xccc.xccc310d + p_xccc.xccc310e + p_xccc.xccc310f +
                         p_xccc.xccc310g + p_xccc.xccc310h
   CALL s_num_round(g_round_type,p_xccc.xccc310 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc310


   #本期盘盈亏
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc311,g_unit_round_digit) RETURNING p_xccc.xccc311
   CALL s_num_round(g_round_type,p_xccc.xccc312a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312a
   CALL s_num_round(g_round_type,p_xccc.xccc312b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312b
   CALL s_num_round(g_round_type,p_xccc.xccc312c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312c
   CALL s_num_round(g_round_type,p_xccc.xccc312d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312d
   CALL s_num_round(g_round_type,p_xccc.xccc312e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312e
   CALL s_num_round(g_round_type,p_xccc.xccc312f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312f
   CALL s_num_round(g_round_type,p_xccc.xccc312g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312g
   CALL s_num_round(g_round_type,p_xccc.xccc312h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312h

   #本期盘盈亏金额
   LET p_xccc.xccc312  = p_xccc.xccc312a + p_xccc.xccc312b + p_xccc.xccc312c +
                         p_xccc.xccc312d + p_xccc.xccc312e + p_xccc.xccc312f +
                         p_xccc.xccc312g + p_xccc.xccc312h
   CALL s_num_round(g_round_type,p_xccc.xccc312 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc312

   #本期其他出库
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc313,g_unit_round_digit) RETURNING p_xccc.xccc313
   CALL s_num_round(g_round_type,p_xccc.xccc314a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314a
   CALL s_num_round(g_round_type,p_xccc.xccc314b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314b
   CALL s_num_round(g_round_type,p_xccc.xccc314c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314c
   CALL s_num_round(g_round_type,p_xccc.xccc314d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314d
   CALL s_num_round(g_round_type,p_xccc.xccc314e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314e
   CALL s_num_round(g_round_type,p_xccc.xccc314f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314f
   CALL s_num_round(g_round_type,p_xccc.xccc314g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314g
   CALL s_num_round(g_round_type,p_xccc.xccc314h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314h

   #本期其他出库金额
   LET p_xccc.xccc314  = p_xccc.xccc314a + p_xccc.xccc314b + p_xccc.xccc314c +
                         p_xccc.xccc314d + p_xccc.xccc314e + p_xccc.xccc314f +
                         p_xccc.xccc314g + p_xccc.xccc314h
   CALL s_num_round(g_round_type,p_xccc.xccc314 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc314

   #期末结存数量        = 上期结存数量    + 采购入库        + 委外入库         + 工单入库
   LET p_xccc.xccc901  = p_xccc.xccc101 + p_xccc.xccc201 + p_xccc.xccc203 + p_xccc.xccc205 +
   #                     重工领出         + 重工入库        + 杂项入库
                         p_xccc.xccc207 + p_xccc.xccc209 + p_xccc.xccc211 +
   #                     调整入库         + 销退入库        + 其他入库
                         p_xccc.xccc213 + p_xccc.xccc215 + p_xccc.xccc217 +
   #                     工单领用         + 销货            + 销退
                         p_xccc.xccc301 + p_xccc.xccc303 + p_xccc.xccc305 +
   #                     销售费用         + 杂发            + 盘盈亏
                         p_xccc.xccc307 + p_xccc.xccc309 + p_xccc.xccc311 +
   #                     其他出库
                         p_xccc.xccc313
                         
   #期末成本
   LET p_xccc.xccc902  = p_xccc.xccc901 * p_xccc.xccc280
   LET p_xccc.xccc902a = p_xccc.xccc901 * p_xccc.xccc280a
   LET p_xccc.xccc902b = p_xccc.xccc901 * p_xccc.xccc280b
   LET p_xccc.xccc902c = p_xccc.xccc901 * p_xccc.xccc280c
   LET p_xccc.xccc902d = p_xccc.xccc901 * p_xccc.xccc280d
   LET p_xccc.xccc902e = p_xccc.xccc901 * p_xccc.xccc280e
   LET p_xccc.xccc902f = p_xccc.xccc901 * p_xccc.xccc280f
   LET p_xccc.xccc902g = p_xccc.xccc901 * p_xccc.xccc280g
   LET p_xccc.xccc902h = p_xccc.xccc901 * p_xccc.xccc280h
   
#  CALL s_num_round(g_unit_round_type,p_xccc.xccc901,g_unit_round_digit) RETURNING p_xccc.xccc901
   CALL s_num_round(g_round_type,p_xccc.xccc902 ,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902 
   CALL s_num_round(g_round_type,p_xccc.xccc902a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902a
   CALL s_num_round(g_round_type,p_xccc.xccc902b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902b
   CALL s_num_round(g_round_type,p_xccc.xccc902c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902c
   CALL s_num_round(g_round_type,p_xccc.xccc902d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902d
   CALL s_num_round(g_round_type,p_xccc.xccc902e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902e
   CALL s_num_round(g_round_type,p_xccc.xccc902f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902f
   CALL s_num_round(g_round_type,p_xccc.xccc902g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902g
   CALL s_num_round(g_round_type,p_xccc.xccc902h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc902h
   
   LET p_xccc.xccc902a  = p_xccc.xccc902 - (p_xccc.xccc902b + p_xccc.xccc902c +
                          p_xccc.xccc902d + p_xccc.xccc902e + p_xccc.xccc902f +
                          p_xccc.xccc902g + p_xccc.xccc902h )

   #本期没有数量,但有金额,则把金额转至结余调整中
   IF p_xccc.xccc901 = 0 AND (p_xccc.xccc902  <> 0 OR p_xccc.xccc902a <> 0 OR p_xccc.xccc902b <> 0 OR p_xccc.xccc902d <> 0 OR 
                              p_xccc.xccc902d <> 0 OR p_xccc.xccc902e <> 0 OR p_xccc.xccc902f <> 0 OR p_xccc.xccc902g <> 0 OR
                              p_xccc.xccc902h <> 0 ) THEN

      LET p_xccc.xccc903  =  p_xccc.xccc903  + p_xccc.xccc902  * -1    #期末結存調整金額
      LET p_xccc.xccc903a =  p_xccc.xccc903a + p_xccc.xccc902a * -1    #期末結存調整金額-材料
      LET p_xccc.xccc903b =  p_xccc.xccc903b + p_xccc.xccc902b * -1    #期末結存調整金額-人工
      LET p_xccc.xccc903c =  p_xccc.xccc903c + p_xccc.xccc902c * -1    #期末結存調整金額-加工
      LET p_xccc.xccc903d =  p_xccc.xccc903d + p_xccc.xccc902d * -1    #期末結存調整金額-製費一
      LET p_xccc.xccc903e =  p_xccc.xccc903e + p_xccc.xccc902e * -1    #期末結存調整金額-製費二
      LET p_xccc.xccc903f =  p_xccc.xccc903f + p_xccc.xccc902f * -1    #期末結存調整金額-製費三
      LET p_xccc.xccc903g =  p_xccc.xccc903g + p_xccc.xccc902g * -1    #期末結存調整金額-製費四
      LET p_xccc.xccc903h =  p_xccc.xccc903h + p_xccc.xccc902h * -1    #期末結存調整金額-製費五

      LET p_xccc.xccc902  = 0
      LET p_xccc.xccc902a = 0
      LET p_xccc.xccc902b = 0
      LET p_xccc.xccc902c = 0
      LET p_xccc.xccc902d = 0
      LET p_xccc.xccc902e = 0
      LET p_xccc.xccc902f = 0
      LET p_xccc.xccc902g = 0
      LET p_xccc.xccc902h = 0
      
   END IF
   
   #xccc902(结余金额)是用 期初 + 本期入 - 本期出得到的,但是不一定等于 xccc901(结余数量) * 平均单价
   #则要把这两个的差额记录至xccc903(结余调整)中
   IF p_xccc.xccc901 <> 0 THEN
      LET l_xccc902.a     = p_xccc.xccc102a + p_xccc.xccc202a + p_xccc.xccc204a + p_xccc.xccc206a +
                            p_xccc.xccc208a + p_xccc.xccc210a + p_xccc.xccc212a +
                            p_xccc.xccc214a + p_xccc.xccc216a + p_xccc.xccc218a +
                            p_xccc.xccc302a + p_xccc.xccc304a + p_xccc.xccc306a +
                            p_xccc.xccc308a + p_xccc.xccc310a + p_xccc.xccc312a +
                            p_xccc.xccc314a
      LET l_xccc902.b     = p_xccc.xccc102b + p_xccc.xccc202b + p_xccc.xccc204b + p_xccc.xccc206b +
                            p_xccc.xccc208b + p_xccc.xccc210b + p_xccc.xccc212b +
                            p_xccc.xccc214b + p_xccc.xccc216b + p_xccc.xccc218b +
                            p_xccc.xccc302b + p_xccc.xccc304b + p_xccc.xccc306b +
                            p_xccc.xccc308b + p_xccc.xccc310b + p_xccc.xccc312b +
                            p_xccc.xccc314b
      LET l_xccc902.c     = p_xccc.xccc102c + p_xccc.xccc202c + p_xccc.xccc204c + p_xccc.xccc206c +
                            p_xccc.xccc208c + p_xccc.xccc210c + p_xccc.xccc212c +
                            p_xccc.xccc214c + p_xccc.xccc216c + p_xccc.xccc218c +
                            p_xccc.xccc302c + p_xccc.xccc304c + p_xccc.xccc306c +
                            p_xccc.xccc308c + p_xccc.xccc310c + p_xccc.xccc312c +
                            p_xccc.xccc314c
      LET l_xccc902.d     = p_xccc.xccc102d + p_xccc.xccc202d + p_xccc.xccc204d + p_xccc.xccc206d +
                            p_xccc.xccc208d + p_xccc.xccc210d + p_xccc.xccc212d +
                            p_xccc.xccc214d + p_xccc.xccc216d + p_xccc.xccc218d +
                            p_xccc.xccc302d + p_xccc.xccc304d + p_xccc.xccc306d +
                            p_xccc.xccc308d + p_xccc.xccc310d + p_xccc.xccc312d +
                            p_xccc.xccc314d
      LET l_xccc902.e     = p_xccc.xccc102e + p_xccc.xccc202e + p_xccc.xccc204e + p_xccc.xccc206e +
                            p_xccc.xccc208e + p_xccc.xccc210e + p_xccc.xccc212e +
                            p_xccc.xccc214e + p_xccc.xccc216e + p_xccc.xccc218e +
                            p_xccc.xccc302e + p_xccc.xccc304e + p_xccc.xccc306e +
                            p_xccc.xccc308e + p_xccc.xccc310e + p_xccc.xccc312e +
                            p_xccc.xccc314e
      LET l_xccc902.f     = p_xccc.xccc102f + p_xccc.xccc202f + p_xccc.xccc204f + p_xccc.xccc206f +
                            p_xccc.xccc208f + p_xccc.xccc210f + p_xccc.xccc212f +
                            p_xccc.xccc214f + p_xccc.xccc216f + p_xccc.xccc218f +
                            p_xccc.xccc302f + p_xccc.xccc304f + p_xccc.xccc306f +
                            p_xccc.xccc308f + p_xccc.xccc310f + p_xccc.xccc312f +
                            p_xccc.xccc314f
      LET l_xccc902.g     = p_xccc.xccc102g + p_xccc.xccc202g + p_xccc.xccc204g + p_xccc.xccc206g +
                            p_xccc.xccc208g + p_xccc.xccc210g + p_xccc.xccc212g +
                            p_xccc.xccc214g + p_xccc.xccc216g + p_xccc.xccc218g +
                            p_xccc.xccc302g + p_xccc.xccc304g + p_xccc.xccc306g +
                            p_xccc.xccc308g + p_xccc.xccc310g + p_xccc.xccc312g +
                            p_xccc.xccc314g
      LET l_xccc902.h     = p_xccc.xccc102h + p_xccc.xccc202h + p_xccc.xccc204h + p_xccc.xccc206h +
                            p_xccc.xccc208h + p_xccc.xccc210h + p_xccc.xccc212h +
                            p_xccc.xccc214h + p_xccc.xccc216h + p_xccc.xccc218h +
                            p_xccc.xccc302h + p_xccc.xccc304h + p_xccc.xccc306h +
                            p_xccc.xccc308h + p_xccc.xccc310h + p_xccc.xccc312h +
                            p_xccc.xccc314h
      LET l_xccc902.sum   = p_xccc.xccc102 + p_xccc.xccc202 + p_xccc.xccc204 + p_xccc.xccc206 +
                            p_xccc.xccc208 + p_xccc.xccc210 + p_xccc.xccc212 +
                            p_xccc.xccc214 + p_xccc.xccc216 + p_xccc.xccc218 +
                            p_xccc.xccc302 + p_xccc.xccc304 + p_xccc.xccc306 +
                            p_xccc.xccc308 + p_xccc.xccc310 + p_xccc.xccc312 +
                            p_xccc.xccc314

      LET p_xccc.xccc903  = p_xccc.xccc902  - l_xccc902.sum
      LET p_xccc.xccc903a = p_xccc.xccc902a - l_xccc902.a     #期末結存調整金額-材料
      LET p_xccc.xccc903b = p_xccc.xccc902b - l_xccc902.b     #期末結存調整金額-人工
      LET p_xccc.xccc903c = p_xccc.xccc902c - l_xccc902.c     #期末結存調整金額-加工
      LET p_xccc.xccc903d = p_xccc.xccc902d - l_xccc902.d     #期末結存調整金額-製費一
      LET p_xccc.xccc903e = p_xccc.xccc902e - l_xccc902.e     #期末結存調整金額-製費二
      LET p_xccc.xccc903f = p_xccc.xccc902f - l_xccc902.f     #期末結存調整金額-製費三
      LET p_xccc.xccc903g = p_xccc.xccc902g - l_xccc902.g     #期末結存調整金額-製費四
      LET p_xccc.xccc903h = p_xccc.xccc902h - l_xccc902.h     #期末結存調整金額-製費五
      
      #調整
      LET p_xccc.xccc903a  = p_xccc.xccc903 - (p_xccc.xccc903b + p_xccc.xccc903c + p_xccc.xccc903d +
                             p_xccc.xccc903e + p_xccc.xccc903f + p_xccc.xccc903g + p_xccc.xccc903h)
                            
      CALL s_num_round(g_round_type,p_xccc.xccc903a,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903a
      CALL s_num_round(g_round_type,p_xccc.xccc903b,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903b
      CALL s_num_round(g_round_type,p_xccc.xccc903c,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903c
      CALL s_num_round(g_round_type,p_xccc.xccc903d,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903d
      CALL s_num_round(g_round_type,p_xccc.xccc903e,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903e
      CALL s_num_round(g_round_type,p_xccc.xccc903f,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903f
      CALL s_num_round(g_round_type,p_xccc.xccc903g,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903g
      CALL s_num_round(g_round_type,p_xccc.xccc903h,g_curr[l_seq].digit2)   RETURNING p_xccc.xccc903h   
      
   END IF

   LET r_xccc.* = p_xccc.*

   RETURN r_xccc.*
END FUNCTION

################################################################################
# Descriptions...: 对xcce_t中的资料做SUM/算平均单价等
# Memo...........:
# Usage..........: CALL s_axcp500_sum_xcce(p_xcce)
#                       RETURNING r_xcce.*
# Input parameter: p_xcce         xcce的资料
# Return code....: r_xcce         经过运算后的xcce资料
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_sum_xcce(p_xcce)
#   DEFINE p_xcce       RECORD LIKE xcce_t.*  #161124-00048#20 mark
#   DEFINE r_xcce       RECORD LIKE xcce_t.* #161124-00048#20 mark
   DEFINE p_xcce           type_g_xcce  #170605-00013#1-add
   DEFINE r_xcce           type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_seq        LIKE xccc_t.xccc001
   
   WHENEVER ERROR CONTINUE

   LET l_seq = p_xcce.xcce001
   CALL s_axcp500_get_round_setting(p_xcce.xcce007) 
   #上期结存
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce101,g_unit_round_digit) RETURNING p_xcce.xcce101
   CALL s_num_round(g_round_type,p_xcce.xcce102a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102a
   CALL s_num_round(g_round_type,p_xcce.xcce102b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102b
   CALL s_num_round(g_round_type,p_xcce.xcce102c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102c
   CALL s_num_round(g_round_type,p_xcce.xcce102d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102d
   CALL s_num_round(g_round_type,p_xcce.xcce102e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102e
   CALL s_num_round(g_round_type,p_xcce.xcce102f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102f
   CALL s_num_round(g_round_type,p_xcce.xcce102g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102g
   CALL s_num_round(g_round_type,p_xcce.xcce102h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce102h

   #上期结存金额
   LET p_xcce.xcce102  = p_xcce.xcce102a + p_xcce.xcce102b + p_xcce.xcce102c +
                         p_xcce.xcce102d + p_xcce.xcce102e + p_xcce.xcce102f +
                         p_xcce.xcce102g + p_xcce.xcce102h
   CALL s_num_round(g_round_type,p_xcce.xcce102 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce102


   #本期本阶投入
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce201,g_unit_round_digit) RETURNING p_xcce.xcce201
   CALL s_num_round(g_round_type,p_xcce.xcce202a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202a
   CALL s_num_round(g_round_type,p_xcce.xcce202b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202b
   CALL s_num_round(g_round_type,p_xcce.xcce202c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202c
   CALL s_num_round(g_round_type,p_xcce.xcce202d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202d
   CALL s_num_round(g_round_type,p_xcce.xcce202e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202e
   CALL s_num_round(g_round_type,p_xcce.xcce202f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202f
   CALL s_num_round(g_round_type,p_xcce.xcce202g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202g
   CALL s_num_round(g_round_type,p_xcce.xcce202h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce202h

   #本期本阶投入金额
   LET p_xcce.xcce202  = p_xcce.xcce202a + p_xcce.xcce202b + p_xcce.xcce202c +
                         p_xcce.xcce202d + p_xcce.xcce202e + p_xcce.xcce202f +
                         p_xcce.xcce202g + p_xcce.xcce202h
   CALL s_num_round(g_round_type,p_xcce.xcce202 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce202

   #本期当站下线
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce205,g_unit_round_digit) RETURNING p_xcce.xcce205
   CALL s_num_round(g_round_type,p_xcce.xcce206a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206a
   CALL s_num_round(g_round_type,p_xcce.xcce206b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206b
   CALL s_num_round(g_round_type,p_xcce.xcce206c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206c
   CALL s_num_round(g_round_type,p_xcce.xcce206d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206d
   CALL s_num_round(g_round_type,p_xcce.xcce206e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206e
   CALL s_num_round(g_round_type,p_xcce.xcce206f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206f
   CALL s_num_round(g_round_type,p_xcce.xcce206g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206g
   CALL s_num_round(g_round_type,p_xcce.xcce206h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce206h

   #本期当站下线金额
   LET p_xcce.xcce206  = p_xcce.xcce206a + p_xcce.xcce206b + p_xcce.xcce206c +
                         p_xcce.xcce206d + p_xcce.xcce206e + p_xcce.xcce206f +
                         p_xcce.xcce206g + p_xcce.xcce206h
   CALL s_num_round(g_round_type,p_xcce.xcce206 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce206
   
   #本期一般退料
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce207,g_unit_round_digit) RETURNING p_xcce.xcce207
   CALL s_num_round(g_round_type,p_xcce.xcce208a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208a
   CALL s_num_round(g_round_type,p_xcce.xcce208b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208b
   CALL s_num_round(g_round_type,p_xcce.xcce208c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208c
   CALL s_num_round(g_round_type,p_xcce.xcce208d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208d
   CALL s_num_round(g_round_type,p_xcce.xcce208e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208e
   CALL s_num_round(g_round_type,p_xcce.xcce208f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208f
   CALL s_num_round(g_round_type,p_xcce.xcce208g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208g
   CALL s_num_round(g_round_type,p_xcce.xcce208h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce208h

   #本期一般退料金额
   LET p_xcce.xcce208  = p_xcce.xcce208a + p_xcce.xcce208b + p_xcce.xcce208c +
                         p_xcce.xcce208d + p_xcce.xcce208e + p_xcce.xcce208f +
                         p_xcce.xcce208g + p_xcce.xcce208h
   CALL s_num_round(g_round_type,p_xcce.xcce208 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce208
      
   #本期超领料
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce209,g_unit_round_digit) RETURNING p_xcce.xcce209
   CALL s_num_round(g_round_type,p_xcce.xcce210a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210a
   CALL s_num_round(g_round_type,p_xcce.xcce210b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210b
   CALL s_num_round(g_round_type,p_xcce.xcce210c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210c
   CALL s_num_round(g_round_type,p_xcce.xcce210d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210d
   CALL s_num_round(g_round_type,p_xcce.xcce210e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210e
   CALL s_num_round(g_round_type,p_xcce.xcce210f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210f
   CALL s_num_round(g_round_type,p_xcce.xcce210g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210g
   CALL s_num_round(g_round_type,p_xcce.xcce210h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce210h

   #本期超领料金额
   LET p_xcce.xcce210  = p_xcce.xcce210a + p_xcce.xcce210b + p_xcce.xcce210c +
                         p_xcce.xcce210d + p_xcce.xcce210e + p_xcce.xcce210f +
                         p_xcce.xcce210g + p_xcce.xcce210h
   CALL s_num_round(g_round_type,p_xcce.xcce210 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce210
         
   #本期转出数量
   CALL s_num_round(g_unit_round_type,p_xcce.xcce301,g_unit_round_digit) RETURNING p_xcce.xcce301  #170502-00001#1 remark
   CALL s_num_round(g_round_type,p_xcce.xcce302a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302a
   CALL s_num_round(g_round_type,p_xcce.xcce302b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302b
   CALL s_num_round(g_round_type,p_xcce.xcce302c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302c
   CALL s_num_round(g_round_type,p_xcce.xcce302d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302d
   CALL s_num_round(g_round_type,p_xcce.xcce302e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302e
   CALL s_num_round(g_round_type,p_xcce.xcce302f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302f
   CALL s_num_round(g_round_type,p_xcce.xcce302g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302g
   CALL s_num_round(g_round_type,p_xcce.xcce302h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce302h

   #本期转出金额
   LET p_xcce.xcce302  = p_xcce.xcce302a + p_xcce.xcce302b + p_xcce.xcce302c +
                         p_xcce.xcce302d + p_xcce.xcce302e + p_xcce.xcce302f +
                         p_xcce.xcce302g + p_xcce.xcce302h
   CALL s_num_round(g_round_type,p_xcce.xcce302 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce302

   #差异转出数量
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce303,g_unit_round_digit) RETURNING p_xcce.xcce303
   CALL s_num_round(g_round_type,p_xcce.xcce304a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304a
   CALL s_num_round(g_round_type,p_xcce.xcce304b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304b
   CALL s_num_round(g_round_type,p_xcce.xcce304c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304c
   CALL s_num_round(g_round_type,p_xcce.xcce304d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304d
   CALL s_num_round(g_round_type,p_xcce.xcce304e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304e
   CALL s_num_round(g_round_type,p_xcce.xcce304f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304f
   CALL s_num_round(g_round_type,p_xcce.xcce304g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304g
   CALL s_num_round(g_round_type,p_xcce.xcce304h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce304h

   #差异转出金额
   LET p_xcce.xcce304  = p_xcce.xcce304a + p_xcce.xcce304b + p_xcce.xcce304c +
                         p_xcce.xcce304d + p_xcce.xcce304e + p_xcce.xcce304f +
                         p_xcce.xcce304g + p_xcce.xcce304h
   CALL s_num_round(g_round_type,p_xcce.xcce304 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce304

   #盘差数量
#  CALL s_num_round(g_unit_round_type,p_xcce.xcce307,g_unit_round_digit) RETURNING p_xcce.xcce307
   CALL s_num_round(g_round_type,p_xcce.xcce308a,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308a
   CALL s_num_round(g_round_type,p_xcce.xcce308b,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308b
   CALL s_num_round(g_round_type,p_xcce.xcce308c,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308c
   CALL s_num_round(g_round_type,p_xcce.xcce308d,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308d
   CALL s_num_round(g_round_type,p_xcce.xcce308e,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308e
   CALL s_num_round(g_round_type,p_xcce.xcce308f,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308f
   CALL s_num_round(g_round_type,p_xcce.xcce308g,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308g
   CALL s_num_round(g_round_type,p_xcce.xcce308h,g_curr[l_seq].digit2)   RETURNING p_xcce.xcce308h

   #盘差金额
   LET p_xcce.xcce308  = p_xcce.xcce308a + p_xcce.xcce308b + p_xcce.xcce308c +
                         p_xcce.xcce308d + p_xcce.xcce308e + p_xcce.xcce308f +
                         p_xcce.xcce308g + p_xcce.xcce308h
   CALL s_num_round(g_round_type,p_xcce.xcce308 ,g_curr[l_seq].digit2) RETURNING p_xcce.xcce308
   
   
   #期末结存数量       = 上期结存       + 本期投入       + 当站下线       + 一般退料        
   LET p_xcce.xcce901  = p_xcce.xcce101 + p_xcce.xcce201 + p_xcce.xcce205 + p_xcce.xcce207 + 
   #                   + 超领退         + 本期转出       + 差异转出       + 盘差
                         p_xcce.xcce209 + p_xcce.xcce301 + p_xcce.xcce303 + p_xcce.xcce307
             
                         
   #期末结存成本-材料   = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902a  = p_xcce.xcce102a + p_xcce.xcce202a + p_xcce.xcce206a + p_xcce.xcce208a + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210a + p_xcce.xcce302a + p_xcce.xcce304a + p_xcce.xcce308a

   #期末结存成本-人工   = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902b  = p_xcce.xcce102b + p_xcce.xcce202b + p_xcce.xcce206b + p_xcce.xcce208b + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210b + p_xcce.xcce302b + p_xcce.xcce304b + p_xcce.xcce308b

   #期末结存成本-加工   = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902c  = p_xcce.xcce102c + p_xcce.xcce202c + p_xcce.xcce206c + p_xcce.xcce208c + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210c + p_xcce.xcce302c + p_xcce.xcce304c + p_xcce.xcce308c
             

   #期末结存成本-制费一 = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902d  = p_xcce.xcce102d + p_xcce.xcce202d + p_xcce.xcce206d + p_xcce.xcce208d + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210d + p_xcce.xcce302d + p_xcce.xcce304d + p_xcce.xcce308d
             
             
   #期末结存成本-制费二 = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902e  = p_xcce.xcce102e + p_xcce.xcce202e + p_xcce.xcce206e + p_xcce.xcce208e + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210e + p_xcce.xcce302e + p_xcce.xcce304e + p_xcce.xcce308e
             
                                                
   #期末结存成本-制费三 = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902f  = p_xcce.xcce102f + p_xcce.xcce202f + p_xcce.xcce206f + p_xcce.xcce208f + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210f + p_xcce.xcce302f + p_xcce.xcce304f + p_xcce.xcce308f
                                  

   #期末结存成本-制费四 = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902g  = p_xcce.xcce102g + p_xcce.xcce202g + p_xcce.xcce206g + p_xcce.xcce208g + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210g + p_xcce.xcce302g + p_xcce.xcce304g + p_xcce.xcce308g
             
                         
   #期末结存成本-制费五 = 上期结存        + 本期投入        + 当站下线        + 一般退料        
   LET p_xcce.xcce902h  = p_xcce.xcce102h + p_xcce.xcce202h + p_xcce.xcce206h + p_xcce.xcce208h + 
   #                    + 超领退          + 本期转出        + 差异转出        + 盘差
                          p_xcce.xcce210h + p_xcce.xcce302h + p_xcce.xcce304h + p_xcce.xcce308h
                                 

   #期末结存金额       = 材料            + 人工            + 加工            + 制费一          + 
   LET p_xcce.xcce902  = p_xcce.xcce902a + p_xcce.xcce902b + p_xcce.xcce902c + p_xcce.xcce902d
   #                     制费二          + 制费三          + 制费四          + 制费五
                       + p_xcce.xcce902e + p_xcce.xcce902f + p_xcce.xcce902g + p_xcce.xcce902h 
            

#   IF p_xcce.xcce901 = 0 AND (p_xcce.xcce902  <> 0 OR p_xcce.xcce902a <> 0 OR p_xcce.xcce902b <> 0 OR
#      p_xcce.xcce902c <> 0 OR p_xcce.xcce902d <> 0 OR p_xcce.xcce902e <> 0 OR p_xcce.xcce902f <> 0 OR
#      p_xcce.xcce902g <> 0 OR p_xcce.xcce902h <> 0 ) THEN
#      LET p_xcce.xcce304  = p_xcce.xcce304  + p_xcce.xcce902
#      LET p_xcce.xcce304a = p_xcce.xcce304a + p_xcce.xcce902a
#      LET p_xcce.xcce304b = p_xcce.xcce304b + p_xcce.xcce902b
#      LET p_xcce.xcce304c = p_xcce.xcce304c + p_xcce.xcce902c
#      LET p_xcce.xcce304d = p_xcce.xcce304d + p_xcce.xcce902d
#      LET p_xcce.xcce304e = p_xcce.xcce304e + p_xcce.xcce902e
#      LET p_xcce.xcce304f = p_xcce.xcce304f + p_xcce.xcce902f
#      LET p_xcce.xcce304g = p_xcce.xcce304g + p_xcce.xcce902g
#      LET p_xcce.xcce304h = p_xcce.xcce304h + p_xcce.xcce902h
#      
#      LET p_xcce.xcce902  = 0
#      LET p_xcce.xcce902a = 0
#      LET p_xcce.xcce902b = 0
#      LET p_xcce.xcce902c = 0
#      LET p_xcce.xcce902d = 0
#      LET p_xcce.xcce902e = 0
#      LET p_xcce.xcce902f = 0
#      LET p_xcce.xcce902g = 0
#      LET p_xcce.xcce902h = 0
#      
#   END IF
   
   LET r_xcce.* = p_xcce.*
   
   RETURN r_xcce.*
END FUNCTION

################################################################################
# Descriptions...: 对xcci_t中的资料做SUM/算平均单价等
# Memo...........:
# Usage..........: CALL s_axcp500_sum_xcci(p_xcci)
#                       RETURNING r_xcci.*
# Input parameter: p_xcci         xcci的资料
# Return code....: r_xcci         经过运算后的xcci资料
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_sum_xcci(p_xcci)
#   DEFINE p_xcci       RECORD LIKE xcci_t.*  #161124-00048#20 mark
#   DEFINE r_xcci       RECORD LIKE xcci_t.*  #161124-00048#20 mark
   DEFINE p_xcci        type_g_xcci  #170605-00013#1-add
   DEFINE r_xcci        type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_seq        LIKE xccc_t.xccc001
   
   WHENEVER ERROR CONTINUE

   LET l_seq = p_xcci.xcci001
   CALL s_axcp500_get_round_setting(p_xcci.xcci007)
   #上期结存
#  CALL s_num_round(g_unit_round_type,p_xcci.xcci101,g_unit_round_digit) RETURNING p_xcci.xcci101
   CALL s_num_round(g_round_type,p_xcci.xcci102 ,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102  #add 160902-00013#1 160902
   CALL s_num_round(g_round_type,p_xcci.xcci102a,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102a
   CALL s_num_round(g_round_type,p_xcci.xcci102b,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102b
   CALL s_num_round(g_round_type,p_xcci.xcci102c,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102c
   CALL s_num_round(g_round_type,p_xcci.xcci102d,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102d
   CALL s_num_round(g_round_type,p_xcci.xcci102e,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102e
   CALL s_num_round(g_round_type,p_xcci.xcci102f,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102f
   CALL s_num_round(g_round_type,p_xcci.xcci102g,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102g
   CALL s_num_round(g_round_type,p_xcci.xcci102h,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci102h

   #上期结存金额
   #mod 160902-00013#1 160902--s
   #LET p_xcci.xcci102  = p_xcci.xcci102a + p_xcci.xcci102b + p_xcci.xcci102c +
   #                      p_xcci.xcci102d + p_xcci.xcci102e + p_xcci.xcci102f +
   #                      p_xcci.xcci102g + p_xcci.xcci102h
   #CALL s_num_round(g_round_type,p_xcci.xcci102 ,g_curr[l_seq].digit2) RETURNING p_xcci.xcci102
   CASE
      WHEN p_xcci.xcci102a != 0
           LET p_xcci.xcci102a = p_xcci.xcci102 - (p_xcci.xcci102b + p_xcci.xcci102c +
                                 p_xcci.xcci102d + p_xcci.xcci102e + p_xcci.xcci102f +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102b != 0
           LET p_xcci.xcci102b = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102c +
                                 p_xcci.xcci102d + p_xcci.xcci102e + p_xcci.xcci102f +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102c != 0
           LET p_xcci.xcci102c = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102d + p_xcci.xcci102e + p_xcci.xcci102f +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102d != 0
           LET p_xcci.xcci102d = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102c + p_xcci.xcci102e + p_xcci.xcci102f +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102e != 0
           LET p_xcci.xcci102e = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102c + p_xcci.xcci102d + p_xcci.xcci102f +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102f != 0
           LET p_xcci.xcci102f = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102c + p_xcci.xcci102d + p_xcci.xcci102e +
                                 p_xcci.xcci102g + p_xcci.xcci102h)
      WHEN p_xcci.xcci102g != 0
           LET p_xcci.xcci102g = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102c + p_xcci.xcci102d + p_xcci.xcci102e +
                                 p_xcci.xcci102f + p_xcci.xcci102h)
      WHEN p_xcci.xcci102h != 0
           LET p_xcci.xcci102g = p_xcci.xcci102 - (p_xcci.xcci102a + p_xcci.xcci102b +
                                 p_xcci.xcci102c + p_xcci.xcci102d + p_xcci.xcci102e +
                                 p_xcci.xcci102f + p_xcci.xcci102g)
   END CASE
   #mod 160902-00013#1 160902--e


   #本期本阶投入
#  CALL s_num_round(g_unit_round_type,p_xcci.xcci201,g_unit_round_digit) RETURNING p_xcci.xcci201
   CALL s_num_round(g_round_type,p_xcci.xcci202 ,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202  #add 160902-00013#1 160902
   CALL s_num_round(g_round_type,p_xcci.xcci202a,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202a
   CALL s_num_round(g_round_type,p_xcci.xcci202b,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202b
   CALL s_num_round(g_round_type,p_xcci.xcci202c,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202c
   CALL s_num_round(g_round_type,p_xcci.xcci202d,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202d
   CALL s_num_round(g_round_type,p_xcci.xcci202e,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202e
   CALL s_num_round(g_round_type,p_xcci.xcci202f,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202f
   CALL s_num_round(g_round_type,p_xcci.xcci202g,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202g
   CALL s_num_round(g_round_type,p_xcci.xcci202h,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci202h

   #本期本阶投入金额
   #mod 160902-00013#1 160902--s
   #LET p_xcci.xcci202  = p_xcci.xcci202a + p_xcci.xcci202b + p_xcci.xcci202c +
   #                      p_xcci.xcci202d + p_xcci.xcci202e + p_xcci.xcci202f +
   #                      p_xcci.xcci202g + p_xcci.xcci202h
   #CALL s_num_round(g_round_type,p_xcci.xcci202 ,g_curr[l_seq].digit2) RETURNING p_xcci.xcci202
   #170113-00031#1---add---s
   #人工制费的金额要先相加
   IF p_xcci.xcci007 = 'DL+OH+SUB' THEN
      LET p_xcci.xcci202  = p_xcci.xcci202a + p_xcci.xcci202b + p_xcci.xcci202c +
                            p_xcci.xcci202d + p_xcci.xcci202e + p_xcci.xcci202f +
                            p_xcci.xcci202g + p_xcci.xcci202h
      CALL s_num_round(g_round_type,p_xcci.xcci202,g_curr[l_seq].digit2) RETURNING p_xcci.xcci202                            
   END IF
   #170113-00031#1---add---e   
   CASE
      WHEN p_xcci.xcci202a != 0
           LET p_xcci.xcci202a = p_xcci.xcci202 - (p_xcci.xcci202b + p_xcci.xcci202c +
                                 p_xcci.xcci202d + p_xcci.xcci202e + p_xcci.xcci202f +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202b != 0
           LET p_xcci.xcci202b = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202c +
                                 p_xcci.xcci202d + p_xcci.xcci202e + p_xcci.xcci202f +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202c != 0
           LET p_xcci.xcci202c = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202d + p_xcci.xcci202e + p_xcci.xcci202f +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202d != 0
           LET p_xcci.xcci202d = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202c + p_xcci.xcci202e + p_xcci.xcci202f +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202e != 0
           LET p_xcci.xcci202e = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202c + p_xcci.xcci202d + p_xcci.xcci202f +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202f != 0
           LET p_xcci.xcci202f = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202c + p_xcci.xcci202d + p_xcci.xcci202e +
                                 p_xcci.xcci202g + p_xcci.xcci202h)
      WHEN p_xcci.xcci202g != 0
           LET p_xcci.xcci202g = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202c + p_xcci.xcci202d + p_xcci.xcci202e +
                                 p_xcci.xcci202f + p_xcci.xcci202h)
      WHEN p_xcci.xcci202h != 0
           LET p_xcci.xcci202g = p_xcci.xcci202 - (p_xcci.xcci202a + p_xcci.xcci202b +
                                 p_xcci.xcci202c + p_xcci.xcci202d + p_xcci.xcci202e +
                                 p_xcci.xcci202f + p_xcci.xcci202g)
   END CASE
   #mod 160902-00013#1 160902--e

   #本期转出数量
   CALL s_num_round(g_unit_round_type,p_xcci.xcci301,g_unit_round_digit) RETURNING p_xcci.xcci301  #170502-00001#1 remark
   CALL s_num_round(g_round_type,p_xcci.xcci302 ,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302  #add 160902-00013#1 160902
   CALL s_num_round(g_round_type,p_xcci.xcci302a,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302a
   CALL s_num_round(g_round_type,p_xcci.xcci302b,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302b
   CALL s_num_round(g_round_type,p_xcci.xcci302c,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302c
   CALL s_num_round(g_round_type,p_xcci.xcci302d,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302d
   CALL s_num_round(g_round_type,p_xcci.xcci302e,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302e
   CALL s_num_round(g_round_type,p_xcci.xcci302f,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302f
   CALL s_num_round(g_round_type,p_xcci.xcci302g,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302g
   CALL s_num_round(g_round_type,p_xcci.xcci302h,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci302h

   #本期转出金额
   #190919-00050#1---mod---s
   ##mod 160902-00013#1 160902--s
   ##LET p_xcci.xcci302  = p_xcci.xcci302a + p_xcci.xcci302b + p_xcci.xcci302c +
   ##                      p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
   ##                      p_xcci.xcci302g + p_xcci.xcci302h
   ##CALL s_num_round(g_round_type,p_xcci.xcci302 ,g_curr[l_seq].digit2) RETURNING p_xcci.xcci302
   #CASE
   #   WHEN p_xcci.xcci302a != 0
   #        LET p_xcci.xcci302a = p_xcci.xcci302 - (p_xcci.xcci302b + p_xcci.xcci302c +
   #                              p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302b != 0
   #        LET p_xcci.xcci302b = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302c +
   #                              p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302c != 0
   #        LET p_xcci.xcci302c = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302d != 0
   #        LET p_xcci.xcci302d = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302c + p_xcci.xcci302e + p_xcci.xcci302f +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302e != 0
   #        LET p_xcci.xcci302e = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302f +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302f != 0
   #        LET p_xcci.xcci302f = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
   #                              p_xcci.xcci302g + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302g != 0
   #        LET p_xcci.xcci302g = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
   #                              p_xcci.xcci302f + p_xcci.xcci302h)
   #   WHEN p_xcci.xcci302h != 0
   #        LET p_xcci.xcci302g = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
   #                              p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
   #                              p_xcci.xcci302f + p_xcci.xcci302g)
   #END CASE
   ##mod 160902-00013#1 160902--e
   CASE
      WHEN p_xcci.xcci302a != 0 AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302b)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302c)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302d)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302e)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302f)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302a) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302a = p_xcci.xcci302 - (p_xcci.xcci302b + p_xcci.xcci302c +
                                 p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302b != 0 AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302c)
                                AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302d)
                                AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302e)
                                AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302f)
                                AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302b) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302b = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302c +
                                 p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302c != 0 AND s_math_abs(p_xcci.xcci302c) >= s_math_abs(p_xcci.xcci302d)
                                AND s_math_abs(p_xcci.xcci302c) >= s_math_abs(p_xcci.xcci302e)
                                AND s_math_abs(p_xcci.xcci302c) >= s_math_abs(p_xcci.xcci302f)
                                AND s_math_abs(p_xcci.xcci302c) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302c) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302c = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302d + p_xcci.xcci302e + p_xcci.xcci302f +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302d != 0 AND s_math_abs(p_xcci.xcci302d) >= s_math_abs(p_xcci.xcci302e)
                                AND s_math_abs(p_xcci.xcci302d) >= s_math_abs(p_xcci.xcci302f)
                                AND s_math_abs(p_xcci.xcci302d) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302d) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302d = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302c + p_xcci.xcci302e + p_xcci.xcci302f +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302e != 0 AND s_math_abs(p_xcci.xcci302e) >= s_math_abs(p_xcci.xcci302f)
                                AND s_math_abs(p_xcci.xcci302e) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302e) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302e = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302f +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302f != 0 AND s_math_abs(p_xcci.xcci302f) >= s_math_abs(p_xcci.xcci302g)
                                AND s_math_abs(p_xcci.xcci302f) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302f = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
                                 p_xcci.xcci302g + p_xcci.xcci302h)
      WHEN p_xcci.xcci302g != 0 AND s_math_abs(p_xcci.xcci302g) >= s_math_abs(p_xcci.xcci302h)
           LET p_xcci.xcci302g = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
                                 p_xcci.xcci302f + p_xcci.xcci302h)
      WHEN p_xcci.xcci302h != 0
           LET p_xcci.xcci302g = p_xcci.xcci302 - (p_xcci.xcci302a + p_xcci.xcci302b +
                                 p_xcci.xcci302c + p_xcci.xcci302d + p_xcci.xcci302e +
                                 p_xcci.xcci302f + p_xcci.xcci302g)
   END CASE   
   #190919-00050#1---mod---e

   #差异转出数量
#  CALL s_num_round(g_unit_round_type,p_xcci.xcci303,g_unit_round_digit) RETURNING p_xcci.xcci303
   CALL s_num_round(g_round_type,p_xcci.xcci304 ,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304  #add 160902-00013#1 160902
   CALL s_num_round(g_round_type,p_xcci.xcci304a,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304a
   CALL s_num_round(g_round_type,p_xcci.xcci304b,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304b
   CALL s_num_round(g_round_type,p_xcci.xcci304c,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304c
   CALL s_num_round(g_round_type,p_xcci.xcci304d,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304d
   CALL s_num_round(g_round_type,p_xcci.xcci304e,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304e
   CALL s_num_round(g_round_type,p_xcci.xcci304f,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304f
   CALL s_num_round(g_round_type,p_xcci.xcci304g,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304g
   CALL s_num_round(g_round_type,p_xcci.xcci304h,g_curr[l_seq].digit2)   RETURNING p_xcci.xcci304h

   #差异转出金额
   #mod 160902-00013#1 160902--s
   #LET p_xcci.xcci304  = p_xcci.xcci304a + p_xcci.xcci304b + p_xcci.xcci304c +
   #                      p_xcci.xcci304d + p_xcci.xcci304e + p_xcci.xcci304f +
   #                      p_xcci.xcci304g + p_xcci.xcci304h
   #CALL s_num_round(g_round_type,p_xcci.xcci304 ,g_curr[l_seq].digit2) RETURNING p_xcci.xcci304
   CASE
      WHEN p_xcci.xcci304a != 0
           LET p_xcci.xcci304a = p_xcci.xcci304 - (p_xcci.xcci304b + p_xcci.xcci304c +
                                 p_xcci.xcci304d + p_xcci.xcci304e + p_xcci.xcci304f +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304b != 0
           LET p_xcci.xcci304b = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304c +
                                 p_xcci.xcci304d + p_xcci.xcci304e + p_xcci.xcci304f +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304c != 0
           LET p_xcci.xcci304c = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304d + p_xcci.xcci304e + p_xcci.xcci304f +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304d != 0
           LET p_xcci.xcci304d = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304c + p_xcci.xcci304e + p_xcci.xcci304f +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304e != 0
           LET p_xcci.xcci304e = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304c + p_xcci.xcci304d + p_xcci.xcci304f +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304f != 0
           LET p_xcci.xcci304f = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304c + p_xcci.xcci304d + p_xcci.xcci304e +
                                 p_xcci.xcci304g + p_xcci.xcci304h)
      WHEN p_xcci.xcci304g != 0
           LET p_xcci.xcci304g = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304c + p_xcci.xcci304d + p_xcci.xcci304e +
                                 p_xcci.xcci304f + p_xcci.xcci304h)
      WHEN p_xcci.xcci304h != 0
           LET p_xcci.xcci304g = p_xcci.xcci304 - (p_xcci.xcci304a + p_xcci.xcci304b +
                                 p_xcci.xcci304c + p_xcci.xcci304d + p_xcci.xcci304e +
                                 p_xcci.xcci304f + p_xcci.xcci304g)
   END CASE
   #mod 160902-00013#1 160902--e
   
   
   #期末结存数量        = 上期结存        + 本期投入       + 本期转出       
   LET p_xcci.xcci901  = p_xcci.xcci101 + p_xcci.xcci201 + p_xcci.xcci301 + 
   #                     + 差异转出       
                         p_xcci.xcci303 
             
                         
   #期末结存数量-材料    = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902a  = p_xcci.xcci102a + p_xcci.xcci202a + p_xcci.xcci302a + 
   #                     + 差异转出       
                         p_xcci.xcci304a 

   #期末结存数量-人工    = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902b  = p_xcci.xcci102b + p_xcci.xcci202b + p_xcci.xcci302b + 
   #                     + 差异转出        
                         p_xcci.xcci304b 

   #期末结存数量-加工    = 上期结存        + 本期投入          + 本期转出       
   LET p_xcci.xcci902c  = p_xcci.xcci102c + p_xcci.xcci202c + p_xcci.xcci302c + 
   #                     + 差异转出       
                         p_xcci.xcci304c

   #期末结存数量-制费一  = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902d  = p_xcci.xcci102d + p_xcci.xcci202d + p_xcci.xcci302d + 
   #                     + 差异转出        
                         p_xcci.xcci304d 
                         
   #期末结存数量-制费二  = 上期结存        + 本期投入        + 本期转出       
   LET p_xcci.xcci902e  = p_xcci.xcci102e + p_xcci.xcci202e + p_xcci.xcci302e + 
   #                     + 差异转出       
                         p_xcci.xcci304e
                                                
   #期末结存数量-制费三  = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902f  = p_xcci.xcci102f + p_xcci.xcci202f + p_xcci.xcci302f + 
   #                     + 差异转出        
                         p_xcci.xcci304f                        

   #期末结存数量-制费四  = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902g  = p_xcci.xcci102g + p_xcci.xcci202g + p_xcci.xcci302g + 
   #                     + 差异转出        
                         p_xcci.xcci304g 
                         
   #期末结存数量-制费五  = 上期结存         + 本期投入         + 本期转出       
   LET p_xcci.xcci902h  = p_xcci.xcci102h + p_xcci.xcci202h + p_xcci.xcci302h + 
   #                     + 差异转出        
                         p_xcci.xcci304h 
                         
   #期末结存金额        = 材料            + 人工             + 加工
   LET p_xcci.xcci902  = p_xcci.xcci902a + p_xcci.xcci902b + p_xcci.xcci902c +
   #                     制费一          + 制费二           + 制费三
                         p_xcci.xcci902d + p_xcci.xcci902e + p_xcci.xcci902f +
   #                     制费四           + 制费五
                         p_xcci.xcci902g + p_xcci.xcci902h   
   
   LET r_xcci.* = p_xcci.*
   
   RETURN r_xcci.*
END FUNCTION

################################################################################
# Descriptions...: 对xccz_t中的资料做SUM/算平均单价等
# Memo...........:
# Usage..........: CALL s_axcp500_sum_xccz(p_xccz)
#                       RETURNING r_xccz.*
# Input parameter: p_xccz         xccz的资料
# Return code....: r_xccz         经过运算后的xccz资料
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_sum_xccz(p_xccz)
#   DEFINE p_xccz       RECORD LIKE xccz_t.*  #161124-00048#20 mark
#   DEFINE r_xccz       RECORD LIKE xccz_t.*  #161124-00048#20 mark
   DEFINE p_xccz           type_g_xccz  #170605-00013#1-add
   DEFINE r_xccz           type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE r_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_seq        LIKE xccc_t.xccc001
   
   WHENEVER ERROR CONTINUE

   LET l_seq = p_xccz.xccz001
   CALL s_axcp500_get_round_setting(p_xccz.xccz007)
   #上期结存
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz101,g_unit_round_digit) RETURNING p_xccz.xccz101

   #本期本阶投入
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz201,g_unit_round_digit) RETURNING p_xccz.xccz201

   #本期当站下线
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz205,g_unit_round_digit) RETURNING p_xccz.xccz205

   #本期一般退料
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz207,g_unit_round_digit) RETURNING p_xccz.xccz207

   #本期超領退數量
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz209,g_unit_round_digit) RETURNING p_xccz.xccz209

   #本期转出数量
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz301,g_unit_round_digit) RETURNING p_xccz.xccz301

   #差异转出数量
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz303,g_unit_round_digit) RETURNING p_xccz.xccz303

   #盤差數量
#  CALL s_num_round(g_unit_round_type,p_xccz.xccz307,g_unit_round_digit) RETURNING p_xccz.xccz307
   
   #期末结存数量       = 上期结存       + 本期投入       + 本期当站下线   + 本期一般退料    +   
   LET p_xccz.xccz901  = p_xccz.xccz101 + p_xccz.xccz201 + p_xccz.xccz205 + p_xccz.xccz207 + 
   #                     本期超领       + 本期转出       + 差异转出       +  盘差数量
                         p_xccz.xccz209 + p_xccz.xccz301 + p_xccz.xccz303 +  p_xccz.xccz307
             
   LET r_xccz.* = p_xccz.*
   
   RETURN r_xccz.*
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccq_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccq(p_xccq)
#                       RETURNING r_success
# Input parameter: p_xccq         xccq_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccq(p_xccq)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xccq          RECORD LIKE xccq_t.*  #161124-00048#20 mark
   DEFINE p_xccq           type_g_xccq  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccq RECORD  #料件庫存成本期異動明細統計檔
   #    xccqent LIKE xccq_t.xccqent, #企业编号
   #    xccqcomp LIKE xccq_t.xccqcomp, #法人组织
   #    xccqld LIKE xccq_t.xccqld, #账套
   #    xccqsite LIKE xccq_t.xccqsite, #营运组织
   #    xccq001 LIKE xccq_t.xccq001, #账套本位币顺序
   #    xccq002 LIKE xccq_t.xccq002, #成本域
   #    xccq003 LIKE xccq_t.xccq003, #成本计算类型
   #    xccq004 LIKE xccq_t.xccq004, #年度
   #    xccq005 LIKE xccq_t.xccq005, #期别
   #    xccq006 LIKE xccq_t.xccq006, #料号
   #    xccq007 LIKE xccq_t.xccq007, #特性码
   #    xccq008 LIKE xccq_t.xccq008, #批号
   #    xccq009 LIKE xccq_t.xccq009, #库存管理特征
   #    xccq010 LIKE xccq_t.xccq010, #仓库
   #    xccq011 LIKE xccq_t.xccq011, #储位
   #    xccq012 LIKE xccq_t.xccq012, #品类
   #    xccq101 LIKE xccq_t.xccq101, #上期结存数量
   #    xccq102 LIKE xccq_t.xccq102, #上期结存金额
   #    xccq102a LIKE xccq_t.xccq102a, #上期结存金额-材料
   #    xccq102b LIKE xccq_t.xccq102b, #上期结存金额-人工
   #    xccq102c LIKE xccq_t.xccq102c, #上期结存金额-加工
   #    xccq102d LIKE xccq_t.xccq102d, #上期结存金额-制费一
   #    xccq102e LIKE xccq_t.xccq102e, #上期结存金额-制费二
   #    xccq102f LIKE xccq_t.xccq102f, #上期结存金额-制费三
   #    xccq102g LIKE xccq_t.xccq102g, #上期结存金额-制费四
   #    xccq102h LIKE xccq_t.xccq102h, #上期结存金额-制费五
   #    xccq201 LIKE xccq_t.xccq201, #本期采购入库数量
   #    xccq202 LIKE xccq_t.xccq202, #本期采购入库金额
   #    xccq202a LIKE xccq_t.xccq202a, #本期采购入库金额-材料
   #    xccq202b LIKE xccq_t.xccq202b, #本期采购入库金额-人工
   #    xccq202c LIKE xccq_t.xccq202c, #本期采购入库金额-加工
   #    xccq202d LIKE xccq_t.xccq202d, #本期采购入库金额-制费一
   #    xccq202e LIKE xccq_t.xccq202e, #本期采购入库金额-制费二
   #    xccq202f LIKE xccq_t.xccq202f, #本期采购入库金额-制费三
   #    xccq202g LIKE xccq_t.xccq202g, #本期采购入库金额-制费四
   #    xccq202h LIKE xccq_t.xccq202h, #本期采购入库金额-制费五
   #    xccq203 LIKE xccq_t.xccq203, #本期委外入库数量
   #    xccq204 LIKE xccq_t.xccq204, #本期委外入库金额
   #    xccq204a LIKE xccq_t.xccq204a, #本期委外入库金额-材料
   #    xccq204b LIKE xccq_t.xccq204b, #本期委外入库金额-人工
   #    xccq204c LIKE xccq_t.xccq204c, #本期委外入库金额-加工
   #    xccq204d LIKE xccq_t.xccq204d, #本期委外入库金额-制费一
   #    xccq204e LIKE xccq_t.xccq204e, #本期委外入库金额-制费二
   #    xccq204f LIKE xccq_t.xccq204f, #本期委外入库金额-制费三
   #    xccq204g LIKE xccq_t.xccq204g, #本期委外入库金额-制费四
   #    xccq204h LIKE xccq_t.xccq204h, #本期委外入库金额-制费五
   #    xccq205 LIKE xccq_t.xccq205, #本期工单入库数量
   #    xccq206 LIKE xccq_t.xccq206, #本期工单入库金额
   #    xccq206a LIKE xccq_t.xccq206a, #本期工单入库金额-材料
   #    xccq206b LIKE xccq_t.xccq206b, #本期工单入库金额-人工
   #    xccq206c LIKE xccq_t.xccq206c, #本期工单入库金额-加工
   #    xccq206d LIKE xccq_t.xccq206d, #本期工单入库金额-制费一
   #    xccq206e LIKE xccq_t.xccq206e, #本期工单入库金额-制费二
   #    xccq206f LIKE xccq_t.xccq206f, #本期工单入库金额-制费三
   #    xccq206g LIKE xccq_t.xccq206g, #本期工单入库金额-制费四
   #    xccq206h LIKE xccq_t.xccq206h, #本期工单入库金额-制费五
   #    xccq207 LIKE xccq_t.xccq207, #本期返工领出数量
   #    xccq208 LIKE xccq_t.xccq208, #本期返工领出金额
   #    xccq208a LIKE xccq_t.xccq208a, #本期返工领出金额-材料
   #    xccq208b LIKE xccq_t.xccq208b, #本期返工领出金额-人工
   #    xccq208c LIKE xccq_t.xccq208c, #本期返工领出金额-加工
   #    xccq208d LIKE xccq_t.xccq208d, #本期返工领出金额-制费一
   #    xccq208e LIKE xccq_t.xccq208e, #本期返工领出金额-制费二
   #    xccq208f LIKE xccq_t.xccq208f, #本期返工领出金额-制费三
   #    xccq208g LIKE xccq_t.xccq208g, #本期返工领出金额-制费四
   #    xccq208h LIKE xccq_t.xccq208h, #本期返工领出金额-制费五
   #    xccq209 LIKE xccq_t.xccq209, #本期返工入库数量
   #    xccq210 LIKE xccq_t.xccq210, #本期返工入库金额
   #    xccq210a LIKE xccq_t.xccq210a, #本期返工入库金额-材料
   #    xccq210b LIKE xccq_t.xccq210b, #本期返工入库金额-人工
   #    xccq210c LIKE xccq_t.xccq210c, #本期返工入库金额-加工
   #    xccq210d LIKE xccq_t.xccq210d, #本期返工入库金额-制费一
   #    xccq210e LIKE xccq_t.xccq210e, #本期返工入库金额-制费二
   #    xccq210f LIKE xccq_t.xccq210f, #本期返工入库金额-制费三
   #    xccq210g LIKE xccq_t.xccq210g, #本期返工入库金额-制费四
   #    xccq210h LIKE xccq_t.xccq210h, #本期返工入库金额-制费五
   #    xccq211 LIKE xccq_t.xccq211, #本期杂项入库数量
   #    xccq212 LIKE xccq_t.xccq212, #本期杂项入库金额
   #    xccq212a LIKE xccq_t.xccq212a, #本期杂项入库金额-材料
   #    xccq212b LIKE xccq_t.xccq212b, #本期杂项入库金额-人工
   #    xccq212c LIKE xccq_t.xccq212c, #本期杂项入库金额-加工
   #    xccq212d LIKE xccq_t.xccq212d, #本期杂项入库金额-制费一
   #    xccq212e LIKE xccq_t.xccq212e, #本期杂项入库金额-制费二
   #    xccq212f LIKE xccq_t.xccq212f, #本期杂项入库金额-制费三
   #    xccq212g LIKE xccq_t.xccq212g, #本期杂项入库金额-制费四
   #    xccq212h LIKE xccq_t.xccq212h, #本期杂项入库金额-制费五
   #    xccq213 LIKE xccq_t.xccq213, #本期调整入库数量
   #    xccq214 LIKE xccq_t.xccq214, #本期调整入库金额
   #    xccq214a LIKE xccq_t.xccq214a, #本期调整入库金额-材料
   #    xccq214b LIKE xccq_t.xccq214b, #本期调整入库金额-人工
   #    xccq214c LIKE xccq_t.xccq214c, #本期调整入库金额-加工
   #    xccq214d LIKE xccq_t.xccq214d, #本期调整入库金额-制费一
   #    xccq214e LIKE xccq_t.xccq214e, #本期调整入库金额-制费二
   #    xccq214f LIKE xccq_t.xccq214f, #本期调整入库金额-制费三
   #    xccq214g LIKE xccq_t.xccq214g, #本期调整入库金额-制费四
   #    xccq214h LIKE xccq_t.xccq214h, #本期调整入库金额-制费五
   #    xccq215 LIKE xccq_t.xccq215, #本期销退入库数量
   #    xccq216 LIKE xccq_t.xccq216, #本期销退入库金额
   #    xccq216a LIKE xccq_t.xccq216a, #本期销退入库金额-材料
   #    xccq216b LIKE xccq_t.xccq216b, #本期销退入库金额-人工
   #    xccq216c LIKE xccq_t.xccq216c, #本期销退入库金额-加工
   #    xccq216d LIKE xccq_t.xccq216d, #本期销退入库金额-制费一
   #    xccq216e LIKE xccq_t.xccq216e, #本期销退入库金额-制费二
   #    xccq216f LIKE xccq_t.xccq216f, #本期销退入库金额-制费三
   #    xccq216g LIKE xccq_t.xccq216g, #本期销退入库金额-制费四
   #    xccq216h LIKE xccq_t.xccq216h, #本期销退入库金额-制费五
   #    xccq217 LIKE xccq_t.xccq217, #本期调拨入库数量
   #    xccq218 LIKE xccq_t.xccq218, #本期调拨入库金额
   #    xccq218a LIKE xccq_t.xccq218a, #本期调拨入库金额-材料
   #    xccq218b LIKE xccq_t.xccq218b, #本期调拨入库金额-人工
   #    xccq218c LIKE xccq_t.xccq218c, #本期调拨入库金额-加工
   #    xccq218d LIKE xccq_t.xccq218d, #本期调拨入库金额-制费一
   #    xccq218e LIKE xccq_t.xccq218e, #本期调拨入库金额-制费二
   #    xccq218f LIKE xccq_t.xccq218f, #本期调拨入库金额-制费三
   #    xccq218g LIKE xccq_t.xccq218g, #本期调拨入库金额-制费四
   #    xccq218h LIKE xccq_t.xccq218h, #本期调拨入库金额-制费五
   #    xccq280 LIKE xccq_t.xccq280, #本期平均单价
   #    xccq280a LIKE xccq_t.xccq280a, #本期平均单价-材料
   #    xccq280b LIKE xccq_t.xccq280b, #本期平均单价-人工
   #    xccq280c LIKE xccq_t.xccq280c, #本期平均单价-加工
   #    xccq280d LIKE xccq_t.xccq280d, #本期平均单价-制费一
   #    xccq280e LIKE xccq_t.xccq280e, #本期平均单价-制费二
   #    xccq280f LIKE xccq_t.xccq280f, #本期平均单价-制费三
   #    xccq280g LIKE xccq_t.xccq280g, #本期平均单价-制费四
   #    xccq280h LIKE xccq_t.xccq280h, #本期平均单价-制费五
   #    xccq301 LIKE xccq_t.xccq301, #本期工单领用数量
   #    xccq302 LIKE xccq_t.xccq302, #本期工单领用金额
   #    xccq302a LIKE xccq_t.xccq302a, #本期工单领用金额-材料
   #    xccq302b LIKE xccq_t.xccq302b, #本期工单领用金额-人工
   #    xccq302c LIKE xccq_t.xccq302c, #本期工单领用金额-加工
   #    xccq302d LIKE xccq_t.xccq302d, #本期工单领用金额-制费一
   #    xccq302e LIKE xccq_t.xccq302e, #本期工单领用金额-制费二
   #    xccq302f LIKE xccq_t.xccq302f, #本期工单领用金额-制费三
   #    xccq302g LIKE xccq_t.xccq302g, #本期工单领用金额-制费四
   #    xccq302h LIKE xccq_t.xccq302h, #本期工单领用金额-制费五
   #    xccq303 LIKE xccq_t.xccq303, #本期销货数量
   #    xccq304 LIKE xccq_t.xccq304, #本期销货成本
   #    xccq304a LIKE xccq_t.xccq304a, #本期销货成本-材料
   #    xccq304b LIKE xccq_t.xccq304b, #本期销货成本-人工
   #    xccq304c LIKE xccq_t.xccq304c, #本期销货成本-加工
   #    xccq304d LIKE xccq_t.xccq304d, #本期销货成本-制费一
   #    xccq304e LIKE xccq_t.xccq304e, #本期销货成本-制费二
   #    xccq304f LIKE xccq_t.xccq304f, #本期销货成本-制费三
   #    xccq304g LIKE xccq_t.xccq304g, #本期销货成本-制费四
   #    xccq304h LIKE xccq_t.xccq304h, #本期销货成本-制费五
   #    xccq305 LIKE xccq_t.xccq305, #本期销退数量
   #    xccq306 LIKE xccq_t.xccq306, #本期销退成本
   #    xccq306a LIKE xccq_t.xccq306a, #本期销退成本-材料
   #    xccq306b LIKE xccq_t.xccq306b, #本期销退成本-人工
   #    xccq306c LIKE xccq_t.xccq306c, #本期销退成本-加工
   #    xccq306d LIKE xccq_t.xccq306d, #本期销退成本-制费一
   #    xccq306e LIKE xccq_t.xccq306e, #本期销退成本-制费二
   #    xccq306f LIKE xccq_t.xccq306f, #本期销退成本-制费三
   #    xccq306g LIKE xccq_t.xccq306g, #本期销退成本-制费四
   #    xccq306h LIKE xccq_t.xccq306h, #本期销退成本-制费五
   #    xccq307 LIKE xccq_t.xccq307, #本期销售费用数量
   #    xccq308 LIKE xccq_t.xccq308, #本期销售费用成本
   #    xccq308a LIKE xccq_t.xccq308a, #本期销售费用成本-材料
   #    xccq308b LIKE xccq_t.xccq308b, #本期销售费用成本-人工
   #    xccq308c LIKE xccq_t.xccq308c, #本期销售费用成本-加工
   #    xccq308d LIKE xccq_t.xccq308d, #本期销售费用成本-制费一
   #    xccq308e LIKE xccq_t.xccq308e, #本期销售费用成本-制费二
   #    xccq308f LIKE xccq_t.xccq308f, #本期销售费用成本-制费三
   #    xccq308g LIKE xccq_t.xccq308g, #本期销售费用成本-制费四
   #    xccq308h LIKE xccq_t.xccq308h, #本期销售费用成本-制费五
   #    xccq309 LIKE xccq_t.xccq309, #本期杂发数量
   #    xccq310 LIKE xccq_t.xccq310, #本期杂发金额
   #    xccq310a LIKE xccq_t.xccq310a, #本期杂发金额-材料
   #    xccq310b LIKE xccq_t.xccq310b, #本期杂发金额-人工
   #    xccq310c LIKE xccq_t.xccq310c, #本期杂发金额-加工
   #    xccq310d LIKE xccq_t.xccq310d, #本期杂发金额-制费一
   #    xccq310e LIKE xccq_t.xccq310e, #本期杂发金额-制费二
   #    xccq310f LIKE xccq_t.xccq310f, #本期杂发金额-制费三
   #    xccq310g LIKE xccq_t.xccq310g, #本期杂发金额-制费四
   #    xccq310h LIKE xccq_t.xccq310h, #本期杂发金额-制费五
   #    xccq311 LIKE xccq_t.xccq311, #本期盘盈亏数量
   #    xccq312 LIKE xccq_t.xccq312, #本期盘盈亏金额
   #    xccq312a LIKE xccq_t.xccq312a, #本期盘盈亏金额-材料
   #    xccq312b LIKE xccq_t.xccq312b, #本期盘盈亏金额-人工
   #    xccq312c LIKE xccq_t.xccq312c, #本期盘盈亏金额-加工
   #    xccq312d LIKE xccq_t.xccq312d, #本期盘盈亏金额-制费一
   #    xccq312e LIKE xccq_t.xccq312e, #本期盘盈亏金额-制费二
   #    xccq312f LIKE xccq_t.xccq312f, #本期盘盈亏金额-制费三
   #    xccq312g LIKE xccq_t.xccq312g, #本期盘盈亏金额-制费四
   #    xccq312h LIKE xccq_t.xccq312h, #本期盘盈亏金额-制费五
   #    xccq313 LIKE xccq_t.xccq313, #本期调拨出库数量
   #    xccq314 LIKE xccq_t.xccq314, #本期调拨出库金额
   #    xccq314a LIKE xccq_t.xccq314a, #本期调拨出库金额-材料
   #    xccq314b LIKE xccq_t.xccq314b, #本期调拨出库金额-人工
   #    xccq314c LIKE xccq_t.xccq314c, #本期调拨出库金额-加工
   #    xccq314d LIKE xccq_t.xccq314d, #本期调拨出库金额-制费一
   #    xccq314e LIKE xccq_t.xccq314e, #本期调拨出库金额-制费二
   #    xccq314f LIKE xccq_t.xccq314f, #本期调拨出库金额-制费三
   #    xccq314g LIKE xccq_t.xccq314g, #本期调拨出库金额-制费四
   #    xccq314h LIKE xccq_t.xccq314h, #本期调拨出库金额-制费五
   #    xccq401 LIKE xccq_t.xccq401, #本期销货收入金额
   #    xccq402 LIKE xccq_t.xccq402, #本期销退金额
   #    xccq901 LIKE xccq_t.xccq901, #期末结存数量
   #    xccq902 LIKE xccq_t.xccq902, #期末结存金额
   #    xccq902a LIKE xccq_t.xccq902a, #期末结存金额-材料
   #    xccq902b LIKE xccq_t.xccq902b, #期末结存金额-人工
   #    xccq902c LIKE xccq_t.xccq902c, #期末结存金额-加工
   #    xccq902d LIKE xccq_t.xccq902d, #期末结存金额-制费一
   #    xccq902e LIKE xccq_t.xccq902e, #期末结存金额-制费二
   #    xccq902f LIKE xccq_t.xccq902f, #期末结存金额-制费三
   #    xccq902g LIKE xccq_t.xccq902g, #期末结存金额-制费四
   #    xccq902h LIKE xccq_t.xccq902h, #期末结存金额-制费五
   #    xccq903 LIKE xccq_t.xccq903, #期末结存调整金额
   #    xccq903a LIKE xccq_t.xccq903a, #期末结存调整金额-材料
   #    xccq903b LIKE xccq_t.xccq903b, #期末结存调整金额-人工
   #    xccq903c LIKE xccq_t.xccq903c, #期末结存调整金额-加工
   #    xccq903d LIKE xccq_t.xccq903d, #期末结存调整金额-制费一
   #    xccq903e LIKE xccq_t.xccq903e, #期末结存调整金额-制费二
   #    xccq903f LIKE xccq_t.xccq903f, #期末结存调整金额-制费三
   #    xccq903g LIKE xccq_t.xccq903g, #期末结存调整金额-制费四
   #    xccq903h LIKE xccq_t.xccq903h, #期末结存调整金额-制费五
   #    xccqtime LIKE xccq_t.xccqtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   CALL s_axcp500_set_xccq_null_to_zero(p_xccq.*)
        RETURNING p_xccq.*

#   INSERT INTO xccq_tmp VALUES(p_xccq.*) #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccq_tmp(xccqent,xccqcomp,xccqld,xccqsite,xccq001,xccq002,xccq003,xccq004,xccq005,
                        xccq006,xccq007,xccq008,xccq009,xccq010,xccq011,xccq012,xccq101,xccq102,
                        xccq102a,xccq102b,xccq102c,xccq102d,xccq102e,xccq102f,xccq102g,xccq102h,
                        xccq201,xccq202,xccq202a,xccq202b,xccq202c,xccq202d,xccq202e,xccq202f,
                        xccq202g,xccq202h,xccq203,xccq204,xccq204a,xccq204b,xccq204c,xccq204d,
                        xccq204e,xccq204f,xccq204g,xccq204h,xccq205,xccq206,xccq206a,xccq206b,
                        xccq206c,xccq206d,xccq206e,xccq206f,xccq206g,xccq206h,xccq207,xccq208,
                        xccq208a,xccq208b,xccq208c,xccq208d,xccq208e,xccq208f,xccq208g,xccq208h,
                        xccq209,xccq210,xccq210a,xccq210b,xccq210c,xccq210d,xccq210e,xccq210f,
                        xccq210g,xccq210h,xccq211,xccq212,xccq212a,xccq212b,xccq212c,xccq212d,
                        xccq212e,xccq212f,xccq212g,xccq212h,xccq213,xccq214,xccq214a,xccq214b,
                        xccq214c,xccq214d,xccq214e,xccq214f,xccq214g,xccq214h,xccq215,xccq216,
                        xccq216a,xccq216b,xccq216c,xccq216d,xccq216e,xccq216f,xccq216g,xccq216h,
                        xccq217,xccq218,xccq218a,xccq218b,xccq218c,xccq218d,xccq218e,xccq218f,
                        xccq218g,xccq218h,xccq280,xccq280a,xccq280b,xccq280c,xccq280d,xccq280e,
                        xccq280f,xccq280g,xccq280h,xccq301,xccq302,xccq302a,xccq302b,xccq302c,
                        xccq302d,xccq302e,xccq302f,xccq302g,xccq302h,xccq303,xccq304,xccq304a,
                        xccq304b,xccq304c,xccq304d,xccq304e,xccq304f,xccq304g,xccq304h,xccq305,
                        xccq306,xccq306a,xccq306b,xccq306c,xccq306d,xccq306e,xccq306f,xccq306g,
                        xccq306h,xccq307,xccq308,xccq308a,xccq308b,xccq308c,xccq308d,xccq308e,
                        xccq308f,xccq308g,xccq308h,xccq309,xccq310,xccq310a,xccq310b,xccq310c,
                        xccq310d,xccq310e,xccq310f,xccq310g,xccq310h,xccq311,xccq312,xccq312a,
                        xccq312b,xccq312c,xccq312d,xccq312e,xccq312f,xccq312g,xccq312h,xccq313,
                        xccq314,xccq314a,xccq314b,xccq314c,xccq314d,xccq314e,xccq314f,xccq314g,
                        xccq314h,xccq401,xccq402,xccq901,xccq902,xccq902a,xccq902b,xccq902c,
                        xccq902d,xccq902e,xccq902f,xccq902g,xccq902h,xccq903,xccq903a,xccq903b,
                        xccq903c,xccq903d,xccq903e,xccq903f,xccq903g,xccq903h,xccqtime) 
                 VALUES(p_xccq.xccqent,p_xccq.xccqcomp,p_xccq.xccqld,p_xccq.xccqsite,p_xccq.xccq001,p_xccq.xccq002,p_xccq.xccq003,p_xccq.xccq004,p_xccq.xccq005,
                        p_xccq.xccq006,p_xccq.xccq007,p_xccq.xccq008,p_xccq.xccq009,p_xccq.xccq010,p_xccq.xccq011,p_xccq.xccq012,p_xccq.xccq101,p_xccq.xccq102,
                        p_xccq.xccq102a,p_xccq.xccq102b,p_xccq.xccq102c,p_xccq.xccq102d,p_xccq.xccq102e,p_xccq.xccq102f,p_xccq.xccq102g,p_xccq.xccq102h,
                        p_xccq.xccq201,p_xccq.xccq202,p_xccq.xccq202a,p_xccq.xccq202b,p_xccq.xccq202c,p_xccq.xccq202d,p_xccq.xccq202e,p_xccq.xccq202f,
                        p_xccq.xccq202g,p_xccq.xccq202h,p_xccq.xccq203,p_xccq.xccq204,p_xccq.xccq204a,p_xccq.xccq204b,p_xccq.xccq204c,p_xccq.xccq204d,
                        p_xccq.xccq204e,p_xccq.xccq204f,p_xccq.xccq204g,p_xccq.xccq204h,p_xccq.xccq205,p_xccq.xccq206,p_xccq.xccq206a,p_xccq.xccq206b,
                        p_xccq.xccq206c,p_xccq.xccq206d,p_xccq.xccq206e,p_xccq.xccq206f,p_xccq.xccq206g,p_xccq.xccq206h,p_xccq.xccq207,p_xccq.xccq208,
                        p_xccq.xccq208a,p_xccq.xccq208b,p_xccq.xccq208c,p_xccq.xccq208d,p_xccq.xccq208e,p_xccq.xccq208f,p_xccq.xccq208g,p_xccq.xccq208h,
                        p_xccq.xccq209,p_xccq.xccq210,p_xccq.xccq210a,p_xccq.xccq210b,p_xccq.xccq210c,p_xccq.xccq210d,p_xccq.xccq210e,p_xccq.xccq210f,
                        p_xccq.xccq210g,p_xccq.xccq210h,p_xccq.xccq211,p_xccq.xccq212,p_xccq.xccq212a,p_xccq.xccq212b,p_xccq.xccq212c,p_xccq.xccq212d,
                        p_xccq.xccq212e,p_xccq.xccq212f,p_xccq.xccq212g,p_xccq.xccq212h,p_xccq.xccq213,p_xccq.xccq214,p_xccq.xccq214a,p_xccq.xccq214b,
                        p_xccq.xccq214c,p_xccq.xccq214d,p_xccq.xccq214e,p_xccq.xccq214f,p_xccq.xccq214g,p_xccq.xccq214h,p_xccq.xccq215,p_xccq.xccq216,
                        p_xccq.xccq216a,p_xccq.xccq216b,p_xccq.xccq216c,p_xccq.xccq216d,p_xccq.xccq216e,p_xccq.xccq216f,p_xccq.xccq216g,p_xccq.xccq216h,
                        p_xccq.xccq217,p_xccq.xccq218,p_xccq.xccq218a,p_xccq.xccq218b,p_xccq.xccq218c,p_xccq.xccq218d,p_xccq.xccq218e,p_xccq.xccq218f,
                        p_xccq.xccq218g,p_xccq.xccq218h,p_xccq.xccq280,p_xccq.xccq280a,p_xccq.xccq280b,p_xccq.xccq280c,p_xccq.xccq280d,p_xccq.xccq280e,
                        p_xccq.xccq280f,p_xccq.xccq280g,p_xccq.xccq280h,p_xccq.xccq301,p_xccq.xccq302,p_xccq.xccq302a,p_xccq.xccq302b,p_xccq.xccq302c,
                        p_xccq.xccq302d,p_xccq.xccq302e,p_xccq.xccq302f,p_xccq.xccq302g,p_xccq.xccq302h,p_xccq.xccq303,p_xccq.xccq304,p_xccq.xccq304a,
                        p_xccq.xccq304b,p_xccq.xccq304c,p_xccq.xccq304d,p_xccq.xccq304e,p_xccq.xccq304f,p_xccq.xccq304g,p_xccq.xccq304h,p_xccq.xccq305,
                        p_xccq.xccq306,p_xccq.xccq306a,p_xccq.xccq306b,p_xccq.xccq306c,p_xccq.xccq306d,p_xccq.xccq306e,p_xccq.xccq306f,p_xccq.xccq306g,
                        p_xccq.xccq306h,p_xccq.xccq307,p_xccq.xccq308,p_xccq.xccq308a,p_xccq.xccq308b,p_xccq.xccq308c,p_xccq.xccq308d,p_xccq.xccq308e,
                        p_xccq.xccq308f,p_xccq.xccq308g,p_xccq.xccq308h,p_xccq.xccq309,p_xccq.xccq310,p_xccq.xccq310a,p_xccq.xccq310b,p_xccq.xccq310c,
                        p_xccq.xccq310d,p_xccq.xccq310e,p_xccq.xccq310f,p_xccq.xccq310g,p_xccq.xccq310h,p_xccq.xccq311,p_xccq.xccq312,p_xccq.xccq312a,
                        p_xccq.xccq312b,p_xccq.xccq312c,p_xccq.xccq312d,p_xccq.xccq312e,p_xccq.xccq312f,p_xccq.xccq312g,p_xccq.xccq312h,p_xccq.xccq313,
                        p_xccq.xccq314,p_xccq.xccq314a,p_xccq.xccq314b,p_xccq.xccq314c,p_xccq.xccq314d,p_xccq.xccq314e,p_xccq.xccq314f,p_xccq.xccq314g,
                        p_xccq.xccq314h,p_xccq.xccq401,p_xccq.xccq402,p_xccq.xccq901,p_xccq.xccq902,p_xccq.xccq902a,p_xccq.xccq902b,p_xccq.xccq902c,
                        p_xccq.xccq902d,p_xccq.xccq902e,p_xccq.xccq902f,p_xccq.xccq902g,p_xccq.xccq902h,p_xccq.xccq903,p_xccq.xccq903a,p_xccq.xccq903b,
                        p_xccq.xccq903c,p_xccq.xccq903d,p_xccq.xccq903e,p_xccq.xccq903f,p_xccq.xccq903g,p_xccq.xccq903h,p_xccq.xccqtime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccq_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xccq.xccq001,p_xccq.xccq002,p_xccq.xccq004,p_xccq.xccq005,
                               '','','','',p_xccq.xccq006,p_xccq.xccq007,p_xccq.xccq008,'',
                               SQLCA.sqlcode,'','ins xccq_tmp')
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p25_xccq USING 
              p_xccq.xccq101 , p_xccq.xccq102 , p_xccq.xccq102a, p_xccq.xccq102b, p_xccq.xccq102c,
              p_xccq.xccq102d, p_xccq.xccq102e, p_xccq.xccq102f, p_xccq.xccq102g, p_xccq.xccq102h,
              p_xccq.xccq201 , p_xccq.xccq202 , p_xccq.xccq202a, p_xccq.xccq202b, p_xccq.xccq202c,
              p_xccq.xccq202d, p_xccq.xccq202e, p_xccq.xccq202f, p_xccq.xccq202g, p_xccq.xccq202h,
              p_xccq.xccq203 , p_xccq.xccq204 , p_xccq.xccq204a, p_xccq.xccq204b, p_xccq.xccq204c,
              p_xccq.xccq204d, p_xccq.xccq204e, p_xccq.xccq204f, p_xccq.xccq204g, p_xccq.xccq204h,
              p_xccq.xccq205 , p_xccq.xccq206 , p_xccq.xccq206a, p_xccq.xccq206b, p_xccq.xccq206c,
              p_xccq.xccq206d, p_xccq.xccq206e, p_xccq.xccq206f, p_xccq.xccq206g, p_xccq.xccq206h,
              p_xccq.xccq207 , p_xccq.xccq208 , p_xccq.xccq208a, p_xccq.xccq208b, p_xccq.xccq208c,
              p_xccq.xccq208d, p_xccq.xccq208e, p_xccq.xccq208f, p_xccq.xccq208g, p_xccq.xccq208h,
              p_xccq.xccq209 , p_xccq.xccq210 , p_xccq.xccq210a, p_xccq.xccq210b, p_xccq.xccq210c,
              p_xccq.xccq210d, p_xccq.xccq210e, p_xccq.xccq210f, p_xccq.xccq210g, p_xccq.xccq210h,
              p_xccq.xccq211 , p_xccq.xccq212 , p_xccq.xccq212a, p_xccq.xccq212b, p_xccq.xccq212c,
              p_xccq.xccq212d, p_xccq.xccq212e, p_xccq.xccq212f, p_xccq.xccq212g, p_xccq.xccq212h,
              p_xccq.xccq213 , p_xccq.xccq214 , p_xccq.xccq214a, p_xccq.xccq214b, p_xccq.xccq214c,
              p_xccq.xccq214d, p_xccq.xccq214e, p_xccq.xccq214f, p_xccq.xccq214g, p_xccq.xccq214h,
              p_xccq.xccq215 , p_xccq.xccq216 , p_xccq.xccq216a, p_xccq.xccq216b, p_xccq.xccq216c,
              p_xccq.xccq216d, p_xccq.xccq216e, p_xccq.xccq216f, p_xccq.xccq216g, p_xccq.xccq216h,
              p_xccq.xccq217 , p_xccq.xccq218 , p_xccq.xccq218a, p_xccq.xccq218b, p_xccq.xccq218c,
              p_xccq.xccq218d, p_xccq.xccq218e, p_xccq.xccq218f, p_xccq.xccq218g, p_xccq.xccq218h,
              p_xccq.xccq280 , p_xccq.xccq280a, p_xccq.xccq280b, p_xccq.xccq280c, p_xccq.xccq280d,
              p_xccq.xccq280e, p_xccq.xccq280f, p_xccq.xccq280g, p_xccq.xccq280h, p_xccq.xccq301 ,
              p_xccq.xccq302 , p_xccq.xccq302a, p_xccq.xccq302b, p_xccq.xccq302c, p_xccq.xccq302d,
              p_xccq.xccq302e, p_xccq.xccq302f, p_xccq.xccq302g, p_xccq.xccq302h, p_xccq.xccq303 ,
              p_xccq.xccq304 , p_xccq.xccq304a, p_xccq.xccq304b, p_xccq.xccq304c, p_xccq.xccq304d,
              p_xccq.xccq304e, p_xccq.xccq304f, p_xccq.xccq304g, p_xccq.xccq304h, p_xccq.xccq305 ,
              p_xccq.xccq306 , p_xccq.xccq306a, p_xccq.xccq306b, p_xccq.xccq306c, p_xccq.xccq306d,
              p_xccq.xccq306e, p_xccq.xccq306f, p_xccq.xccq306g, p_xccq.xccq306h, p_xccq.xccq307 ,
              p_xccq.xccq308 , p_xccq.xccq308a, p_xccq.xccq308b, p_xccq.xccq308c, p_xccq.xccq308d,
              p_xccq.xccq308e, p_xccq.xccq308f, p_xccq.xccq308g, p_xccq.xccq308h, p_xccq.xccq309 ,
              p_xccq.xccq310 , p_xccq.xccq310a, p_xccq.xccq310b, p_xccq.xccq310c, p_xccq.xccq310d,
              p_xccq.xccq310e, p_xccq.xccq310f, p_xccq.xccq310g, p_xccq.xccq310h, p_xccq.xccq311 ,
              p_xccq.xccq312 , p_xccq.xccq312a, p_xccq.xccq312b, p_xccq.xccq312c, p_xccq.xccq312d,
              p_xccq.xccq312e, p_xccq.xccq312f, p_xccq.xccq312g, p_xccq.xccq312h, p_xccq.xccq313 ,
              p_xccq.xccq314 , p_xccq.xccq314a, p_xccq.xccq314b, p_xccq.xccq314c, p_xccq.xccq314d,
              p_xccq.xccq314e, p_xccq.xccq314f, p_xccq.xccq314g, p_xccq.xccq314h, p_xccq.xccq401 ,
              p_xccq.xccq402 , p_xccq.xccq901 , p_xccq.xccq902 , p_xccq.xccq902a, p_xccq.xccq902b,
              p_xccq.xccq902c, p_xccq.xccq902d, p_xccq.xccq902e, p_xccq.xccq902f, p_xccq.xccq902g,
              p_xccq.xccq902h, p_xccq.xccq903 , p_xccq.xccq903a, p_xccq.xccq903b, p_xccq.xccq903c,
              p_xccq.xccq903d, p_xccq.xccq903e, p_xccq.xccq903f, p_xccq.xccq903g, p_xccq.xccq903h,
              p_xccq.xccqent , p_xccq.xccqld  , p_xccq.xccqsite, p_xccq.xccq001 , p_xccq.xccq002 ,
              p_xccq.xccq003 , p_xccq.xccq004 , p_xccq.xccq005 , p_xccq.xccq006 , p_xccq.xccq007 ,
              p_xccq.xccq008 , p_xccq.xccq009 , p_xccq.xccq010 , p_xccq.xccq011 , p_xccq.xccq012

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccq_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccq.xccq001,p_xccq.xccq002,p_xccq.xccq004,p_xccq.xccq005,
                                  '','','','',
                                  p_xccq.xccq006,p_xccq.xccq007,p_xccq.xccq008,
                                  '',SQLCA.sqlcode,'','upd xccq_tmp')            
         RETURN r_success
      END IF
   END IF
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccc_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccc(p_xccc)
#                       RETURNING r_success
# Input parameter: p_xccc         xccc_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-05-31 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccc(p_xccc)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xccc          RECORD LIKE xccc_t.*  #161124-00048#20 mark
   DEFINE p_xccc           type_g_xccc  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccc RECORD  #料件庫存成本期異動統計檔
   #    xcccent LIKE xccc_t.xcccent, #企业编号
   #    xccccomp LIKE xccc_t.xccccomp, #法人组织
   #    xcccld LIKE xccc_t.xcccld, #账套
   #    xccc001 LIKE xccc_t.xccc001, #账套本位币顺序
   #    xccc002 LIKE xccc_t.xccc002, #成本域
   #    xccc003 LIKE xccc_t.xccc003, #成本计算类型
   #    xccc004 LIKE xccc_t.xccc004, #年度
   #    xccc005 LIKE xccc_t.xccc005, #期别
   #    xccc006 LIKE xccc_t.xccc006, #料号
   #    xccc007 LIKE xccc_t.xccc007, #产品特征
   #    xccc008 LIKE xccc_t.xccc008, #批号
   #    xccc010 LIKE xccc_t.xccc010, #核算币种
   #    xccc101 LIKE xccc_t.xccc101, #上期结存数量
   #    xccc102 LIKE xccc_t.xccc102, #上期结存金额
   #    xccc102a LIKE xccc_t.xccc102a, #上期结存金额-材料
   #    xccc102b LIKE xccc_t.xccc102b, #上期结存金额-人工
   #    xccc102c LIKE xccc_t.xccc102c, #上期结存金额-加工
   #    xccc102d LIKE xccc_t.xccc102d, #上期结存金额-制费一
   #    xccc102e LIKE xccc_t.xccc102e, #上期结存金额-制费二
   #    xccc102f LIKE xccc_t.xccc102f, #上期结存金额-制费三
   #    xccc102g LIKE xccc_t.xccc102g, #上期结存金额-制费四
   #    xccc102h LIKE xccc_t.xccc102h, #上期结存金额-制费五
   #    xccc201 LIKE xccc_t.xccc201, #本期采购入库数量
   #    xccc202 LIKE xccc_t.xccc202, #本期采购入库金额
   #    xccc202a LIKE xccc_t.xccc202a, #本期采购入库金额-材料
   #    xccc202b LIKE xccc_t.xccc202b, #本期采购入库金额-人工
   #    xccc202c LIKE xccc_t.xccc202c, #本期采购入库金额-加工
   #    xccc202d LIKE xccc_t.xccc202d, #本期采购入库金额-制费一
   #    xccc202e LIKE xccc_t.xccc202e, #本期采购入库金额-制费二
   #    xccc202f LIKE xccc_t.xccc202f, #本期采购入库金额-制费三
   #    xccc202g LIKE xccc_t.xccc202g, #本期采购入库金额-制费四
   #    xccc202h LIKE xccc_t.xccc202h, #本期采购入库金额-制费五
   #    xccc203 LIKE xccc_t.xccc203, #本期委外入库数量
   #    xccc204 LIKE xccc_t.xccc204, #本期委外入库金额
   #    xccc204a LIKE xccc_t.xccc204a, #本期委外入库金额-材料
   #    xccc204b LIKE xccc_t.xccc204b, #本期委外入库金额-人工
   #    xccc204c LIKE xccc_t.xccc204c, #本期委外入库金额-加工
   #    xccc204d LIKE xccc_t.xccc204d, #本期委外入库金额-制费一
   #    xccc204e LIKE xccc_t.xccc204e, #本期委外入库金额-制费二
   #    xccc204f LIKE xccc_t.xccc204f, #本期委外入库金额-制费三
   #    xccc204g LIKE xccc_t.xccc204g, #本期委外入库金额-制费四
   #    xccc204h LIKE xccc_t.xccc204h, #本期委外入库金额-制费五
   #    xccc205 LIKE xccc_t.xccc205, #本期工单入库数量
   #    xccc206 LIKE xccc_t.xccc206, #本期工单入库金额
   #    xccc206a LIKE xccc_t.xccc206a, #本期工单入库金额-材料
   #    xccc206b LIKE xccc_t.xccc206b, #本期工单入库金额-人工
   #    xccc206c LIKE xccc_t.xccc206c, #本期工单入库金额-加工
   #    xccc206d LIKE xccc_t.xccc206d, #本期工单入库金额-制费一
   #    xccc206e LIKE xccc_t.xccc206e, #本期工单入库金额-制费二
   #    xccc206f LIKE xccc_t.xccc206f, #本期工单入库金额-制费三
   #    xccc206g LIKE xccc_t.xccc206g, #本期工单入库金额-制费四
   #    xccc206h LIKE xccc_t.xccc206h, #本期工单入库金额-制费五
   #    xccc207 LIKE xccc_t.xccc207, #本期返工领出数量
   #    xccc208 LIKE xccc_t.xccc208, #本期返工领出金额
   #    xccc208a LIKE xccc_t.xccc208a, #本期返工领出金额-材料
   #    xccc208b LIKE xccc_t.xccc208b, #本期返工领出金额-人工
   #    xccc208c LIKE xccc_t.xccc208c, #本期返工领出金额-加工
   #    xccc208d LIKE xccc_t.xccc208d, #本期返工领出金额-制费一
   #    xccc208e LIKE xccc_t.xccc208e, #本期返工领出金额-制费二
   #    xccc208f LIKE xccc_t.xccc208f, #本期返工领出金额-制费三
   #    xccc208g LIKE xccc_t.xccc208g, #本期返工领出金额-制费四
   #    xccc208h LIKE xccc_t.xccc208h, #本期返工领出金额-制费五
   #    xccc209 LIKE xccc_t.xccc209, #本期返工入库数量
   #    xccc210 LIKE xccc_t.xccc210, #本期返工入库金额
   #    xccc210a LIKE xccc_t.xccc210a, #本期返工入库金额-材料
   #    xccc210b LIKE xccc_t.xccc210b, #本期返工入库金额-人工
   #    xccc210c LIKE xccc_t.xccc210c, #本期返工入库金额-加工
   #    xccc210d LIKE xccc_t.xccc210d, #本期返工入库金额-制费一
   #    xccc210e LIKE xccc_t.xccc210e, #本期返工入库金额-制费二
   #    xccc210f LIKE xccc_t.xccc210f, #本期返工入库金额-制费三
   #    xccc210g LIKE xccc_t.xccc210g, #本期返工入库金额-制费四
   #    xccc210h LIKE xccc_t.xccc210h, #本期返工入库金额-制费五
   #    xccc211 LIKE xccc_t.xccc211, #本期杂项入库数量
   #    xccc212 LIKE xccc_t.xccc212, #本期杂项入库金额
   #    xccc212a LIKE xccc_t.xccc212a, #本期杂项入库金额-材料
   #    xccc212b LIKE xccc_t.xccc212b, #本期杂项入库金额-人工
   #    xccc212c LIKE xccc_t.xccc212c, #本期杂项入库金额-加工
   #    xccc212d LIKE xccc_t.xccc212d, #本期杂项入库金额-制费一
   #    xccc212e LIKE xccc_t.xccc212e, #本期杂项入库金额-制费二
   #    xccc212f LIKE xccc_t.xccc212f, #本期杂项入库金额-制费三
   #    xccc212g LIKE xccc_t.xccc212g, #本期杂项入库金额-制费四
   #    xccc212h LIKE xccc_t.xccc212h, #本期杂项入库金额-制费五
   #    xccc213 LIKE xccc_t.xccc213, #本期调整入库数量
   #    xccc214 LIKE xccc_t.xccc214, #本期调整入库金额
   #    xccc214a LIKE xccc_t.xccc214a, #本期调整入库金额-材料
   #    xccc214b LIKE xccc_t.xccc214b, #本期调整入库金额-人工
   #    xccc214c LIKE xccc_t.xccc214c, #本期调整入库金额-加工
   #    xccc214d LIKE xccc_t.xccc214d, #本期调整入库金额-制费一
   #    xccc214e LIKE xccc_t.xccc214e, #本期调整入库金额-制费二
   #    xccc214f LIKE xccc_t.xccc214f, #本期调整入库金额-制费三
   #    xccc214g LIKE xccc_t.xccc214g, #本期调整入库金额-制费四
   #    xccc214h LIKE xccc_t.xccc214h, #本期调整入库金额-制费五
   #    xccc215 LIKE xccc_t.xccc215, #本期销退入库数量
   #    xccc216 LIKE xccc_t.xccc216, #本期销退入库金额
   #    xccc216a LIKE xccc_t.xccc216a, #本期销退入库金额-材料
   #    xccc216b LIKE xccc_t.xccc216b, #本期销退入库金额-人工
   #    xccc216c LIKE xccc_t.xccc216c, #本期销退入库金额-加工
   #    xccc216d LIKE xccc_t.xccc216d, #本期销退入库金额-制费一
   #    xccc216e LIKE xccc_t.xccc216e, #本期销退入库金额-制费二
   #    xccc216f LIKE xccc_t.xccc216f, #本期销退入库金额-制费三
   #    xccc216g LIKE xccc_t.xccc216g, #本期销退入库金额-制费四
   #    xccc216h LIKE xccc_t.xccc216h, #本期销退入库金额-制费五
   #    xccc217 LIKE xccc_t.xccc217, #本期调拨入库数量
   #    xccc218 LIKE xccc_t.xccc218, #本期调拨入库金额
   #    xccc218a LIKE xccc_t.xccc218a, #本期调拨入库金额-材料
   #    xccc218b LIKE xccc_t.xccc218b, #本期调拨入库金额-人工
   #    xccc218c LIKE xccc_t.xccc218c, #本期调拨入库金额-加工
   #    xccc218d LIKE xccc_t.xccc218d, #本期调拨入库金额-制费一
   #    xccc218e LIKE xccc_t.xccc218e, #本期调拨入库金额-制费二
   #    xccc218f LIKE xccc_t.xccc218f, #本期调拨入库金额-制费三
   #    xccc218g LIKE xccc_t.xccc218g, #本期调拨入库金额-制费四
   #    xccc218h LIKE xccc_t.xccc218h, #本期调拨入库金额-制费五
   #    xccc280 LIKE xccc_t.xccc280, #本期平均单价
   #    xccc280a LIKE xccc_t.xccc280a, #本期平均单价-材料
   #    xccc280b LIKE xccc_t.xccc280b, #本期平均单价-人工
   #    xccc280c LIKE xccc_t.xccc280c, #本期平均单价-加工
   #    xccc280d LIKE xccc_t.xccc280d, #本期平均单价-制费一
   #    xccc280e LIKE xccc_t.xccc280e, #本期平均单价-制费二
   #    xccc280f LIKE xccc_t.xccc280f, #本期平均单价-制费三
   #    xccc280g LIKE xccc_t.xccc280g, #本期平均单价-制费四
   #    xccc280h LIKE xccc_t.xccc280h, #本期平均单价-制费五
   #    xccc301 LIKE xccc_t.xccc301, #本期工单领用数量
   #    xccc302 LIKE xccc_t.xccc302, #本期工单领用金额
   #    xccc302a LIKE xccc_t.xccc302a, #本期工单领用金额-材料
   #    xccc302b LIKE xccc_t.xccc302b, #本期工单领用金额-人工
   #    xccc302c LIKE xccc_t.xccc302c, #本期工单领用金额-加工
   #    xccc302d LIKE xccc_t.xccc302d, #本期工单领用金额-制费一
   #    xccc302e LIKE xccc_t.xccc302e, #本期工单领用金额-制费二
   #    xccc302f LIKE xccc_t.xccc302f, #本期工单领用金额-制费三
   #    xccc302g LIKE xccc_t.xccc302g, #本期工单领用金额-制费四
   #    xccc302h LIKE xccc_t.xccc302h, #本期工单领用金额-制费五
   #    xccc303 LIKE xccc_t.xccc303, #本期销货数量
   #    xccc304 LIKE xccc_t.xccc304, #本期销货成本
   #    xccc304a LIKE xccc_t.xccc304a, #本期销货成本-材料
   #    xccc304b LIKE xccc_t.xccc304b, #本期销货成本-人工
   #    xccc304c LIKE xccc_t.xccc304c, #本期销货成本-加工
   #    xccc304d LIKE xccc_t.xccc304d, #本期销货成本-制费一
   #    xccc304e LIKE xccc_t.xccc304e, #本期销货成本-制费二
   #    xccc304f LIKE xccc_t.xccc304f, #本期销货成本-制费三
   #    xccc304g LIKE xccc_t.xccc304g, #本期销货成本-制费四
   #    xccc304h LIKE xccc_t.xccc304h, #本期销货成本-制费五
   #    xccc305 LIKE xccc_t.xccc305, #本期销退数量
   #    xccc306 LIKE xccc_t.xccc306, #本期销退成本
   #    xccc306a LIKE xccc_t.xccc306a, #本期销退成本-材料
   #    xccc306b LIKE xccc_t.xccc306b, #本期销退成本-人工
   #    xccc306c LIKE xccc_t.xccc306c, #本期销退成本-加工
   #    xccc306d LIKE xccc_t.xccc306d, #本期销退成本-制费一
   #    xccc306e LIKE xccc_t.xccc306e, #本期销退成本-制费二
   #    xccc306f LIKE xccc_t.xccc306f, #本期销退成本-制费三
   #    xccc306g LIKE xccc_t.xccc306g, #本期销退成本-制费四
   #    xccc306h LIKE xccc_t.xccc306h, #本期销退成本-制费五
   #    xccc307 LIKE xccc_t.xccc307, #本期销售费用数量
   #    xccc308 LIKE xccc_t.xccc308, #本期销售费用成本
   #    xccc308a LIKE xccc_t.xccc308a, #本期销售费用成本-材料
   #    xccc308b LIKE xccc_t.xccc308b, #本期销售费用成本-人工
   #    xccc308c LIKE xccc_t.xccc308c, #本期销售费用成本-加工
   #    xccc308d LIKE xccc_t.xccc308d, #本期销售费用成本-制费一
   #    xccc308e LIKE xccc_t.xccc308e, #本期销售费用成本-制费二
   #    xccc308f LIKE xccc_t.xccc308f, #本期销售费用成本-制费三
   #    xccc308g LIKE xccc_t.xccc308g, #本期销售费用成本-制费四
   #    xccc308h LIKE xccc_t.xccc308h, #本期销售费用成本-制费五
   #    xccc309 LIKE xccc_t.xccc309, #本期杂发数量
   #    xccc310 LIKE xccc_t.xccc310, #本期杂发金额
   #    xccc310a LIKE xccc_t.xccc310a, #本期杂发金额-材料
   #    xccc310b LIKE xccc_t.xccc310b, #本期杂发金额-人工
   #    xccc310c LIKE xccc_t.xccc310c, #本期杂发金额-加工
   #    xccc310d LIKE xccc_t.xccc310d, #本期杂发金额-制费一
   #    xccc310e LIKE xccc_t.xccc310e, #本期杂发金额-制费二
   #    xccc310f LIKE xccc_t.xccc310f, #本期杂发金额-制费三
   #    xccc310g LIKE xccc_t.xccc310g, #本期杂发金额-制费四
   #    xccc310h LIKE xccc_t.xccc310h, #本期杂发金额-制费五
   #    xccc311 LIKE xccc_t.xccc311, #本期盘盈亏数量
   #    xccc312 LIKE xccc_t.xccc312, #本期盘盈亏金额
   #    xccc312a LIKE xccc_t.xccc312a, #本期盘盈亏金额-材料
   #    xccc312b LIKE xccc_t.xccc312b, #本期盘盈亏金额-人工
   #    xccc312c LIKE xccc_t.xccc312c, #本期盘盈亏金额-加工
   #    xccc312d LIKE xccc_t.xccc312d, #本期盘盈亏金额-制费一
   #    xccc312e LIKE xccc_t.xccc312e, #本期盘盈亏金额-制费二
   #    xccc312f LIKE xccc_t.xccc312f, #本期盘盈亏金额-制费三
   #    xccc312g LIKE xccc_t.xccc312g, #本期盘盈亏金额-制费四
   #    xccc312h LIKE xccc_t.xccc312h, #本期盘盈亏金额-制费五
   #    xccc313 LIKE xccc_t.xccc313, #本期调拨出库数量
   #    xccc314 LIKE xccc_t.xccc314, #本期调拨出库金额
   #    xccc314a LIKE xccc_t.xccc314a, #本期调拨出库金额-材料
   #    xccc314b LIKE xccc_t.xccc314b, #本期调拨出库金额-人工
   #    xccc314c LIKE xccc_t.xccc314c, #本期调拨出库金额-加工
   #    xccc314d LIKE xccc_t.xccc314d, #本期调拨出库金额-制费一
   #    xccc314e LIKE xccc_t.xccc314e, #本期调拨出库金额-制费二
   #    xccc314f LIKE xccc_t.xccc314f, #本期调拨出库金额-制费三
   #    xccc314g LIKE xccc_t.xccc314g, #本期调拨出库金额-制费四
   #    xccc314h LIKE xccc_t.xccc314h, #本期调拨出库金额-制费五
   #    xccc401 LIKE xccc_t.xccc401, #本期销货收入金额
   #    xccc402 LIKE xccc_t.xccc402, #本期销退金额
   #    xccc901 LIKE xccc_t.xccc901, #期末结存数量
   #    xccc902 LIKE xccc_t.xccc902, #期末结存金额
   #    xccc902a LIKE xccc_t.xccc902a, #期末结存金额-材料
   #    xccc902b LIKE xccc_t.xccc902b, #期末结存金额-人工
   #    xccc902c LIKE xccc_t.xccc902c, #期末结存金额-加工
   #    xccc902d LIKE xccc_t.xccc902d, #期末结存金额-制费一
   #    xccc902e LIKE xccc_t.xccc902e, #期末结存金额-制费二
   #    xccc902f LIKE xccc_t.xccc902f, #期末结存金额-制费三
   #    xccc902g LIKE xccc_t.xccc902g, #期末结存金额-制费四
   #    xccc902h LIKE xccc_t.xccc902h, #期末结存金额-制费五
   #    xccc903 LIKE xccc_t.xccc903, #期末结存调整金额
   #    xccc903a LIKE xccc_t.xccc903a, #期末结存调整金额-材料
   #    xccc903b LIKE xccc_t.xccc903b, #期末结存调整金额-人工
   #    xccc903c LIKE xccc_t.xccc903c, #期末结存调整金额-加工
   #    xccc903d LIKE xccc_t.xccc903d, #期末结存调整金额-制费一
   #    xccc903e LIKE xccc_t.xccc903e, #期末结存调整金额-制费二
   #    xccc903f LIKE xccc_t.xccc903f, #期末结存调整金额-制费三
   #    xccc903g LIKE xccc_t.xccc903g, #期末结存调整金额-制费四
   #    xccc903h LIKE xccc_t.xccc903h, #期末结存调整金额-制费五
   #    xccctime LIKE xccc_t.xccctime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   CALL s_axcp500_set_xccc_null_to_zero(p_xccc.*)
        RETURNING p_xccc.*

#   INSERT INTO xccc_tmp VALUES(p_xccc.*) #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccc_tmp(xcccent,xccccomp,xcccld,xccc001,xccc002,xccc003,xccc004,xccc005,
                        xccc006,xccc007,xccc008,xccc010,xccc101,xccc102,xccc102a,xccc102b,
                        xccc102c,xccc102d,xccc102e,xccc102f,xccc102g,xccc102h,xccc201,xccc202,
                        xccc202a,xccc202b,xccc202c,xccc202d,xccc202e,xccc202f,xccc202g,xccc202h,
                        xccc203,xccc204,xccc204a,xccc204b,xccc204c,xccc204d,xccc204e,xccc204f,
                        xccc204g,xccc204h,xccc205,xccc206,xccc206a,xccc206b,xccc206c,xccc206d,
                        xccc206e,xccc206f,xccc206g,xccc206h,xccc207,xccc208,xccc208a,xccc208b,
                        xccc208c,xccc208d,xccc208e,xccc208f,xccc208g,xccc208h,xccc209,xccc210,
                        xccc210a,xccc210b,xccc210c,xccc210d,xccc210e,xccc210f,xccc210g,xccc210h,
                        xccc211,xccc212,xccc212a,xccc212b,xccc212c,xccc212d,xccc212e,xccc212f,
                        xccc212g,xccc212h,xccc213,xccc214,xccc214a,xccc214b,xccc214c,xccc214d,
                        xccc214e,xccc214f,xccc214g,xccc214h,xccc215,xccc216,xccc216a,xccc216b,
                        xccc216c,xccc216d,xccc216e,xccc216f,xccc216g,xccc216h,xccc217,xccc218,
                        xccc218a,xccc218b,xccc218c,xccc218d,xccc218e,xccc218f,xccc218g,xccc218h,
                        xccc280,xccc280a,xccc280b,xccc280c,xccc280d,xccc280e,xccc280f,xccc280g,
                        xccc280h,xccc301,xccc302,xccc302a,xccc302b,xccc302c,xccc302d,xccc302e,
                        xccc302f,xccc302g,xccc302h,xccc303,xccc304,xccc304a,xccc304b,xccc304c,
                        xccc304d,xccc304e,xccc304f,xccc304g,xccc304h,xccc305,xccc306,xccc306a,
                        xccc306b,xccc306c,xccc306d,xccc306e,xccc306f,xccc306g,xccc306h,xccc307,
                        xccc308,xccc308a,xccc308b,xccc308c,xccc308d,xccc308e,xccc308f,xccc308g,
                        xccc308h,xccc309,xccc310,xccc310a,xccc310b,xccc310c,xccc310d,xccc310e,
                        xccc310f,xccc310g,xccc310h,xccc311,xccc312,xccc312a,xccc312b,xccc312c,
                        xccc312d,xccc312e,xccc312f,xccc312g,xccc312h,xccc313,xccc314,xccc314a,
                        xccc314b,xccc314c,xccc314d,xccc314e,xccc314f,xccc314g,xccc314h,xccc401,
                        xccc402,xccc901,xccc902,xccc902a,xccc902b,xccc902c,xccc902d,xccc902e,
                        xccc902f,xccc902g,xccc902h,xccc903,xccc903a,xccc903b,xccc903c,xccc903d,
                        xccc903e,xccc903f,xccc903g,xccc903h,xccctime) 
                 VALUES(p_xccc.xcccent,p_xccc.xccccomp,p_xccc.xcccld,p_xccc.xccc001,p_xccc.xccc002,p_xccc.xccc003,p_xccc.xccc004,p_xccc.xccc005,
                        p_xccc.xccc006,p_xccc.xccc007,p_xccc.xccc008,p_xccc.xccc010,p_xccc.xccc101,p_xccc.xccc102,p_xccc.xccc102a,p_xccc.xccc102b,
                        p_xccc.xccc102c,p_xccc.xccc102d,p_xccc.xccc102e,p_xccc.xccc102f,p_xccc.xccc102g,p_xccc.xccc102h,p_xccc.xccc201,p_xccc.xccc202,
                        p_xccc.xccc202a,p_xccc.xccc202b,p_xccc.xccc202c,p_xccc.xccc202d,p_xccc.xccc202e,p_xccc.xccc202f,p_xccc.xccc202g,p_xccc.xccc202h,
                        p_xccc.xccc203,p_xccc.xccc204,p_xccc.xccc204a,p_xccc.xccc204b,p_xccc.xccc204c,p_xccc.xccc204d,p_xccc.xccc204e,p_xccc.xccc204f,
                        p_xccc.xccc204g,p_xccc.xccc204h,p_xccc.xccc205,p_xccc.xccc206,p_xccc.xccc206a,p_xccc.xccc206b,p_xccc.xccc206c,p_xccc.xccc206d,
                        p_xccc.xccc206e,p_xccc.xccc206f,p_xccc.xccc206g,p_xccc.xccc206h,p_xccc.xccc207,p_xccc.xccc208,p_xccc.xccc208a,p_xccc.xccc208b,
                        p_xccc.xccc208c,p_xccc.xccc208d,p_xccc.xccc208e,p_xccc.xccc208f,p_xccc.xccc208g,p_xccc.xccc208h,p_xccc.xccc209,p_xccc.xccc210,
                        p_xccc.xccc210a,p_xccc.xccc210b,p_xccc.xccc210c,p_xccc.xccc210d,p_xccc.xccc210e,p_xccc.xccc210f,p_xccc.xccc210g,p_xccc.xccc210h,
                        p_xccc.xccc211,p_xccc.xccc212,p_xccc.xccc212a,p_xccc.xccc212b,p_xccc.xccc212c,p_xccc.xccc212d,p_xccc.xccc212e,p_xccc.xccc212f,
                        p_xccc.xccc212g,p_xccc.xccc212h,p_xccc.xccc213,p_xccc.xccc214,p_xccc.xccc214a,p_xccc.xccc214b,p_xccc.xccc214c,p_xccc.xccc214d,
                        p_xccc.xccc214e,p_xccc.xccc214f,p_xccc.xccc214g,p_xccc.xccc214h,p_xccc.xccc215,p_xccc.xccc216,p_xccc.xccc216a,p_xccc.xccc216b,
                        p_xccc.xccc216c,p_xccc.xccc216d,p_xccc.xccc216e,p_xccc.xccc216f,p_xccc.xccc216g,p_xccc.xccc216h,p_xccc.xccc217,p_xccc.xccc218,
                        p_xccc.xccc218a,p_xccc.xccc218b,p_xccc.xccc218c,p_xccc.xccc218d,p_xccc.xccc218e,p_xccc.xccc218f,p_xccc.xccc218g,p_xccc.xccc218h,
                        p_xccc.xccc280,p_xccc.xccc280a,p_xccc.xccc280b,p_xccc.xccc280c,p_xccc.xccc280d,p_xccc.xccc280e,p_xccc.xccc280f,p_xccc.xccc280g,
                        p_xccc.xccc280h,p_xccc.xccc301,p_xccc.xccc302,p_xccc.xccc302a,p_xccc.xccc302b,p_xccc.xccc302c,p_xccc.xccc302d,p_xccc.xccc302e,
                        p_xccc.xccc302f,p_xccc.xccc302g,p_xccc.xccc302h,p_xccc.xccc303,p_xccc.xccc304,p_xccc.xccc304a,p_xccc.xccc304b,p_xccc.xccc304c,
                        p_xccc.xccc304d,p_xccc.xccc304e,p_xccc.xccc304f,p_xccc.xccc304g,p_xccc.xccc304h,p_xccc.xccc305,p_xccc.xccc306,p_xccc.xccc306a,
                        p_xccc.xccc306b,p_xccc.xccc306c,p_xccc.xccc306d,p_xccc.xccc306e,p_xccc.xccc306f,p_xccc.xccc306g,p_xccc.xccc306h,p_xccc.xccc307,
                        p_xccc.xccc308,p_xccc.xccc308a,p_xccc.xccc308b,p_xccc.xccc308c,p_xccc.xccc308d,p_xccc.xccc308e,p_xccc.xccc308f,p_xccc.xccc308g,
                        p_xccc.xccc308h,p_xccc.xccc309,p_xccc.xccc310,p_xccc.xccc310a,p_xccc.xccc310b,p_xccc.xccc310c,p_xccc.xccc310d,p_xccc.xccc310e,
                        p_xccc.xccc310f,p_xccc.xccc310g,p_xccc.xccc310h,p_xccc.xccc311,p_xccc.xccc312,p_xccc.xccc312a,p_xccc.xccc312b,p_xccc.xccc312c,
                        p_xccc.xccc312d,p_xccc.xccc312e,p_xccc.xccc312f,p_xccc.xccc312g,p_xccc.xccc312h,p_xccc.xccc313,p_xccc.xccc314,p_xccc.xccc314a,
                        p_xccc.xccc314b,p_xccc.xccc314c,p_xccc.xccc314d,p_xccc.xccc314e,p_xccc.xccc314f,p_xccc.xccc314g,p_xccc.xccc314h,p_xccc.xccc401,
                        p_xccc.xccc402,p_xccc.xccc901,p_xccc.xccc902,p_xccc.xccc902a,p_xccc.xccc902b,p_xccc.xccc902c,p_xccc.xccc902d,p_xccc.xccc902e,
                        p_xccc.xccc902f,p_xccc.xccc902g,p_xccc.xccc902h,p_xccc.xccc903,p_xccc.xccc903a,p_xccc.xccc903b,p_xccc.xccc903c,p_xccc.xccc903d,
                        p_xccc.xccc903e,p_xccc.xccc903f,p_xccc.xccc903g,p_xccc.xccc903h,p_xccc.xccctime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccc_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xccc.xccc001,p_xccc.xccc002,p_xccc.xccc004,p_xccc.xccc005,
                               '','','','',p_xccc.xccc006,p_xccc.xccc007,p_xccc.xccc008,'',
                               SQLCA.sqlcode,'','ins xccc_tmp')
      RETURN r_success
   END IF


   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p25 USING 
              p_xccc.xccc101 , p_xccc.xccc102 , p_xccc.xccc102a, p_xccc.xccc102b, p_xccc.xccc102c,
              p_xccc.xccc102d, p_xccc.xccc102e, p_xccc.xccc102f, p_xccc.xccc102g, p_xccc.xccc102h,
              p_xccc.xccc201 , p_xccc.xccc202 , p_xccc.xccc202a, p_xccc.xccc202b, p_xccc.xccc202c,
              p_xccc.xccc202d, p_xccc.xccc202e, p_xccc.xccc202f, p_xccc.xccc202g, p_xccc.xccc202h,
              p_xccc.xccc203 , p_xccc.xccc204 , p_xccc.xccc204a, p_xccc.xccc204b, p_xccc.xccc204c,
              p_xccc.xccc204d, p_xccc.xccc204e, p_xccc.xccc204f, p_xccc.xccc204g, p_xccc.xccc204h,
              p_xccc.xccc205 , p_xccc.xccc206 , p_xccc.xccc206a, p_xccc.xccc206b, p_xccc.xccc206c,
              p_xccc.xccc206d, p_xccc.xccc206e, p_xccc.xccc206f, p_xccc.xccc206g, p_xccc.xccc206h,
              p_xccc.xccc207 , p_xccc.xccc208 , p_xccc.xccc208a, p_xccc.xccc208b, p_xccc.xccc208c,
              p_xccc.xccc208d, p_xccc.xccc208e, p_xccc.xccc208f, p_xccc.xccc208g, p_xccc.xccc208h,
              p_xccc.xccc209 , p_xccc.xccc210 , p_xccc.xccc210a, p_xccc.xccc210b, p_xccc.xccc210c,
              p_xccc.xccc210d, p_xccc.xccc210e, p_xccc.xccc210f, p_xccc.xccc210g, p_xccc.xccc210h,
              p_xccc.xccc211 , p_xccc.xccc212 , p_xccc.xccc212a, p_xccc.xccc212b, p_xccc.xccc212c,
              p_xccc.xccc212d, p_xccc.xccc212e, p_xccc.xccc212f, p_xccc.xccc212g, p_xccc.xccc212h,
              p_xccc.xccc213 , p_xccc.xccc214 , p_xccc.xccc214a, p_xccc.xccc214b, p_xccc.xccc214c,
              p_xccc.xccc214d, p_xccc.xccc214e, p_xccc.xccc214f, p_xccc.xccc214g, p_xccc.xccc214h,
              p_xccc.xccc215 , p_xccc.xccc216 , p_xccc.xccc216a, p_xccc.xccc216b, p_xccc.xccc216c,
              p_xccc.xccc216d, p_xccc.xccc216e, p_xccc.xccc216f, p_xccc.xccc216g, p_xccc.xccc216h,
              p_xccc.xccc217 , p_xccc.xccc218 , p_xccc.xccc218a, p_xccc.xccc218b, p_xccc.xccc218c,
              p_xccc.xccc218d, p_xccc.xccc218e, p_xccc.xccc218f, p_xccc.xccc218g, p_xccc.xccc218h,
              p_xccc.xccc280 , p_xccc.xccc280a, p_xccc.xccc280b, p_xccc.xccc280c, p_xccc.xccc280d,
              p_xccc.xccc280e, p_xccc.xccc280f, p_xccc.xccc280g, p_xccc.xccc280h, p_xccc.xccc301 ,
              p_xccc.xccc302 , p_xccc.xccc302a, p_xccc.xccc302b, p_xccc.xccc302c, p_xccc.xccc302d,
              p_xccc.xccc302e, p_xccc.xccc302f, p_xccc.xccc302g, p_xccc.xccc302h, p_xccc.xccc303 ,
              p_xccc.xccc304 , p_xccc.xccc304a, p_xccc.xccc304b, p_xccc.xccc304c, p_xccc.xccc304d,
              p_xccc.xccc304e, p_xccc.xccc304f, p_xccc.xccc304g, p_xccc.xccc304h, p_xccc.xccc305 ,
              p_xccc.xccc306 , p_xccc.xccc306a, p_xccc.xccc306b, p_xccc.xccc306c, p_xccc.xccc306d,
              p_xccc.xccc306e, p_xccc.xccc306f, p_xccc.xccc306g, p_xccc.xccc306h, p_xccc.xccc307 ,
              p_xccc.xccc308 , p_xccc.xccc308a, p_xccc.xccc308b, p_xccc.xccc308c, p_xccc.xccc308d,
              p_xccc.xccc308e, p_xccc.xccc308f, p_xccc.xccc308g, p_xccc.xccc308h, p_xccc.xccc309 ,
              p_xccc.xccc310 , p_xccc.xccc310a, p_xccc.xccc310b, p_xccc.xccc310c, p_xccc.xccc310d,
              p_xccc.xccc310e, p_xccc.xccc310f, p_xccc.xccc310g, p_xccc.xccc310h, p_xccc.xccc311 ,
              p_xccc.xccc312 , p_xccc.xccc312a, p_xccc.xccc312b, p_xccc.xccc312c, p_xccc.xccc312d,
              p_xccc.xccc312e, p_xccc.xccc312f, p_xccc.xccc312g, p_xccc.xccc312h, p_xccc.xccc313 ,
              p_xccc.xccc314 , p_xccc.xccc314a, p_xccc.xccc314b, p_xccc.xccc314c, p_xccc.xccc314d,
              p_xccc.xccc314e, p_xccc.xccc314f, p_xccc.xccc314g, p_xccc.xccc314h, p_xccc.xccc401 ,
              p_xccc.xccc402 , p_xccc.xccc901 , p_xccc.xccc902 , p_xccc.xccc902a, p_xccc.xccc902b,
              p_xccc.xccc902c, p_xccc.xccc902d, p_xccc.xccc902e, p_xccc.xccc902f, p_xccc.xccc902g,
              p_xccc.xccc902h, p_xccc.xccc903 , p_xccc.xccc903a, p_xccc.xccc903b, p_xccc.xccc903c,
              p_xccc.xccc903d, p_xccc.xccc903e, p_xccc.xccc903f, p_xccc.xccc903g, p_xccc.xccc903h,
              p_xccc.xcccent , p_xccc.xcccld  , p_xccc.xccc001 , p_xccc.xccc002 , p_xccc.xccc003,
              p_xccc.xccc004 , p_xccc.xccc005 , p_xccc.xccc006 , p_xccc.xccc007 , p_xccc.xccc008

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccc_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccc.xccc001,p_xccc.xccc002,p_xccc.xccc004,p_xccc.xccc005,
                                  '','','','',
                                  p_xccc.xccc006,p_xccc.xccc007,p_xccc.xccc008,
                                  '',SQLCA.sqlcode,'','upd xccc_tmp')            
         RETURN r_success
      END IF
   END IF
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccd_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccd(p_xccd)
#                       RETURNING r_success
# Input parameter: p_xccd         xccd_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-06-16 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccd(p_xccd)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xccd       RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE p_xccd       type_g_xccd  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   DEFINE l_count      LIKE type_t.num10  #PGS(D)-08172 memo add
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE

   CALL s_axcp500_set_xccd_null_to_zero(p_xccd.*)
        RETURNING p_xccd.*

#   INSERT INTO xccd_tmp VALUES(p_xccd.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccd_tmp(xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,
                        xccd006,xccd007,xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,
                        xccd014,xccd101,xccd102,xccd102a,xccd102b,xccd102c,xccd102d,xccd102e,
                        xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,xccd202a,xccd202b,
                        xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,
                        xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,
                        xccd302,xccd302a,xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,
                        xccd302h,xccd303,xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,
                        xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,xccd902b,xccd902c,
                        xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime) 
                 VALUES(p_xccd.xccdent,p_xccd.xccdcomp,p_xccd.xccdld,p_xccd.xccd001,p_xccd.xccd002,p_xccd.xccd003,p_xccd.xccd004,p_xccd.xccd005,
                        p_xccd.xccd006,p_xccd.xccd007,p_xccd.xccd008,p_xccd.xccd009,p_xccd.xccd010,p_xccd.xccd011,p_xccd.xccd012,p_xccd.xccd013,
                        p_xccd.xccd014,p_xccd.xccd101,p_xccd.xccd102,p_xccd.xccd102a,p_xccd.xccd102b,p_xccd.xccd102c,p_xccd.xccd102d,p_xccd.xccd102e,
                        p_xccd.xccd102f,p_xccd.xccd102g,p_xccd.xccd102h,p_xccd.xccd200,p_xccd.xccd201,p_xccd.xccd202,p_xccd.xccd202a,p_xccd.xccd202b,
                        p_xccd.xccd202c,p_xccd.xccd202d,p_xccd.xccd202e,p_xccd.xccd202f,p_xccd.xccd202g,p_xccd.xccd202h,p_xccd.xccd204,p_xccd.xccd204a,
                        p_xccd.xccd204b,p_xccd.xccd204c,p_xccd.xccd204d,p_xccd.xccd204e,p_xccd.xccd204f,p_xccd.xccd204g,p_xccd.xccd204h,p_xccd.xccd301,
                        p_xccd.xccd302,p_xccd.xccd302a,p_xccd.xccd302b,p_xccd.xccd302c,p_xccd.xccd302d,p_xccd.xccd302e,p_xccd.xccd302f,p_xccd.xccd302g,
                        p_xccd.xccd302h,p_xccd.xccd303,p_xccd.xccd304,p_xccd.xccd304a,p_xccd.xccd304b,p_xccd.xccd304c,p_xccd.xccd304d,p_xccd.xccd304e,
                        p_xccd.xccd304f,p_xccd.xccd304g,p_xccd.xccd304h,p_xccd.xccd901,p_xccd.xccd902,p_xccd.xccd902a,p_xccd.xccd902b,p_xccd.xccd902c,
                        p_xccd.xccd902d,p_xccd.xccd902e,p_xccd.xccd902f,p_xccd.xccd902g,p_xccd.xccd902h,p_xccd.xccdtime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccd_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xccd.xccd001,p_xccd.xccd002,p_xccd.xccd004,p_xccd.xccd005,
                               p_xccd.xccd006,'','','',p_xccd.xccd007,p_xccd.xccd008,p_xccd.xccd009,
                               '',SQLCA.sqlcode,'','ins xccd_tmp')

      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p26 USING 
              p_xccd.xccd101 , p_xccd.xccd102 , p_xccd.xccd102a, p_xccd.xccd102b, p_xccd.xccd102c,
              p_xccd.xccd102d, p_xccd.xccd102e, p_xccd.xccd102f, p_xccd.xccd102g, p_xccd.xccd102h,
              p_xccd.xccd200,
              p_xccd.xccd201 , p_xccd.xccd202 , p_xccd.xccd202a, p_xccd.xccd202b, p_xccd.xccd202c,
              p_xccd.xccd202d, p_xccd.xccd202e, p_xccd.xccd202f, p_xccd.xccd202g, p_xccd.xccd202h,
                               p_xccd.xccd204 , p_xccd.xccd204a, p_xccd.xccd204b, p_xccd.xccd204c,
              p_xccd.xccd204d, p_xccd.xccd204e, p_xccd.xccd204f, p_xccd.xccd204g, p_xccd.xccd204h,
              p_xccd.xccd301 , p_xccd.xccd302 , p_xccd.xccd302a, p_xccd.xccd302b, p_xccd.xccd302c, 
              p_xccd.xccd302d, p_xccd.xccd302e, p_xccd.xccd302f, p_xccd.xccd302g, p_xccd.xccd302h, 
              p_xccd.xccd303 , p_xccd.xccd304 , p_xccd.xccd304a, p_xccd.xccd304b, p_xccd.xccd304c, 
              p_xccd.xccd304d, p_xccd.xccd304e, p_xccd.xccd304f, p_xccd.xccd304g, p_xccd.xccd304h, 
              p_xccd.xccd901 , p_xccd.xccd902 , p_xccd.xccd902a, p_xccd.xccd902b, p_xccd.xccd902c, 
              p_xccd.xccd902d, p_xccd.xccd902e, p_xccd.xccd902f, p_xccd.xccd902g, p_xccd.xccd902h, 
              p_xccd.xccdent , p_xccd.xccdld  , p_xccd.xccd001 , p_xccd.xccd002 , p_xccd.xccd003,
              p_xccd.xccd004 , p_xccd.xccd005 , p_xccd.xccd006 

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccd_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccd.xccd001,p_xccd.xccd002,p_xccd.xccd004,p_xccd.xccd005,
                                  p_xccd.xccd006,'','','',
                                  p_xccd.xccd007,'','',
                                  '',SQLCA.sqlcode,'','upd xccd_tmp')            
         RETURN r_success
      END IF

   END IF
   #PGS(D)-08172 memo -S- add
   #PGS(D)-08172 memo -E- add
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xcce_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xcce(p_xcce)
#                       RETURNING r_success
# Input parameter: p_xcce         xcce_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-06-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xcce(p_xcce)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xcce       RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE p_xcce       type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE p_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   DEFINE l_count      LIKE type_t.num10  #PGS(D)-08172 memo add
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   CALL s_axcp500_set_xcce_null_to_zero(p_xcce.*)   
        RETURNING p_xcce.*
        
   CALL s_axcp500_sum_xcce(p_xcce.*)
        RETURNING p_xcce.*
         
#   INSERT INTO xcce_tmp VALUES(p_xcce.*) #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xcce_tmp(xcceent,xccecomp,xcceld,xcce001,xcce002,xcce003,xcce004,xcce005,
                        xcce006,xcce007,xcce008,xcce009,xcce010,xcce101,xcce102,xcce102a,
                        xcce102b,xcce102c,xcce102d,xcce102e,xcce102f,xcce102g,xcce102h,
                        xcce201,xcce202,xcce202a,xcce202b,xcce202c,xcce202d,xcce202e,xcce202f,
                        xcce202g,xcce202h,xcce205,xcce206,xcce206a,xcce206b,xcce206c,xcce206d,
                        xcce206e,xcce206f,xcce206g,xcce206h,xcce207,xcce208,xcce208a,xcce208b,
                        xcce208c,xcce208d,xcce208e,xcce208f,xcce208g,xcce208h,xcce209,xcce210,
                        xcce210a,xcce210b,xcce210c,xcce210d,xcce210e,xcce210f,xcce210g,xcce210h,
                        xcce301,xcce302,xcce302a,xcce302b,xcce302c,xcce302d,xcce302e,xcce302f,
                        xcce302g,xcce302h,xcce303,xcce304,xcce304a,xcce304b,xcce304c,xcce304d,
                        xcce304e,xcce304f,xcce304g,xcce304h,xcce307,xcce308,xcce308a,xcce308b,
                        xcce308c,xcce308d,xcce308e,xcce308f,xcce308g,xcce308h,xcce901,xcce902,
                        xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h,xccetime) 
                 VALUES(p_xcce.xcceent,p_xcce.xccecomp,p_xcce.xcceld,p_xcce.xcce001,p_xcce.xcce002,p_xcce.xcce003,p_xcce.xcce004,p_xcce.xcce005,
                        p_xcce.xcce006,p_xcce.xcce007,p_xcce.xcce008,p_xcce.xcce009,p_xcce.xcce010,p_xcce.xcce101,p_xcce.xcce102,p_xcce.xcce102a,
                        p_xcce.xcce102b,p_xcce.xcce102c,p_xcce.xcce102d,p_xcce.xcce102e,p_xcce.xcce102f,p_xcce.xcce102g,p_xcce.xcce102h,
                        p_xcce.xcce201,p_xcce.xcce202,p_xcce.xcce202a,p_xcce.xcce202b,p_xcce.xcce202c,p_xcce.xcce202d,p_xcce.xcce202e,p_xcce.xcce202f,
                        p_xcce.xcce202g,p_xcce.xcce202h,p_xcce.xcce205,p_xcce.xcce206,p_xcce.xcce206a,p_xcce.xcce206b,p_xcce.xcce206c,p_xcce.xcce206d,
                        p_xcce.xcce206e,p_xcce.xcce206f,p_xcce.xcce206g,p_xcce.xcce206h,p_xcce.xcce207,p_xcce.xcce208,p_xcce.xcce208a,p_xcce.xcce208b,
                        p_xcce.xcce208c,p_xcce.xcce208d,p_xcce.xcce208e,p_xcce.xcce208f,p_xcce.xcce208g,p_xcce.xcce208h,p_xcce.xcce209,p_xcce.xcce210,
                        p_xcce.xcce210a,p_xcce.xcce210b,p_xcce.xcce210c,p_xcce.xcce210d,p_xcce.xcce210e,p_xcce.xcce210f,p_xcce.xcce210g,p_xcce.xcce210h,
                        p_xcce.xcce301,p_xcce.xcce302,p_xcce.xcce302a,p_xcce.xcce302b,p_xcce.xcce302c,p_xcce.xcce302d,p_xcce.xcce302e,p_xcce.xcce302f,
                        p_xcce.xcce302g,p_xcce.xcce302h,p_xcce.xcce303,p_xcce.xcce304,p_xcce.xcce304a,p_xcce.xcce304b,p_xcce.xcce304c,p_xcce.xcce304d,
                        p_xcce.xcce304e,p_xcce.xcce304f,p_xcce.xcce304g,p_xcce.xcce304h,p_xcce.xcce307,p_xcce.xcce308,p_xcce.xcce308a,p_xcce.xcce308b,
                        p_xcce.xcce308c,p_xcce.xcce308d,p_xcce.xcce308e,p_xcce.xcce308f,p_xcce.xcce308g,p_xcce.xcce308h,p_xcce.xcce901,p_xcce.xcce902,
                        p_xcce.xcce902a,p_xcce.xcce902b,p_xcce.xcce902c,p_xcce.xcce902d,p_xcce.xcce902e,p_xcce.xcce902f,p_xcce.xcce902g,p_xcce.xcce902h,p_xcce.xccetime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xcce_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xcce.xcce001,p_xcce.xcce002,p_xcce.xcce004,p_xcce.xcce005,
                               p_xcce.xcce006,'','','',p_xcce.xcce007,p_xcce.xcce008,p_xcce.xcce009,
                               '',SQLCA.sqlcode,'','ins xcce_tmp')
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p28 USING 
              p_xcce.xcce101 , p_xcce.xcce102 , p_xcce.xcce102a, p_xcce.xcce102b, p_xcce.xcce102c,
              p_xcce.xcce102d, p_xcce.xcce102e, p_xcce.xcce102f, p_xcce.xcce102g, p_xcce.xcce102h,
              p_xcce.xcce201 , p_xcce.xcce202 , p_xcce.xcce202a, p_xcce.xcce202b, p_xcce.xcce202c,
              p_xcce.xcce202d, p_xcce.xcce202e, p_xcce.xcce202f, p_xcce.xcce202g, p_xcce.xcce202h,
              p_xcce.xcce205 , p_xcce.xcce206 , p_xcce.xcce206a, p_xcce.xcce206b, p_xcce.xcce206c,
              p_xcce.xcce206d, p_xcce.xcce206e, p_xcce.xcce206f, p_xcce.xcce206g, p_xcce.xcce206h,
              p_xcce.xcce207 , p_xcce.xcce208 , p_xcce.xcce208a, p_xcce.xcce208b, p_xcce.xcce208c,
              p_xcce.xcce208d, p_xcce.xcce208e, p_xcce.xcce208f, p_xcce.xcce208g, p_xcce.xcce208h,
              p_xcce.xcce209 , p_xcce.xcce210 , p_xcce.xcce210a, p_xcce.xcce210b, p_xcce.xcce210c,
              p_xcce.xcce210d, p_xcce.xcce210e, p_xcce.xcce210f, p_xcce.xcce210g, p_xcce.xcce210h,
              p_xcce.xcce301 , p_xcce.xcce302 , p_xcce.xcce302a, p_xcce.xcce302b, p_xcce.xcce302c, 
              p_xcce.xcce302d, p_xcce.xcce302e, p_xcce.xcce302f, p_xcce.xcce302g, p_xcce.xcce302h, 
              p_xcce.xcce303 , p_xcce.xcce304 , p_xcce.xcce304a, p_xcce.xcce304b, p_xcce.xcce304c, 
              p_xcce.xcce304d, p_xcce.xcce304e, p_xcce.xcce304f, p_xcce.xcce304g, p_xcce.xcce304h, 
              p_xcce.xcce307 , p_xcce.xcce308 , p_xcce.xcce308a, p_xcce.xcce308b, p_xcce.xcce308c, 
              p_xcce.xcce308d, p_xcce.xcce308e, p_xcce.xcce308f, p_xcce.xcce308g, p_xcce.xcce308h, 
              p_xcce.xcce901 , p_xcce.xcce902 , p_xcce.xcce902a, p_xcce.xcce902b, p_xcce.xcce902c, 
              p_xcce.xcce902d, p_xcce.xcce902e, p_xcce.xcce902f, p_xcce.xcce902g, p_xcce.xcce902h, 
              p_xcce.xcceent , p_xcce.xcceld  , p_xcce.xcce001 , p_xcce.xcce002 , p_xcce.xcce003 ,
              p_xcce.xcce004 , p_xcce.xcce005 , p_xcce.xcce006 , p_xcce.xcce007 , p_xcce.xcce008 ,
              p_xcce.xcce009

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xcce_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xcce.xcce001,p_xcce.xcce002,p_xcce.xcce004,p_xcce.xcce005,
                                  p_xcce.xcce006,'','','',
                                  p_xcce.xcce007,p_xcce.xcce008,p_xcce.xcce009,
                                  '',SQLCA.sqlcode,'','upd xcce_tmp')            
         RETURN r_success
      END IF
   END IF
   #PGS(D)-08172 memo -S- add
   #PGS(D)-08172 memo -E- add
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccg_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccg(p_xccg)
#                       RETURNING r_success
# Input parameter: p_xccg         xccg_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccg(p_xccg)
#   DEFINE p_xccg       RECORD LIKE xccg_t.*  #161124-00048#20 mark
   DEFINE p_xccg        type_g_xccg  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccg RECORD  #聯產品成本期異動統計檔
   #    xccgent LIKE xccg_t.xccgent, #企业编号
   #    xccgcomp LIKE xccg_t.xccgcomp, #法人组织
   #    xccgld LIKE xccg_t.xccgld, #账套
   #    xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
   #    xccg002 LIKE xccg_t.xccg002, #成本域
   #    xccg003 LIKE xccg_t.xccg003, #成本计算类型
   #    xccg004 LIKE xccg_t.xccg004, #年度
   #    xccg005 LIKE xccg_t.xccg005, #期别
   #    xccg006 LIKE xccg_t.xccg006, #工单编号
   #    xccg007 LIKE xccg_t.xccg007, #联产品料号
   #    xccg008 LIKE xccg_t.xccg008, #特性
   #    xccg009 LIKE xccg_t.xccg009, #批号
   #    xccg010 LIKE xccg_t.xccg010, #核算币种
   #    xccg101 LIKE xccg_t.xccg101, #上期结存数量
   #    xccg102 LIKE xccg_t.xccg102, #上期结存金额
   #    xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
   #    xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
   #    xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
   #    xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
   #    xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
   #    xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
   #    xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
   #    xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
   #    xccg301 LIKE xccg_t.xccg301, #本期转出数量
   #    xccg302 LIKE xccg_t.xccg302, #本期转出金额
   #    xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
   #    xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
   #    xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
   #    xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
   #    xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
   #    xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
   #    xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
   #    xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
   #    xccg901 LIKE xccg_t.xccg901, #期末结存数量
   #    xccg902 LIKE xccg_t.xccg902, #期末结存金额
   #    xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
   #    xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
   #    xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
   #    xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
   #    xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
   #    xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
   #    xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
   #    xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
   #    xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   DEFINE l_count      LIKE type_t.num10  #PGS(D)-08172 memo add
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
                
   CALL s_axcp500_set_xccg_null_to_zero(p_xccg.*)
        RETURNING p_xccg.*

#   INSERT INTO xccg_tmp VALUES(p_xccg.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccg_tmp(xccgent,xccgcomp,xccgld,xccg001,xccg002,xccg003,xccg004,xccg005,
                        xccg006,xccg007,xccg008,xccg009,xccg010,xccg101,xccg102,xccg102a,
                        xccg102b,xccg102c,xccg102d,xccg102e,xccg102f,xccg102g,xccg102h,
                        xccg301,xccg302,xccg302a,xccg302b,xccg302c,xccg302d,xccg302e,
                        xccg302f,xccg302g,xccg302h,xccg901,xccg902,xccg902a,xccg902b,
                        xccg902c,xccg902d,xccg902e,xccg902f,xccg902g,xccg902h,xccgtime) 
                 VALUES(p_xccg.xccgent,p_xccg.xccgcomp,p_xccg.xccgld,p_xccg.xccg001,p_xccg.xccg002,p_xccg.xccg003,p_xccg.xccg004,p_xccg.xccg005,
                        p_xccg.xccg006,p_xccg.xccg007,p_xccg.xccg008,p_xccg.xccg009,p_xccg.xccg010,p_xccg.xccg101,p_xccg.xccg102,p_xccg.xccg102a,
                        p_xccg.xccg102b,p_xccg.xccg102c,p_xccg.xccg102d,p_xccg.xccg102e,p_xccg.xccg102f,p_xccg.xccg102g,p_xccg.xccg102h,
                        p_xccg.xccg301,p_xccg.xccg302,p_xccg.xccg302a,p_xccg.xccg302b,p_xccg.xccg302c,p_xccg.xccg302d,p_xccg.xccg302e,
                        p_xccg.xccg302f,p_xccg.xccg302g,p_xccg.xccg302h,p_xccg.xccg901,p_xccg.xccg902,p_xccg.xccg902a,p_xccg.xccg902b,
                        p_xccg.xccg902c,p_xccg.xccg902d,p_xccg.xccg902e,p_xccg.xccg902f,p_xccg.xccg902g,p_xccg.xccg902h,p_xccg.xccgtime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccg_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN r_success
      CALL s_axcp500_ins_error(p_xccg.xccg001,p_xccg.xccg002,p_xccg.xccg004,p_xccg.xccg005,
                               p_xccg.xccg006,'','','',p_xccg.xccg007,p_xccg.xccg008,p_xccg.xccg009,
                               '',SQLCA.sqlcode,'','ins xccg_tmp')      
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p31 USING 
              p_xccg.xccg101 , p_xccg.xccg102 , p_xccg.xccg102a, p_xccg.xccg102b, p_xccg.xccg102c,
              p_xccg.xccg102d, p_xccg.xccg102e, p_xccg.xccg102f, p_xccg.xccg102g, p_xccg.xccg102h,
              p_xccg.xccg301 , p_xccg.xccg302 , p_xccg.xccg302a, p_xccg.xccg302b, p_xccg.xccg302c, 
              p_xccg.xccg302d, p_xccg.xccg302e, p_xccg.xccg302f, p_xccg.xccg302g, p_xccg.xccg302h, 
              p_xccg.xccg901 , p_xccg.xccg902 , p_xccg.xccg902a, p_xccg.xccg902b, p_xccg.xccg902c, 
              p_xccg.xccg902d, p_xccg.xccg902e, p_xccg.xccg902f, p_xccg.xccg902g, p_xccg.xccg902h, 
              p_xccg.xccgent , p_xccg.xccgld  , p_xccg.xccg001 , p_xccg.xccg002 , p_xccg.xccg003 ,
              p_xccg.xccg004 , p_xccg.xccg005 , p_xccg.xccg006 , p_xccg.xccg007 , p_xccg.xccg008 ,
              p_xccg.xccg009

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccg_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccg.xccg001,p_xccg.xccg002,p_xccg.xccg004,p_xccg.xccg005,
                                  p_xccg.xccg006,'','','',
                                  p_xccg.xccg007,p_xccg.xccg008,p_xccg.xccg009,
                                  '',SQLCA.sqlcode,'','upd xccg_tmp')            
         RETURN r_success
      END IF
   END IF
   #PGS(D)-08172 memo -S- add
   #PGS(D)-08172 memo -E- add

   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xcch_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xcch(p_xcch)
#                       RETURNING r_success
# Input parameter: p_xcch         xcch_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xcch(p_xcch)
#   DEFINE p_xcch       RECORD LIKE xcch_t.*  #161124-00048#20 mark
   DEFINE p_xcch           type_g_xcch  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   #PGS-(D)-03080-----s
   DEFINE l_count      LIKE type_t.num10
   #PGS-(D)-03080-----e
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
        
   CALL s_axcp500_set_xcch_null_to_zero(p_xcch.*)
        RETURNING p_xcch.*

#PGS-(D)-03080-----s
#PGS-(D)-03080-----e
#   INSERT INTO xcch_t VALUES(p_xcch.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xcch_t(xcchent,xcchcomp,xcchld,xcch001,xcch002,xcch003,xcch004,xcch005,
                      xcch006,xcch007,xcch008,xcch009,xcch010,xcch011,xcch101,xcch102,
                      xcch102a,xcch102b,xcch102c,xcch102d,xcch102e,xcch102f,xcch102g,
                      xcch102h,xcch200,xcch201,xcch202,xcch202a,xcch202b,xcch202c,xcch202d,
                      xcch202e,xcch202f,xcch202g,xcch202h,xcch204,xcch204a,xcch204b,xcch204c,
                      xcch204d,xcch204e,xcch204f,xcch204g,xcch204h,xcch301,xcch302,xcch302a,
                      xcch302b,xcch302c,xcch302d,xcch302e,xcch302f,xcch302g,xcch302h,xcch303,
                      xcch304,xcch304a,xcch304b,xcch304c,xcch304d,xcch304e,xcch304f,xcch304g,
                      xcch304h,xcch901,xcch902,xcch902a,xcch902b,xcch902c,xcch902d,xcch902e,
                      xcch902f,xcch902g,xcch902h,xcchtime) 
               VALUES(p_xcch.xcchent,p_xcch.xcchcomp,p_xcch.xcchld,p_xcch.xcch001,p_xcch.xcch002,p_xcch.xcch003,p_xcch.xcch004,p_xcch.xcch005,
                      p_xcch.xcch006,p_xcch.xcch007,p_xcch.xcch008,p_xcch.xcch009,p_xcch.xcch010,p_xcch.xcch011,p_xcch.xcch101,p_xcch.xcch102,
                      p_xcch.xcch102a,p_xcch.xcch102b,p_xcch.xcch102c,p_xcch.xcch102d,p_xcch.xcch102e,p_xcch.xcch102f,p_xcch.xcch102g,
                      p_xcch.xcch102h,p_xcch.xcch200,p_xcch.xcch201,p_xcch.xcch202,p_xcch.xcch202a,p_xcch.xcch202b,p_xcch.xcch202c,p_xcch.xcch202d,
                      p_xcch.xcch202e,p_xcch.xcch202f,p_xcch.xcch202g,p_xcch.xcch202h,p_xcch.xcch204,p_xcch.xcch204a,p_xcch.xcch204b,p_xcch.xcch204c,
                      p_xcch.xcch204d,p_xcch.xcch204e,p_xcch.xcch204f,p_xcch.xcch204g,p_xcch.xcch204h,p_xcch.xcch301,p_xcch.xcch302,p_xcch.xcch302a,
                      p_xcch.xcch302b,p_xcch.xcch302c,p_xcch.xcch302d,p_xcch.xcch302e,p_xcch.xcch302f,p_xcch.xcch302g,p_xcch.xcch302h,p_xcch.xcch303,
                      p_xcch.xcch304,p_xcch.xcch304a,p_xcch.xcch304b,p_xcch.xcch304c,p_xcch.xcch304d,p_xcch.xcch304e,p_xcch.xcch304f,p_xcch.xcch304g,
                      p_xcch.xcch304h,p_xcch.xcch901,p_xcch.xcch902,p_xcch.xcch902a,p_xcch.xcch902b,p_xcch.xcch902c,p_xcch.xcch902d,p_xcch.xcch902e,
                      p_xcch.xcch902f,p_xcch.xcch902g,p_xcch.xcch902h,p_xcch.xcchtime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xcch_t'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xcch.xcch001,p_xcch.xcch002,p_xcch.xcch004,p_xcch.xcch005,
                               p_xcch.xcch006,'','','',p_xcch.xcch007,p_xcch.xcch008,p_xcch.xcch009,
                               '',SQLCA.sqlcode,'','ins xcch_t')      
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
#      UPDATE xcch_t SET xcch_t.* = p_xcch.*  #161124-00048#20 mark
      #161124-00048#20 add(s)
      UPDATE xcch_t SET (xcchent,xcchcomp,xcchld,xcch001,xcch002,xcch003,xcch004,xcch005,xcch006,
                         xcch007,xcch008,xcch009,xcch010,xcch011,xcch101,xcch102,xcch102a,xcch102b,
                         xcch102c,xcch102d,xcch102e,xcch102f,xcch102g,xcch102h,xcch200,xcch201,xcch202,
                         xcch202a,xcch202b,xcch202c,xcch202d,xcch202e,xcch202f,xcch202g,xcch202h,xcch204,
                         xcch204a,xcch204b,xcch204c,xcch204d,xcch204e,xcch204f,xcch204g,xcch204h,xcch301,
                         xcch302,xcch302a,xcch302b,xcch302c,xcch302d,xcch302e,xcch302f,xcch302g,xcch302h,
                         xcch303,xcch304,xcch304a,xcch304b,xcch304c,xcch304d,xcch304e,xcch304f,xcch304g,
                         xcch304h,xcch901,xcch902,xcch902a,xcch902b,xcch902c,xcch902d,xcch902e,xcch902f,
                         xcch902g,xcch902h,xcchtime) 
                      = (p_xcch.xcchent,p_xcch.xcchcomp,p_xcch.xcchld,p_xcch.xcch001,p_xcch.xcch002,p_xcch.xcch003,p_xcch.xcch004,p_xcch.xcch005,p_xcch.xcch006,
                         p_xcch.xcch007,p_xcch.xcch008,p_xcch.xcch009,p_xcch.xcch010,p_xcch.xcch011,p_xcch.xcch101,p_xcch.xcch102,p_xcch.xcch102a,p_xcch.xcch102b,
                         p_xcch.xcch102c,p_xcch.xcch102d,p_xcch.xcch102e,p_xcch.xcch102f,p_xcch.xcch102g,p_xcch.xcch102h,p_xcch.xcch200,p_xcch.xcch201,p_xcch.xcch202,
                         p_xcch.xcch202a,p_xcch.xcch202b,p_xcch.xcch202c,p_xcch.xcch202d,p_xcch.xcch202e,p_xcch.xcch202f,p_xcch.xcch202g,p_xcch.xcch202h,p_xcch.xcch204,
                         p_xcch.xcch204a,p_xcch.xcch204b,p_xcch.xcch204c,p_xcch.xcch204d,p_xcch.xcch204e,p_xcch.xcch204f,p_xcch.xcch204g,p_xcch.xcch204h,p_xcch.xcch301,
                         p_xcch.xcch302,p_xcch.xcch302a,p_xcch.xcch302b,p_xcch.xcch302c,p_xcch.xcch302d,p_xcch.xcch302e,p_xcch.xcch302f,p_xcch.xcch302g,p_xcch.xcch302h,
                         p_xcch.xcch303,p_xcch.xcch304,p_xcch.xcch304a,p_xcch.xcch304b,p_xcch.xcch304c,p_xcch.xcch304d,p_xcch.xcch304e,p_xcch.xcch304f,p_xcch.xcch304g,
                         p_xcch.xcch304h,p_xcch.xcch901,p_xcch.xcch902,p_xcch.xcch902a,p_xcch.xcch902b,p_xcch.xcch902c,p_xcch.xcch902d,p_xcch.xcch902e,p_xcch.xcch902f,
                         p_xcch.xcch902g,p_xcch.xcch902h,p_xcch.xcchtime)
      #161124-00048#20 add(e)
       WHERE xcchent = p_xcch.xcchent
         AND xcchld  = p_xcch.xcchld
         AND xcch001 = p_xcch.xcch001
         AND xcch002 = p_xcch.xcch002
         AND xcch003 = p_xcch.xcch003
         AND xcch004 = p_xcch.xcch004
         AND xcch005 = p_xcch.xcch005
         AND xcch006 = p_xcch.xcch006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xcch_t'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xcch.xcch001,p_xcch.xcch002,p_xcch.xcch004,p_xcch.xcch005,
                                  p_xcch.xcch006,'','','',p_xcch.xcch007,p_xcch.xcch008,p_xcch.xcch009,
                                  '',SQLCA.sqlcode,'','upd xcch_t')          
         RETURN r_success
      END IF
   END IF
#PGS-(D)-03080-----s
#PGS-(D)-03080-----e

   #PGS-(D)-03080-----s
   #PGS-(D)-03080-----e
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xcci_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xcci(p_xcci)
#                       RETURNING r_success
# Input parameter: p_xcci         xcci_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-07-22 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xcci(p_xcci)
#   DEFINE p_xcci       RECORD LIKE xcci_t.*  #161124-00048#20 mark
   DEFINE p_xcci        type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE p_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
#PGS-(D)-03080-----s
DEFINE l_sql    STRING
DEFINE l_count  LIKE type_t.num10
#PGS-(D)-03080-----e
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
        
   CALL s_axcp500_set_xcci_null_to_zero(p_xcci.*)
        RETURNING p_xcci.*
   
   CALL s_axcp500_sum_xcci(p_xcci.*)
        RETURNING p_xcci.*
        
#PGS-(D)-03080-----s
#PGS-(D)-03080-----e
#   INSERT INTO xcci_t VALUES(p_xcci.*)   #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xcci_t(xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,
                      xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,
                      xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,
                      xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,xcci202f,
                      xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,xcci302c,xcci302d,
                      xcci302e,xcci302f,xcci302g,xcci302h,xcci303,xcci304,xcci304a,xcci304b,
                      xcci304c,xcci304d,xcci304e,xcci304f,xcci304g,xcci304h,xcci901,xcci902,
                      xcci902a,xcci902b,xcci902c,xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,xccitime) 
               VALUES(p_xcci.xccient,p_xcci.xccicomp,p_xcci.xccild,p_xcci.xcci001,p_xcci.xcci002,p_xcci.xcci003,p_xcci.xcci004,p_xcci.xcci005,
                      p_xcci.xcci006,p_xcci.xcci007,p_xcci.xcci008,p_xcci.xcci009,p_xcci.xcci010,p_xcci.xcci101,p_xcci.xcci102,p_xcci.xcci102a,
                      p_xcci.xcci102b,p_xcci.xcci102c,p_xcci.xcci102d,p_xcci.xcci102e,p_xcci.xcci102f,p_xcci.xcci102g,p_xcci.xcci102h,
                      p_xcci.xcci201,p_xcci.xcci202,p_xcci.xcci202a,p_xcci.xcci202b,p_xcci.xcci202c,p_xcci.xcci202d,p_xcci.xcci202e,p_xcci.xcci202f,
                      p_xcci.xcci202g,p_xcci.xcci202h,p_xcci.xcci301,p_xcci.xcci302,p_xcci.xcci302a,p_xcci.xcci302b,p_xcci.xcci302c,p_xcci.xcci302d,
                      p_xcci.xcci302e,p_xcci.xcci302f,p_xcci.xcci302g,p_xcci.xcci302h,p_xcci.xcci303,p_xcci.xcci304,p_xcci.xcci304a,p_xcci.xcci304b,
                      p_xcci.xcci304c,p_xcci.xcci304d,p_xcci.xcci304e,p_xcci.xcci304f,p_xcci.xcci304g,p_xcci.xcci304h,p_xcci.xcci901,p_xcci.xcci902,
                      p_xcci.xcci902a,p_xcci.xcci902b,p_xcci.xcci902c,p_xcci.xcci902d,p_xcci.xcci902e,p_xcci.xcci902f,p_xcci.xcci902g,p_xcci.xcci902h,p_xcci.xccitime)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xcci_t'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xcci.xcci001,p_xcci.xcci002,p_xcci.xcci004,p_xcci.xcci005,
                               p_xcci.xcci006,'','','',p_xcci.xcci007,p_xcci.xcci008,p_xcci.xcci009,
                               '',SQLCA.sqlcode,'','ins xcci_t')      
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
#      UPDATE xcci_t SET xcci_t.* = p_xcci.*   #161124-00048#20 mark
      #161124-00048#20 add(s)
      UPDATE xcci_t SET (xccient,xccicomp,xccild,xcci001,xcci002,xcci003,xcci004,xcci005,
                         xcci006,xcci007,xcci008,xcci009,xcci010,xcci101,xcci102,xcci102a,
                         xcci102b,xcci102c,xcci102d,xcci102e,xcci102f,xcci102g,xcci102h,
                         xcci201,xcci202,xcci202a,xcci202b,xcci202c,xcci202d,xcci202e,xcci202f,
                         xcci202g,xcci202h,xcci301,xcci302,xcci302a,xcci302b,xcci302c,xcci302d,
                         xcci302e,xcci302f,xcci302g,xcci302h,xcci303,xcci304,xcci304a,xcci304b,
                         xcci304c,xcci304d,xcci304e,xcci304f,xcci304g,xcci304h,xcci901,xcci902,
                         xcci902a,xcci902b,xcci902c,xcci902d,xcci902e,xcci902f,xcci902g,xcci902h,
                         xccitime) 
                      = (p_xcci.xccient,p_xcci.xccicomp,p_xcci.xccild,p_xcci.xcci001,p_xcci.xcci002,p_xcci.xcci003,p_xcci.xcci004,p_xcci.xcci005,
                         p_xcci.xcci006,p_xcci.xcci007,p_xcci.xcci008,p_xcci.xcci009,p_xcci.xcci010,p_xcci.xcci101,p_xcci.xcci102,p_xcci.xcci102a,
                         p_xcci.xcci102b,p_xcci.xcci102c,p_xcci.xcci102d,p_xcci.xcci102e,p_xcci.xcci102f,p_xcci.xcci102g,p_xcci.xcci102h,
                         p_xcci.xcci201,p_xcci.xcci202,p_xcci.xcci202a,p_xcci.xcci202b,p_xcci.xcci202c,p_xcci.xcci202d,p_xcci.xcci202e,p_xcci.xcci202f,
                         p_xcci.xcci202g,p_xcci.xcci202h,p_xcci.xcci301,p_xcci.xcci302,p_xcci.xcci302a,p_xcci.xcci302b,p_xcci.xcci302c,p_xcci.xcci302d,
                         p_xcci.xcci302e,p_xcci.xcci302f,p_xcci.xcci302g,p_xcci.xcci302h,p_xcci.xcci303,p_xcci.xcci304,p_xcci.xcci304a,p_xcci.xcci304b,
                         p_xcci.xcci304c,p_xcci.xcci304d,p_xcci.xcci304e,p_xcci.xcci304f,p_xcci.xcci304g,p_xcci.xcci304h,p_xcci.xcci901,p_xcci.xcci902,
                         p_xcci.xcci902a,p_xcci.xcci902b,p_xcci.xcci902c,p_xcci.xcci902d,p_xcci.xcci902e,p_xcci.xcci902f,p_xcci.xcci902g,p_xcci.xcci902h,
                         p_xcci.xccitime)
      #161124-00048#20 add(e)
       WHERE xccient = p_xcci.xccient
         AND xccild  = p_xcci.xccild
         AND xcci001 = p_xcci.xcci001
         AND xcci002 = p_xcci.xcci002
         AND xcci003 = p_xcci.xcci003
         AND xcci004 = p_xcci.xcci004
         AND xcci005 = p_xcci.xcci005
         AND xcci006 = p_xcci.xcci006
         AND xcci007 = p_xcci.xcci007
         AND xcci008 = p_xcci.xcci008
         AND xcci009 = p_xcci.xcci009
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xcci_t'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xcci.xcci001,p_xcci.xcci002,p_xcci.xcci004,p_xcci.xcci005,
                                  p_xcci.xcci006,'','','',p_xcci.xcci007,p_xcci.xcci008,p_xcci.xcci009,
                                  '',SQLCA.sqlcode,'','upd xcci_t')               
         RETURN r_success
      END IF
   END IF
#PGS-(D)-03080-----s
#PGS-(D)-0e080-----e

   #PGS-(D)-03080-----s
   #PGS-(D)-03080-----e
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xcck_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xcck(p_xcck)
#                       RETURNING r_success
# Input parameter: p_xcck         xcck_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xcck(p_xcck)
   #DEFINE p_xcck       RECORD LIKE xcck_t.*
   DEFINE p_xcck       type_xcck  #mod zhangllc 151214 比原来多了xccktmp1 库存管理特征
   DEFINE r_success    LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE

#   INSERT INTO xcck_tmp VALUES(p_xcck.*)
   #161124-00048#20 add(s)
   INSERT INTO xcck_tmp(xcckent,xccksite,xcckcomp,xcckld,xcck001,xcck002,xcck003,xcck004,xcck005,
                        xcck006,xcck007,xcck008,xcck009,xcck010,xcck011,xcck012,xcck013,xcck014,
                        xcck015,xcck016,xcck017,xcck020,xcck021,xcck022,xcck023,xcck024,xcck025,
                        xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032,xcck033,xcck034,
                        xcck040,xcck041,xcck042,xcck043,xcck044,xcck045,xcck046,xcck047,xcck048,
                        xcck049,xcck050,xcck051,xcck055,xcck201,xcck202,xcck202a,xcck202b,xcck202c,
                        xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,xcck282,xcck282a,xcck282b,
                        xcck282c,xcck282d,xcck282e,xcck282f,xcck282g,xcck282h,xcck301,xcck302,
                        xcck302a,xcck302b,xcck302c,xcck302d,xcck302e,xcck302f,xcck302g,xcck302h,
                        xcck901,xcck902,xcck902a,xcck902b,xcck902c,xcck902d,xcck902e,xcck902f,
                        xcck902g,xcck902h,xcck980,xcck980a,xcck980b,xcck980c,xcck980d,xcck980e,
                        xcck980f,xcck980g,xcck980h,xcck903,xcck903a,xcck903b,xcck903c,xcck903d,
                        xcck903e,xcck903f,xcck903g,xcck903h,xcckownid,xcckowndp,xcckcrtid,xcckcrtdp,
                        xcckcrtdt,xcckmodid,xcckmoddt,xcckstus,xcck056,xccktmp1)    #180424-00058#1 add xccktmp1
                 VALUES(p_xcck.xcckent,p_xcck.xccksite,p_xcck.xcckcomp,p_xcck.xcckld,p_xcck.xcck001,p_xcck.xcck002,p_xcck.xcck003,p_xcck.xcck004,p_xcck.xcck005,
                        p_xcck.xcck006,p_xcck.xcck007,p_xcck.xcck008,p_xcck.xcck009,p_xcck.xcck010,p_xcck.xcck011,p_xcck.xcck012,p_xcck.xcck013,p_xcck.xcck014,
                        p_xcck.xcck015,p_xcck.xcck016,p_xcck.xcck017,p_xcck.xcck020,p_xcck.xcck021,p_xcck.xcck022,p_xcck.xcck023,p_xcck.xcck024,p_xcck.xcck025,
                        p_xcck.xcck026,p_xcck.xcck027,p_xcck.xcck028,p_xcck.xcck029,p_xcck.xcck030,p_xcck.xcck031,p_xcck.xcck032,p_xcck.xcck033,p_xcck.xcck034,
                        p_xcck.xcck040,p_xcck.xcck041,p_xcck.xcck042,p_xcck.xcck043,p_xcck.xcck044,p_xcck.xcck045,p_xcck.xcck046,p_xcck.xcck047,p_xcck.xcck048,
                        p_xcck.xcck049,p_xcck.xcck050,p_xcck.xcck051,p_xcck.xcck055,p_xcck.xcck201,p_xcck.xcck202,p_xcck.xcck202a,p_xcck.xcck202b,p_xcck.xcck202c,
                        p_xcck.xcck202d,p_xcck.xcck202e,p_xcck.xcck202f,p_xcck.xcck202g,p_xcck.xcck202h,p_xcck.xcck282,p_xcck.xcck282a,p_xcck.xcck282b,
                        p_xcck.xcck282c,p_xcck.xcck282d,p_xcck.xcck282e,p_xcck.xcck282f,p_xcck.xcck282g,p_xcck.xcck282h,p_xcck.xcck301,p_xcck.xcck302,
                        p_xcck.xcck302a,p_xcck.xcck302b,p_xcck.xcck302c,p_xcck.xcck302d,p_xcck.xcck302e,p_xcck.xcck302f,p_xcck.xcck302g,p_xcck.xcck302h,
                        p_xcck.xcck901,p_xcck.xcck902,p_xcck.xcck902a,p_xcck.xcck902b,p_xcck.xcck902c,p_xcck.xcck902d,p_xcck.xcck902e,p_xcck.xcck902f,
                        p_xcck.xcck902g,p_xcck.xcck902h,p_xcck.xcck980,p_xcck.xcck980a,p_xcck.xcck980b,p_xcck.xcck980c,p_xcck.xcck980d,p_xcck.xcck980e,
                        p_xcck.xcck980f,p_xcck.xcck980g,p_xcck.xcck980h,p_xcck.xcck903,p_xcck.xcck903a,p_xcck.xcck903b,p_xcck.xcck903c,p_xcck.xcck903d,
                        p_xcck.xcck903e,p_xcck.xcck903f,p_xcck.xcck903g,p_xcck.xcck903h,p_xcck.xcckownid,p_xcck.xcckowndp,p_xcck.xcckcrtid,p_xcck.xcckcrtdp,
                        p_xcck.xcckcrtdt,p_xcck.xcckmodid,p_xcck.xcckmoddt,p_xcck.xcckstus,p_xcck.xcck056,p_xcck.xccktmp1)  #180424-00058#1 add xccktmp1
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xcck_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xcck.xcck001,p_xcck.xcck002,p_xcck.xcck004,p_xcck.xcck005,
                               p_xcck.xcck006,p_xcck.xcck007,p_xcck.xcck008,p_xcck.xcck009,
                               p_xcck.xcck010,p_xcck.xcck011,p_xcck.xcck017,
                               '',SQLCA.sqlcode,'','ins xcck_tmp')      
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p24 USING 
                        p_xcck.xcck010 ,p_xcck.xcck011 ,p_xcck.xcck012 ,p_xcck.xcck013 ,p_xcck.xcck014 ,
                        p_xcck.xcck015 ,p_xcck.xcck016 ,p_xcck.xcck017 ,p_xcck.xcck020 ,p_xcck.xcck021 ,
                        p_xcck.xcck022 ,p_xcck.xcck023 ,p_xcck.xcck024 ,p_xcck.xcck025 ,p_xcck.xcck026 ,
                        p_xcck.xcck027 ,p_xcck.xcck028 ,p_xcck.xcck029 ,p_xcck.xcck030 ,p_xcck.xcck031 ,
                        p_xcck.xcck032 ,p_xcck.xcck033 ,p_xcck.xcck034 ,p_xcck.xcck040 ,p_xcck.xcck041 ,
                        p_xcck.xcck042 ,p_xcck.xcck043 ,p_xcck.xcck044 ,p_xcck.xcck045 ,p_xcck.xcck046 ,
                        p_xcck.xcck047 ,p_xcck.xcck048 ,p_xcck.xcck049 ,p_xcck.xcck050 ,p_xcck.xcck051 ,
                        p_xcck.xcck055 ,p_xcck.xcck201 ,p_xcck.xcck202 ,p_xcck.xcck202a,p_xcck.xcck202b,
                        p_xcck.xcck202c,p_xcck.xcck202d,p_xcck.xcck202e,p_xcck.xcck202f,p_xcck.xcck202g,
                        p_xcck.xcck202h,p_xcck.xcck282 ,p_xcck.xcck282a,p_xcck.xcck282b,p_xcck.xcck282c,
                        p_xcck.xcck282d,p_xcck.xcck282e,p_xcck.xcck282f,p_xcck.xcck282g,p_xcck.xcck282h,
                        p_xcck.xcck301 ,p_xcck.xcck302 ,p_xcck.xcck302a,p_xcck.xcck302b,p_xcck.xcck302c,
                        p_xcck.xcck302d,p_xcck.xcck302e,p_xcck.xcck302f,p_xcck.xcck302g,p_xcck.xcck302h,
                        p_xcck.xcck901 ,p_xcck.xcck902 ,p_xcck.xcck902a,p_xcck.xcck902b,p_xcck.xcck902c,
                        p_xcck.xcck902d,p_xcck.xcck902e,p_xcck.xcck902f,p_xcck.xcck902g,p_xcck.xcck902h,
                        p_xcck.xcck980 ,p_xcck.xcck980a,p_xcck.xcck980b,p_xcck.xcck980c,p_xcck.xcck980d,
                        p_xcck.xcck980e,p_xcck.xcck980f,p_xcck.xcck980g,p_xcck.xcck980h,p_xcck.xcck903 ,
                        p_xcck.xcck903a,p_xcck.xcck903b,p_xcck.xcck903c,p_xcck.xcck903d,p_xcck.xcck903e,
                        p_xcck.xcck903f,p_xcck.xcck903g,p_xcck.xcck903h,
                        p_xcck.xccktmp1,  #mod zhangllc 151214 add xccktmp1
                        p_xcck.xcckent, p_xcck.xcckld ,
                        p_xcck.xcck001, p_xcck.xcck002, p_xcck.xcck003, p_xcck.xcck004, p_xcck.xcck005,
                        p_xcck.xcck006, p_xcck.xcck007, p_xcck.xcck008, p_xcck.xcck009

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xcck_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xcck.xcck001,p_xcck.xcck002,p_xcck.xcck004,p_xcck.xcck005,
                                  p_xcck.xcck006,p_xcck.xcck007,p_xcck.xcck008,p_xcck.xcck009,
                                  p_xcck.xcck010,p_xcck.xcck011,p_xcck.xcck017,
                                  '',SQLCA.sqlcode,'','upd xcck_tmp')            
         RETURN r_success
      END IF
   END IF
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccn_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccn(p_xccn)
#                       RETURNING r_success
# Input parameter: p_xccn         xccn_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-09-29 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccn(p_xccn)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xccn       RECORD LIKE xccn_t.*  #161124-00048#20 mark
   DEFINE p_xccn           type_g_xccn  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE p_xccn RECORD  #本期在製轉出成本與工單入庫標準成本差異檔
   #    xccnent LIKE xccn_t.xccnent, #企业编号
   #    xccncomp LIKE xccn_t.xccncomp, #法人
   #    xccnld LIKE xccn_t.xccnld, #账套
   #    xccn001 LIKE xccn_t.xccn001, #账套本位币顺序
   #    xccn002 LIKE xccn_t.xccn002, #成本域
   #    xccn003 LIKE xccn_t.xccn003, #成本计算类型
   #    xccn004 LIKE xccn_t.xccn004, #年度
   #    xccn005 LIKE xccn_t.xccn005, #期别
   #    xccn006 LIKE xccn_t.xccn006, #工单编号
   #    xccn102 LIKE xccn_t.xccn102, #在制转出金额
   #    xccn102a LIKE xccn_t.xccn102a, #在制转出金额-材料
   #    xccn102b LIKE xccn_t.xccn102b, #在制转出金额-人工
   #    xccn102c LIKE xccn_t.xccn102c, #在制转出金额-委外
   #    xccn102d LIKE xccn_t.xccn102d, #在制转出金额-制费一
   #    xccn102e LIKE xccn_t.xccn102e, #在制转出金额-制费二
   #    xccn102f LIKE xccn_t.xccn102f, #在制转出金额-制费三
   #    xccn102g LIKE xccn_t.xccn102g, #在制转出金额-制费四
   #    xccn102h LIKE xccn_t.xccn102h, #在制转出金额-制费五
   #    xccn202 LIKE xccn_t.xccn202, #入库标准成本金额
   #    xccn202a LIKE xccn_t.xccn202a, #入库标准成本金额-材料
   #    xccn202b LIKE xccn_t.xccn202b, #入库标准成本金额-人工
   #    xccn202c LIKE xccn_t.xccn202c, #入库标准成本金额-委外
   #    xccn202d LIKE xccn_t.xccn202d, #入库标准成本金额-制费一
   #    xccn202e LIKE xccn_t.xccn202e, #入库标准成本金额-制费二
   #    xccn202f LIKE xccn_t.xccn202f, #入库标准成本金额-制费三
   #    xccn202g LIKE xccn_t.xccn202g, #入库标准成本金额-制费四
   #    xccn202h LIKE xccn_t.xccn202h, #入库标准成本金额-制费五
   #    xccn302 LIKE xccn_t.xccn302, #差异金额
   #    xccn302a LIKE xccn_t.xccn302a, #差异金额-材料
   #    xccn302b LIKE xccn_t.xccn302b, #差异金额-人工
   #    xccn302c LIKE xccn_t.xccn302c, #差异金额-加工费
   #    xccn302d LIKE xccn_t.xccn302d, #差异金额-制费一
   #    xccn302e LIKE xccn_t.xccn302e, #差异金额-制费二
   #    xccn302f LIKE xccn_t.xccn302f, #差异金额-制费三
   #    xccn302g LIKE xccn_t.xccn302g, #差异金额-制费四
   #    xccn302h LIKE xccn_t.xccn302h  #差异金额-制费五
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   
   CALL s_axcp500_set_xccn_null_to_zero(p_xccn.*)
        RETURNING p_xccn.*

#   INSERT INTO xccn_t VALUES(p_xccn.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccn_t(xccnent,xccncomp,xccnld,xccn001,xccn002,xccn003,xccn004,xccn005,
                      xccn006,xccn102,xccn102a,xccn102b,xccn102c,xccn102d,xccn102e,
                      xccn102f,xccn102g,xccn102h,xccn202,xccn202a,xccn202b,xccn202c,
                      xccn202d,xccn202e,xccn202f,xccn202g,xccn202h,xccn302,xccn302a,
                      xccn302b,xccn302c,xccn302d,xccn302e,xccn302f,xccn302g,xccn302h) 
               VALUES(p_xccn.xccnent,p_xccn.xccncomp,p_xccn.xccnld,p_xccn.xccn001,p_xccn.xccn002,p_xccn.xccn003,p_xccn.xccn004,p_xccn.xccn005,
                      p_xccn.xccn006,p_xccn.xccn102,p_xccn.xccn102a,p_xccn.xccn102b,p_xccn.xccn102c,p_xccn.xccn102d,p_xccn.xccn102e,
                      p_xccn.xccn102f,p_xccn.xccn102g,p_xccn.xccn102h,p_xccn.xccn202,p_xccn.xccn202a,p_xccn.xccn202b,p_xccn.xccn202c,
                      p_xccn.xccn202d,p_xccn.xccn202e,p_xccn.xccn202f,p_xccn.xccn202g,p_xccn.xccn202h,p_xccn.xccn302,p_xccn.xccn302a,
                      p_xccn.xccn302b,p_xccn.xccn302c,p_xccn.xccn302d,p_xccn.xccn302e,p_xccn.xccn302f,p_xccn.xccn302g,p_xccn.xccn302h)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccn_t'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xccn.xccn001,p_xccn.xccn002,p_xccn.xccn004,p_xccn.xccn005,
                               p_xccn.xccn006,'','','','','','','',
                               SQLCA.sqlcode,'','ins xccn_t')
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
#      UPDATE xccn_t SET xccn_t.* = p_xccn.*  #161124-00048#20 mark
      #161124-00048#20 add(s)
      UPDATE xccn_t SET (xccnent,xccncomp,xccnld,xccn001,xccn002,xccn003,xccn004,xccn005,
                         xccn006,xccn102,xccn102a,xccn102b,xccn102c,xccn102d,xccn102e,
                         xccn102f,xccn102g,xccn102h,xccn202,xccn202a,xccn202b,xccn202c,
                         xccn202d,xccn202e,xccn202f,xccn202g,xccn202h,xccn302,xccn302a,
                         xccn302b,xccn302c,xccn302d,xccn302e,xccn302f,xccn302g,xccn302h)
                     =  (p_xccn.xccnent,p_xccn.xccncomp,p_xccn.xccnld,p_xccn.xccn001,p_xccn.xccn002,p_xccn.xccn003,p_xccn.xccn004,p_xccn.xccn005,
                         p_xccn.xccn006,p_xccn.xccn102,p_xccn.xccn102a,p_xccn.xccn102b,p_xccn.xccn102c,p_xccn.xccn102d,p_xccn.xccn102e,
                         p_xccn.xccn102f,p_xccn.xccn102g,p_xccn.xccn102h,p_xccn.xccn202,p_xccn.xccn202a,p_xccn.xccn202b,p_xccn.xccn202c,
                         p_xccn.xccn202d,p_xccn.xccn202e,p_xccn.xccn202f,p_xccn.xccn202g,p_xccn.xccn202h,p_xccn.xccn302,p_xccn.xccn302a,
                         p_xccn.xccn302b,p_xccn.xccn302c,p_xccn.xccn302d,p_xccn.xccn302e,p_xccn.xccn302f,p_xccn.xccn302g,p_xccn.xccn302h)
      #161124-00048#20 add(e)
       WHERE xccnent = p_xccn.xccnent
         AND xccnld  = p_xccn.xccnld
         AND xccn001 = p_xccn.xccn001
         AND xccn002 = p_xccn.xccn002
         AND xccn003 = p_xccn.xccn003
         AND xccn004 = p_xccn.xccn004
         AND xccn005 = p_xccn.xccn005
         AND xccn006 = p_xccn.xccn006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccn_t'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccn.xccn001,p_xccn.xccn002,p_xccn.xccn004,p_xccn.xccn005,
                                  p_xccn.xccn006,'','','','','','','',
                                  SQLCA.sqlcode,'','upd xccn_t')
         RETURN r_success
      END IF
   END IF
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增/更新xccz_t表的资料
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xccz(p_xccz)
#                       RETURNING r_success
# Input parameter: p_xccz         xccz_t的资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xccz(p_xccz)
   DEFINE p_seq        LIKE type_t.num5
#   DEFINE p_xccz       RECORD LIKE xccz_t.* #161124-00048#20 mark
   DEFINE p_xccz        type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE p_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE r_success    LIKE type_t.num5
   DEFINE l_count      LIKE type_t.num10  #PGS(D)-08172 memo add
   
   WHENEVER ERROR CONTINUE

   LET r_success = FALSE
   CALL s_axcp500_set_xccz_null_to_zero(p_xccz.*)
        RETURNING p_xccz.*
   
   CALL s_axcp500_sum_xccz(p_xccz.*)
        RETURNING p_xccz.*
        
#   INSERT INTO xccz_tmp VALUES(p_xccz.*)  #161124-00048#20 mark
   #161124-00048#20 add(s)
   INSERT INTO xccz_tmp(xcczent,xcczcomp,xcczld,xccz001,xccz002,xccz003,xccz004,xccz005,
                        xccz006,xccz007,xccz008,xccz009,xccz010,xccz011,xccz101,xccz201,
                        xccz205,xccz207,xccz209,xccz301,xccz303,xccz307,xccz901) 
                VALUES(p_xccz.xcczent,p_xccz.xcczcomp,p_xccz.xcczld,p_xccz.xccz001,p_xccz.xccz002,p_xccz.xccz003,p_xccz.xccz004,p_xccz.xccz005,
                        p_xccz.xccz006,p_xccz.xccz007,p_xccz.xccz008,p_xccz.xccz009,p_xccz.xccz010,p_xccz.xccz011,p_xccz.xccz101,p_xccz.xccz201,
                        p_xccz.xccz205,p_xccz.xccz207,p_xccz.xccz209,p_xccz.xccz301,p_xccz.xccz303,p_xccz.xccz307,p_xccz.xccz901)
   #161124-00048#20 add(e)
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'ins xccz_tmp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(p_xccz.xccz001,p_xccz.xccz002,p_xccz.xccz004,p_xccz.xccz005,
                               p_xccz.xccz006,'','','',p_xccz.xccz007,p_xccz.xccz008,p_xccz.xccz009,
                               '',SQLCA.sqlcode,'','ins xccz_tmp')      
      RETURN r_success
   END IF
   
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN
      EXECUTE s_axcp500_def_cursor_p30 USING 
              p_xccz.xccz101 , p_xccz.xccz201 , p_xccz.xccz205 , p_xccz.xccz207 , p_xccz.xccz209,
              p_xccz.xccz301 , p_xccz.xccz303 , p_xccz.xccz307 , p_xccz.xccz901 , 
              p_xccz.xcczent , p_xccz.xcczld  , p_xccz.xccz001 , p_xccz.xccz002 , p_xccz.xccz003 ,
              p_xccz.xccz004 , p_xccz.xccz005 , p_xccz.xccz006 , p_xccz.xccz007 , p_xccz.xccz008 ,
              p_xccz.xccz009 , p_xccz.xccz010 , p_xccz.xccz011 

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'upd xccz_tmp'
         LET g_errparam.popup = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(p_xccz.xccz001,p_xccz.xccz002,p_xccz.xccz004,p_xccz.xccz005,
                                  '','','','',
                                  p_xccz.xccz007,p_xccz.xccz008,p_xccz.xccz009,
                                  '',SQLCA.sqlcode,'','upd xccz_tmp')            
         RETURN r_success
      END IF
   END IF
   #PGS(D)-08172 memo -S- add
   #PGS(D)-08172 memo -E- add
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 取料件进出补成本档--异动单价
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccw282(p_seq,p_xccw002,p_xccw006,p_xccw007,p_xccw008,p_xccw009)
#                       RETURNING r_sum
# Input parameter: p_seq          记帐本位币顺序
#                : p_xccw002      成本域
#                : p_xccw006      参考单号
#                : p_xccw007      项次
#                : p_xccw008      项序
#                : p_xccw009      出入库码
# Return code....: r_sum          成本金额
# Date & Author..: 2014-07-31 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccw282(p_seq,p_xccw002,p_xccw006,p_xccw007,p_xccw008,p_xccw009)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_xccw002       LIKE xccc_t.xccc002
   DEFINE p_xccw006       LIKE inaj_t.inaj001
   DEFINE p_xccw007       LIKE inaj_t.inaj002
   DEFINE p_xccw008       LIKE inaj_t.inaj003
   DEFINE p_xccw009       LIKE inaj_t.inaj004
   DEFINE r_sum           RECORD
                          tot  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD  
                          
   WHENEVER ERROR CONTINUE
   SELECT SUM(xccw282),SUM(xccw282a),SUM(xccw282b),SUM(xccw282c),SUM(xccw282d),
                       SUM(xccw282e),SUM(xccw282f),SUM(xccw282g),SUM(xccw282h)
     INTO r_sum.tot,r_sum.a,r_sum.b,r_sum.c,r_sum.d,
                    r_sum.e,r_sum.f,r_sum.g,r_sum.h
     FROM xccw_t
    WHERE xccwent = g_enterprise
      AND xccwld  = g_ld
      AND xccw001 = p_seq
      AND xccw002 = p_xccw002
      AND xccw003 = g_xcat001
      AND xccw004 = g_yy
      AND xccw005 = g_pp
      AND xccw006 = p_xccw006
      AND xccw007 = p_xccw007
      AND xccw008 = p_xccw008
      AND xccw009 = p_xccw009

   IF cl_null(r_sum.a) THEN LET r_sum.a = 0 END IF
   IF cl_null(r_sum.b) THEN LET r_sum.b = 0 END IF
   IF cl_null(r_sum.c) THEN LET r_sum.c = 0 END IF
   IF cl_null(r_sum.d) THEN LET r_sum.d = 0 END IF
   IF cl_null(r_sum.e) THEN LET r_sum.e = 0 END IF
   IF cl_null(r_sum.f) THEN LET r_sum.f = 0 END IF
   IF cl_null(r_sum.g) THEN LET r_sum.g = 0 END IF
   IF cl_null(r_sum.h) THEN LET r_sum.h = 0 END IF
#   IF cl_null(r_sum.a) THEN LET r_sum.a = 1 END IF
#   IF cl_null(r_sum.b) THEN LET r_sum.b = 2 END IF
#   IF cl_null(r_sum.c) THEN LET r_sum.c = 3 END IF
#   IF cl_null(r_sum.d) THEN LET r_sum.d = 4 END IF
#   IF cl_null(r_sum.e) THEN LET r_sum.e = 5 END IF
#   IF cl_null(r_sum.f) THEN LET r_sum.f = 6 END IF
#   IF cl_null(r_sum.g) THEN LET r_sum.g = 7 END IF
#   IF cl_null(r_sum.h) THEN LET r_sum.h = 8 END IF
   LET r_sum.tot = r_sum.a + r_sum.b + r_sum.c + r_sum.d + 
                   r_sum.e + r_sum.f + r_sum.g + r_sum.h
   RETURN r_sum.*           
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算-主件工时及入库数量计算
# Memo...........:
# Usage..........: CALL s_axcp500_wip_1(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_site         工单SITE
#                : p_xcck047      工单单号
#                : p_xcck048      重复性生产-计划编号
#                : p_xcck049      重复性生产-生产料号
#                : p_xcck050      重复性生产-生产BOM特性
#                : p_xcck051      重复性生产-生产料号产品特征
#                : p_sfaa010      主件编号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-04 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_1(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_site          LIKE sfaa_t.sfaasite
   DEFINE p_xcck047       LIKE xcck_t.xcck047
   DEFINE p_xcck048       LIKE xcck_t.xcck048
   DEFINE p_xcck049       LIKE xcck_t.xcck049
   DEFINE p_xcck050       LIKE xcck_t.xcck050
   DEFINE p_xcck051       LIKE xcck_t.xcck051
   DEFINE p_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xccd       RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE l_xccd          type_g_xccd  #170605-00013#1-add 
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_set1          LIKE type_t.num26_10
   DEFINE l_set2          LIKE type_t.num26_10
   DEFINE l_date          LIKE type_t.dat
   DEFINE l_cnt           LIKE type_t.num5
   DEFINE l_sfaa013       LIKE sfaa_t.sfaa013
   DEFINE l_sfaa012       LIKE sfaa_t.sfaa012
   DEFINE l_cost_unit     LIKE imag_t.imag014
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
   CALL s_axcp500_get_xccd(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
        RETURNING l_xccd.*

   #本期投入工時
   CALL s_axcp500_get_xccd200(p_xcck047)                   #工时统计
        RETURNING l_xccd.xccd200
   
   #本期完工数量
   CALL s_axcp500_get_xccd301(p_xcck047,l_xccd.xccd007)    #本期转出数量    
        RETURNING l_xccd.xccd301
   
   #本期材料投入套数
   SELECT xcbg004 * xcbg006 INTO l_xccd.xccd201 
     FROM xcbg_t
    WHERE xcbgent  = g_enterprise
      AND xcbgcomp = g_comp
      AND xcbg001  = g_yy
      AND xcbg002  = g_pp
      AND xcbg003  = l_xccd.xccd006
   
   IF cl_null(l_xccd.xccd201) THEN LET l_xccd.xccd201 = 0 END IF

   IF l_xccd.xccd201 < l_xccd.xccd301 * -1 THEN
      LET l_xccd.xccd201 = l_xccd.xccd301 * -1
   END IF

#   IF l_xccd.xccd012 = 'N' THEN
#      SELECT sfaa012,sfaa013 INTO l_sfaa012,l_sfaa013 FROM sfaa_tmp
#       WHERE sfaaent   = g_enterprise
#         AND sfaadocno = l_xccd.xccd006   
#   
#      CALL s_axcp500_get_cost_unit(p_sfaa010)
#           RETURNING l_cost_unit
#      #主件本期投入数量为本期投入的套数
#      CALL s_asft340_full_sets(l_xccd.xccd006,' ',' ',g_edate)
#            RETURNING l_success,l_set1
#            
#      LET l_date = g_bdate -1
#      CALL s_asft340_full_sets(l_xccd.xccd006,' ',' ',l_date)
#            RETURNING l_success,l_set2
#   
#      #套数为截止本期末的套数-期初的套数
#      LET l_xccd.xccd201 = l_set1 - l_set2 
#      
#      IF l_xccd.xccd201 = 0 THEN  #若备料均是倒扣料,则套数算不到
#         SELECT COUNT(*) INTO l_cnt FROM sfba_tmp
#          WHERE sfbaent = g_enterprise
#            AND sfbadocno = l_xccd.xccd006
#            AND sfba009 <> 'Y'
#            AND (sfba013 - sfba015 ) > 0
#         IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
#         IF l_cnt = 0 THEN
#            LET l_xccd.xccd201 = l_sfaa012
#         END IF
#      END IF      
#      
#      #工单的生产单位和成本单位不一致时
#      IF l_cost_unit <> l_sfaa013 THEN
#         CALL s_aooi250_convert_qty(p_sfaa010,l_sfaa013,l_cost_unit,l_xccd.xccd201)
#              RETURNING l_success,l_xccd.xccd201 
#         IF NOT l_success THEN
#
#         END IF
#      END IF
#      
#   ELSE
#   
#   
#   END IF

   CALL s_axcp500_ins_or_upd_xccd(l_xccd.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET g_stat_cnt1 = g_stat_cnt1 + 1
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(8,g_stat_begin1,g_stat_end1,g_stat_cnt1)  


   LET g_xccd.* = l_xccd.*
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算-取工单的工时投入
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccd200(p_xcbi002)
#                       RETURNING r_xcbi201
# Input parameter: p_xcbi002      工单单号
# Return code....: r_xcbi201      实际工时
# Date & Author..: 2014-08-04 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccd200(p_xcbi002)
   DEFINE p_xcbi002       LIKE xcbi_t.xcbi002
   DEFINE r_xcbi201       LIKE xcbi_t.xcbi201
   
   WHENEVER ERROR CONTINUE
   LET r_xcbi201 = 0
   SELECT SUM(xcbi201) INTO r_xcbi201 FROM xcbh_t,xcbi_t
    WHERE xcbhent   = xcbient AND xcbient = g_enterprise
      AND xcbhdocno = xcbidocno
      AND xcbh001   BETWEEN g_bdate AND g_edate
      AND xcbi002   = p_xcbi002         #工单
      AND xcbhstus  = 'Y'
      
   IF cl_null(r_xcbi201) THEN LET r_xcbi201 = 0 END IF
   
   RETURN r_xcbi201  
END FUNCTION

################################################################################
# Descriptions...: 工单在制计算 - 主件入库数量
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccd301(p_inaj020,p_imaa001)
#                       RETURNING r_xccd301
# Input parameter: p_inaj020      工单单号
#                : p_imaa001      料件编号
# Return code....: r_xccd301      主件入库数量
# Date & Author..: 2014-08-04 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccd301(p_inaj020,p_imaa001)
   DEFINE p_inaj020       LIKE inaj_t.inaj020      #工单单号
   DEFINE p_imaa001       LIKE imaa_t.imaa001
   DEFINE r_xccd301       LIKE xccd_t.xccd301
   DEFINE l_inajsite      LIKE inaj_t.inajsite
   DEFINE l_inaj005       LIKE inaj_t.inaj005
   DEFINE l_inaj036       LIKE inaj_t.inaj036
   DEFINE l_inaj004       LIKE inaj_t.inaj004
   DEFINE l_qty           LIKE xccd_t.xccd301
   DEFINE l_tot           LIKE xccd_t.xccd301
   DEFINE l_xcbp006       LIKE xcbp_t.xcbp006
   
   WHENEVER ERROR CONTINUE
   #联产品分配方式
   LET l_tot = 0

   #IF g_sys_6009 = '1' THEN   
   IF g_sys_6009 = '1' OR g_sys_6017 = 'N' THEN   #mod zhangllc 150717 聯產品入庫折算在制轉出數量不按分配率計算,那么在制转出数量在计算时联产品的转出数量不需要乘以分配率              
      #SELECT nvl(SUM(inaj011*inaj014 * -1),0)  #160518-00033#2 mark
      #SELECT nvl(SUM(inaj011*inaj048/ inaj049 * -1),0)  #160518-00033#2 add  #170705-00006#1 mark
      SELECT nvl(SUM(CASE inaj049 WHEN 0 THEN 0 ELSE inaj011*inaj048/ inaj049 * -1 END),0)  #170705-00006#1 add
        INTO l_tot
        FROM inaj_tmp
       WHERE inajent = g_enterprise
         AND inaj020 = p_inaj020
         AND inaj036 IN ('110','111','112','113','103','104','105','106')
         AND inaj022 BETWEEN g_bdate AND g_edate
   ELSE
      #SELECT SUM(inaj011*inaj014 * nvl(xcbp006,100) / 100 * -1)  #160518-00033#2 mark
      #SELECT SUM(inaj011*inaj048/ inaj049 * nvl(xcbp006,100) / 100 * -1)  #160518-00033#2 add  #170705-00006#1 mark
      SELECT SUM(CASE inaj049 * nvl(xcbp006,100) WHEN 0 THEN 0 ELSE inaj011*inaj048/ inaj049 * nvl(xcbp006,100) / 100 * -1 END)  #170705-00006#1 add
        INTO l_tot
        FROM inaj_tmp LEFT OUTER JOIN xcbp_t
                                   ON xcbpent  = inajent
                                  AND xcbpsite = inajsite
                                  AND xcbp001  = g_yy
                                  AND xcbp002  = g_pp
                                  AND xcbp003  = p_imaa001
                                  AND xcbp004  = inaj005        
       WHERE inajent = g_enterprise
         AND inaj020 = p_inaj020
         AND inaj036 IN ('110','111','112','113','103','104','105','106')
         AND inaj022 BETWEEN g_bdate AND g_edate
   END IF    
   IF cl_null(l_tot) THEN LET l_tot = 0 END IF
 
   LET r_xccd301 = l_tot
   RETURN r_xccd301
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 元件投入
# Memo...........: 此FUNCTION已废，虽有被s_axcp500_avg&s_axcp500_std调用，但调用处也已经不被使用
# Usage..........: CALL s_axcp500_wip_2() 
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-05 By Carrier
# Modify.........: 
################################################################################
PUBLIC FUNCTION s_axcp500_wip_2()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #STEP -1 结转上期的xcce资料至本期
   CALL s_axcp500_wip_2_1()
        RETURNING l_success   
   IF NOT l_success THEN
#      RETURN r_success
   END IF
   
   #STEP -2 取当期的发退料元件成本
   CALL s_axcp500_wip_2_2()
        RETURNING l_success   
   IF NOT l_success THEN
#      RETURN r_success
   END IF
   
   #STEP -3 取当期的人工/加工/制费
   CALL s_axcp500_wip_2_3()
        RETURNING l_success   
   IF NOT l_success THEN
#      RETURN r_success
   END IF

   #STEP -4 取当期的在制成本调整
   CALL s_axcp500_wip_2_4()
        RETURNING l_success   
   IF NOT l_success THEN
#      RETURN r_success
   END IF
               
   LET r_success = TRUE   
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 结转元件上期成本
# Memo...........:
# Usage..........: CALL s_axcp500_wip_2_1()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成本否标识符
# Date & Author..: 2014-08-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_2_1()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcce          RECORD LIKE xcce_t.*   #161124-00048#20 mark
#   DEFINE l_t_xcce        RECORD LIKE xcce_t.*   #161124-00048#20 mark
   DEFINE l_xcce           type_g_xcce  #170605-00013#1-add
   DEFINE l_t_xcce         type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_t_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME   
   FOREACH s_axcp500_wip_2_1_cs1 USING g_xccd.xccd001,g_xccd.xccd003,
                                       g_last_yy,g_last_pp,g_xccd.xccd006
                                  INTO l_t_xcce.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_1_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','',g_last_yy,g_last_pp,g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_2_1_cs1')
         CONTINUE FOREACH
      END IF 
      
      CALL s_axcp500_get_xcce(g_xccd.xccd001,l_t_xcce.xcce002,g_xccd.xccd006,l_t_xcce.xcce007,l_t_xcce.xcce008,l_t_xcce.xcce009)
           RETURNING l_xcce.* 
           
      CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
      LET g_stat_cnt1 = g_stat_cnt1 + 1
      
   END FOREACH                                  
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(9,g_stat_begin1,g_stat_end1,g_stat_cnt1)  
   
   LET r_success = TRUE                                   
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 下阶料投入(发料/退料等)
# Memo...........: 此FUNCTION已废，虽有被s_axcp500_avg&s_axcp500_std调用，但调用处也已经不被使用
# Usage..........: CALL s_axcp500_wip_2_2()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_2_2()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_xcce          RECORD LIKE xcce_t.* #161124-00048#20 mark
   DEFINE l_xcce           type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_inaj          RECORD 
                          inaj005     LIKE inaj_t.inaj005,
                          inaj006     LIKE inaj_t.inaj006,
                          inaj010     LIKE inaj_t.inaj010,
                          inaj015     LIKE inaj_t.inaj015,
                          inaj036     LIKE inaj_t.inaj036,
                          qty         LIKE inaj_t.inaj011,
                          xcce002     LIKE xcce_t.xcce002
                          END RECORD
   DEFINE l_sum1          type_get_cost_rec
   DEFINE l_sum2          type_get_cost_rec
   DEFINE l_avg           type_g_std_cost
   DEFINE l_choice        LIKE type_t.chr10
   DEFINE l_avg1          RECORD
                          tot  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD  
#   DEFINE l_inaj_t        RECORD LIKE inaj_t.*  #161124-00048#20 mark
#161124-00048#20 add(s)
DEFINE l_inaj_t RECORD  #庫存交易明細檔
       inajent LIKE inaj_t.inajent, #企业编号
       inajsite LIKE inaj_t.inajsite, #营运据点
       inaj001 LIKE inaj_t.inaj001, #单据编号
       inaj002 LIKE inaj_t.inaj002, #项次
       inaj003 LIKE inaj_t.inaj003, #项序
       inaj004 LIKE inaj_t.inaj004, #出入库码
       inaj005 LIKE inaj_t.inaj005, #料件编号
       inaj006 LIKE inaj_t.inaj006, #产品特征
       inaj007 LIKE inaj_t.inaj007, #库存管理特征
       inaj008 LIKE inaj_t.inaj008, #库位编号
       inaj009 LIKE inaj_t.inaj009, #储位编号
       inaj010 LIKE inaj_t.inaj010, #批号
       inaj011 LIKE inaj_t.inaj011, #交易数量
       inaj012 LIKE inaj_t.inaj012, #交易单位
#       inaj013 LIKE inaj_t.inaj013, #交易单位与库存单位换算率        #190513-00024#1 mark
#       inaj014 LIKE inaj_t.inaj014, #交易单位与料件基本单位换算率     #190513-00024#1 mark
       inaj015 LIKE inaj_t.inaj015, #异动单据性质
       inaj016 LIKE inaj_t.inaj016, #理由码
#       inaj017 LIKE inaj_t.inaj017, #异动部门编号                    #190513-00024#1 mark
       inaj018 LIKE inaj_t.inaj018, #异动供应商/客户编号
#       inaj019 LIKE inaj_t.inaj019, #备注                           #190513-00024#1 mark
       inaj020 LIKE inaj_t.inaj020, #工单单号
#       inaj021 LIKE inaj_t.inaj021, #多角序号                      #190513-00024#1 mark
       inaj022 LIKE inaj_t.inaj022, #单据扣账日期
#       inaj023 LIKE inaj_t.inaj023, #实际运行扣账日期               #190513-00024#1 mark
       inaj024 LIKE inaj_t.inaj024, #数据生成时间
       #190513-00024#1 mark-S
#       inaj025 LIKE inaj_t.inaj025, #异动数据生成者
#       inaj026 LIKE inaj_t.inaj026, #参考单位
#       inaj027 LIKE inaj_t.inaj027, #参考数量
#       inaj028 LIKE inaj_t.inaj028, #成本料号
       #190513-00024#1 mark-E
       inaj036 LIKE inaj_t.inaj036, #库存异动类型
       inaj029 LIKE inaj_t.inaj029, #交易单位与成本单位换算率
       #190513-00024#1 mark-S
#       inaj030 LIKE inaj_t.inaj030, #VMI交易结算否
#       inaj031 LIKE inaj_t.inaj031, #VMI对应入库/仓退单号
#       inaj032 LIKE inaj_t.inaj032, #VMI对应入库/仓退项次
#       inaj033 LIKE inaj_t.inaj033, #VMI对应杂发/杂收单号
#       inaj034 LIKE inaj_t.inaj034, #VMI对应杂发/杂收项次
       #190513-00024#1 mark-E
       inaj035 LIKE inaj_t.inaj035, #异动作业编号
       inaj037 LIKE inaj_t.inaj037, #成本中心
       inaj038 LIKE inaj_t.inaj038, #项目编号
       inaj039 LIKE inaj_t.inaj039, #WBS编号
       inaj040 LIKE inaj_t.inaj040, #重复性生产-计划编号
       inaj041 LIKE inaj_t.inaj041, #重复性生产-生产料号
       inaj042 LIKE inaj_t.inaj042, #重复性生产-生产料号BOM特性
       inaj043 LIKE inaj_t.inaj043, #重复性生产-生产料号产品特征
#       inaj044 LIKE inaj_t.inaj044, #来源单号       #190513-00024#1 mark
       inaj200 LIKE inaj_t.inaj200, #内部结算否
#       inaj201 LIKE inaj_t.inaj201, #业务类型       #190513-00024#1 mark
#       inaj202 LIKE inaj_t.inaj202, #内部交易类型   #190513-00024#1 mark
       inaj203 LIKE inaj_t.inaj203, #币种
       #190513-00024#1 mark-S
#       inaj204 LIKE inaj_t.inaj204, #税种
#       inaj205 LIKE inaj_t.inaj205, #内部结算税前金额
#       inaj206 LIKE inaj_t.inaj206, #内部结算含税金额
#       inaj207 LIKE inaj_t.inaj207, #交易所属法人
#       inaj208 LIKE inaj_t.inaj208, #内部交易对象组织
#       inaj209 LIKE inaj_t.inaj209, #内部交易对象法人
#       inaj045 LIKE inaj_t.inaj045, #异动时库存单位
#       inaj046 LIKE inaj_t.inaj046, #交易单位与库存单位换算分子
#       inaj047 LIKE inaj_t.inaj047, #交易单位与库存单位换算分母
       #190513-00024#1 mark-E
       inaj048 LIKE inaj_t.inaj048, #交易单位与料件基本单位换算分子
       inaj049 LIKE inaj_t.inaj049, #交易单位与料件基本单位换算分母
       #190513-00024#1 mark-S
#       inaj050 LIKE inaj_t.inaj050, #交易单位与成本单位换算分子
#       inaj051 LIKE inaj_t.inaj051, #交易单位与成本单位换算分母
#       inaj210 LIKE inaj_t.inaj210, #单据单价
       #190513-00024#1 mark-E
       inaj211 LIKE inaj_t.inaj211  #品类
END RECORD
#161124-00048#20 add(e)
   DEFINE l_xcce002       LIKE xcce_t.xcce002
   DEFINE l_xcce009       LIKE xcce_t.xcce009
   DEFINE l_qty           LIKE xcck_t.xcck201
   DEFINE l_inaj999       LIKE xcce_t.xcce002
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME   
   FOREACH s_axcp500_wip_2_cs1 USING g_xccd.xccd001,g_xccd.xccd003,g_xccd.xccd006
                                INTO l_inaj.*,l_avg.*              #l_avg2 是FOR月加权使用
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','',g_yy,g_pp,g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_2_cs1')
         CONTINUE FOREACH      
      END IF  
       
      CALL s_axcp500_get_xcce(g_xccd.xccd001,l_inaj.xcce002,g_xccd.xccd006,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010)
           RETURNING l_xcce.*
      
      CASE 
           WHEN g_cost_type = '1' #标准成本时  
#              CALL s_axcp500_std_get_std_cost(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007) #171211-00028#13 mark
              CALL s_axcp500_std_get_std_cost1(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007,l_xcce.xcce008) #171211-00028#13 mod
                   RETURNING l_success,l_avg.*  
              
              CASE l_inaj.inaj036
                   WHEN '115'   #当站下线
                        LET l_choice = '205'
                   WHEN '302'   #生产发料
                        CASE l_inaj.inaj015
                             WHEN 'asft312'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '201'
                        END CASE    
                   WHEN '303'   #生产退料
                        CASE l_inaj.inaj015
                             WHEN 'asft322'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '207'
                        END CASE    
                   WHEN '114'
                        LET l_choice = '207'
                   WHEN '107'
                        LET l_choice = '207'
                   WHEN '501'   #盘点
                        LET l_choice = '307'
              END CASE
              
              CASE l_choice
                   WHEN '201' LET l_xcce.xcce201  = l_xcce.xcce201  + l_inaj.qty
                              LET l_xcce.xcce202  = l_xcce.xcce202  + l_inaj.qty * l_avg.sum
                              LET l_xcce.xcce202a = l_xcce.xcce202a + l_inaj.qty * l_avg.a
                              LET l_xcce.xcce202b = l_xcce.xcce202b + l_inaj.qty * l_avg.b
                              LET l_xcce.xcce202c = l_xcce.xcce202c + l_inaj.qty * l_avg.c
                              LET l_xcce.xcce202d = l_xcce.xcce202d + l_inaj.qty * l_avg.d
                              LET l_xcce.xcce202e = l_xcce.xcce202e + l_inaj.qty * l_avg.e
                              LET l_xcce.xcce202f = l_xcce.xcce202f + l_inaj.qty * l_avg.f
                              LET l_xcce.xcce202g = l_xcce.xcce202g + l_inaj.qty * l_avg.g
                              LET l_xcce.xcce202h = l_xcce.xcce202h + l_inaj.qty * l_avg.h    
                              
                   WHEN '205' LET l_xcce.xcce205  = l_xcce.xcce205  + l_inaj.qty
                              LET l_xcce.xcce206  = l_xcce.xcce206  + l_inaj.qty * l_avg.sum
                              LET l_xcce.xcce206a = l_xcce.xcce206a + l_inaj.qty * l_avg.a
                              LET l_xcce.xcce206b = l_xcce.xcce206b + l_inaj.qty * l_avg.b
                              LET l_xcce.xcce206c = l_xcce.xcce206c + l_inaj.qty * l_avg.c
                              LET l_xcce.xcce206d = l_xcce.xcce206d + l_inaj.qty * l_avg.d
                              LET l_xcce.xcce206e = l_xcce.xcce206e + l_inaj.qty * l_avg.e
                              LET l_xcce.xcce206f = l_xcce.xcce206f + l_inaj.qty * l_avg.f
                              LET l_xcce.xcce206g = l_xcce.xcce206g + l_inaj.qty * l_avg.g
                              LET l_xcce.xcce206h = l_xcce.xcce206h + l_inaj.qty * l_avg.h    
        
                   WHEN '207' LET l_xcce.xcce207  = l_xcce.xcce207  + l_inaj.qty
                              LET l_xcce.xcce208  = l_xcce.xcce208  + l_inaj.qty * l_avg.sum
                              LET l_xcce.xcce208a = l_xcce.xcce208a + l_inaj.qty * l_avg.a
                              LET l_xcce.xcce208b = l_xcce.xcce208b + l_inaj.qty * l_avg.b
                              LET l_xcce.xcce208c = l_xcce.xcce208c + l_inaj.qty * l_avg.c
                              LET l_xcce.xcce208d = l_xcce.xcce208d + l_inaj.qty * l_avg.d
                              LET l_xcce.xcce208e = l_xcce.xcce208e + l_inaj.qty * l_avg.e
                              LET l_xcce.xcce208f = l_xcce.xcce208f + l_inaj.qty * l_avg.f
                              LET l_xcce.xcce208g = l_xcce.xcce208g + l_inaj.qty * l_avg.g
                              LET l_xcce.xcce208h = l_xcce.xcce208h + l_inaj.qty * l_avg.h    
        
                   WHEN '209' LET l_xcce.xcce209  = l_xcce.xcce209  + l_inaj.qty
                              LET l_xcce.xcce210  = l_xcce.xcce210  + l_inaj.qty * l_avg.sum
                              LET l_xcce.xcce210a = l_xcce.xcce210a + l_inaj.qty * l_avg.a
                              LET l_xcce.xcce210b = l_xcce.xcce210b + l_inaj.qty * l_avg.b
                              LET l_xcce.xcce210c = l_xcce.xcce210c + l_inaj.qty * l_avg.c
                              LET l_xcce.xcce210d = l_xcce.xcce210d + l_inaj.qty * l_avg.d
                              LET l_xcce.xcce210e = l_xcce.xcce210e + l_inaj.qty * l_avg.e
                              LET l_xcce.xcce210f = l_xcce.xcce210f + l_inaj.qty * l_avg.f
                              LET l_xcce.xcce210g = l_xcce.xcce210g + l_inaj.qty * l_avg.g
                              LET l_xcce.xcce210h = l_xcce.xcce210h + l_inaj.qty * l_avg.h    
        
                   WHEN '307' LET l_xcce.xcce307  = l_xcce.xcce307  + l_inaj.qty
                              LET l_xcce.xcce308  = l_xcce.xcce308  + l_inaj.qty * l_avg.sum
                              LET l_xcce.xcce308a = l_xcce.xcce308a + l_inaj.qty * l_avg.a
                              LET l_xcce.xcce308b = l_xcce.xcce308b + l_inaj.qty * l_avg.b
                              LET l_xcce.xcce308c = l_xcce.xcce308c + l_inaj.qty * l_avg.c
                              LET l_xcce.xcce308d = l_xcce.xcce308d + l_inaj.qty * l_avg.d
                              LET l_xcce.xcce308e = l_xcce.xcce308e + l_inaj.qty * l_avg.e
                              LET l_xcce.xcce308f = l_xcce.xcce308f + l_inaj.qty * l_avg.f
                              LET l_xcce.xcce308g = l_xcce.xcce308g + l_inaj.qty * l_avg.g
                              LET l_xcce.xcce308h = l_xcce.xcce308h + l_inaj.qty * l_avg.h 
                              
              END CASE
              
           WHEN g_cost_type MATCHES '[35]' #月加权/批次

              IF l_inaj.inaj036 = '115' THEN
                 CALL s_axcp500_get_xccw202_2(l_xcce.xcce001,l_xcce.xcce002,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce009)
                      RETURNING l_avg.*
                 LET l_avg.sum = l_avg.sum * -1
                 LET l_avg.a   = l_avg.a   * -1
                 LET l_avg.b   = l_avg.b   * -1
                 LET l_avg.c   = l_avg.c   * -1
                 LET l_avg.d   = l_avg.d   * -1
                 LET l_avg.e   = l_avg.e   * -1
                 LET l_avg.f   = l_avg.f   * -1
                 LET l_avg.g   = l_avg.g   * -1
                 LET l_avg.h   = l_avg.h   * -1
              ELSE
#                CALL s_axcp500_avg_get_cost(g_xccd.xccd007,l_xcce.xcce001,l_xcce.xcce002,l_xcce.xcce003,g_yy,
#                                        g_pp,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce009)
#                     RETURNING l_success,l_avg.*     
#                IF NOT l_success THEN
#                
#                END IF             
              END IF
      
              CASE l_inaj.inaj036
                   WHEN '115'   #当站下线
                        LET l_choice = '205'
                   WHEN '302'   #生产发料
                        CASE l_inaj.inaj015
                             WHEN 'asft312'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '201'
                        END CASE    
                   WHEN '303'   #生产退料
                        CASE l_inaj.inaj015
                             WHEN 'asft322'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '207'
                        END CASE    
                   WHEN '114'
                        LET l_choice = '207'
                   WHEN '107'
                        LET l_choice = '207'                        
                   WHEN '501'   #盘点
                        LET l_choice = '307'
              END CASE
              
                 CASE l_choice
                      WHEN '201' LET l_xcce.xcce201  = l_xcce.xcce201  + l_inaj.qty
                                 LET l_xcce.xcce202  = l_xcce.xcce202  + l_avg.sum
                                 LET l_xcce.xcce202a = l_xcce.xcce202a + l_avg.a
                                 LET l_xcce.xcce202b = l_xcce.xcce202b + l_avg.b
                                 LET l_xcce.xcce202c = l_xcce.xcce202c + l_avg.c
                                 LET l_xcce.xcce202d = l_xcce.xcce202d + l_avg.d
                                 LET l_xcce.xcce202e = l_xcce.xcce202e + l_avg.e
                                 LET l_xcce.xcce202f = l_xcce.xcce202f + l_avg.f
                                 LET l_xcce.xcce202g = l_xcce.xcce202g + l_avg.g
                                 LET l_xcce.xcce202h = l_xcce.xcce202h + l_avg.h    
                                 
                      WHEN '205' LET l_xcce.xcce205  = l_xcce.xcce205  + l_inaj.qty
                                 LET l_xcce.xcce206  = l_xcce.xcce206  + l_avg.sum
                                 LET l_xcce.xcce206a = l_xcce.xcce206a + l_avg.a
                                 LET l_xcce.xcce206b = l_xcce.xcce206b + l_avg.b
                                 LET l_xcce.xcce206c = l_xcce.xcce206c + l_avg.c
                                 LET l_xcce.xcce206d = l_xcce.xcce206d + l_avg.d
                                 LET l_xcce.xcce206e = l_xcce.xcce206e + l_avg.e
                                 LET l_xcce.xcce206f = l_xcce.xcce206f + l_avg.f
                                 LET l_xcce.xcce206g = l_xcce.xcce206g + l_avg.g
                                 LET l_xcce.xcce206h = l_xcce.xcce206h + l_avg.h    
           
                      WHEN '207' LET l_xcce.xcce207  = l_xcce.xcce207  + l_inaj.qty
                                 LET l_xcce.xcce208  = l_xcce.xcce208  + l_avg.sum
                                 LET l_xcce.xcce208a = l_xcce.xcce208a + l_avg.a
                                 LET l_xcce.xcce208b = l_xcce.xcce208b + l_avg.b
                                 LET l_xcce.xcce208c = l_xcce.xcce208c + l_avg.c
                                 LET l_xcce.xcce208d = l_xcce.xcce208d + l_avg.d
                                 LET l_xcce.xcce208e = l_xcce.xcce208e + l_avg.e
                                 LET l_xcce.xcce208f = l_xcce.xcce208f + l_avg.f
                                 LET l_xcce.xcce208g = l_xcce.xcce208g + l_avg.g
                                 LET l_xcce.xcce208h = l_xcce.xcce208h + l_avg.h    
           
                      WHEN '209' LET l_xcce.xcce209  = l_xcce.xcce209  + l_inaj.qty
                                 LET l_xcce.xcce210  = l_xcce.xcce210  + l_avg.sum
                                 LET l_xcce.xcce210a = l_xcce.xcce210a + l_avg.a
                                 LET l_xcce.xcce210b = l_xcce.xcce210b + l_avg.b
                                 LET l_xcce.xcce210c = l_xcce.xcce210c + l_avg.c
                                 LET l_xcce.xcce210d = l_xcce.xcce210d + l_avg.d
                                 LET l_xcce.xcce210e = l_xcce.xcce210e + l_avg.e
                                 LET l_xcce.xcce210f = l_xcce.xcce210f + l_avg.f
                                 LET l_xcce.xcce210g = l_xcce.xcce210g + l_avg.g
                                 LET l_xcce.xcce210h = l_xcce.xcce210h + l_avg.h    
           
                      WHEN '307' LET l_xcce.xcce307  = l_xcce.xcce307  + l_inaj.qty
                                 LET l_xcce.xcce308  = l_xcce.xcce308  + l_avg.sum
                                 LET l_xcce.xcce308a = l_xcce.xcce308a + l_avg.a
                                 LET l_xcce.xcce308b = l_xcce.xcce308b + l_avg.b
                                 LET l_xcce.xcce308c = l_xcce.xcce308c + l_avg.c
                                 LET l_xcce.xcce308d = l_xcce.xcce308d + l_avg.d
                                 LET l_xcce.xcce308e = l_xcce.xcce308e + l_avg.e
                                 LET l_xcce.xcce308f = l_xcce.xcce308f + l_avg.f
                                 LET l_xcce.xcce308g = l_xcce.xcce308g + l_avg.g
                                 LET l_xcce.xcce308h = l_xcce.xcce308h + l_avg.h                               
                 END CASE              

      END CASE      
      CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
      LET g_stat_cnt1 = g_stat_cnt1 + 1      
   END FOREACH
              
                  
   #若在制工单的发料中出现成本阶大于当前主件的，若是成本阶和当前主件相同，但是还没有计算的料时，执行下面的语句
   FOREACH s_axcp500_wip_2_cs2 USING g_xccd.xccd006,g_xccd.xccd001
                                INTO l_inaj_t.*,l_inaj999
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_cs2'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','',g_yy,g_pp,g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_2_cs2')
         CONTINUE FOREACH      
      END IF  
      
      LET l_xcce002 = l_inaj999
      IF l_xcce002 IS NULL THEN
         LET l_xcce002 = ' '
      END IF
      
      #批号
      IF g_cost_type <> '3' THEN #非批次成本
         LET l_xcce009 = ' '
      ELSE
         LET l_xcce009 = l_inaj_t.inaj010     
      END IF
      
      #异动数量
      #LET l_qty = l_inaj_t.inaj004 * l_inaj_t.inaj011 * l_inaj_t.inaj014 * -1   #160518-00033#2
      #LET l_qty = l_inaj_t.inaj004 * l_inaj_t.inaj011 * l_inaj_t.inaj048/l_inaj_t.inaj049 * -1   #160518-00033#2 #170705-00006#1 mark
      #170705-00006#1 add(S)
      IF l_inaj_t.inaj049 <> 0 THEN
         LET l_qty = l_inaj_t.inaj004 * l_inaj_t.inaj011 * l_inaj_t.inaj048/l_inaj_t.inaj049 * -1
      ELSE
         LET l_qty =0
      END IF
      #170705-00006#1 add(E)
        
      CALL s_axcp500_get_xcce(g_xccd.xccd001,l_xcce002,g_xccd.xccd006,l_inaj_t.inaj005,l_inaj_t.inaj006,l_xcce009)
           RETURNING l_xcce.*
      
      CASE 
           WHEN g_cost_type = '1' #标准成本时  
#              CALL s_axcp500_std_get_std_cost(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007) #171211-00028#13 mark
              CALL s_axcp500_std_get_std_cost1(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007,l_xcce.xcce008) #171211-00028#13 mod
                   RETURNING l_success,l_avg.*  
              
              CASE l_inaj_t.inaj036
                   WHEN '115'   #当站下线
                        LET l_choice = '205'
                   WHEN '302'   #生产发料
                        CASE l_inaj_t.inaj015
                             WHEN 'asft312'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '201'
                        END CASE    
                   WHEN '303'   #生产退料
                        CASE l_inaj_t.inaj015
                             WHEN 'asft322'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '207'
                        END CASE    
                   WHEN '114'
                        LET l_choice = '207'
                   WHEN '107'
                        LET l_choice = '207'                        
                   WHEN '501'   #盘点
                        LET l_choice = '307'
              END CASE
              
              
              CASE l_choice
                   WHEN '201' LET l_xcce.xcce201  = l_xcce.xcce201  + l_qty
                              LET l_xcce.xcce202  = l_xcce.xcce202  + l_qty * l_avg.sum
                              LET l_xcce.xcce202a = l_xcce.xcce202a + l_qty * l_avg.a
                              LET l_xcce.xcce202b = l_xcce.xcce202b + l_qty * l_avg.b
                              LET l_xcce.xcce202c = l_xcce.xcce202c + l_qty * l_avg.c
                              LET l_xcce.xcce202d = l_xcce.xcce202d + l_qty * l_avg.d
                              LET l_xcce.xcce202e = l_xcce.xcce202e + l_qty * l_avg.e
                              LET l_xcce.xcce202f = l_xcce.xcce202f + l_qty * l_avg.f
                              LET l_xcce.xcce202g = l_xcce.xcce202g + l_qty * l_avg.g
                              LET l_xcce.xcce202h = l_xcce.xcce202h + l_qty * l_avg.h    
                              
                   WHEN '205' LET l_xcce.xcce205  = l_xcce.xcce205  + l_qty
                              LET l_xcce.xcce206  = l_xcce.xcce206  + l_qty * l_avg.sum
                              LET l_xcce.xcce206a = l_xcce.xcce206a + l_qty * l_avg.a
                              LET l_xcce.xcce206b = l_xcce.xcce206b + l_qty * l_avg.b
                              LET l_xcce.xcce206c = l_xcce.xcce206c + l_qty * l_avg.c
                              LET l_xcce.xcce206d = l_xcce.xcce206d + l_qty * l_avg.d
                              LET l_xcce.xcce206e = l_xcce.xcce206e + l_qty * l_avg.e
                              LET l_xcce.xcce206f = l_xcce.xcce206f + l_qty * l_avg.f
                              LET l_xcce.xcce206g = l_xcce.xcce206g + l_qty * l_avg.g
                              LET l_xcce.xcce206h = l_xcce.xcce206h + l_qty * l_avg.h    
        
                   WHEN '207' LET l_xcce.xcce207  = l_xcce.xcce207  + l_qty
                              LET l_xcce.xcce208  = l_xcce.xcce208  + l_qty * l_avg.sum
                              LET l_xcce.xcce208a = l_xcce.xcce208a + l_qty * l_avg.a
                              LET l_xcce.xcce208b = l_xcce.xcce208b + l_qty * l_avg.b
                              LET l_xcce.xcce208c = l_xcce.xcce208c + l_qty * l_avg.c
                              LET l_xcce.xcce208d = l_xcce.xcce208d + l_qty * l_avg.d
                              LET l_xcce.xcce208e = l_xcce.xcce208e + l_qty * l_avg.e
                              LET l_xcce.xcce208f = l_xcce.xcce208f + l_qty * l_avg.f
                              LET l_xcce.xcce208g = l_xcce.xcce208g + l_qty * l_avg.g
                              LET l_xcce.xcce208h = l_xcce.xcce208h + l_qty * l_avg.h    
        
                   WHEN '209' LET l_xcce.xcce209  = l_xcce.xcce209  + l_qty
                              LET l_xcce.xcce210  = l_xcce.xcce210  + l_qty * l_avg.sum
                              LET l_xcce.xcce210a = l_xcce.xcce210a + l_qty * l_avg.a
                              LET l_xcce.xcce210b = l_xcce.xcce210b + l_qty * l_avg.b
                              LET l_xcce.xcce210c = l_xcce.xcce210c + l_qty * l_avg.c
                              LET l_xcce.xcce210d = l_xcce.xcce210d + l_qty * l_avg.d
                              LET l_xcce.xcce210e = l_xcce.xcce210e + l_qty * l_avg.e
                              LET l_xcce.xcce210f = l_xcce.xcce210f + l_qty * l_avg.f
                              LET l_xcce.xcce210g = l_xcce.xcce210g + l_qty * l_avg.g
                              LET l_xcce.xcce210h = l_xcce.xcce210h + l_qty * l_avg.h    
        
                   WHEN '307' LET l_xcce.xcce307  = l_xcce.xcce307  + l_qty
                              LET l_xcce.xcce308  = l_xcce.xcce308  + l_qty * l_avg.sum
                              LET l_xcce.xcce308a = l_xcce.xcce308a + l_qty * l_avg.a
                              LET l_xcce.xcce308b = l_xcce.xcce308b + l_qty * l_avg.b
                              LET l_xcce.xcce308c = l_xcce.xcce308c + l_qty * l_avg.c
                              LET l_xcce.xcce308d = l_xcce.xcce308d + l_qty * l_avg.d
                              LET l_xcce.xcce308e = l_xcce.xcce308e + l_qty * l_avg.e
                              LET l_xcce.xcce308f = l_xcce.xcce308f + l_qty * l_avg.f
                              LET l_xcce.xcce308g = l_xcce.xcce308g + l_qty * l_avg.g
                              LET l_xcce.xcce308h = l_xcce.xcce308h + l_qty * l_avg.h 
                              
              END CASE
              
           WHEN g_cost_type MATCHES '[35]' #月加权 & 批次
              IF l_inaj_t.inaj036 = '115' THEN
                 CALL s_axcp500_get_xccw282(l_xcce.xcce001,l_xcce.xcce002,l_inaj_t.inaj001,l_inaj_t.inaj002,l_inaj_t.inaj003,l_inaj_t.inaj004)
                      RETURNING l_avg1.*   
              END IF
              IF l_avg1.tot = 0 THEN
                 INITIALIZE g_errparam TO NULL
                 #计算主件%1的过程中，无法取得元件编号=%2 的成本资料
                 LET g_errparam.code   = 'axc-00518'
                 LET g_errparam.extend = ''
                 LET g_errparam.replace[1] = g_xccd.xccd006
                 LET g_errparam.replace[2] = g_xccd.xccd007
                 LET g_errparam.replace[3] = l_xcce.xcce007
                 LET g_errparam.popup  = TRUE
                 CALL cl_err()
                 LET g_str = cl_getmsg('axc-00518',g_lang)
                 LET g_str = cl_err_replace_msg(g_str)
                 CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',l_xcce.xcce007,l_xcce.xcce008,
                                          l_xcce.xcce009,'','axc-00518',g_str,'')
#                RETURN r_success                            
              END IF

      
              CASE l_inaj_t.inaj036
                   WHEN '115'   #当站下线
                        LET l_choice = '205'
                   WHEN '302'   #生产发料
                        CASE l_inaj_t.inaj015
                             WHEN 'asft312'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '201'
                        END CASE    
                   WHEN '303'   #生产退料
                        CASE l_inaj_t.inaj015
                             WHEN 'asft322'   LET l_choice = '209'
                             OTHERWISE        LET l_choice = '207'
                        END CASE    
                   WHEN '114'
                        LET l_choice = '207'
                   WHEN '107'
                        LET l_choice = '207'                        
                   WHEN '501'   #盘点
                        LET l_choice = '307'
              END CASE
                                                       
              
              CASE l_choice
                   WHEN '201' LET l_xcce.xcce201  = l_xcce.xcce201  + l_qty
                              LET l_xcce.xcce202  = l_xcce.xcce202  + l_qty * l_avg1.tot
                              LET l_xcce.xcce202a = l_xcce.xcce202a + l_qty * l_avg1.a
                              LET l_xcce.xcce202b = l_xcce.xcce202b + l_qty * l_avg1.b
                              LET l_xcce.xcce202c = l_xcce.xcce202c + l_qty * l_avg1.c
                              LET l_xcce.xcce202d = l_xcce.xcce202d + l_qty * l_avg1.d
                              LET l_xcce.xcce202e = l_xcce.xcce202e + l_qty * l_avg1.e
                              LET l_xcce.xcce202f = l_xcce.xcce202f + l_qty * l_avg1.f
                              LET l_xcce.xcce202g = l_xcce.xcce202g + l_qty * l_avg1.g
                              LET l_xcce.xcce202h = l_xcce.xcce202h + l_qty * l_avg1.h    
                              
                   WHEN '205' LET l_xcce.xcce205  = l_xcce.xcce205  + l_qty
                              LET l_xcce.xcce206  = l_xcce.xcce206  + -1 * l_avg1.tot
                              LET l_xcce.xcce206a = l_xcce.xcce206a + -1 * l_avg1.a
                              LET l_xcce.xcce206b = l_xcce.xcce206b + -1 * l_avg1.b
                              LET l_xcce.xcce206c = l_xcce.xcce206c + -1 * l_avg1.c
                              LET l_xcce.xcce206d = l_xcce.xcce206d + -1 * l_avg1.d
                              LET l_xcce.xcce206e = l_xcce.xcce206e + -1 * l_avg1.e
                              LET l_xcce.xcce206f = l_xcce.xcce206f + -1 * l_avg1.f
                              LET l_xcce.xcce206g = l_xcce.xcce206g + -1 * l_avg1.g
                              LET l_xcce.xcce206h = l_xcce.xcce206h + -1 * l_avg1.h    
        
                   WHEN '207' LET l_xcce.xcce207  = l_xcce.xcce207  + l_qty
                              LET l_xcce.xcce208  = l_xcce.xcce208  + l_qty * l_avg1.tot
                              LET l_xcce.xcce208a = l_xcce.xcce208a + l_qty * l_avg1.a
                              LET l_xcce.xcce208b = l_xcce.xcce208b + l_qty * l_avg1.b
                              LET l_xcce.xcce208c = l_xcce.xcce208c + l_qty * l_avg1.c
                              LET l_xcce.xcce208d = l_xcce.xcce208d + l_qty * l_avg1.d
                              LET l_xcce.xcce208e = l_xcce.xcce208e + l_qty * l_avg1.e
                              LET l_xcce.xcce208f = l_xcce.xcce208f + l_qty * l_avg1.f
                              LET l_xcce.xcce208g = l_xcce.xcce208g + l_qty * l_avg1.g
                              LET l_xcce.xcce208h = l_xcce.xcce208h + l_qty * l_avg1.h    
        
                   WHEN '209' LET l_xcce.xcce209  = l_xcce.xcce209  + l_qty
                              LET l_xcce.xcce210  = l_xcce.xcce210  + l_qty * l_avg1.tot
                              LET l_xcce.xcce210a = l_xcce.xcce210a + l_qty * l_avg1.a
                              LET l_xcce.xcce210b = l_xcce.xcce210b + l_qty * l_avg1.b
                              LET l_xcce.xcce210c = l_xcce.xcce210c + l_qty * l_avg1.c
                              LET l_xcce.xcce210d = l_xcce.xcce210d + l_qty * l_avg1.d
                              LET l_xcce.xcce210e = l_xcce.xcce210e + l_qty * l_avg1.e
                              LET l_xcce.xcce210f = l_xcce.xcce210f + l_qty * l_avg1.f
                              LET l_xcce.xcce210g = l_xcce.xcce210g + l_qty * l_avg1.g
                              LET l_xcce.xcce210h = l_xcce.xcce210h + l_qty * l_avg1.h    
        
                   WHEN '307' LET l_xcce.xcce307  = l_xcce.xcce307  + l_qty
                              LET l_xcce.xcce308  = l_xcce.xcce308  + l_qty * l_avg1.tot
                              LET l_xcce.xcce308a = l_xcce.xcce308a + l_qty * l_avg1.a
                              LET l_xcce.xcce308b = l_xcce.xcce308b + l_qty * l_avg1.b
                              LET l_xcce.xcce308c = l_xcce.xcce308c + l_qty * l_avg1.c
                              LET l_xcce.xcce308d = l_xcce.xcce308d + l_qty * l_avg1.d
                              LET l_xcce.xcce308e = l_xcce.xcce308e + l_qty * l_avg1.e
                              LET l_xcce.xcce308f = l_xcce.xcce308f + l_qty * l_avg1.f
                              LET l_xcce.xcce308g = l_xcce.xcce308g + l_qty * l_avg1.g
                              LET l_xcce.xcce308h = l_xcce.xcce308h + l_qty * l_avg1.h 
                              
              END CASE
      END CASE      
      
      CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
      LET g_stat_cnt1 = g_stat_cnt1 + 1      
   END FOREACH

   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(10,g_stat_begin1,g_stat_end1,g_stat_cnt1)
   
   LET r_success = TRUE   
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 取得人工/加工/制费
# Memo...........:
# Usage..........: CALL s_axcp500_wip_2_3()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_2_3()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE l_xcce           type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_arr           ARRAY[6] OF RECORD
                          xcbk202     LIKE xcbk_t.xcbk202,
                          xcbk212     LIKE xcbk_t.xcbk212,
                          xcbk222     LIKE xcbk_t.xcbk222
                          END RECORD
#   DEFINE l_inaj          RECORD LIKE inaj_t.*    #161124-00048#20 mark 
#161124-00048#20 add(s)
DEFINE l_inaj RECORD  #庫存交易明細檔
       inajent LIKE inaj_t.inajent, #企业编号
       inajsite LIKE inaj_t.inajsite, #营运据点
       inaj001 LIKE inaj_t.inaj001, #单据编号
       inaj002 LIKE inaj_t.inaj002, #项次
       inaj003 LIKE inaj_t.inaj003, #项序
       inaj004 LIKE inaj_t.inaj004, #出入库码
       inaj005 LIKE inaj_t.inaj005, #料件编号
       inaj006 LIKE inaj_t.inaj006, #产品特征
       inaj007 LIKE inaj_t.inaj007, #库存管理特征
       inaj008 LIKE inaj_t.inaj008, #库位编号
       inaj009 LIKE inaj_t.inaj009, #储位编号
       inaj010 LIKE inaj_t.inaj010, #批号
       inaj011 LIKE inaj_t.inaj011, #交易数量
       inaj012 LIKE inaj_t.inaj012, #交易单位
       inaj013 LIKE inaj_t.inaj013, #交易单位与库存单位换算率
       inaj014 LIKE inaj_t.inaj014, #交易单位与料件基本单位换算率
       inaj015 LIKE inaj_t.inaj015, #异动单据性质
       inaj016 LIKE inaj_t.inaj016, #理由码
       inaj017 LIKE inaj_t.inaj017, #异动部门编号
       inaj018 LIKE inaj_t.inaj018, #异动供应商/客户编号
       inaj019 LIKE inaj_t.inaj019, #备注
       inaj020 LIKE inaj_t.inaj020, #工单单号
       inaj021 LIKE inaj_t.inaj021, #多角序号
       inaj022 LIKE inaj_t.inaj022, #单据扣账日期
       inaj023 LIKE inaj_t.inaj023, #实际运行扣账日期
       inaj024 LIKE inaj_t.inaj024, #数据生成时间
       inaj025 LIKE inaj_t.inaj025, #异动数据生成者
       inaj026 LIKE inaj_t.inaj026, #参考单位
       inaj027 LIKE inaj_t.inaj027, #参考数量
       inaj028 LIKE inaj_t.inaj028, #成本料号
       inaj036 LIKE inaj_t.inaj036, #库存异动类型
       inaj029 LIKE inaj_t.inaj029, #交易单位与成本单位换算率
       inaj030 LIKE inaj_t.inaj030, #VMI交易结算否
       inaj031 LIKE inaj_t.inaj031, #VMI对应入库/仓退单号
       inaj032 LIKE inaj_t.inaj032, #VMI对应入库/仓退项次
       inaj033 LIKE inaj_t.inaj033, #VMI对应杂发/杂收单号
       inaj034 LIKE inaj_t.inaj034, #VMI对应杂发/杂收项次
       inaj035 LIKE inaj_t.inaj035, #异动作业编号
       inaj037 LIKE inaj_t.inaj037, #成本中心
       inaj038 LIKE inaj_t.inaj038, #项目编号
       inaj039 LIKE inaj_t.inaj039, #WBS编号
       inaj040 LIKE inaj_t.inaj040, #重复性生产-计划编号
       inaj041 LIKE inaj_t.inaj041, #重复性生产-生产料号
       inaj042 LIKE inaj_t.inaj042, #重复性生产-生产料号BOM特性
       inaj043 LIKE inaj_t.inaj043, #重复性生产-生产料号产品特征
       inaj044 LIKE inaj_t.inaj044, #来源单号
       inaj200 LIKE inaj_t.inaj200, #内部结算否
       inaj201 LIKE inaj_t.inaj201, #业务类型
       inaj202 LIKE inaj_t.inaj202, #内部交易类型
       inaj203 LIKE inaj_t.inaj203, #币种
       inaj204 LIKE inaj_t.inaj204, #税种
       inaj205 LIKE inaj_t.inaj205, #内部结算税前金额
       inaj206 LIKE inaj_t.inaj206, #内部结算含税金额
       inaj207 LIKE inaj_t.inaj207, #交易所属法人
       inaj208 LIKE inaj_t.inaj208, #内部交易对象组织
       inaj209 LIKE inaj_t.inaj209, #内部交易对象法人
       inaj045 LIKE inaj_t.inaj045, #异动时库存单位
       inaj046 LIKE inaj_t.inaj046, #交易单位与库存单位换算分子
       inaj047 LIKE inaj_t.inaj047, #交易单位与库存单位换算分母
       inaj048 LIKE inaj_t.inaj048, #交易单位与料件基本单位换算分子
       inaj049 LIKE inaj_t.inaj049, #交易单位与料件基本单位换算分母
       inaj050 LIKE inaj_t.inaj050, #交易单位与成本单位换算分子
       inaj051 LIKE inaj_t.inaj051, #交易单位与成本单位换算分母
       inaj210 LIKE inaj_t.inaj210, #单据单价
       inaj211 LIKE inaj_t.inaj211  #品类
END RECORD
#161124-00048#20 add(e)
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_sum           LIKE xccc_t.xccc202
   DEFINE l_tot           LIKE xccc_t.xccc202   
   DEFINE l_inajsite      LIKE inaj_t.inajsite #160823-00040#1
   DEFINE l_inaj001       LIKE inaj_t.inaj001  #160823-00040#1
   DEFINE l_inaj002       LIKE inaj_t.inaj002  #160823-00040#1
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
  #CALL s_axcp500_get_xcce(g_xccd.xccd001,' ',g_xccd.xccd006,'DL+OH+SUB',' ',' ')              #160825-00022#1 mark
   CALL s_axcp500_get_xcce(g_xccd.xccd001,g_xccd.xccd002,g_xccd.xccd006,'DL+OH+SUB',' ',' ')   #160825-00022#1 add #DL+OH也需考慮成本域
        RETURNING l_xcce.*   
        
   LET l_xcce.xcce201 = g_xccd.xccd201      #人工制费本期的投入数量=材料投入数量
    
   #201210-00021#1---mark---s   
   #180703-00046#1#1---add---s
   #IF g_xccd.xccd201 = 0 THEN  #190808-00004#1 mark
   IF g_xccd.xccd201 = 0 AND l_xcce.xcce101 = 0 THEN  #190808-00004#1 add
      LET l_xcce.xcce201 = g_xccd.xccd101  
   END IF
   #180703-00046#1#1---add---s
   #201210-00021#1---mark---e
   #201210-00021#1---add---s
   IF l_xcce.xcce101 = 0 THEN  
      LET l_xcce.xcce201 = g_xccd.xccd101 + g_xccd.xccd201 
   END IF   
   #201210-00021#1---add---e
   
#wujie 160523 --begin 五合一，提高执行效能
   EXECUTE s_axcp500_def_cursor_p10 USING g_xccd.xccd006
                                     INTO l_arr[1].*,l_arr[2].*,l_arr[3].*,l_arr[4].*,l_arr[5].*,l_arr[6].* 
   
   IF cl_null(l_arr[1].xcbk202) THEN LET l_arr[1].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[1].xcbk212) THEN LET l_arr[1].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[1].xcbk222) THEN LET l_arr[1].xcbk222 = 0 END IF
   IF cl_null(l_arr[2].xcbk202) THEN LET l_arr[2].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[2].xcbk212) THEN LET l_arr[2].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[2].xcbk222) THEN LET l_arr[2].xcbk222 = 0 END IF
   IF cl_null(l_arr[3].xcbk202) THEN LET l_arr[3].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[3].xcbk212) THEN LET l_arr[3].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[3].xcbk222) THEN LET l_arr[3].xcbk222 = 0 END IF 
   IF cl_null(l_arr[4].xcbk202) THEN LET l_arr[4].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[4].xcbk212) THEN LET l_arr[4].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[4].xcbk222) THEN LET l_arr[4].xcbk222 = 0 END IF
   IF cl_null(l_arr[5].xcbk202) THEN LET l_arr[5].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[5].xcbk212) THEN LET l_arr[5].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[5].xcbk222) THEN LET l_arr[5].xcbk222 = 0 END IF  
   IF cl_null(l_arr[6].xcbk202) THEN LET l_arr[6].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[6].xcbk212) THEN LET l_arr[6].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[6].xcbk222) THEN LET l_arr[6].xcbk222 = 0 END IF 

#   #人工：axcq202中工单xccd006的人工主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '1',g_xccd.xccd006
#                                     INTO l_arr[1].*   
#   IF cl_null(l_arr[1].xcbk202) THEN LET l_arr[1].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[1].xcbk212) THEN LET l_arr[1].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[1].xcbk222) THEN LET l_arr[1].xcbk222 = 0 END IF                            
#   #制费1： axcq202中工单xccd006的制费1主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '2',g_xccd.xccd006 
#                                     INTO l_arr[2].*                            
#   IF cl_null(l_arr[2].xcbk202) THEN LET l_arr[2].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[2].xcbk212) THEN LET l_arr[2].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[2].xcbk222) THEN LET l_arr[2].xcbk222 = 0 END IF                            
#   #制费2： axcq202中工单xccd006的制费2主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '3',g_xccd.xccd006 
#                                     INTO l_arr[3].*                            
#   IF cl_null(l_arr[3].xcbk202) THEN LET l_arr[3].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[3].xcbk212) THEN LET l_arr[3].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[3].xcbk222) THEN LET l_arr[3].xcbk222 = 0 END IF                            
#   #制费3： axcq202中工单xccd006的制费3主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '4',g_xccd.xccd006 
#                                     INTO l_arr[4].*                            
#   IF cl_null(l_arr[4].xcbk202) THEN LET l_arr[4].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[4].xcbk212) THEN LET l_arr[4].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[4].xcbk222) THEN LET l_arr[4].xcbk222 = 0 END IF                            
#   #制费4： axcq202中工单xccd006的制费4主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '5',g_xccd.xccd006 
#                                     INTO l_arr[5].*                            
#   IF cl_null(l_arr[5].xcbk202) THEN LET l_arr[5].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[5].xcbk212) THEN LET l_arr[5].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[5].xcbk222) THEN LET l_arr[5].xcbk222 = 0 END IF                            
#   #制费5： axcq202中工单xccd006的制费5主要素的分摊金额(本位币1~3)：SUM(xcbk202),SUM(xcbk212),SUM(xcbk222)
#   EXECUTE s_axcp500_def_cursor_p10 USING '6',g_xccd.xccd006 
#                                     INTO l_arr[6].*                            
#   IF cl_null(l_arr[6].xcbk202) THEN LET l_arr[6].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[6].xcbk212) THEN LET l_arr[6].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[6].xcbk222) THEN LET l_arr[6].xcbk222 = 0 END IF                            

#wujie 160523 --END
   
   #在原基础上累加
   CASE g_xccd.xccd001
        WHEN '1'  #第一记帐本位币
                  LET l_xcce.xcce202b = l_xcce.xcce202b + l_arr[1].xcbk202
                  LET l_xcce.xcce202d = l_xcce.xcce202d + l_arr[2].xcbk202
                  LET l_xcce.xcce202e = l_xcce.xcce202e + l_arr[3].xcbk202
                  LET l_xcce.xcce202f = l_xcce.xcce202f + l_arr[4].xcbk202
                  LET l_xcce.xcce202g = l_xcce.xcce202g + l_arr[5].xcbk202
                  LET l_xcce.xcce202h = l_xcce.xcce202h + l_arr[6].xcbk202
        WHEN '2'  #第二记帐本位币
                  LET l_xcce.xcce202b = l_xcce.xcce202b + l_arr[1].xcbk212
                  LET l_xcce.xcce202d = l_xcce.xcce202d + l_arr[2].xcbk212
                  LET l_xcce.xcce202e = l_xcce.xcce202e + l_arr[3].xcbk212
                  LET l_xcce.xcce202f = l_xcce.xcce202f + l_arr[4].xcbk212
                  LET l_xcce.xcce202g = l_xcce.xcce202g + l_arr[5].xcbk212
                  LET l_xcce.xcce202h = l_xcce.xcce202h + l_arr[6].xcbk212
        WHEN '3'  #第三记帐本位币
                  LET l_xcce.xcce202b = l_xcce.xcce202b + l_arr[1].xcbk222
                  LET l_xcce.xcce202d = l_xcce.xcce202d + l_arr[2].xcbk222
                  LET l_xcce.xcce202e = l_xcce.xcce202e + l_arr[3].xcbk222
                  LET l_xcce.xcce202f = l_xcce.xcce202f + l_arr[4].xcbk222
                  LET l_xcce.xcce202g = l_xcce.xcce202g + l_arr[5].xcbk222
                  LET l_xcce.xcce202h = l_xcce.xcce202h + l_arr[6].xcbk222
   END CASE
   
   #取委外加工费

   LET l_tot = 0
   #FOREACH s_axcp500_wip_2_3_cs1 USING g_xccd.xccd006 INTO l_inaj.*    #160823-00040#1 mark
   FOREACH s_axcp500_wip_2_3_cs1 USING g_xccd.xccd006 INTO l_inajsite,l_inaj001,l_inaj002    #160823-00040#1 add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_3_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_2_3_cs1')
         CONTINUE FOREACH   
      END IF
      #CALL s_axcp500_get_ap_sum_1(g_xccd.xccd001,l_inaj.inaj001,l_inaj.inaj002,l_inaj.inaj003)   #160823-00040#1 mark    
      CALL s_axcp500_get_ap_sum_1(g_xccd.xccd001,l_inaj001,l_inaj002,0)   #160823-00040#1 add    
           RETURNING l_sum
      LET l_tot = l_tot + l_sum
      
   END FOREACH
   IF l_tot <> 0 THEN
      LET l_xcce.xcce201 = g_xccd.xccd301 * -1
      LET l_xcce.xcce301 = g_xccd.xccd301
   END IF
   LET l_xcce.xcce202c = l_xcce.xcce202c + l_tot

   IF g_gywwrk = 'Y' THEN  #add zhangllc 160131 有工艺委外采购入库
      #add 150721 zhangllc--begin-- 
      #取工艺委外加工费
      LET l_tot = 0
      INITIALIZE l_inaj.inaj001 TO NULL 
      INITIALIZE l_inaj.inaj002 TO NULL 
      INITIALIZE l_inaj.inaj003 TO NULL 
      FOREACH s_axcp500_wip_2_3_cs2 USING g_xccd.xccd006 INTO l_inaj.inaj001,l_inaj.inaj002 #,l_inaj.inaj003
          IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_3_cs2'
            LET g_errparam.popup  = TRUE
            CALL cl_err()   
            CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                     '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_2_3_cs2')
            CONTINUE FOREACH  
         END IF  
         #CALL s_axcp500_get_ap_sum_1(g_xccd.xccd001,l_inaj.inaj001,l_inaj.inaj002,l_inaj.inaj003) 
         CALL s_axcp500_get_ap_sum_1(g_xccd.xccd001,l_inaj.inaj001,l_inaj.inaj002,0)    
              RETURNING l_sum
         LET l_tot = l_tot + l_sum
      END FOREACH 
      LET l_xcce.xcce202c = l_xcce.xcce202c + l_tot
      #add 150721 zhangllc---end---
   END IF  #add zhangllc 160131
   
   CALL s_axcp500_set_xcce_null_to_zero(l_xcce.*)
        RETURNING l_xcce.*
           
#   IF l_xcce.xcce201  = 0 AND l_xcce.xcce202  = 0 AND l_xcce.xcce202a = 0 AND l_xcce.xcce202b = 0 AND l_xcce.xcce202c = 0 AND
#      l_xcce.xcce202d = 0 AND l_xcce.xcce202e = 0 AND l_xcce.xcce202f = 0 AND l_xcce.xcce202g = 0 AND l_xcce.xcce202h = 0 THEN
#      LET r_success = TRUE
#      RETURN r_success
#   END IF
   
   IF l_xcce.xcce202  = 0 AND l_xcce.xcce202a = 0 AND l_xcce.xcce202b = 0 AND l_xcce.xcce202c = 0 AND
      l_xcce.xcce202d = 0 AND l_xcce.xcce202e = 0 AND l_xcce.xcce202f = 0 AND l_xcce.xcce202g = 0 AND l_xcce.xcce202h = 0 THEN
      LET r_success = TRUE
      RETURN r_success
   END IF
             
           
   CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   LET g_stat_cnt1 = g_stat_cnt1 + 1
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(11,g_stat_begin1,g_stat_end1,g_stat_cnt1)   
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 取当期在制成本调整资料
# Memo...........:
# Usage..........: CALL s_axcp500_wip_2_4()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_2_4()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcce          RECORD LIKE xcce_t.* #161124-00048#20 mark
   DEFINE l_xcce           type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_sum           type_get_cost_rec

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
   CALL s_axcp500_get_xcce(g_xccd.xccd001,' ',g_xccd.xccd006,'ADJUST',' ',' ')
        RETURNING l_xcce.* 

   EXECUTE s_axcp500_def_cursor_p11 USING g_xccd.xccd001,g_xccd.xccd006
                                     INTO l_sum.*
   IF cl_null(l_sum.qty) THEN LET l_sum.qty = 0 END IF
   IF cl_null(l_sum.a)   THEN LET l_sum.a   = 0 END IF
   IF cl_null(l_sum.b)   THEN LET l_sum.b   = 0 END IF
   IF cl_null(l_sum.c)   THEN LET l_sum.c   = 0 END IF
   IF cl_null(l_sum.d)   THEN LET l_sum.d   = 0 END IF
   IF cl_null(l_sum.e)   THEN LET l_sum.e   = 0 END IF
   IF cl_null(l_sum.f)   THEN LET l_sum.f   = 0 END IF
   IF cl_null(l_sum.g)   THEN LET l_sum.g   = 0 END IF
   IF cl_null(l_sum.h)   THEN LET l_sum.h   = 0 END IF
   LET l_sum.tot = l_sum.a + l_sum.b + l_sum.c + l_sum.d +
                   l_sum.e + l_sum.f + l_sum.g + l_sum.h
   
   LET l_xcce.xcce201  = l_xcce.xcce201  + l_sum.qty
   LET l_xcce.xcce202  = l_xcce.xcce202  + l_sum.tot
   LET l_xcce.xcce202a = l_xcce.xcce202a + l_sum.a
   LET l_xcce.xcce202b = l_xcce.xcce202b + l_sum.b
   LET l_xcce.xcce202c = l_xcce.xcce202c + l_sum.c
   LET l_xcce.xcce202d = l_xcce.xcce202d + l_sum.d
   LET l_xcce.xcce202e = l_xcce.xcce202e + l_sum.e
   LET l_xcce.xcce202f = l_xcce.xcce202f + l_sum.f
   LET l_xcce.xcce202g = l_xcce.xcce202g + l_sum.g
   LET l_xcce.xcce202h = l_xcce.xcce202h + l_sum.h                       

   CALL s_axcp500_set_xcce_null_to_zero(l_xcce.*)
        RETURNING l_xcce.*
        
   IF l_xcce.xcce201  = 0 AND l_xcce.xcce202  = 0 AND l_xcce.xcce202a = 0 AND l_xcce.xcce202b = 0 AND l_xcce.xcce202c = 0 AND
      l_xcce.xcce202d = 0 AND l_xcce.xcce202e = 0 AND l_xcce.xcce202f = 0 AND l_xcce.xcce202g = 0 AND l_xcce.xcce202h = 0 THEN
      LET r_success = TRUE
      RETURN r_success
   END IF        
        
   CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET g_stat_cnt1 = g_stat_cnt1 + 1
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(12,g_stat_begin1,g_stat_end1,g_stat_cnt1)    
      
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - xccz档案处理(发料明细对应至工单备料)
# Memo...........:
# Usage..........: CALL s_axcp500_wip_3() 
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_3()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_xccz          RECORD LIKE xccz_t.*   #161124-00048#20 mark
#   DEFINE l_t_xccz        RECORD LIKE xccz_t.*   #161124-00048#20 mark
   DEFINE l_xccz          type_g_xccz  #170605-00013#1-add
   DEFINE l_t_xccz        type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_t_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_inaj          RECORD 
                          inaj005     LIKE inaj_t.inaj005,
                          inaj006     LIKE inaj_t.inaj006,
                          inaj010     LIKE inaj_t.inaj010,
                          inaj015     LIKE inaj_t.inaj015,
                          inaj036     LIKE inaj_t.inaj036,
                          sfdc001     LIKE sfdc_t.sfdc001,
                          sfdc002     LIKE sfdc_t.sfdc002,
                          sfdc003     LIKE sfdc_t.sfdc003,
                          qty         LIKE inaj_t.inaj011,
                          inaj007     LIKE inaj_t.inaj007,
                          inaj008     LIKE inaj_t.inaj008,
                          inajsite    LIKE inaj_t.inajsite,
                          inaj999     LIKE xccz_t.xccz002
                          END RECORD
   DEFINE l_xccz002       LIKE xccz_t.xccz002                          
   DEFINE l_choice        LIKE type_t.chr10
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
   #STEP -1 结转上期的xccz资料至本期
   FOREACH s_axcp500_wip_3_cs1 USING g_xccd.xccd001,g_xccd.xccd003,
                                     g_xccd.xccd006
                                INTO l_t_xccz.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_3_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','',g_last_yy,g_last_pp,g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_3_cs1')
         CONTINUE FOREACH   
      END IF
      CALL s_axcp500_get_xccz(g_xccd.xccd001,l_t_xccz.xccz002,g_xccd.xccd006,l_t_xccz.xccz007,l_t_xccz.xccz008,
                              l_t_xccz.xccz009,l_t_xccz.xccz010,l_t_xccz.xccz011)      
           RETURNING l_xccz.*                              
              
      CALL s_axcp500_ins_or_upd_xccz(l_xccz.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF              
          
      LET g_stat_cnt1 = g_stat_cnt1 + 1          
   END FOREACH
   
   #STEP -2 取当期的发退料元件明细数量
   #发料明细对至工单备料档
   FOREACH s_axcp500_wip_3_cs2 USING g_xccd.xccd006
                                INTO l_inaj.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_3_cs2'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_3_cs2')
         CONTINUE FOREACH   
      END IF

#      LET l_xccz002 = ' '
#      CASE g_field_type
#           WHEN '1'
#                SELECT xcbf001 INTO l_xccz002 FROM xcbf_t
#                 WHERE xcbfent = g_enterprise
#                   AND xcbfcomp = g_comp
#                   AND xcbf002  = l_inaj.inajsite
#           WHEN '2'
#                SELECT xcbf001 INTO l_xccz002 FROM xcbf_t
#                 WHERE xcbfent = g_enterprise
#                   AND xcbfcomp = g_comp
#                   AND xcbf002  = l_inaj.inaj008              
#           WHEN '3'
#                LET l_xccz002 = l_inaj.inaj007
#           OTHERWISE 
#                LET l_xccz002 = ' '
#      END CASE
      
      LET l_xccz002 = l_inaj.inaj999
      IF l_xccz002 IS NULL THEN
         LET l_xccz002 = ' '
      END IF
            
      
      CALL s_axcp500_get_xccz(g_xccd.xccd001,l_xccz002,g_xccd.xccd006,l_inaj.inaj005,l_inaj.inaj006,
                              l_inaj.inaj010,l_inaj.sfdc002,l_inaj.sfdc003)      
           RETURNING l_xccz.*    
                    
      CASE l_inaj.inaj036
           WHEN '115'   #当站下线
                LET l_choice = '205'
           WHEN '302'   #生产发料
                CASE l_inaj.inaj015
                     WHEN 'asft312'   LET l_choice = '209'
                     OTHERWISE        LET l_choice = '201'
                END CASE    
           WHEN '303'   #生产退料
                CASE l_inaj.inaj015
                     WHEN 'asft322'   LET l_choice = '209'
                     OTHERWISE        LET l_choice = '207'
                END CASE    
           WHEN '114'
                LET l_choice = '207'
           WHEN '107'
                LET l_choice = '207'                        
           WHEN '501'   #盘点
                LET l_choice = '307'
      END CASE

      CASE l_choice
           WHEN '201' LET l_xccz.xccz201 = l_xccz.xccz201 + l_inaj.qty
           WHEN '205' LET l_xccz.xccz205 = l_xccz.xccz205 + l_inaj.qty
           WHEN '207' LET l_xccz.xccz207 = l_xccz.xccz207 + l_inaj.qty
           WHEN '209' LET l_xccz.xccz209 = l_xccz.xccz209 + l_inaj.qty
           WHEN '307' LET l_xccz.xccz307 = l_xccz.xccz307 + l_inaj.qty
      END CASE
      
      CALL s_axcp500_ins_or_upd_xccz(l_xccz.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF          
      LET g_stat_cnt1 = g_stat_cnt1 + 1      
   END FOREACH
   
   #工单下线及工单盘点也要加入xccz_t吗?
   #carrier 待确定
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(13,g_stat_begin1,g_stat_end1,g_stat_cnt1)
   
   LET r_success = TRUE   
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算 - 元件按主件入库数量转出
# Memo...........:
# Usage..........: CALL s_axcp500_wip_4(p_close) 
#                       RETURNING r_success
# Input parameter: p_close        工单本期结案否
#                : p_qty          本次结转套数(FOR 移动加权)
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_4(p_close,p_qty)
   DEFINE p_close         LIKE type_t.chr1
   DEFINE p_qty           LIKE xccd_t.xccd301
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_sfbaseq       LIKE sfba_t.sfbaseq
   DEFINE l_sfbaseq1      LIKE sfba_t.sfbaseq1
   DEFINE l_sfba006       LIKE sfba_t.sfba006    #发料料件
   DEFINE l_sfba021       LIKE sfba_t.sfba021    #特征
   DEFINE l_sfba006_t     LIKE sfba_t.sfba006
   DEFINE l_sfba021_t     LIKE sfba_t.sfba021
   DEFINE l_sfba022       LIKE sfba_t.sfba022    #替代率
   DEFINE l_sfba013       LIKE sfba_t.sfba013    #总应发数量
   DEFINE l_sfba015       LIKE sfba_t.sfba015    #代买量
   DEFINE l_sfaa012       LIKE sfaa_t.sfaa012    #主件生产数量
   DEFINE l_qpa           LIKE sfba_t.sfba010
   DEFINE l_tot           LIKE sfaa_t.sfaa012    #应转数量
   DEFINE l_left          LIKE sfaa_t.sfaa012    #剩余还要转的数量
   DEFINE l_qty1          LIKE sfaa_t.sfaa012    #当前项序可转数量
   DEFINE l_qty2          LIKE sfaa_t.sfaa012
   DEFINE l_xccz101       LIKE xccz_t.xccz101
   DEFINE l_xccz102       LIKE xccz_t.xccz201
#   DEFINE l_xcce          RECORD LIKE xcce_t.*  #161124-00048#20 mark
   DEFINE l_xcce          type_g_xcce  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xcce RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企业编号
#       xccecomp LIKE xcce_t.xccecomp, #法人组织
#       xcceld LIKE xcce_t.xcceld, #账套
#       xcce001 LIKE xcce_t.xcce001, #账套本位币顺序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本计算类型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期别
#       xcce006 LIKE xcce_t.xcce006, #工单编号
#       xcce007 LIKE xcce_t.xcce007, #元件编号
#       xcce008 LIKE xcce_t.xcce008, #产品特征
#       xcce009 LIKE xcce_t.xcce009, #批号
#       xcce010 LIKE xcce_t.xcce010, #核算币种
#       xcce101 LIKE xcce_t.xcce101, #上期结存数量
#       xcce102 LIKE xcce_t.xcce102, #上期结存金额
#       xcce102a LIKE xcce_t.xcce102a, #上期结存金额-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期结存金额-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期结存金额-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期结存金额-制费一
#       xcce102e LIKE xcce_t.xcce102e, #上期结存金额-制费二
#       xcce102f LIKE xcce_t.xcce102f, #上期结存金额-制费三
#       xcce102g LIKE xcce_t.xcce102g, #上期结存金额-制费四
#       xcce102h LIKE xcce_t.xcce102h, #上期结存金额-制费五
#       xcce201 LIKE xcce_t.xcce201, #本期投入数量
#       xcce202 LIKE xcce_t.xcce202, #本期本阶投入金额
#       xcce202a LIKE xcce_t.xcce202a, #本期本阶投入金额-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本阶投入金额-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本阶投入金额-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本阶投入金额-制费一
#       xcce202e LIKE xcce_t.xcce202e, #本期本阶投入金额-制费二
#       xcce202f LIKE xcce_t.xcce202f, #本期本阶投入金额-制费三
#       xcce202g LIKE xcce_t.xcce202g, #本期本阶投入金额-制费四
#       xcce202h LIKE xcce_t.xcce202h, #本期本阶投入金额-制费五
#       xcce205 LIKE xcce_t.xcce205, #本期当站下线数量
#       xcce206 LIKE xcce_t.xcce206, #本期当站下线成本
#       xcce206a LIKE xcce_t.xcce206a, #本期当站下线成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期当站下线成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期当站下线成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期当站下线成本-制费一
#       xcce206e LIKE xcce_t.xcce206e, #本期当站下线成本-制费二
#       xcce206f LIKE xcce_t.xcce206f, #本期当站下线成本-制费三
#       xcce206g LIKE xcce_t.xcce206g, #本期当站下线成本-制费四
#       xcce206h LIKE xcce_t.xcce206h, #本期当站下线成本-制费五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料数量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制费一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制费二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制费三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制费四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制费五
#       xcce209 LIKE xcce_t.xcce209, #本期超领退数量
#       xcce210 LIKE xcce_t.xcce210, #本期超领退金额
#       xcce210a LIKE xcce_t.xcce210a, #本期超领退金额-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超领退金额-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超领退金额-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超领退金额-制费一
#       xcce210e LIKE xcce_t.xcce210e, #本期超领退金额-制费二
#       xcce210f LIKE xcce_t.xcce210f, #本期超领退金额-制费三
#       xcce210g LIKE xcce_t.xcce210g, #本期超领退金额-制费四
#       xcce210h LIKE xcce_t.xcce210h, #本期超领退金额-制费五
#       xcce301 LIKE xcce_t.xcce301, #本期转出数量
#       xcce302 LIKE xcce_t.xcce302, #本期转出金额
#       xcce302a LIKE xcce_t.xcce302a, #本期转出金额-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期转出金额-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期转出金额-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期转出金额-制费一
#       xcce302e LIKE xcce_t.xcce302e, #本期转出金额-制费二
#       xcce302f LIKE xcce_t.xcce302f, #本期转出金额-制费三
#       xcce302g LIKE xcce_t.xcce302g, #本期转出金额-制费四
#       xcce302h LIKE xcce_t.xcce302h, #本期转出金额-制费五
#       xcce303 LIKE xcce_t.xcce303, #差异转出数量
#       xcce304 LIKE xcce_t.xcce304, #差异转出金额
#       xcce304a LIKE xcce_t.xcce304a, #差异转出金额-材料
#       xcce304b LIKE xcce_t.xcce304b, #差异转出金额-人工
#       xcce304c LIKE xcce_t.xcce304c, #差异转出金额-加工
#       xcce304d LIKE xcce_t.xcce304d, #差异转出金额-制费一
#       xcce304e LIKE xcce_t.xcce304e, #差异转出金额-制费二
#       xcce304f LIKE xcce_t.xcce304f, #差异转出金额-制费三
#       xcce304g LIKE xcce_t.xcce304g, #差异转出金额-制费四
#       xcce304h LIKE xcce_t.xcce304h, #差异转出金额-制费五
#       xcce307 LIKE xcce_t.xcce307, #盘差数量
#       xcce308 LIKE xcce_t.xcce308, #盘差金额
#       xcce308a LIKE xcce_t.xcce308a, #盘差金额-材料
#       xcce308b LIKE xcce_t.xcce308b, #盘差金额-人工
#       xcce308c LIKE xcce_t.xcce308c, #盘差金额-加工
#       xcce308d LIKE xcce_t.xcce308d, #盘差金额-制费一
#       xcce308e LIKE xcce_t.xcce308e, #盘差金额-制费二
#       xcce308f LIKE xcce_t.xcce308f, #盘差金额-制费三
#       xcce308g LIKE xcce_t.xcce308g, #盘差金额-制费四
#       xcce308h LIKE xcce_t.xcce308h, #盘差金额-制费五
#       xcce901 LIKE xcce_t.xcce901, #期末结存数量
#       xcce902 LIKE xcce_t.xcce902, #期末结存金额
#       xcce902a LIKE xcce_t.xcce902a, #期末结存金额-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末结存金额-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末结存金额-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末结存金额-制费一
#       xcce902e LIKE xcce_t.xcce902e, #期末结存金额-制费二
#       xcce902f LIKE xcce_t.xcce902f, #期末结存金额-制费三
#       xcce902g LIKE xcce_t.xcce902g, #期末结存金额-制费四
#       xcce902h LIKE xcce_t.xcce902h, #期末结存金额-制费五
#       xccetime LIKE xcce_t.xccetime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
#   DEFINE l_xccz          RECORD LIKE xccz_t.*  #161124-00048#20 mark
DEFINE l_xccz              type_g_xccz  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
##161124-00048#20 add(s)
#DEFINE l_xccz RECORD  #在製元件發料明細檔
#       xcczent LIKE xccz_t.xcczent, #企业编号
#       xcczcomp LIKE xccz_t.xcczcomp, #法人
#       xcczld LIKE xccz_t.xcczld, #账套
#       xccz001 LIKE xccz_t.xccz001, #账套本位币顺序
#       xccz002 LIKE xccz_t.xccz002, #成本域
#       xccz003 LIKE xccz_t.xccz003, #成本计算类型
#       xccz004 LIKE xccz_t.xccz004, #年度
#       xccz005 LIKE xccz_t.xccz005, #期别
#       xccz006 LIKE xccz_t.xccz006, #工单编号
#       xccz007 LIKE xccz_t.xccz007, #元件编号
#       xccz008 LIKE xccz_t.xccz008, #产品特征
#       xccz009 LIKE xccz_t.xccz009, #批号
#       xccz010 LIKE xccz_t.xccz010, #项次
#       xccz011 LIKE xccz_t.xccz011, #项序
#       xccz101 LIKE xccz_t.xccz101, #上期结存数量
#       xccz201 LIKE xccz_t.xccz201, #本期投入数量
#       xccz205 LIKE xccz_t.xccz205, #本期当站下线数量
#       xccz207 LIKE xccz_t.xccz207, #本期一般退料数量
#       xccz209 LIKE xccz_t.xccz209, #本期超领退数量
#       xccz301 LIKE xccz_t.xccz301, #本期转出数量
#       xccz303 LIKE xccz_t.xccz303, #差异转出数量
#       xccz307 LIKE xccz_t.xccz307, #盘差数量
#       xccz901 LIKE xccz_t.xccz901  #期末结存数量
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_xccd301       LIKE xccd_t.xccd301
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcbi100       LIKE xcbi_t.xcbi100   #180611-00091#1 add
   DEFINE l_xcbi103       LIKE xcbi_t.xcbi103
   DEFINE l_rate          LIKE type_t.num26_10
   DEFINE l_avg           type_get_cost_rec
   DEFINE l_avg1          type_g_std_cost    
   DEFINE l_qty3          LIKE xcce_t.xcce201      #FOR 移动加权
   DEFINE l_qty4          LIKE type_t.num26_10
   #161230-00010#15---s
   DEFINE l_inaj011       LIKE type_t.num26_10
   DEFINE l_xcce302b      LIKE xcce_t.xcce302b
   DEFINE l_xcce302c      LIKE xcce_t.xcce302c
   DEFINE l_xcce302d      LIKE xcce_t.xcce302d
   DEFINE l_xcce302e      LIKE xcce_t.xcce302e
   DEFINE l_xcce302f      LIKE xcce_t.xcce302f
   DEFINE l_xcce302g      LIKE xcce_t.xcce302g
   DEFINE l_xcce302h      LIKE xcce_t.xcce302h
   #161230-00010#15---e
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
   LET l_left = 0
   #取备料  
   FOREACH s_axcp500_wip_4_cs1 USING g_xccd.xccd006 
                                INTO l_sfbaseq,l_sfbaseq1,l_sfba006,l_sfba021,
                                     l_sfba022,l_sfba013,l_sfba015,l_sfaa012
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_4_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',l_sfba006,'',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_4_cs1')
         CONTINUE FOREACH   
      END IF
      
#      #主件
#      IF l_sfba006 = g_xccd.xccd007 THEN
#         CONTINUE FOREACH
#      END IF
      
      #项次=0,代表主元件,项次<>0为替代料
      IF l_sfbaseq1 = 0 THEN
#         IF l_left > 0  THEN
#            #计算主件%1的过程中,无件%2的转出数量不足
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code   = 'axc-00519'
#            LET g_errparam.extend = ''
#            LET g_errparam.replace[1]=g_xccd.xccd006
#            LET g_errparam.replace[2]=g_xccd.xccd007
#            LET g_errparam.replace[3]=l_sfba006_t
#            LET g_errparam.popup  = TRUE
#            CALL cl_err()   
#            LET g_str = cl_getmsg('axc-00519',g_lang)
#            LET g_str = cl_err_replace_msg(g_str)
#            CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,l_sfbaseq,l_sfbaseq1,'',l_sfba006,'',
#                                     '','','axc-00519',g_str,'')
##           RETURN r_success           
#         END IF
      
         #若实际应发数量=0,则不需要处理
         #SELECT SUM((sfba013 - sfba015 )/sfba022) INTO l_sfba013  #170705-00006#1 mark
         SELECT SUM(CASE sfba022 WHEN 0 THEN 0 ELSE (sfba013 - sfba015 )/sfba022 END) INTO l_sfba013  #170705-00006#1 add        
           FROM sfba_tmp
          WHERE sfbaent   = g_enterprise
            AND sfbadocno = g_xccd.xccd006
            AND sfbaseq   = l_sfbaseq
            
         IF cl_null(l_sfba013) THEN LET l_sfba013 = 0 END IF
         
         IF l_sfba013 <=0 THEN
            CONTINUE FOREACH
         END IF
         
         #实际QPA      
#        LET l_qpa = ( l_sfba013 - l_sfba015) / l_sfaa012 
         #LET l_qpa = l_sfba013 / l_sfaa012  #170705-00006#1 mark
         #170705-00006#1 add(S)
         IF l_sfaa012 <> 0 THEN
            LET l_qpa = l_sfba013 / l_sfaa012
         ELSE
            LET l_qpa = 0
         END IF
         #170705-00006#1 add(E)         
         IF cl_null(l_qpa) THEN LET l_qpa = 0 END IF
         
         #应转数量
         LET l_xccd301 = g_xccd.xccd301 * -1
         IF g_cost_type = '4' OR g_cost_type = '2' THEN   #移动加权平均 OR 先进先出
            #移动加权平均元件转出是BY每次入库的数量来进行分批次结转,并不是以总入为数量的角度来做一次性材料成本结转
            LET l_xccd301 = p_qty * -1
         END IF
         LET l_tot = l_xccd301 * l_qpa
         IF l_tot <=0 THEN
            CONTINUE FOREACH      
         END IF
         LET l_left = l_tot
         
         #旧值
         LET l_sfba006_t = l_sfba006
         LET l_sfba021_t = l_sfba021
      END IF
      
      #本项次不需要再转了,数量已经够了
      IF l_left <=0 THEN
         CONTINUE FOREACH
      END IF

      #按此备料料件串xcce
      FOREACH s_axcp500_wip_4_cs3 USING g_xccd.xccd001,g_xccd.xccd003,g_xccd.xccd004,
                                        g_xccd.xccd005,g_xccd.xccd006,l_sfba006
                                   INTO l_xcce.*
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = 'FOREACH s_axcp500_wip_4_cs3'
            LET g_errparam.popup  = TRUE
            CALL cl_err()   
            CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,l_sfbaseq,l_sfbaseq1,'',l_sfba006,'',
                                     '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_4_cs3')
            CONTINUE FOREACH   
         END IF
         CALL s_axcp500_get_xccz(g_xccd.xccd001,l_xcce.xcce002,g_xccd.xccd006,l_xcce.xcce007,l_xcce.xcce008,
                                 l_xcce.xcce009,l_sfbaseq,l_sfbaseq1)      
              RETURNING l_xccz.*  
           
         #取出此项次+项序的可转数量
#         LET l_qty1 = l_xccz.xccz101 + l_xccz.xccz201 + l_xccz.xccz205 + l_xccz.xccz207 
#         IF g_cost_type = '4' OR g_cost_type = '2' THEN   #移动加权 OR 先进先出
#            LET l_qty1 = l_xccz.xccz101 + l_xccz.xccz201 + l_xccz.xccz205 + l_xccz.xccz207 + l_xccz.xccz301
#         END IF
         LET l_qty1 = l_xccz.xccz101 + l_xccz.xccz201 + l_xccz.xccz207 + l_xccz.xccz209  #加上超领
         IF g_cost_type = '4' OR g_cost_type = '2' THEN   #移动加权 OR 先进先出
            LET l_qty1 = l_xccz.xccz101 + l_xccz.xccz201 + l_xccz.xccz207 + l_xccz.xccz301
         END IF
         IF l_qty1 <=0 THEN
            CONTINUE FOREACH
         END IF
         
         #LET l_qty4 = l_qty1 / l_sfba022  #170705-00006#1 mark
         #170705-00006#1 add(S)
         IF l_sfba022 <>0 THEN
            LET l_qty4 = l_qty1 / l_sfba022
         ELSE 
            LET l_qty4 = 0
         END IF            
         #170705-00006#1 add(E)
#         IF l_left <= l_qty1 THEN
         IF l_left <= l_qty4 THEN
            LET l_qty2 = l_left * l_sfba022
         ELSE
            LET l_qty2 = l_qty4
         END IF
         
         LET l_qty2 = l_qty2 * -1
         
         CASE 
            WHEN g_cost_type = '1'   #标准成本时
               LET l_xcce.xcce301 = l_xcce.xcce301 + l_qty2   #本期轉出數量
         
#               CALL s_axcp500_std_get_std_cost(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007)   #171211-00028#13 mark
               CALL s_axcp500_std_get_std_cost1(l_xcce.xcce001,l_xcce.xcce002,g_xcag001,l_xcce.xcce007,l_xcce.xcce008)   #171211-00028#13 mod
                    RETURNING l_success,l_avg1.*  
#               LET l_avg.qty = 0
#               LET l_avg.tot = l_avg1.sum
#               LET l_avg.a   = l_avg1.a
#               LET l_avg.b   = l_avg1.b
#               LET l_avg.c   = l_avg1.c
#               LET l_avg.d   = l_avg1.d
#               LET l_avg.e   = l_avg1.e
#               LET l_avg.f   = l_avg1.f
#               LET l_avg.g   = l_avg1.g
#               LET l_avg.h   = l_avg1.h
                 
            WHEN g_cost_type MATCHES '[35]'  #月加权/批次       
               LET l_xcce.xcce301 = l_xcce.xcce301 + l_qty2   #本期轉出數量
#              CALL s_axcp500_avg_get_cost(g_xccd.xccd007,l_xcce.xcce001,l_xcce.xcce002,l_xcce.xcce003,l_xcce.xcce004,
#                                          l_xcce.xcce005,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce009)
#                   RETURNING l_success,l_avg1.*
#              IF NOT l_success THEN
#
#              END IF
                CALL s_axcp500_avg_get_xcck_cost(g_xccd.xccd001,g_xccd.xccd006,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce009,g_xccd.xccd007)
                     RETURNING l_success,l_avg1.*  
                IF NOT l_success THEN
      #             RETURN r_success
                END IF
#               LET l_avg.qty = 0
#               LET l_avg.tot = l_avg1.sum
#               LET l_avg.a   = l_avg1.a
#               LET l_avg.b   = l_avg1.b
#               LET l_avg.c   = l_avg1.c
#               LET l_avg.d   = l_avg1.d
#               LET l_avg.e   = l_avg1.e
#               LET l_avg.f   = l_avg1.f
#               LET l_avg.g   = l_avg1.g
#               LET l_avg.h   = l_avg1.h
               
            WHEN g_cost_type = '4' OR g_cost_type = '2'  #移动加权 OR 先进先出
               #剩余材料投入
               LET l_qty3 = l_xcce.xcce101 + l_xcce.xcce201 + l_xcce.xcce205 + l_xcce.xcce207 + l_xcce.xcce301
               #LET l_rate = l_qty2 / l_qty3   #转出比率  #170705-00006#1 mark
               #170705-00006#1 add(S)
               IF l_qty3 <> 0 THEN
                  LET l_rate = l_qty2 / l_qty3
               ELSE
                  LET l_rate = 0
               END IF    
               #170705-00006#1 add(E)
               #161230-00010#7---s
               #先进先出成本更新xcce之前，先写入详细的异动记录到xcct
               IF g_cost_type = '2' THEN
                  LET g_xcct.xcct007 = l_xcce.xcce007
                  LET g_xcct.xcct008 = l_xcce.xcce008
                  LET g_xcct.xcct009 = l_xcce.xcce009
                  
                  SELECT xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h
                     INTO g_xcct.xcct101, g_xcct.xcct102, g_xcct.xcct102a,g_xcct.xcct102b,g_xcct.xcct102c,
                          g_xcct.xcct102d,g_xcct.xcct102e,g_xcct.xcct102f,g_xcct.xcct102g,g_xcct.xcct102h
                  FROM xcce_tmp
                  WHERE xcceent = g_enterprise AND xcceld = g_xcct.xcctld 
                    AND xcce001 = g_xcct.xcct001 AND xcce002 = g_xcct.xcct002
                    AND xcce003 = g_xcct.xcct003 AND xcce004 = g_xcct.xcct004 AND xcce005 = g_xcct.xcct005
                    AND xcce006 = g_xcct.xcct006 AND xcce007 = g_xcct.xcct007 AND xcce008 = g_xcct.xcct008
                    AND xcce009 = g_xcct.xcct009 
                  LET g_xcct.xcct201 = l_qty2
                  LET g_xcct.xcct202a= (l_xcce.xcce102a + l_xcce.xcce202a + l_xcce.xcce206a + l_xcce.xcce208a + l_xcce.xcce302a) * l_rate 
                  LET g_xcct.xcct202b= (l_xcce.xcce102b + l_xcce.xcce202b + l_xcce.xcce206b + l_xcce.xcce208b + l_xcce.xcce302b) * l_rate 
                  LET g_xcct.xcct202c= (l_xcce.xcce102c + l_xcce.xcce202c + l_xcce.xcce206c + l_xcce.xcce208c + l_xcce.xcce302c) * l_rate 
                  LET g_xcct.xcct202d= (l_xcce.xcce102d + l_xcce.xcce202d + l_xcce.xcce206d + l_xcce.xcce208d + l_xcce.xcce302d) * l_rate 
                  LET g_xcct.xcct202e= (l_xcce.xcce102e + l_xcce.xcce202e + l_xcce.xcce206e + l_xcce.xcce208e + l_xcce.xcce302e) * l_rate 
                  LET g_xcct.xcct202f= (l_xcce.xcce102f + l_xcce.xcce202f + l_xcce.xcce206f + l_xcce.xcce208f + l_xcce.xcce302f) * l_rate 
                  LET g_xcct.xcct202g= (l_xcce.xcce102g + l_xcce.xcce202g + l_xcce.xcce206g + l_xcce.xcce208g + l_xcce.xcce302g) * l_rate 
                  LET g_xcct.xcct202h= (l_xcce.xcce102h + l_xcce.xcce202h + l_xcce.xcce206h + l_xcce.xcce208h + l_xcce.xcce302h) * l_rate      
                  LET g_xcct.xcct202 = g_xcct.xcct202a+g_xcct.xcct202b+g_xcct.xcct202c+g_xcct.xcct202d+
                                       g_xcct.xcct202e+g_xcct.xcct202f+g_xcct.xcct202g+g_xcct.xcct202h
                  CALL s_axcp500_ins_or_upd_xcct() RETURNING l_success
                  IF NOT l_success THEN
                  END IF
               END IF
               #161230-00010#7---e    
               
               LET l_xcce.xcce301 = l_xcce.xcce301 + l_qty2   #本期轉出數量
         
               
               LET l_xcce.xcce302a = l_xcce.xcce302a + (l_xcce.xcce102a + l_xcce.xcce202a + l_xcce.xcce206a + 
                                                        l_xcce.xcce208a + l_xcce.xcce302a) * l_rate 
               LET l_xcce.xcce302b = l_xcce.xcce302b + (l_xcce.xcce102b + l_xcce.xcce202b + l_xcce.xcce206b + 
                                                        l_xcce.xcce208b + l_xcce.xcce302b) * l_rate 
               LET l_xcce.xcce302c = l_xcce.xcce302c + (l_xcce.xcce102c + l_xcce.xcce202c + l_xcce.xcce206c + 
                                                        l_xcce.xcce208c + l_xcce.xcce302c) * l_rate 
               LET l_xcce.xcce302d = l_xcce.xcce302d + (l_xcce.xcce102d + l_xcce.xcce202d + l_xcce.xcce206d + 
                                                        l_xcce.xcce208d + l_xcce.xcce302d) * l_rate 
               LET l_xcce.xcce302e = l_xcce.xcce302e + (l_xcce.xcce102e + l_xcce.xcce202e + l_xcce.xcce206e + 
                                                        l_xcce.xcce208e + l_xcce.xcce302e) * l_rate 
               LET l_xcce.xcce302f = l_xcce.xcce302f + (l_xcce.xcce102f + l_xcce.xcce202f + l_xcce.xcce206f + 
                                                        l_xcce.xcce208f + l_xcce.xcce302f) * l_rate 
               LET l_xcce.xcce302g = l_xcce.xcce302g + (l_xcce.xcce102g + l_xcce.xcce202g + l_xcce.xcce206g + 
                                                        l_xcce.xcce208g + l_xcce.xcce302g) * l_rate 
               LET l_xcce.xcce302h = l_xcce.xcce302h + (l_xcce.xcce102h + l_xcce.xcce202h + l_xcce.xcce206h + 
                                                        l_xcce.xcce208h + l_xcce.xcce302h) * l_rate          
               LET l_xcce.xcce302  = l_xcce.xcce302a + l_xcce.xcce302b + l_xcce.xcce302c + l_xcce.xcce302d +
                                     l_xcce.xcce302e + l_xcce.xcce302f + l_xcce.xcce302g + l_xcce.xcce302h    
                       
                                     
         END CASE
         IF g_cost_type <> '4' AND g_cost_type <> '2' THEN
            LET l_xcce.xcce302a = l_xcce.xcce302a + l_qty2 * l_avg1.a
            LET l_xcce.xcce302b = l_xcce.xcce302b + l_qty2 * l_avg1.b
            LET l_xcce.xcce302c = l_xcce.xcce302c + l_qty2 * l_avg1.c
            LET l_xcce.xcce302d = l_xcce.xcce302d + l_qty2 * l_avg1.d
            LET l_xcce.xcce302e = l_xcce.xcce302e + l_qty2 * l_avg1.e
            LET l_xcce.xcce302f = l_xcce.xcce302f + l_qty2 * l_avg1.f
            LET l_xcce.xcce302g = l_xcce.xcce302g + l_qty2 * l_avg1.g
            LET l_xcce.xcce302h = l_xcce.xcce302h + l_qty2 * l_avg1.h
            LET l_xcce.xcce302  = l_xcce.xcce302a + l_xcce.xcce302b + l_xcce.xcce302c + l_xcce.xcce302d +
                                  l_xcce.xcce302e + l_xcce.xcce302f + l_xcce.xcce302g + l_xcce.xcce302h
         END IF          

         CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
              RETURNING l_success
         IF NOT l_success THEN
#           RETURN r_success
         END IF
         
         #161230-00010#7---s
         #先进先出成本更新xcce之前，先写入详细的异动记录到xcct
         #更新后xcce的期末结存给xcct的本次结存
         IF g_cost_type = '2' THEN
            SELECT xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h
               INTO g_xcct.xcct901, g_xcct.xcct902, g_xcct.xcct902a,g_xcct.xcct902b,g_xcct.xcct902c,
                    g_xcct.xcct902d,g_xcct.xcct902e,g_xcct.xcct902f,g_xcct.xcct902g,g_xcct.xcct902h
            FROM xcce_tmp 
            WHERE xcceent = g_enterprise AND xcceld = g_xcct.xcctld 
              AND xcce001 = g_xcct.xcct001 AND xcce002 = g_xcct.xcct002
              AND xcce003 = g_xcct.xcct003 AND xcce004 = g_xcct.xcct004 AND xcce005 = g_xcct.xcct005
              AND xcce006 = g_xcct.xcct006 AND xcce007 = g_xcct.xcct007 AND xcce008 = g_xcct.xcct008
              AND xcce009 = g_xcct.xcct009 
              
            CALL s_axcp500_upd_xcct() RETURNING l_success
            IF NOT l_success THEN
            END IF
         END IF
         #161230-00010#7---e   
         
         LET l_xccz.xccz301 = l_xccz.xccz301 + l_qty2
         CALL s_axcp500_ins_or_upd_xccz(l_xccz.*)
              RETURNING l_success
         IF NOT l_success THEN
#           RETURN r_success
         END IF         
         
         LET l_left = l_left + l_qty2

         LET g_stat_cnt1 = g_stat_cnt1 + 1
      END FOREACH
     
   END FOREACH

   #最后一个项次是否可以正常结转?
#   IF l_left > 0  THEN
#      #计算主件%1的过程中,无件%2的转出数量不足
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = 'axc-00519'
#      LET g_errparam.extend = ''
#      LET g_errparam.replace[1]=g_xccd.xccd006
#      LET g_errparam.replace[2]=g_xccd.xccd007      
#      LET g_errparam.replace[3]=l_sfba006_t
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()   
#      LET g_str = cl_getmsg('axc-00519',g_lang)
#      LET g_str = cl_err_replace_msg(g_str)
#      CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,l_sfbaseq,l_sfbaseq1,'',l_sfba006,'',
#                               '','','axc-00519',g_str,'')
##     RETURN r_success           
#   END IF
   
   #取DL+OH+SUB
   FOREACH s_axcp500_wip_4_cs3 USING g_xccd.xccd001,g_xccd.xccd003,g_xccd.xccd004,
                                     g_xccd.xccd005,g_xccd.xccd006,'DL+OH+SUB'
                                INTO l_xcce.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_4_cs3'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','','DL+OH+SUB','',
                                  '','',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_4_cs3')
         CONTINUE FOREACH   
      END IF   
      
      #在制人工制费分摊方式
#    　成本参数S-FIN-60014(在制人工制费转出规则)='1.依约当量'
#        根据工单号和年度、期别从报工数据档(xcbh_t/xcbi_t)中抓取期末在制约当量xcbi103
##    　　转出比率=工单在制转出数量/(工单在制转出数量+在制约当量)  #180611-00091#1 mark
#        轉出比率=(轉出數量*(SUM(1/(入庫數量*同成本中心的報工站數+約當量)/總報工站數)   #180611-00091#1 mod
#               =(SUM(xcbi100 入庫量)/SUM(xcbi100入庫量+xcbi103約當量)              #180611-00091#1 mod
#      成本参数S-FIN-60014(在制人工制费转出规则)='2.依投入套数'（相当于期末在制约当量为100%）
#        转出比率=工单在制转出数量/(工单在制期初结存数量+本期在制投入数量)
#      成本参数S-FIN-60014(在制人工制费转出规则)='3.依产出套数'（相当于期末在制约当量为0%）
#        转出比率=1      
      CASE g_sys_6014
           WHEN '1'
#                SELECT SUM(xcbi103) INTO l_xcbi103 FROM xcbh_t,xcbi_t   #180611-00091#1 mark
                SELECT SUM(xcbi100),SUM(xcbi100+xcbi103) INTO l_xcbi100,l_xcbi103 FROM xcbh_t,xcbi_t   #180611-00091#1 add xcbi100
                 WHERE xcbhent   = xcbient AND xcbient = g_enterprise
                   AND xcbhdocno = xcbidocno
                   AND xcbh001   BETWEEN g_bdate AND g_edate
                   AND xcbi002   = g_xccd.xccd006
                   AND xcbhstus  = 'Y'  
                IF cl_null(l_xcbi103) THEN LET l_xcbi103 = 0 END IF
                IF cl_null(l_xcbi100) THEN LET l_xcbi100 = 0 END IF #180611-00091#1 add
                #LET l_rate = g_xccd.xccd301 / (g_xccd.xccd301 - l_xcbi103)  #170705-00006#1 mark
                #180611-00091#1 mark-S
#                #170705-00006#1 add(S)
#                IF (g_xccd.xccd301 - l_xcbi103) <> 0 THEN
#                   LET l_rate = g_xccd.xccd301 / (g_xccd.xccd301 - l_xcbi103)
#                ELSE 
#                   LET l_rate = 0
#                END IF 
#                #170705-00006#1 add(E)
                #180611-00091#1 mark-E
                #180611-00091#1 add-S 
                #l_rate=(SUM(xcbi100 入庫量)/SUM(xcbi100入庫量+xcbi103約當量)
                IF l_xcbi103 <> 0 THEN
                   LET l_rate = l_xcbi100 / l_xcbi103
                ELSE
                   LET l_rate = 0
                END IF
                #180611-00091#1 add-E               
           WHEN '2'
                #LET l_rate = g_xccd.xccd301 / (g_xccd.xccd101 + g_xccd.xccd201 )  #170705-00006#1 mark
                #170705-00006#1 add(S)
                IF (g_xccd.xccd101 + g_xccd.xccd201 ) <> 0 THEN
                   LET l_rate = g_xccd.xccd301 / (g_xccd.xccd101 + g_xccd.xccd201 )
                ELSE
                   LET l_rate = 0
                END IF 
                #170705-00006#1 add(E)                
           OTHERWISE
                #161230-00010#15---s
                #LET l_rate = 1
                #先進先出是每入庫一次跑一次這段，在算比例時，要先把每月本工單入庫量先算出來，才能算出這次的比例
                IF g_cost_type = '2' THEN
                	 ## 本月工單總入庫量
                	 SELECT NVL(SUM(inaj011),0) INTO l_inaj011 FROM inaj_tmp
                	  WHERE inaj020 = g_xccd.xccd006  #工單
                	    AND inaj036 in ('110','112','111')  ##110工單入庫 112多主件入庫 111聯產品入庫
                	 #LET l_rate = p_qty / (l_inaj011 - (g_xccd.xccd301*-1) + (p_qty*-1))  #170705-00006#1 mark
                	 #170705-00006#1 add(S)
                	 IF (l_inaj011 - (g_xccd.xccd301*-1) + (p_qty*-1)) <> 0 THEN
                	    LET l_rate = p_qty / (l_inaj011 - (g_xccd.xccd301*-1) + (p_qty*-1))
                	 ELSE
                	    LET l_rate = 0
                	 END IF
                   #170705-00006#1 add(E)                	 
                ELSE
                   LET l_rate = 1
                END IF
                #161230-00010#15---e
      END CASE
      
      LET l_xcce.xcce301  = g_xccd.xccd301
      LET l_rate = l_rate * -1
      
      #161230-00010#15---s
      #LET l_xcce.xcce302b = l_rate * (l_xcce.xcce102b + l_xcce.xcce202b)
      #LET l_xcce.xcce302d = l_rate * (l_xcce.xcce102d + l_xcce.xcce202d)
      #LET l_xcce.xcce302e = l_rate * (l_xcce.xcce102e + l_xcce.xcce202e)
      #LET l_xcce.xcce302f = l_rate * (l_xcce.xcce102f + l_xcce.xcce202f)
      #LET l_xcce.xcce302g = l_rate * (l_xcce.xcce102g + l_xcce.xcce202g)
      #LET l_xcce.xcce302h = l_rate * (l_xcce.xcce102h + l_xcce.xcce202h)
      #
      #LET l_rate = g_xccd.xccd301 / (g_xccd.xccd101 + g_xccd.xccd201 )
      #LET l_xcce.xcce302c = l_rate * (l_xcce.xcce102c + l_xcce.xcce202c)
      IF g_cost_type = '2' THEN
         LET l_xcce302b = l_rate * (l_xcce.xcce102b + l_xcce.xcce202b + l_xcce.xcce302b) * -1
         LET l_xcce302d = l_rate * (l_xcce.xcce102d + l_xcce.xcce202d + l_xcce.xcce302d) * -1
         LET l_xcce302e = l_rate * (l_xcce.xcce102e + l_xcce.xcce202e + l_xcce.xcce302e) * -1
         LET l_xcce302f = l_rate * (l_xcce.xcce102f + l_xcce.xcce202f + l_xcce.xcce302f) * -1
         LET l_xcce302g = l_rate * (l_xcce.xcce102g + l_xcce.xcce202g + l_xcce.xcce302g) * -1
         LET l_xcce302h = l_rate * (l_xcce.xcce102h + l_xcce.xcce202h + l_xcce.xcce302h) * -1
         LET l_xcce302c = l_rate * (l_xcce.xcce102c + l_xcce.xcce202c + l_xcce.xcce302c) * -1

         LET l_xcce.xcce302b = l_xcce.xcce302b + l_xcce302b
         LET l_xcce.xcce302d = l_xcce.xcce302d + l_xcce302d
         LET l_xcce.xcce302e = l_xcce.xcce302e + l_xcce302e
         LET l_xcce.xcce302f = l_xcce.xcce302f + l_xcce302f
         LET l_xcce.xcce302g = l_xcce.xcce302g + l_xcce302g
         LET l_xcce.xcce302h = l_xcce.xcce302h + l_xcce302h
         LET l_xcce.xcce302c = l_xcce.xcce302c + l_xcce302c
      ELSE
         LET l_xcce.xcce302b = l_rate * (l_xcce.xcce102b + l_xcce.xcce202b)
         LET l_xcce.xcce302d = l_rate * (l_xcce.xcce102d + l_xcce.xcce202d)
         LET l_xcce.xcce302e = l_rate * (l_xcce.xcce102e + l_xcce.xcce202e)
         LET l_xcce.xcce302f = l_rate * (l_xcce.xcce102f + l_xcce.xcce202f)
         LET l_xcce.xcce302g = l_rate * (l_xcce.xcce102g + l_xcce.xcce202g)
         LET l_xcce.xcce302h = l_rate * (l_xcce.xcce102h + l_xcce.xcce202h)
         
         #LET l_rate = g_xccd.xccd301 / (g_xccd.xccd101 + g_xccd.xccd201 )  #170705-00006#1 mark
         #170705-00006#1 add(S)
         IF (g_xccd.xccd101 + g_xccd.xccd201 ) <> 0 THEN
            LET l_rate = g_xccd.xccd301 / (g_xccd.xccd101 + g_xccd.xccd201 )
         ELSE 
            LET l_rate = 0
         END IF
         #170705-00006#1 add(E)         
         LET l_xcce.xcce302c = l_rate * (l_xcce.xcce102c + l_xcce.xcce202c)
      END IF
      #161230-00010#15---e
      
      #161230-00010#7---s
      #先进先出成本更新xcce之前，先写入详细的异动记录到xcct
      IF g_cost_type = '2' THEN
         LET g_xcct.xcct007 = l_xcce.xcce007
         LET g_xcct.xcct008 = l_xcce.xcce008
         LET g_xcct.xcct009 = l_xcce.xcce009
         
         SELECT xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h
            INTO g_xcct.xcct101, g_xcct.xcct102, g_xcct.xcct102a,g_xcct.xcct102b,g_xcct.xcct102c,
                 g_xcct.xcct102d,g_xcct.xcct102e,g_xcct.xcct102f,g_xcct.xcct102g,g_xcct.xcct102h
         FROM xcce_tmp 
         WHERE xcceent = g_enterprise AND xcceld = g_xcct.xcctld 
           AND xcce001 = g_xcct.xcct001 AND xcce002 = g_xcct.xcct002
           AND xcce003 = g_xcct.xcct003 AND xcce004 = g_xcct.xcct004 AND xcce005 = g_xcct.xcct005
           AND xcce006 = g_xcct.xcct006 AND xcce007 = g_xcct.xcct007 AND xcce008 = g_xcct.xcct008
           AND xcce009 = g_xcct.xcct009 
           
         #161230-00010#15---s
         #LET g_xcct.xcct201 = l_xcce.xcce301
         #LET g_xcct.xcct202a= l_xcce.xcce302a
         #LET g_xcct.xcct202b= l_xcce.xcce302b
         #LET g_xcct.xcct202c= l_xcce.xcce302c
         #LET g_xcct.xcct202d= l_xcce.xcce302d
         #LET g_xcct.xcct202e= l_xcce.xcce302e
         #LET g_xcct.xcct202f= l_xcce.xcce302f
         #LET g_xcct.xcct202g= l_xcce.xcce302g
         #LET g_xcct.xcct202h= l_xcce.xcce302h   
         LET g_xcct.xcct201 = p_qty 
         LET g_xcct.xcct202a= 0   
         LET g_xcct.xcct202b= l_xcce302b 
         LET g_xcct.xcct202c= l_xcce302c
         LET g_xcct.xcct202d= l_xcce302d
         LET g_xcct.xcct202e= l_xcce302e
         LET g_xcct.xcct202f= l_xcce302f
         LET g_xcct.xcct202g= l_xcce302g
         LET g_xcct.xcct202h= l_xcce302h
         #161230-00010#15---e
         LET g_xcct.xcct202 = g_xcct.xcct202a+g_xcct.xcct202b+g_xcct.xcct202c+g_xcct.xcct202d+
                              g_xcct.xcct202e+g_xcct.xcct202f+g_xcct.xcct202g+g_xcct.xcct202h
         CALL s_axcp500_ins_or_upd_xcct() RETURNING l_success
         IF NOT l_success THEN
         END IF
      END IF
      #161230-00010#7---e      

      CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
           RETURNING l_success
      IF NOT l_success THEN
#        RETURN r_success
      END IF      
      
      #161230-00010#7---s
      #先进先出成本更新xcce之前，先写入详细的异动记录到xcct
      #更新后xcce的期末结存给xcct的本次结存
      IF g_cost_type = '2' THEN
         SELECT xcce901,xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h
            INTO g_xcct.xcct901, g_xcct.xcct902, g_xcct.xcct902a,g_xcct.xcct902b,g_xcct.xcct902c,
                 g_xcct.xcct902d,g_xcct.xcct902e,g_xcct.xcct902f,g_xcct.xcct902g,g_xcct.xcct902h
         FROM xcce_tmp 
         WHERE xcceent = g_enterprise AND xcceld = g_xcct.xcctld 
           AND xcce001 = g_xcct.xcct001 AND xcce002 = g_xcct.xcct002
           AND xcce003 = g_xcct.xcct003 AND xcce004 = g_xcct.xcct004 AND xcce005 = g_xcct.xcct005
           AND xcce006 = g_xcct.xcct006 AND xcce007 = g_xcct.xcct007 AND xcce008 = g_xcct.xcct008
           AND xcce009 = g_xcct.xcct009 
           
         CALL s_axcp500_upd_xcct() RETURNING l_success
         IF NOT l_success THEN
         END IF
      END IF
      #161230-00010#7---e   
      LET g_stat_cnt1 = g_stat_cnt1 + 1      
   END FOREACH
   
   #若工单结案,则把所有还未结转完的全部转至差异,本期结存保持0
   IF p_close = 'Y' THEN
     #161031-00055#1-s-add
      #若參數g_sys_6008 = Y，且有入庫量時，數量金額全數當在製轉出
      #                     無入庫量時，判斷 參數g_sys_6022 = Y時，數量金額全數當在製轉出
      #其餘情況，數量金額都留在差異轉出
      IF g_sys_6008 = 'Y' THEN
         IF g_sys_6022 = 'N' THEN  #本月无入库的在制差异转入主件当期入库='N'
            #本月有入库,则结转至xcce302
            UPDATE xcce_tmp SET xcce301  = xcce301  + xcce901 * -1,
                                xcce302  = xcce302  + xcce902 * -1,
                                xcce302a = xcce302a + xcce902a * -1,
                                xcce302b = xcce302b + xcce902b * -1,
                                xcce302c = xcce302c + xcce902c * -1,
                                xcce302d = xcce302d + xcce902d * -1,
                                xcce302e = xcce302e + xcce902e * -1,
                                xcce302f = xcce302f + xcce902f * -1,
                                xcce302g = xcce302g + xcce902g * -1,
                                xcce302h = xcce302h + xcce902h * -1
             WHERE xcce001 = g_xccd.xccd001
               AND xcce003 = g_xccd.xccd003
               AND xcce004 = g_xccd.xccd004
               AND xcce005 = g_xccd.xccd005
               AND xcce006 = g_xccd.xccd006
               AND EXISTS ( SELECT 1 FROM inaj_tmp   #有入库
                             WHERE inaj036 IN ('110','111','112','113','103','104','105','106')
                               AND inaj020 = xcce006
                           )
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xcce_tmp SET xcce301"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            
            #本月有入库,则结转至xccz301
            UPDATE xccz_tmp SET xccz301  = xccz301 + xccz901 * -1
             WHERE xccz001 = g_xccd.xccd001
               AND xccz003 = g_xccd.xccd003
               AND xccz004 = g_xccd.xccd004
               AND xccz005 = g_xccd.xccd005
               AND xccz006 = g_xccd.xccd006
               AND EXISTS ( SELECT 1 FROM inaj_tmp   #有入库
                             WHERE inaj036 IN ('110','111','112','113','103','104','105','106')
                               AND inaj020 = xccz006
                          )
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xccz_tmp SET xccz301"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            
            #本月无入库,则结转至xcce304
            UPDATE xcce_tmp SET xcce303  = xcce303  + xcce901 * -1,
                                xcce304  = xcce304  + xcce902 * -1,
                                xcce304a = xcce304a + xcce902a * -1,
                                xcce304b = xcce304b + xcce902b * -1,
                                xcce304c = xcce304c + xcce902c * -1,
                                xcce304d = xcce304d + xcce902d * -1,
                                xcce304e = xcce304e + xcce902e * -1,
                                xcce304f = xcce304f + xcce902f * -1,
                                xcce304g = xcce304g + xcce902g * -1,
                                xcce304h = xcce304h + xcce902h * -1
             WHERE xcce001 = g_xccd.xccd001
               AND xcce003 = g_xccd.xccd003
               AND xcce004 = g_xccd.xccd004
               AND xcce005 = g_xccd.xccd005
               AND xcce006 = g_xccd.xccd006  
               AND NOT EXISTS ( SELECT 1 FROM inaj_tmp   #无入库
                             WHERE inaj036 IN ('110','111','112','113','103','104','105','106')
                               AND inaj020 = xcce006
                               )
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xcce_tmp SET xcce303"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            
            #本月无入库,则结转至xccz303
            UPDATE xccz_tmp SET xccz303  = xccz901 * -1
             WHERE xccz001 = g_xccd.xccd001
               AND xccz003 = g_xccd.xccd003
               AND xccz004 = g_xccd.xccd004
               AND xccz005 = g_xccd.xccd005
               AND xccz006 = g_xccd.xccd006
               AND NOT EXISTS ( SELECT 1 FROM inaj_tmp  #无入库
                                 WHERE inaj036 IN ('110','111','112','113','103','104','105','106')
                                   AND inaj020 = xccz006
                               )
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xccz_tmp SET xccz303"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            
         ELSE #本月无入库的在制差异转入主件当期入库='Y'
            #将本月无入库的部分写入一笔新的xcck
            #根据xcck012单据类型='DIFF'可以判断为调整的，或者根据xcck055判断
            LET g_sql = "INSERT INTO xcck_tmp ",
                        #        企业编号 site组织 法人组织 账套 账套本位币顺序
                        " SELECT xcceent,sfac_tmp.sfacsite,xccecomp,xcceld,xcce001,",  
                        #        成本域  成本计算类型 年度 期别 
                        "        xcce002,xcce003,xcce004,xcce005, ",
                        #        参考单号 项次                                    #参考单号=工单单号 项次为同个工单+1
                        "        xccd006 ,ROW_NUMBER() OVER ( PARTITION BY xccd006 ORDER BY xccd007,xccd008 )   , ",
                        #        项序 出入库码  料号
                        "        0   ,1       ,xccd007, ",
                        #特性：不能直接用xccd008，xccd上是不存特征的，肯定是空格，但实际工单上的主件不一定是有空格的，都有特征，那这样写入xcck后，最后汇总到xccc时，特征就会匹配不到，这部分也就会计入不到xccc中
                        #              所以需再关联sfac_tmp去获取一个特征,用sfac006。尽量关联相同成本阶的那个特征
                        #      再如果工单有多产出主件，则只要抓一笔就行了，这部分差异转出的部分只要有个主件认领就可以了
                        "        sfac_tmp.sfac006, ",
                        #        单据类型 单据日期 时间 仓库 储位                  #单据类型xcck012='DIFF'
                       #"        'DIFF' ,''      ,'' ,' ' ,' ' ,  ",           #PGS(D)-10500-mark
                        "        'DIFF' ,cast(null as date),'' ,' ' ,' ' ,  ", #PGS(D)-10500-add
                        #        批号    异动类型  原因码 交易对象 客群
                        "        xccd009,'1100'  ,' '   ,' '    ,' ',  ",        #xcck020异动类型='1100'本月无入库差异转出的类型
                        #        区域 成本中心 经营类别 渠道 品类
                        "        ' ' ,' '     ,' '     ,' ' ,' '  ,  ",
                        #        品牌              项目号 WBS 存货科目 费用成本科目
                        "        nvl(imaa126,' '),' '   ,' ',' '     ,' '         ,  ",
                        #        收入科目 交易币种 本位币种   汇率  交易单位            
                        "        ' '    ,xccd011,xccd011,1      ,imaa006,  ",
                        #        成本单位 换算率 交易数量 工单号码 重复性生产-计划编号        
                        "        imaa006 ,1    ,0      ,xccd006,' '    ,  ",
                        #        重复性生产-生产料号 BOM特性 产品特征
                        "        ' '              ,' '    ,' '    ,  ",
                        #        xccc类型                                                                                              本期异动数量
                        #"        CASE '",p_flag,"' WHEN 'Y' THEN '2090' ELSE '2050' END IF, 0, ",   #xcck055异动类型=本月无入库差异转出的类型 '2050'一般工单 '2090'重工工单  #本期异动数量=0
                       #"        CASE  WHEN  sfaa042= 'Y' THEN '2090'  WHEN sfaa057='2' AND sfaa042='N' THEN '2030' ELSE '2050' END IF, 0, ",   #mod zhangllc 160608 SBS2 增加2030返工入库类型 #PGS(D)-10500-mark
                        "        CASE  WHEN  sfaa042= 'Y' THEN '2090'  WHEN sfaa057='2' AND sfaa042='N' THEN '2030' ELSE '2050' END , 0, ", #PGS(D)-10500-add
                        #        本期异动数量金额    
                        "        xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h, ",
                        #        本期异动单价        
                        "        xcce902,xcce902a,xcce902b,xcce902c,xcce902d,xcce902e,xcce902f,xcce902g,xcce902h,   ",
                        #        已耗数量金额          结存数量金额          结存单位成本        结存调整金额
                        "        0,0,0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,0, ",
                        #        资料所有者      部门         录入者       部门  创建日 更改者 最近更改日 状态码
                       #"        '",g_user,"','",g_dept,"','",g_user,"','",g_dept,"','','','','Y', ", #PGS(D)-10500-mark
                        "        '",g_user,"','",g_dept,"','",g_user,"','",g_dept,"',cast(null as date),'',cast(null as date),'Y', ", #PGS(D)-10500-add 
                        #        自定义字段
                        #PGS(D)-10500-mark -S-
                       #"        '','','','','','','','','','','','','','','', ",
                       #"        '','','','','','','','','','','','','','','', ",
                        #PGS(D)-10500-mark -E-
                        #PGS(D)-10500-add -S-
                        "        '','','','','','','','','','', ",
                        "        cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int),cast(null as int), ",
                        "        cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date),cast(null as date), ",
                        #PGS(D)-10500-add -E-
                        "        '',",    #成本代销单号  160509-00004#76
                        "        ' ' ",   #库存管理特征 for xccq use
                        "    FROM xcce_tmp LEFT OUTER JOIN imaa_t ON imaaent = xcceent AND imaa001 = xcce007,xccd_tmp, ",
                        "         (SELECT * ",
                        "            FROM ( SELECT sfacdocno,sfacsite,sfac001,sfac006,clevel,ROW_NUMBER() OVER ( PARTITION BY sfacdocno ORDER BY sfac001,sfac006 ) num FROM sfac_tmp WHERE sfacdocno ='",g_xccd.xccd006,"' ) a ",  
                        "           WHERE num=1 ",
                        "         ) sfac_tmp, ",
                        "         (SELECT sfaa_tmp.* FROM sfaa_tmp ",
                        "           WHERE sfaaent = ",g_enterprise,
                        "             AND sfaadocno= '",g_xccd.xccd006,"' ",
                        "          ) sfaa_tmp ",
                        "   WHERE xcceent = xccdent AND xcceld =xccdld  AND xcce001=xccd001 AND xcce002=xccd002 AND xcce003=xccd003 ",
                        "     AND xcce004 = xccd004 AND xcce005=xccd005 AND xcce006=xccd006 ",
                        "     AND sfacdocno = xccd006 AND sfac001=xccd007 ",  #关联sfac_tmp
                        "     AND xcce001 = '",g_xccd.xccd001,"' ",
                        "     AND xcce003 = '",g_xccd.xccd003,"' ",
                        "     AND xcce004 = ",g_xccd.xccd004,
                        "     AND xcce005 = ",g_xccd.xccd005,
                        "     AND xcce006 = '",g_xccd.xccd006,"' ",
                        "     AND xcceent = sfaaent AND xcce006 = sfaadocno ", #关联sfaa_tmp
                        "     AND xcce902 != 0 ",   #170513-00005#1 add
                        "     AND NOT EXISTS ( SELECT 1 FROM inaj_tmp  ",  #无入库
                        "                   WHERE inaj036 IN ('110','111','112','113','103','104','105','106') ",
                        "                     AND inaj020 = xcce006 ",
                        "                     ) "
            PREPARE s_axcp500_wip_4_p1 FROM g_sql
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "PREPARE s_axcp500_avg1_wip_4_2_p10"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            EXECUTE s_axcp500_wip_4_p1
            
            
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "EXECUTE s_axcp500_avg1_wip_4_2_p10"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
               
            #不管本月有无入库,全结转至xcce302
            UPDATE xcce_tmp SET xcce301  = xcce301  + xcce901 * -1,
                                xcce302  = xcce302  + xcce902 * -1,
                                xcce302a = xcce302a + xcce902a * -1,
                                xcce302b = xcce302b + xcce902b * -1,
                                xcce302c = xcce302c + xcce902c * -1,
                                xcce302d = xcce302d + xcce902d * -1,
                                xcce302e = xcce302e + xcce902e * -1,
                                xcce302f = xcce302f + xcce902f * -1,
                                xcce302g = xcce302g + xcce902g * -1,
                                xcce302h = xcce302h + xcce902h * -1
             WHERE xcce001 = g_xccd.xccd001
               AND xcce003 = g_xccd.xccd003
               AND xcce004 = g_xccd.xccd004
               AND xcce005 = g_xccd.xccd005
               AND xcce006 = g_xccd.xccd006
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xcce_tmp SET xcce301"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
            
            #不管本月有无入库,全结转至xcce302
            UPDATE xccz_tmp SET xccz301  = xccz301 + xccz901 * -1
             WHERE xccz001 = g_xccd.xccd001
               AND xccz003 = g_xccd.xccd003
               AND xccz004 = g_xccd.xccd004
               AND xccz005 = g_xccd.xccd005
               AND xccz006 = g_xccd.xccd006
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = SQLCA.sqlcode
               LET g_errparam.extend = "UPDATE xcce_tmp SET xcce301"
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
        
         END IF
      ELSE
         UPDATE xcce_tmp SET xcce303  = xcce303  + xcce901 * -1,
                             xcce304  = xcce304  + xcce902 * -1,
                             xcce304a = xcce304a + xcce902a * -1,
                             xcce304b = xcce304b + xcce902b * -1,
                             xcce304c = xcce304c + xcce902c * -1,
                             xcce304d = xcce304d + xcce902d * -1,
                             xcce304e = xcce304e + xcce902e * -1,
                             xcce304f = xcce304f + xcce902f * -1,
                             xcce304g = xcce304g + xcce902g * -1,
                             xcce304h = xcce304h + xcce902h * -1
          WHERE xcce001 = g_xccd.xccd001
            AND xcce003 = g_xccd.xccd003
            AND xcce004 = g_xccd.xccd004
            AND xcce005 = g_xccd.xccd005
            AND xcce006 = g_xccd.xccd006
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = "UPDATE xcce_tmp SET xcce303"
            LET g_errparam.popup  = TRUE
            CALL cl_err()
         END IF
         
         UPDATE xccz_tmp SET xccz303  = xccz901 * -1
          WHERE xccz001 = g_xccd.xccd001
            AND xccz003 = g_xccd.xccd003
            AND xccz004 = g_xccd.xccd004
            AND xccz005 = g_xccd.xccd005
            AND xccz006 = g_xccd.xccd006
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = "UPDATE xccz_tmp SET xccz303"
            LET g_errparam.popup  = TRUE
            CALL cl_err()
         END IF
      END IF
      
      UPDATE xcce_tmp SET xcce901  = 0,
                          xcce902  = 0,
                          xcce902a = 0,
                          xcce902b = 0,
                          xcce902c = 0,
                          xcce902d = 0,
                          xcce902e = 0,
                          xcce902f = 0,
                          xcce902g = 0,
                          xcce902h = 0
       WHERE xcce001 = g_xccd.xccd001
         AND xcce003 = g_xccd.xccd003
         AND xcce004 = g_xccd.xccd004
         AND xcce005 = g_xccd.xccd005
         AND xcce006 = g_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE xcce_tmp SET xcce901"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
      END IF
      
      UPDATE xccz_tmp SET xccz901  = 0
       WHERE xccz001 = g_xccd.xccd001
         AND xccz003 = g_xccd.xccd003
         AND xccz004 = g_xccd.xccd004
         AND xccz005 = g_xccd.xccd005
         AND xccz006 = g_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE xccz_tmp SET xccz901"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
      END IF
      
      #161230-00010#7---s
      #先进先出成本更新xcce之前，先写入详细的异动记录到xcct
      #更新后xcce的期末结存给xcct的本次结存
      IF g_cost_type = '2' THEN
         UPDATE xcct_t SET xcct901  = 0,
                             xcct902  = 0,
                             xcct902a = 0,
                             xcct902b = 0,
                             xcct902c = 0,
                             xcct902d = 0,
                             xcct902e = 0,
                             xcct902f = 0,
                             xcct902g = 0,
                             xcct902h = 0
          WHERE xcct001 = g_xccd.xccd001
            AND xcct003 = g_xccd.xccd003
            AND xcct004 = g_xccd.xccd004
            AND xcct005 = g_xccd.xccd005
            AND xcct006 = g_xccd.xccd006
            AND xcct010 = g_xcct.xcct010 AND xcct011 = g_xcct.xcct011
            AND xcct012 = g_xcct.xcct012
            AND xcctent = g_enterprise    #180424-00058#1
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = "UPDATE xcct_tmp SET xcct901"
            LET g_errparam.popup  = TRUE
            CALL cl_err()
         END IF
      END IF
      #161230-00010#7---e   
      
     #161031-00055#1-e-add
     #161031-00055#1-s-mark
     #FOREACH s_axcp500_wip_4_cs4 USING g_xccd.xccd001,g_xccd.xccd003,g_xccd.xccd004,g_xccd.xccd005,g_xccd.xccd006
     #                               INTO l_xcce.*
     #   IF SQLCA.sqlcode THEN
     #      INITIALIZE g_errparam TO NULL
     #      LET g_errparam.code   = SQLCA.sqlcode
     #      LET g_errparam.extend = 'FOREACH s_axcp500_wip_4_cs4'
     #      LET g_errparam.popup  = TRUE
     #      CALL cl_err()   
     #      CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',l_xcce.xcce007,l_xcce.xcce008,
     #                               l_xcce.xcce009,'',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_4_cs4')
     #      CONTINUE FOREACH   
     #   END IF    
     #   IF l_xcce.xcce901  <> 0 OR l_xcce.xcce902  <> 0 OR l_xcce.xcce902a <> 0 OR l_xcce.xcce902b <> 0 OR 
     #      l_xcce.xcce902c <> 0 OR l_xcce.xcce902d <> 0 OR l_xcce.xcce902e <> 0 OR l_xcce.xcce902f <> 0  OR
     #      l_xcce.xcce902g <> 0 OR l_xcce.xcce902h <> 0 THEN
     #      
     #      LET l_xcce.xcce303  = l_xcce.xcce901  * -1
     #      LET l_xcce.xcce304  = l_xcce.xcce902  * -1
     #      LET l_xcce.xcce304a = l_xcce.xcce902a * -1
     #      LET l_xcce.xcce304b = l_xcce.xcce902b * -1
     #      LET l_xcce.xcce304c = l_xcce.xcce902c * -1
     #      LET l_xcce.xcce304d = l_xcce.xcce902d * -1
     #      LET l_xcce.xcce304e = l_xcce.xcce902e * -1
     #      LET l_xcce.xcce304f = l_xcce.xcce902f * -1
     #      LET l_xcce.xcce304g = l_xcce.xcce902g * -1
     #      LET l_xcce.xcce304h = l_xcce.xcce902h * -1
     #      
     #      LET l_xcce.xcce901  = 0
     #      LET l_xcce.xcce902  = 0
     #      LET l_xcce.xcce902a = 0
     #      LET l_xcce.xcce902b = 0
     #      LET l_xcce.xcce902c = 0
     #      LET l_xcce.xcce902d = 0
     #      LET l_xcce.xcce902e = 0
     #      LET l_xcce.xcce902f = 0
     #      LET l_xcce.xcce902g = 0
     #      LET l_xcce.xcce902h = 0
     #      
     #      CALL s_axcp500_ins_or_upd_xcce(l_xcce.*)
     #           RETURNING l_success
     #      IF NOT l_success THEN
#    #         RETURN r_success
     #      END IF 
     #
     #   END IF
     #   LET g_stat_cnt1 = g_stat_cnt1 + 1         
     #END FOREACH
     #
     #FOREACH s_axcp500_wip_4_cs5 USING g_xccd.xccd001,g_xccd.xccd003,g_xccd.xccd004,
     #                                  g_xccd.xccd005,g_xccd.xccd006
     #                             INTO l_xccz.*
     #   IF SQLCA.sqlcode THEN
     #      INITIALIZE g_errparam TO NULL
     #      LET g_errparam.code   = SQLCA.sqlcode
     #      LET g_errparam.extend = 'FOREACH s_axcp500_wip_4_cs5'
     #      LET g_errparam.popup  = TRUE
     #      CALL cl_err()   
     #      CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',l_xccz.xccz007,l_xccz.xccz008,
     #                               l_xccz.xccz009,'',SQLCA.sqlcode,'','FOREACH s_axcp500_wip_4_cs5')
     #      CONTINUE FOREACH   
     #   END IF    
     #   IF l_xccz.xccz901  <> 0 THEN
     #      LET l_xccz.xccz303  = l_xccz.xccz901  * -1
     #      LET l_xccz.xccz901  = 0
     #      
     #      CALL s_axcp500_ins_or_upd_xccz(l_xccz.*)
     #           RETURNING l_success
     #      IF NOT l_success THEN
#    #         RETURN r_success
     #      END IF 
     #   END IF
     #   LET g_stat_cnt1 = g_stat_cnt1 + 1         
     #END FOREACH
     #161031-00055#1-e-mark
   END IF

   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(14,g_stat_begin1,g_stat_end1,g_stat_cnt1) 
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: xcce的材料/人工/加工/制费更新xccd的投入                      
# Memo...........:                                                              
# Usage..........: CALL s_axcp500_wip_5()                        
#                       RETURNING r_success                                       
# Input parameter: NULL                           
# Return code....: r_success      成功否标识符                            
# Date & Author..: 2014-08-11 By Carrier                                        
# Modify.........:                                                              
################################################################################
PUBLIC FUNCTION s_axcp500_wip_5()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   LET g_stat_cnt1 = 0
   LET g_stat_begin1 = TIME
   
   SELECT SUM(xcce102),                                               #期初
          SUM(xcce102a),SUM(xcce102b),SUM(xcce102c),SUM(xcce102d),
          SUM(xcce102e),SUM(xcce102f),SUM(xcce102g),SUM(xcce102h),
          
          SUM(xcce202) +SUM(xcce206) +SUM(xcce208) +SUM(xcce210) ,    #本期投入
          SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),
          SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),
          SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),
          SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),
          SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),
          SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),
          SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),
          SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h),
          
          SUM(xcce302),                                               #本期转出
          SUM(xcce302a),SUM(xcce302b),SUM(xcce302c),SUM(xcce302d),
          SUM(xcce302e),SUM(xcce302f),SUM(xcce302g),SUM(xcce302h),   
                 
          SUM(xcce304)+SUM(xcce308),                                  #差异转出
          SUM(xcce304a)+SUM(xcce308a),SUM(xcce304b)+SUM(xcce308b),
          SUM(xcce304c)+SUM(xcce308c),SUM(xcce304d)+SUM(xcce308d),
          SUM(xcce304e)+SUM(xcce308e),SUM(xcce304f)+SUM(xcce308f),
          SUM(xcce304g)+SUM(xcce308g),SUM(xcce304h)+SUM(xcce308h), 
          
          SUM(xcce902),                                               #期末结余
          SUM(xcce902a),SUM(xcce902b),SUM(xcce902c),SUM(xcce902d),
          SUM(xcce902e),SUM(xcce902f),SUM(xcce902g),SUM(xcce902h)
          
     INTO g_xccd.xccd102, 
          g_xccd.xccd102a,g_xccd.xccd102b,g_xccd.xccd102c,g_xccd.xccd102d,
          g_xccd.xccd102e,g_xccd.xccd102f,g_xccd.xccd102g,g_xccd.xccd102h,
          
          g_xccd.xccd202, 
          g_xccd.xccd202a,g_xccd.xccd202b,g_xccd.xccd202c,g_xccd.xccd202d,
          g_xccd.xccd202e,g_xccd.xccd202f,g_xccd.xccd202g,g_xccd.xccd202h, 
          
          g_xccd.xccd302, 
          g_xccd.xccd302a,g_xccd.xccd302b,g_xccd.xccd302c,g_xccd.xccd302d,
          g_xccd.xccd302e,g_xccd.xccd302f,g_xccd.xccd302g,g_xccd.xccd302h, 
          
          g_xccd.xccd304,                                                                                   
          g_xccd.xccd304a,g_xccd.xccd304b,g_xccd.xccd304c,g_xccd.xccd304d,                                  
          g_xccd.xccd304e,g_xccd.xccd304f,g_xccd.xccd304g,g_xccd.xccd304h, 
          
          g_xccd.xccd902,                                                                                   
          g_xccd.xccd902a,g_xccd.xccd902b,g_xccd.xccd902c,g_xccd.xccd902d,                                  
          g_xccd.xccd902e,g_xccd.xccd902f,g_xccd.xccd902g,g_xccd.xccd902h                                                                          
     FROM xcce_tmp
    WHERE xcceent = g_enterprise
      AND xcceld  = g_ld
      AND xcce001 = g_xccd.xccd001
      AND xcce003 = g_xccd.xccd003
      AND xcce004 = g_xccd.xccd004
      AND xcce005 = g_xccd.xccd005
      AND xcce006 = g_xccd.xccd006  
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 's_axcp500_wip_5'
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                               '','',SQLCA.sqlcode,'','s_axcp500_wip_5')
      RETURN r_success
   END IF
   
   #160929-00019#1---s
   IF cl_null(g_xccd.xccd102)  THEN LET g_xccd.xccd102  = 0 END IF
   IF cl_null(g_xccd.xccd102a)  THEN LET g_xccd.xccd102a  = 0 END IF
   IF cl_null(g_xccd.xccd102b)  THEN LET g_xccd.xccd102b  = 0 END IF
   IF cl_null(g_xccd.xccd102c)  THEN LET g_xccd.xccd102c  = 0 END IF
   IF cl_null(g_xccd.xccd102d)  THEN LET g_xccd.xccd102d  = 0 END IF
   IF cl_null(g_xccd.xccd102e)  THEN LET g_xccd.xccd102e  = 0 END IF
   IF cl_null(g_xccd.xccd102f)  THEN LET g_xccd.xccd102f  = 0 END IF
   IF cl_null(g_xccd.xccd102g)  THEN LET g_xccd.xccd102g  = 0 END IF
   IF cl_null(g_xccd.xccd102h)  THEN LET g_xccd.xccd102h  = 0 END IF
   IF cl_null(g_xccd.xccd202)  THEN LET g_xccd.xccd202  = 0 END IF
   IF cl_null(g_xccd.xccd202a)  THEN LET g_xccd.xccd202a  = 0 END IF
   IF cl_null(g_xccd.xccd202b)  THEN LET g_xccd.xccd202b  = 0 END IF
   IF cl_null(g_xccd.xccd202c)  THEN LET g_xccd.xccd202c  = 0 END IF
   IF cl_null(g_xccd.xccd202d)  THEN LET g_xccd.xccd202d  = 0 END IF
   IF cl_null(g_xccd.xccd202e)  THEN LET g_xccd.xccd202e  = 0 END IF
   IF cl_null(g_xccd.xccd202f)  THEN LET g_xccd.xccd202f  = 0 END IF
   IF cl_null(g_xccd.xccd202g)  THEN LET g_xccd.xccd202g  = 0 END IF
   IF cl_null(g_xccd.xccd202h)  THEN LET g_xccd.xccd202h  = 0 END IF
   IF cl_null(g_xccd.xccd302)  THEN LET g_xccd.xccd302  = 0 END IF
   IF cl_null(g_xccd.xccd302a)  THEN LET g_xccd.xccd302a  = 0 END IF
   IF cl_null(g_xccd.xccd302b)  THEN LET g_xccd.xccd302b  = 0 END IF
   IF cl_null(g_xccd.xccd302c)  THEN LET g_xccd.xccd302c  = 0 END IF
   IF cl_null(g_xccd.xccd302d)  THEN LET g_xccd.xccd302d  = 0 END IF
   IF cl_null(g_xccd.xccd302e)  THEN LET g_xccd.xccd302e  = 0 END IF
   IF cl_null(g_xccd.xccd302f)  THEN LET g_xccd.xccd302f = 0 END IF
   IF cl_null(g_xccd.xccd302g)  THEN LET g_xccd.xccd302g  = 0 END IF
   IF cl_null(g_xccd.xccd302h)  THEN LET g_xccd.xccd302h = 0 END IF
   IF cl_null(g_xccd.xccd304)  THEN LET g_xccd.xccd304  = 0 END IF
   IF cl_null(g_xccd.xccd304a)  THEN LET g_xccd.xccd304a = 0 END IF
   IF cl_null(g_xccd.xccd304b)  THEN LET g_xccd.xccd304b  = 0 END IF
   IF cl_null(g_xccd.xccd304c)  THEN LET g_xccd.xccd304c  = 0 END IF
   IF cl_null(g_xccd.xccd304d)  THEN LET g_xccd.xccd304d  = 0 END IF
   IF cl_null(g_xccd.xccd304e)  THEN LET g_xccd.xccd304e  = 0 END IF
   IF cl_null(g_xccd.xccd304f)  THEN LET g_xccd.xccd304f  = 0 END IF
   IF cl_null(g_xccd.xccd304g)  THEN LET g_xccd.xccd304g  = 0 END IF
   IF cl_null(g_xccd.xccd304h)  THEN LET g_xccd.xccd304h  = 0 END IF
   IF cl_null(g_xccd.xccd902)  THEN LET g_xccd.xccd902  = 0 END IF
   IF cl_null(g_xccd.xccd902a)  THEN LET g_xccd.xccd902a  = 0 END IF
   IF cl_null(g_xccd.xccd902b)  THEN LET g_xccd.xccd902b  = 0 END IF
   IF cl_null(g_xccd.xccd902c)  THEN LET g_xccd.xccd902c  = 0 END IF
   IF cl_null(g_xccd.xccd902d)  THEN LET g_xccd.xccd902d  = 0 END IF
   IF cl_null(g_xccd.xccd902e)  THEN LET g_xccd.xccd902e  = 0 END IF
   IF cl_null(g_xccd.xccd902f)  THEN LET g_xccd.xccd902f  = 0 END IF
   IF cl_null(g_xccd.xccd902g)  THEN LET g_xccd.xccd902g  = 0 END IF
   IF cl_null(g_xccd.xccd902h)  THEN LET g_xccd.xccd902h  = 0 END IF
   #160929-00019#1---e

   #本期下阶投入
   SELECT SUM(xcce202) +SUM(xcce206) +SUM(xcce208) +SUM(xcce210) ,    #本期投入
          SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),
          SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),
          SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),
          SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),
          SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),
          SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),
          SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),
          SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h)
     INTO g_xccd.xccd204, 
          g_xccd.xccd204a,g_xccd.xccd204b,g_xccd.xccd204c,g_xccd.xccd204d,
          g_xccd.xccd204e,g_xccd.xccd204f,g_xccd.xccd204g,g_xccd.xccd204h
     FROM xcce_tmp,imaa_t
    WHERE xcceent = imaaent AND xcceent = g_enterprise
      AND xcce007 = imaa001 AND imaa004 = 'A'                        #半成品或主件
      AND xcceld  = g_ld
      AND xcce001 = g_xccd.xccd001
      AND xcce003 = g_xccd.xccd003
      AND xcce004 = g_xccd.xccd004
      AND xcce005 = g_xccd.xccd005
      AND xcce006 = g_xccd.xccd006 
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 's_axcp500_wip_5'
      LET g_errparam.popup  = TRUE
      CALL s_axcp500_ins_error('','','','',g_xccd.xccd006,'','','',g_xccd.xccd007,'',
                               '','',SQLCA.sqlcode,'','s_axcp500_wip_5')
      CALL cl_err()
      RETURN r_success
   END IF
   
   IF cl_null(g_xccd.xccd204)  THEN LET g_xccd.xccd204  = 0 END IF
   IF cl_null(g_xccd.xccd204a) THEN LET g_xccd.xccd204a = 0 END IF
   IF cl_null(g_xccd.xccd204b) THEN LET g_xccd.xccd204b = 0 END IF
   IF cl_null(g_xccd.xccd204c) THEN LET g_xccd.xccd204c = 0 END IF
   IF cl_null(g_xccd.xccd204d) THEN LET g_xccd.xccd204d = 0 END IF
   IF cl_null(g_xccd.xccd204e) THEN LET g_xccd.xccd204e = 0 END IF
   IF cl_null(g_xccd.xccd204f) THEN LET g_xccd.xccd204f = 0 END IF
   IF cl_null(g_xccd.xccd204g) THEN LET g_xccd.xccd204g = 0 END IF
   IF cl_null(g_xccd.xccd204h) THEN LET g_xccd.xccd204h = 0 END IF
   
   LET g_xccd.xccd202  = g_xccd.xccd202  - g_xccd.xccd204            #本期本阶投入金额
   LET g_xccd.xccd202a = g_xccd.xccd202a - g_xccd.xccd204a           #本期本阶投入金额
   LET g_xccd.xccd202b = g_xccd.xccd202b - g_xccd.xccd204b           #本期本阶投入金额
   LET g_xccd.xccd202c = g_xccd.xccd202c - g_xccd.xccd204c           #本期本阶投入金额
   LET g_xccd.xccd202d = g_xccd.xccd202d - g_xccd.xccd204d           #本期本阶投入金额
   LET g_xccd.xccd202e = g_xccd.xccd202e - g_xccd.xccd204e           #本期本阶投入金额
   LET g_xccd.xccd202f = g_xccd.xccd202f - g_xccd.xccd204f           #本期本阶投入金额
   LET g_xccd.xccd202g = g_xccd.xccd202g - g_xccd.xccd204g           #本期本阶投入金额
   LET g_xccd.xccd202h = g_xccd.xccd202h - g_xccd.xccd204h           #本期本阶投入金额
   
   LET g_xccd.xccd901 = g_xccd.xccd101 + g_xccd.xccd201 + g_xccd.xccd301 + g_xccd.xccd303 
  #161031-00055#1-s-mark
  ##差异
  #IF g_xccd.xccd902 = 0 AND g_xccd.xccd901 <> 0 THEN
  #   LET g_xccd.xccd303 = g_xccd.xccd901 * -1
  #   LET g_xccd.xccd901 = 0
  #END IF
  #161031-00055#1-e-mark
   CALL s_axcp500_ins_or_upd_xccd(g_xccd.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET g_stat_cnt1 = g_stat_cnt1 + 1
   LET g_stat_end1 = TIME
   CALL s_axcp500_avg1_stats_cnt(15,g_stat_begin1,g_stat_end1,g_stat_cnt1)    
      
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 在制成本计算-若主件无异动,元件无异动时,删除在制资料
# Memo...........:
# Usage..........: CALL s_axcp500_wip_del(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_site         工单SITE
#                : p_xcck047      工单单号
#                : p_xcck048      重复性生产-计划编号
#                : p_xcck049      重复性生产-生产料号
#                : p_xcck050      重复性生产-生产BOM特性
#                : p_xcck051      重复性生产-生产料号产品特征
#                : p_sfaa010      主件编号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-09-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_wip_del(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_site          LIKE sfaa_t.sfaasite
   DEFINE p_xcck047       LIKE xcck_t.xcck047
   DEFINE p_xcck048       LIKE xcck_t.xcck048
   DEFINE p_xcck049       LIKE xcck_t.xcck049
   DEFINE p_xcck050       LIKE xcck_t.xcck050
   DEFINE p_xcck051       LIKE xcck_t.xcck051
   DEFINE p_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xccd       RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE l_xccd          type_g_xccd  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   CALL s_axcp500_get_xccd(p_seq,p_site,p_xcck047,p_xcck048,p_xcck049,p_xcck050,p_xcck051,p_sfaa010)
        RETURNING l_xccd.*
        
   IF l_xccd.xccd101 = 0 AND l_xccd.xccd102 = 0 AND l_xccd.xccd200 = 0 AND l_xccd.xccd201 = 0 AND l_xccd.xccd202 = 0 AND
      l_xccd.xccd204 = 0 AND l_xccd.xccd301 = 0 AND l_xccd.xccd302 = 0 AND l_xccd.xccd303 = 0 AND l_xccd.xccd304 = 0 AND
      l_xccd.xccd901 = 0 AND l_xccd.xccd902 = 0 THEN
      DELETE FROM xcce_tmp 
       WHERE xcceent = g_enterprise     
         AND xcceld  = g_ld
         AND xcce001 = l_xccd.xccd001
         AND xcce003 = l_xccd.xccd003
         AND xcce004 = l_xccd.xccd004
         AND xcce005 = l_xccd.xccd005
         AND xcce006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xcce_tmp'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','','','',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xcce_tmp')
      END IF    

      DELETE FROM xccz_tmp 
       WHERE xcczent = g_enterprise
         AND xcczld  = g_ld
         AND xccz001 = l_xccd.xccd001
         AND xccz003 = l_xccd.xccd003
         AND xccz004 = l_xccd.xccd004
         AND xccz005 = l_xccd.xccd005
         AND xccz006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xccz_tmp'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','','','',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xccz_tmp')
      END IF 
      
      DELETE FROM xccd_tmp 
       WHERE xccdent = g_enterprise
         AND xccdld  = g_ld
         AND xccd001 = l_xccd.xccd001
         AND xccd003 = l_xccd.xccd003
         AND xccd004 = l_xccd.xccd004
         AND xccd005 = l_xccd.xccd005
         AND xccd006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xccd_tmp'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','',l_xccd.xccd007,'',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xccd_tmp')
      END IF      

      DELETE FROM xccg_tmp
       WHERE xccgent = g_enterprise
         AND xccgld  = g_ld
         AND xccg001 = l_xccd.xccd001
         AND xccg003 = l_xccd.xccd003
         AND xccg004 = l_xccd.xccd004
         AND xccg005 = l_xccd.xccd005
         AND xccg006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xccg_tmp'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','','','',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xccg_tmp')
      END IF   

      DELETE FROM xcde_t 
       WHERE xcdeent = g_enterprise     
         AND xcdeld  = g_ld
         AND xcde001 = l_xccd.xccd001
         AND xcde003 = l_xccd.xccd003
         AND xcde004 = l_xccd.xccd004
         AND xcde005 = l_xccd.xccd005
         AND xcde006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xcde_t'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','','','',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xcde_t')
      END IF  

      DELETE FROM xcdg_t 
       WHERE xcdgent = g_enterprise
         AND xcdgld  = g_ld
         AND xcdg001 = l_xccd.xccd001
         AND xcdg003 = l_xccd.xccd003
         AND xcdg004 = l_xccd.xccd004
         AND xcdg005 = l_xccd.xccd005
         AND xcdg006 = l_xccd.xccd006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'DELETE FROM xcdg_t'
         LET g_errparam.popup  = TRUE
         CALL cl_err()      
         CALL s_axcp500_ins_error('','','','',l_xccd.xccd006,'','','','','',
                                  '','',SQLCA.sqlcode,'','DELETE FROM xcdg_t')
      END IF   
      
   END IF

   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取料件的成本调整金额
# Memo...........: 根据xccq的按料号的合计金额(期初金额＋本期入库金额)为分母，每笔xccq的金额为分子，算出比率，再乘以xcco的金额
#                  实时成本下不会用xcco去调整
# Usage..........: CALL s_axcp500_get_adjust_xccq()
#                       RETURNING r_adjust
# Input parameter: NULL
# Return code....: r_adjust       调整的金额
# Date & Author..: 2015-12-15 By zhangllc 151215
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_adjust_xccq()
   DEFINE l_adjust        RECORD
                          tot  LIKE xccq_t.xccq214,
                          a    LIKE xccq_t.xccq214a,
                          b    LIKE xccq_t.xccq214b,
                          c    LIKE xccq_t.xccq214c,
                          d    LIKE xccq_t.xccq214d,
                          e    LIKE xccq_t.xccq214e,
                          f    LIKE xccq_t.xccq214f,
                          g    LIKE xccq_t.xccq214g,
                          h    LIKE xccq_t.xccq214h
                          END RECORD
   DEFINE l_son           LIKE xccq_t.xccq202
   DEFINE l_mum           LIKE xccq_t.xccq202

   WHENEVER ERROR CONTINUE
   
   #获取xcco金额
   LET l_adjust.tot = 0
   LET l_adjust.a = 0 LET l_adjust.b = 0 LET l_adjust.c = 0 LET l_adjust.d = 0
   LET l_adjust.e = 0 LET l_adjust.f = 0 LET l_adjust.g = 0 LET l_adjust.h = 0
   SELECT SUM(xcco102),SUM(xcco102a),SUM(xcco102b),SUM(xcco102c),SUM(xcco102d),
                       SUM(xcco102e),SUM(xcco102f),SUM(xcco102g),SUM(xcco102h)
     INTO l_adjust.tot,l_adjust.a,l_adjust.b,l_adjust.c,l_adjust.d,
          l_adjust.e,l_adjust.f,l_adjust.g,l_adjust.h
     FROM xcco_t
    WHERE xccoent = g_enterprise
      AND xccold  = g_ld
      AND xcco001 = g_xccq.xccq001 #帳套本位幣順序
      AND xcco002 = g_xccq.xccq002 #成本域
      AND xcco003 = g_xcat001 #成本計算類型
      AND xcco004 = g_yy
      AND xcco005 = g_pp
      AND xcco006 = g_xccq.xccq006 #料
      AND xcco007 = g_xccq.xccq007 #特性
      AND xcco008 = g_xccq.xccq008 #批号
   IF cl_null(l_adjust.a) THEN LET l_adjust.a = 0 END IF
   IF cl_null(l_adjust.b) THEN LET l_adjust.b = 0 END IF
   IF cl_null(l_adjust.c) THEN LET l_adjust.c = 0 END IF
   IF cl_null(l_adjust.d) THEN LET l_adjust.d = 0 END IF
   IF cl_null(l_adjust.e) THEN LET l_adjust.e = 0 END IF
   IF cl_null(l_adjust.f) THEN LET l_adjust.f = 0 END IF
   IF cl_null(l_adjust.g) THEN LET l_adjust.g = 0 END IF
   IF cl_null(l_adjust.h) THEN LET l_adjust.h = 0 END IF
   LET l_adjust.tot = l_adjust.a + l_adjust.b + l_adjust.c + l_adjust.d + 
                      l_adjust.e + l_adjust.f + l_adjust.g + l_adjust.h
   
   #获取分子：每笔xccq的金额(期初金额＋本期入库金额,排除调整)
   LET l_son = g_xccq.xccq102  + g_xccq.xccq202  + g_xccq.xccq204  + g_xccq.xccq206  + g_xccq.xccq208 +
               g_xccq.xccq210  + g_xccq.xccq212  + g_xccq.xccq216  + g_xccq.xccq218
   #获取分母：xccq的按料号的合计金额(期初金额＋本期入库金额)
   SELECT NVL(SUM(xccq102),0) + NVL(SUM(xccq202),0)+ NVL(SUM(xccq204),0) + NVL(SUM(xccq206),0)
        + NVL(SUM(xccq208),0) + NVL(SUM(xccq210),0)+ NVL(SUM(xccq212),0) + NVL(SUM(xccq216),0)
        + NVL(SUM(xccq218),0)
     INTO l_mum
     FROM xccq_t
    WHERE xccqent = g_enterprise
      AND xccqld  = g_ld
      AND xccq001 = g_xccq.xccq001 #帳套本位幣順序
      AND xccq002 = g_xccq.xccq002 #成本域
      AND xccq003 = g_xcat001 #成本計算類型
      AND xccq004 = g_yy
      AND xccq005 = g_pp
      AND xccq006 = g_xccq.xccq006 #料
      AND xccq007 = g_xccq.xccq007 #特性
      AND xccq008 = g_xccq.xccq008 #批号
   LET l_mum = l_mum + l_son  #把本笔的汇进去
   #计算分摊金额
   #170705-00006#1 mark(S)
   #LET l_adjust.tot = l_son/l_mum * l_adjust.tot
   #LET l_adjust.a   = l_son/l_mum * l_adjust.a
   #LET l_adjust.b   = l_son/l_mum * l_adjust.b
   #LET l_adjust.c   = l_son/l_mum * l_adjust.c
   #LET l_adjust.d   = l_son/l_mum * l_adjust.d
   #LET l_adjust.e   = l_son/l_mum * l_adjust.e
   #LET l_adjust.f   = l_son/l_mum * l_adjust.f
   #LET l_adjust.g   = l_son/l_mum * l_adjust.g
   #LET l_adjust.h   = l_son/l_mum * l_adjust.h
   #170705-00006#1 mark(E)
   #170705-00006#1 add(S)
   IF l_mum = 0 THEN
      LET l_adjust.tot = 0
      LET l_adjust.a   = 0
      LET l_adjust.b   = 0
      LET l_adjust.c   = 0
      LET l_adjust.d   = 0
      LET l_adjust.e   = 0
      LET l_adjust.f   = 0
      LET l_adjust.g   = 0
      LET l_adjust.h   = 0
   ELSE
      IF l_adjust.tot <> 0 THEN
         LET l_adjust.tot = l_son/l_mum * l_adjust.tot
      ELSE 
         LET l_adjust.tot = 0
      END IF
      IF l_adjust.a <> 0 THEN
         LET l_adjust.a = l_son/l_mum * l_adjust.a
      ELSE 
         LET l_adjust.a = 0
      END IF
      IF l_adjust.b <> 0 THEN
         LET l_adjust.b = l_son/l_mum * l_adjust.b
      ELSE 
         LET l_adjust.b = 0
      END IF
      IF l_adjust.c <> 0 THEN
         LET l_adjust.c = l_son/l_mum * l_adjust.c
      ELSE 
         LET l_adjust.c = 0
      END IF
      IF l_adjust.d <> 0 THEN
         LET l_adjust.d = l_son/l_mum * l_adjust.d
      ELSE 
         LET l_adjust.d = 0
      END IF
      IF l_adjust.e <> 0 THEN
         LET l_adjust.e = l_son/l_mum * l_adjust.e
      ELSE 
         LET l_adjust.e = 0
      END IF
      IF l_adjust.f <> 0 THEN
         LET l_adjust.f = l_son/l_mum * l_adjust.f
      ELSE 
         LET l_adjust.f = 0
      END IF
      IF l_adjust.g <> 0 THEN
         LET l_adjust.g = l_son/l_mum * l_adjust.g
      ELSE 
         LET l_adjust.g = 0
      END IF
      IF l_adjust.h <> 0 THEN
         LET l_adjust.h = l_son/l_mum * l_adjust.h
      ELSE 
         LET l_adjust.h = 0
      END IF
   END IF
   #170705-00006#1 add(E)   
   LET l_adjust.tot = l_adjust.a + l_adjust.b + l_adjust.c + l_adjust.d + 
                      l_adjust.e + l_adjust.f + l_adjust.g + l_adjust.h
   #计算调整金额
   LET g_xccq.xccq213  = g_xccq.xccq213  + 0 
   LET g_xccq.xccq214  = g_xccq.xccq214  + l_adjust.tot     
   LET g_xccq.xccq214a = g_xccq.xccq214a + l_adjust.a       
   LET g_xccq.xccq214b = g_xccq.xccq214b + l_adjust.b       
   LET g_xccq.xccq214c = g_xccq.xccq214c + l_adjust.c       
   LET g_xccq.xccq214d = g_xccq.xccq214d + l_adjust.d       
   LET g_xccq.xccq214e = g_xccq.xccq214e + l_adjust.e       
   LET g_xccq.xccq214f = g_xccq.xccq214f + l_adjust.f       
   LET g_xccq.xccq214g = g_xccq.xccq214g + l_adjust.g       
   LET g_xccq.xccq214h = g_xccq.xccq214h + l_adjust.h
END FUNCTION

################################################################################
# Descriptions...: 取料件的成本调整金额
# Memo...........:
# Usage..........: CALL s_axcp500_get_adjust()
#                       RETURNING r_adjust
# Input parameter: NULL
# Return code....: r_adjust       调整的金额
# Date & Author..: 2014-07-30 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_adjust(p_xccc001,p_xccc002,p_xccc006,p_xccc007,p_xccc008)
   DEFINE p_xccc001       LIKE xccc_t.xccc001
   DEFINE p_xccc002       LIKE xccc_t.xccc002
   DEFINE p_xccc006       LIKE xccc_t.xccc006
   DEFINE p_xccc007       LIKE xccc_t.xccc007
   DEFINE p_xccc008       LIKE xccc_t.xccc008
   DEFINE l_adjust        RECORD
                          tot  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD  

   WHENEVER ERROR CONTINUE
   LET l_adjust.tot = 0
   LET l_adjust.a = 0 LET l_adjust.b = 0 LET l_adjust.c = 0 LET l_adjust.d = 0
   LET l_adjust.e = 0 LET l_adjust.f = 0 LET l_adjust.g = 0 LET l_adjust.h = 0
   
   SELECT SUM(xcco102),SUM(xcco102a),SUM(xcco102b),SUM(xcco102c),SUM(xcco102d),
                       SUM(xcco102e),SUM(xcco102f),SUM(xcco102g),SUM(xcco102h)
     INTO l_adjust.tot,l_adjust.a,l_adjust.b,l_adjust.c,l_adjust.d,
          l_adjust.e,l_adjust.f,l_adjust.g,l_adjust.h
     FROM xcco_t
    WHERE xccoent = g_enterprise
      AND xccold  = g_ld
      #AND xcco001 = p_seq
      AND xcco001 = p_xccc001 #mod zhangllc
      AND xcco002 = p_xccc002
      AND xcco003 = g_xcat001
      AND xcco004 = g_yy
      AND xcco005 = g_pp
      AND xcco006 = p_xccc006
      AND xcco007 = p_xccc007
      AND xcco008 = p_xccc008
   IF cl_null(l_adjust.a) THEN LET l_adjust.a = 0 END IF
   IF cl_null(l_adjust.b) THEN LET l_adjust.b = 0 END IF
   IF cl_null(l_adjust.c) THEN LET l_adjust.c = 0 END IF
   IF cl_null(l_adjust.d) THEN LET l_adjust.d = 0 END IF
   IF cl_null(l_adjust.e) THEN LET l_adjust.e = 0 END IF
   IF cl_null(l_adjust.f) THEN LET l_adjust.f = 0 END IF
   IF cl_null(l_adjust.g) THEN LET l_adjust.g = 0 END IF
   IF cl_null(l_adjust.h) THEN LET l_adjust.h = 0 END IF
   LET l_adjust.tot = l_adjust.a + l_adjust.b + l_adjust.c + l_adjust.d + 
                      l_adjust.e + l_adjust.f + l_adjust.g + l_adjust.h
   
   #mod zhangllc 151208 --begin
   #LET g_xccc.xccc213  = 0 
   #LET g_xccc.xccc214  = l_adjust.tot     
   #LET g_xccc.xccc214a = l_adjust.a       
   #LET g_xccc.xccc214b = l_adjust.b       
   #LET g_xccc.xccc214c = l_adjust.c       
   #LET g_xccc.xccc214d = l_adjust.d       
   #LET g_xccc.xccc214e = l_adjust.e       
   #LET g_xccc.xccc214f = l_adjust.f       
   #LET g_xccc.xccc214g = l_adjust.g       
   #LET g_xccc.xccc214h = l_adjust.h 
   LET g_xccc.xccc213  = g_xccc.xccc213  + 0 
   LET g_xccc.xccc214  = g_xccc.xccc214  + l_adjust.tot     
   LET g_xccc.xccc214a = g_xccc.xccc214a + l_adjust.a       
   LET g_xccc.xccc214b = g_xccc.xccc214b + l_adjust.b       
   LET g_xccc.xccc214c = g_xccc.xccc214c + l_adjust.c       
   LET g_xccc.xccc214d = g_xccc.xccc214d + l_adjust.d       
   LET g_xccc.xccc214e = g_xccc.xccc214e + l_adjust.e       
   LET g_xccc.xccc214f = g_xccc.xccc214f + l_adjust.f       
   LET g_xccc.xccc214g = g_xccc.xccc214g + l_adjust.g       
   LET g_xccc.xccc214h = g_xccc.xccc214h + l_adjust.h 
   #mod zhangllc 151208 --end
   
END FUNCTION

################################################################################
# Descriptions...: 联产品处理 - 设置xccg_t的资料
# Memo...........:
# Usage..........: CALL s_axcp500_coproduct_set_xccg(p_xcck,p_sum)
#                       RETURNING r_success
# Input parameter: p_xcck         xcck的资料
#                : p_sum          联产品入库成本
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_coproduct_set_xccg(p_xcck,p_sum)
   #DEFINE p_xcck          RECORD LIKE xcck_t.*
   DEFINE p_xcck          type_xcck  #mod zhangllc 151214 比原来多了xccktmp1 库存管理特征
   DEFINE p_sum           type_g_std_cost 
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xccg       RECORD LIKE xccg_t.*  #161124-00048#20 mark
   DEFINE l_xccg          type_g_xccg  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccg RECORD  #聯產品成本期異動統計檔
   #    xccgent LIKE xccg_t.xccgent, #企业编号
   #    xccgcomp LIKE xccg_t.xccgcomp, #法人组织
   #    xccgld LIKE xccg_t.xccgld, #账套
   #    xccg001 LIKE xccg_t.xccg001, #账套本位币顺序
   #    xccg002 LIKE xccg_t.xccg002, #成本域
   #    xccg003 LIKE xccg_t.xccg003, #成本计算类型
   #    xccg004 LIKE xccg_t.xccg004, #年度
   #    xccg005 LIKE xccg_t.xccg005, #期别
   #    xccg006 LIKE xccg_t.xccg006, #工单编号
   #    xccg007 LIKE xccg_t.xccg007, #联产品料号
   #    xccg008 LIKE xccg_t.xccg008, #特性
   #    xccg009 LIKE xccg_t.xccg009, #批号
   #    xccg010 LIKE xccg_t.xccg010, #核算币种
   #    xccg101 LIKE xccg_t.xccg101, #上期结存数量
   #    xccg102 LIKE xccg_t.xccg102, #上期结存金额
   #    xccg102a LIKE xccg_t.xccg102a, #上期结存金额-材料
   #    xccg102b LIKE xccg_t.xccg102b, #上期结存金额-人工
   #    xccg102c LIKE xccg_t.xccg102c, #上期结存金额-加工
   #    xccg102d LIKE xccg_t.xccg102d, #上期结存金额-制费一
   #    xccg102e LIKE xccg_t.xccg102e, #上期结存金额-制费二
   #    xccg102f LIKE xccg_t.xccg102f, #上期结存金额-制费三
   #    xccg102g LIKE xccg_t.xccg102g, #上期结存金额-制费四
   #    xccg102h LIKE xccg_t.xccg102h, #上期结存金额-制费五
   #    xccg301 LIKE xccg_t.xccg301, #本期转出数量
   #    xccg302 LIKE xccg_t.xccg302, #本期转出金额
   #    xccg302a LIKE xccg_t.xccg302a, #本期转出金额-材料
   #    xccg302b LIKE xccg_t.xccg302b, #本期转出金额-人工
   #    xccg302c LIKE xccg_t.xccg302c, #本期转出金额-加工
   #    xccg302d LIKE xccg_t.xccg302d, #本期转出金额-制费一
   #    xccg302e LIKE xccg_t.xccg302e, #本期转出金额-制费二
   #    xccg302f LIKE xccg_t.xccg302f, #本期转出金额-制费三
   #    xccg302g LIKE xccg_t.xccg302g, #本期转出金额-制费四
   #    xccg302h LIKE xccg_t.xccg302h, #本期转出金额-制费五
   #    xccg901 LIKE xccg_t.xccg901, #期末结存数量
   #    xccg902 LIKE xccg_t.xccg902, #期末结存金额
   #    xccg902a LIKE xccg_t.xccg902a, #期末结存金额-材料
   #    xccg902b LIKE xccg_t.xccg902b, #期末结存金额-人工
   #    xccg902c LIKE xccg_t.xccg902c, #期末结存金额-加工
   #    xccg902d LIKE xccg_t.xccg902d, #期末结存金额-制费一
   #    xccg902e LIKE xccg_t.xccg902e, #期末结存金额-制费二
   #    xccg902f LIKE xccg_t.xccg902f, #期末结存金额-制费三
   #    xccg902g LIKE xccg_t.xccg902g, #期末结存金额-制费四
   #    xccg902h LIKE xccg_t.xccg902h, #期末结存金额-制费五
   #    xccgtime LIKE xccg_t.xccgtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_rate          LIKE type_t.num26_10
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcbp006       LIKE xcbp_t.xcbp006
#   DEFINE l_xccd       RECORD LIKE xccd_t.*  #161124-00048#20 mark
   DEFINE l_xccd          type_g_xccd  #170605-00013#1-add
   #170605-00013#1-s-mark 改用type方式
   ##161124-00048#20 add(s)
   #DEFINE l_xccd RECORD  #在製主件成本期異動統計檔
   #    xccdent LIKE xccd_t.xccdent, #企业编号
   #    xccdcomp LIKE xccd_t.xccdcomp, #法人组织
   #    xccdld LIKE xccd_t.xccdld, #账套
   #    xccd001 LIKE xccd_t.xccd001, #账套本位币顺序
   #    xccd002 LIKE xccd_t.xccd002, #成本域
   #    xccd003 LIKE xccd_t.xccd003, #成本计算类型
   #    xccd004 LIKE xccd_t.xccd004, #年度
   #    xccd005 LIKE xccd_t.xccd005, #期别
   #    xccd006 LIKE xccd_t.xccd006, #工单编号
   #    xccd007 LIKE xccd_t.xccd007, #主件料号
   #    xccd008 LIKE xccd_t.xccd008, #产品特征
   #    xccd009 LIKE xccd_t.xccd009, #批号
   #    xccd010 LIKE xccd_t.xccd010, #项目号
   #    xccd011 LIKE xccd_t.xccd011, #核算币种
   #    xccd012 LIKE xccd_t.xccd012, #重复性成产否
   #    xccd013 LIKE xccd_t.xccd013, #成产计划号
   #    xccd014 LIKE xccd_t.xccd014, #BOM特性
   #    xccd101 LIKE xccd_t.xccd101, #上期结存数量
   #    xccd102 LIKE xccd_t.xccd102, #上期结存金额
   #    xccd102a LIKE xccd_t.xccd102a, #上期结存金额-材料
   #    xccd102b LIKE xccd_t.xccd102b, #上期结存金额-人工
   #    xccd102c LIKE xccd_t.xccd102c, #上期结存金额-加工
   #    xccd102d LIKE xccd_t.xccd102d, #上期结存金额-制费一
   #    xccd102e LIKE xccd_t.xccd102e, #上期结存金额-制费二
   #    xccd102f LIKE xccd_t.xccd102f, #上期结存金额-制费三
   #    xccd102g LIKE xccd_t.xccd102g, #上期结存金额-制费四
   #    xccd102h LIKE xccd_t.xccd102h, #上期结存金额-制费五
   #    xccd200 LIKE xccd_t.xccd200, #本期投入工时
   #    xccd201 LIKE xccd_t.xccd201, #本期投入数量
   #    xccd202 LIKE xccd_t.xccd202, #本期本阶投入金额
   #    xccd202a LIKE xccd_t.xccd202a, #本期本阶投入金额-材料
   #    xccd202b LIKE xccd_t.xccd202b, #本期本阶投入金额-人工
   #    xccd202c LIKE xccd_t.xccd202c, #本期本阶投入金额-加工
   #    xccd202d LIKE xccd_t.xccd202d, #本期本阶投入金额-制费一
   #    xccd202e LIKE xccd_t.xccd202e, #本期本阶投入金额-制费二
   #    xccd202f LIKE xccd_t.xccd202f, #本期本阶投入金额-制费三
   #    xccd202g LIKE xccd_t.xccd202g, #本期本阶投入金额-制费四
   #    xccd202h LIKE xccd_t.xccd202h, #本期本阶投入金额-制费五
   #    xccd204 LIKE xccd_t.xccd204, #本期下阶投入金额
   #    xccd204a LIKE xccd_t.xccd204a, #本期下阶投入金额-材料
   #    xccd204b LIKE xccd_t.xccd204b, #本期下阶投入金额-人工
   #    xccd204c LIKE xccd_t.xccd204c, #本期下阶投入金额-加工
   #    xccd204d LIKE xccd_t.xccd204d, #本期下阶投入金额-制费一
   #    xccd204e LIKE xccd_t.xccd204e, #本期下阶投入金额-制费二
   #    xccd204f LIKE xccd_t.xccd204f, #本期下阶投入金额-制费三
   #    xccd204g LIKE xccd_t.xccd204g, #本期下阶投入金额-制费四
   #    xccd204h LIKE xccd_t.xccd204h, #本期下阶投入金额-制费五
   #    xccd301 LIKE xccd_t.xccd301, #本期转出数量
   #    xccd302 LIKE xccd_t.xccd302, #本期转出金额
   #    xccd302a LIKE xccd_t.xccd302a, #本期转出金额-材料
   #    xccd302b LIKE xccd_t.xccd302b, #本期转出金额-人工
   #    xccd302c LIKE xccd_t.xccd302c, #本期转出金额-加工
   #    xccd302d LIKE xccd_t.xccd302d, #本期转出金额-制费一
   #    xccd302e LIKE xccd_t.xccd302e, #本期转出金额-制费二
   #    xccd302f LIKE xccd_t.xccd302f, #本期转出金额-制费三
   #    xccd302g LIKE xccd_t.xccd302g, #本期转出金额-制费四
   #    xccd302h LIKE xccd_t.xccd302h, #本期转出金额-制费五
   #    xccd303 LIKE xccd_t.xccd303, #差异转出数量
   #    xccd304 LIKE xccd_t.xccd304, #差异转出金额
   #    xccd304a LIKE xccd_t.xccd304a, #差异转出金额-材料
   #    xccd304b LIKE xccd_t.xccd304b, #差异转出金额-人工
   #    xccd304c LIKE xccd_t.xccd304c, #差异转出金额-加工
   #    xccd304d LIKE xccd_t.xccd304d, #差异转出金额-制费一
   #    xccd304e LIKE xccd_t.xccd304e, #差异转出金额-制费二
   #    xccd304f LIKE xccd_t.xccd304f, #差异转出金额-制费三
   #    xccd304g LIKE xccd_t.xccd304g, #差异转出金额-制费四
   #    xccd304h LIKE xccd_t.xccd304h, #差异转出金额-制费五
   #    xccd901 LIKE xccd_t.xccd901, #期末结存数量
   #    xccd902 LIKE xccd_t.xccd902, #期末结存金额
   #    xccd902a LIKE xccd_t.xccd902a, #期末结存金额-材料
   #    xccd902b LIKE xccd_t.xccd902b, #期末结存金额-人工
   #    xccd902c LIKE xccd_t.xccd902c, #期末结存金额-加工
   #    xccd902d LIKE xccd_t.xccd902d, #期末结存金额-制费一
   #    xccd902e LIKE xccd_t.xccd902e, #期末结存金额-制费二
   #    xccd902f LIKE xccd_t.xccd902f, #期末结存金额-制费三
   #    xccd902g LIKE xccd_t.xccd902g, #期末结存金额-制费四
   #    xccd902h LIKE xccd_t.xccd902h, #期末结存金额-制费五
   #    xccdtime LIKE xccd_t.xccdtime  #最近成本计算时间
   #END RECORD
   ##161124-00048#20 add(e)
   #170605-00013#1-e-mark
   DEFINE l_xccd002       LIKE xccd_t.xccd002
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   CALL s_axcp500_get_xccg(p_xcck.xcck001,p_xcck.xcck002,p_xcck.xcck047,p_xcck.xcck010,p_xcck.xcck011,p_xcck.xcck017)
        RETURNING l_xccg.*
        
   LET l_xccd002 = ' '
   IF g_field_type = '1' THEN
      LET l_xccd002 = p_xcck.xcck002
   END IF
#   SELECT * INTO l_xccd.* FROM xccd_tmp  #161124-00048#20 mark
   #161124-00048#20 add(s)
   SELECT xccdent,xccdcomp,xccdld,xccd001,xccd002,xccd003,xccd004,xccd005,
          xccd006,xccd007,xccd008,xccd009,xccd010,xccd011,xccd012,xccd013,
          xccd014,xccd101,xccd102,xccd102a,xccd102b,xccd102c,xccd102d,xccd102e,
          xccd102f,xccd102g,xccd102h,xccd200,xccd201,xccd202,xccd202a,xccd202b,
          xccd202c,xccd202d,xccd202e,xccd202f,xccd202g,xccd202h,xccd204,xccd204a,
          xccd204b,xccd204c,xccd204d,xccd204e,xccd204f,xccd204g,xccd204h,xccd301,
          xccd302,xccd302a,xccd302b,xccd302c,xccd302d,xccd302e,xccd302f,xccd302g,
          xccd302h,xccd303,xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,
          xccd304f,xccd304g,xccd304h,xccd901,xccd902,xccd902a,xccd902b,xccd902c,
          xccd902d,xccd902e,xccd902f,xccd902g,xccd902h,xccdtime 
     INTO l_xccd.* FROM xccd_tmp
   #161124-00048#20 add(e)
    WHERE xccdent = g_enterprise
      AND xccdld  = g_ld
      AND xccd001 = p_xcck.xcck001
      AND xccd002 = l_xccd002
      AND xccd003 = p_xcck.xcck003
      AND xccd004 = p_xcck.xcck004
      AND xccd005 = p_xcck.xcck005
      AND xccd006 = p_xcck.xcck047
   IF SQLCA.sqlcode THEN
      #取不到在制工单%1的主件成本期资料(xccd)
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = 'axc-00522'
      LET g_errparam.extend = ''
      LET g_errparam.replace[1] = p_xcck.xcck047
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      LET g_str = cl_getmsg('axc-00522',g_lang)
      LET g_str = cl_err_replace_msg(g_str)
      CALL s_axcp500_ins_error('','','','',p_xcck.xcck006,p_xcck.xcck007,p_xcck.xcck008,p_xcck.xcck009,
                               p_xcck.xcck010,p_xcck.xcck011,p_xcck.xcck017,'','axc-00522',g_str,'')  
      RETURN r_success
   END IF
   
   #取得联产品比率
   CALL s_axcp500_coproduct_get_share_rate(p_xcck.xccksite,p_xcck.xcck047,p_xcck.xcck049,p_xcck.xcck010)
        RETURNING l_success,l_xcbp006
   IF NOT l_success THEN
      LET l_xcbp006 = 100
   END IF
   IF cl_null(l_xcbp006) OR l_xcbp006 = 0 THEN
      LET l_xcbp006 = 100
   END IF
   
   #分配的比率=联产品交易数量*联产品占比率/转出数量
   IF p_xcck.xcck012!='DIFF' THEN  #170511-00068#1 add by 00768 本月无入库的部分不用按比率，按全部算
      #LET l_rate = p_xcck.xcck045 * p_xcck.xcck046 * l_xcbp006 / (l_xccd.xccd301 * 100)  #170705-00006#1 mark
      #170705-00006#1 add(S)
      IF l_xccd.xccd301 <> 0 THEN
         LET l_rate = p_xcck.xcck045 * p_xcck.xcck046 * l_xcbp006 / (l_xccd.xccd301 * 100)
      ELSE 
         LET l_rate = 0
      END IF 
      #170705-00006#1 add(E)      
      IF l_rate = 0 THEN  #不需要分配
         LET r_success = TRUE
         RETURN r_success
      END IF
   END IF  #170511-00068#1 add by 00768
   #170511-00068#1 add by 00768------str----
   IF p_xcck.xcck012='DIFF' AND p_xcck.xcck282=0 THEN 
      LET r_success = TRUE
      RETURN r_success
   END IF    
   #170511-00068#1 add by 00768------end----
   
#   LET l_xccg.xccg301  = l_xccg.xccg301  + l_xccd.xccd301  * l_rate                               #本期轉出數量
   LET l_xccg.xccg301  = l_xccg.xccg301  + p_xcck.xcck045 * p_xcck.xcck046                         #本期轉出數量
#   LET l_xccg.xccg302a = l_xccg.xccg302a + (l_xccd.xccd302a + l_xccd.xccd304a) * l_rate           #本期轉出金額-材料 
#   LET l_xccg.xccg302b = l_xccg.xccg302b + (l_xccd.xccd302b + l_xccd.xccd304b) * l_rate           #本期轉出金額-人工 
#   LET l_xccg.xccg302c = l_xccg.xccg302c + (l_xccd.xccd302c + l_xccd.xccd304c) * l_rate           #本期轉出金額-加工 
#   LET l_xccg.xccg302d = l_xccg.xccg302d + (l_xccd.xccd302d + l_xccd.xccd304d) * l_rate           #本期轉出金額-制費一 
#   LET l_xccg.xccg302e = l_xccg.xccg302e + (l_xccd.xccd302e + l_xccd.xccd304e) * l_rate           #本期轉出金額-制費二 
#   LET l_xccg.xccg302f = l_xccg.xccg302f + (l_xccd.xccd302f + l_xccd.xccd304f) * l_rate           #本期轉出金額-制費三 
#   LET l_xccg.xccg302g = l_xccg.xccg302g + (l_xccd.xccd302g + l_xccd.xccd304g) * l_rate           #本期轉出金額-制費四 
#   LET l_xccg.xccg302h = l_xccg.xccg302h + (l_xccd.xccd302h + l_xccd.xccd304h) * l_rate           #本期轉出金額-制費五 
   LET l_xccg.xccg302a = l_xccg.xccg302a + p_sum.a          #本期轉出金額-材料 
   LET l_xccg.xccg302b = l_xccg.xccg302b + p_sum.b          #本期轉出金額-人工 
   LET l_xccg.xccg302c = l_xccg.xccg302c + p_sum.c          #本期轉出金額-加工 
   LET l_xccg.xccg302d = l_xccg.xccg302d + p_sum.d          #本期轉出金額-制費一 
   LET l_xccg.xccg302e = l_xccg.xccg302e + p_sum.e          #本期轉出金額-制費二 
   LET l_xccg.xccg302f = l_xccg.xccg302f + p_sum.f          #本期轉出金額-制費三 
   LET l_xccg.xccg302g = l_xccg.xccg302g + p_sum.g          #本期轉出金額-制費四 
   LET l_xccg.xccg302h = l_xccg.xccg302h + p_sum.h          #本期轉出金額-制費五 
   ##本期轉出金額
   LET l_xccg.xccg302  = l_xccg.xccg302a + l_xccg.xccg302b + l_xccg.xccg302c + l_xccg.xccg302d +
                         l_xccg.xccg302e + l_xccg.xccg302f + l_xccg.xccg302g + l_xccg.xccg302h
                         
#   LET l_xccg.xccg901  = l_xccg.xccg101  + l_xccg.xccg301                       #期末結存數量  
#   LET l_xccg.xccg902  = l_xccg.xccg102  + l_xccg.xccg302                       #期末結存金額  
#   LET l_xccg.xccg902a = l_xccg.xccg102a + l_xccg.xccg302a                      #期末結存金額-材料 
#   LET l_xccg.xccg902b = l_xccg.xccg102b + l_xccg.xccg302b                      #期末結存金額-人工 
#   LET l_xccg.xccg902c = l_xccg.xccg102c + l_xccg.xccg302c                      #期末結存金額-加工 
#   LET l_xccg.xccg902d = l_xccg.xccg102d + l_xccg.xccg302d                      #期末結存金額-制費一 
#   LET l_xccg.xccg902e = l_xccg.xccg102e + l_xccg.xccg302e                      #期末結存金額-制費二 
#   LET l_xccg.xccg902f = l_xccg.xccg102f + l_xccg.xccg302f                      #期末結存金額-制費三 
#   LET l_xccg.xccg902g = l_xccg.xccg102g + l_xccg.xccg302g                      #期末結存金額-制費四 
#   LET l_xccg.xccg902h = l_xccg.xccg102h + l_xccg.xccg302h                      #期末結存金額-制費五 
#   LET l_xccg.xccgtime = cl_get_current()                                       #最近成本計算時間  

   LET l_xccg.xccg901  = 0                      #期末結存數量  
   LET l_xccg.xccg902  = 0                      #期末結存金額  
   LET l_xccg.xccg902a = 0                      #期末結存金額-材料 
   LET l_xccg.xccg902b = 0                      #期末結存金額-人工 
   LET l_xccg.xccg902c = 0                      #期末結存金額-加工 
   LET l_xccg.xccg902d = 0                      #期末結存金額-制費一 
   LET l_xccg.xccg902e = 0                      #期末結存金額-制費二 
   LET l_xccg.xccg902f = 0                      #期末結存金額-制費三 
   LET l_xccg.xccg902g = 0                      #期末結存金額-制費四 
   LET l_xccg.xccg902h = 0                      #期末結存金額-制費五 
   LET l_xccg.xccgtime = cl_get_current()                                       #最近成本計算時間  

   CALL s_axcp500_ins_or_upd_xccg(l_xccg.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF   
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取得联产品分配比率
# Memo...........:
# Usage..........: s_axcp500_coproduct_get_share_rate(p_site,p_sfaadocno,p_sfaa010,p_xcbp004)
#                    RETURNING r_success,r_xcbp006
# Input parameter: p_site         营运据点
#                : p_sfaadocno    工单单号
#                : p_sfaa010      重复性生产的主件
#                : p_xcbp004      联产品料件
# Return code....: r_success      成功否标识符
#                : r_xcbp006      分配比率
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_coproduct_get_share_rate(p_site,p_sfaadocno,p_sfaa010,p_xcbp004)
   DEFINE p_site          LIKE xcbp_t.xcbpsite
   DEFINE p_sfaadocno     LIKE sfaa_t.sfaadocno
   DEFINE p_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE p_xcbp004       LIKE xcbp_t.xcbp004
   DEFINE r_success       LIKE type_t.num5
   DEFINE r_xcbp006       LIKE xcbp_t.xcbp006
   DEFINE l_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE l_sfaa003       LIKE sfaa_t.sfaa003
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   LET r_xcbp006 = 100

   IF cl_null(p_sfaadocno) THEN
      #联产品成本计算:xcck047(工单单号)为空
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = 'axc-00521'
      LET g_errparam.extend = ''
      LET g_errparam.popup  = TRUE
      CALL cl_err()   
      RETURN r_success,r_xcbp006
   END IF
   
   #重复性生产时,直接传p_sfaa010进来,若是一般工单,则执行下面的SELECT
   IF cl_null(p_sfaa010) THEN
      SELECT sfaa010,sfaa003 INTO l_sfaa010,l_sfaa003 FROM sfaa_tmp
       WHERE sfaaent   = g_enterprise
         AND sfaadocno = p_sfaadocno
      IF SQLCA.sqlcode THEN
         #此工单不存在!
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = 'asf-00321'
         LET g_errparam.extend = ''
         LET g_errparam.replace[1] = p_sfaadocno
         LET g_errparam.popup  = TRUE
         CALL cl_err()     
         CALL s_axcp500_ins_error('','','','',p_sfaadocno,'','','',l_sfaa010,'','',
                                  '','asf-00321','','')      
         RETURN r_success,r_xcbp006
      END IF
   ELSE
      LET l_sfaa010 = p_sfaa010
   END IF

   IF l_sfaa003 = '3' THEN  #拆件式
      LET r_xcbp006 = 100
   ELSE
      #IF g_sys_6009 = '1' THEN
      #IF g_sys_6009 = '1' OR g_sys_6017 = 'N' THEN   #mod zhangllc 150717 聯產品入庫折算在制轉出數量不按分配率計算,那么在制转出数量在计算时联产品的转出数量不需要乘以分配率 #210125-00026#1 mark
      IF g_sys_6009 = '1' THEN    #210125-00026#1   
         LET r_xcbp006 = 100
      ELSE
         SELECT xcbp006 INTO r_xcbp006 FROM xcbp_t
          WHERE xcbpent  = g_enterprise
            AND xcbpsite = p_site
            AND xcbp001  = g_yy
            AND xcbp002  = g_pp
            AND xcbp003  = l_sfaa010
            AND xcbp004  = p_xcbp004
         IF SQLCA.sqlcode THEN
            SELECT xcbo004 INTO r_xcbp006 FROM xcbo_t
             WHERE xcboent  = g_enterprise
               AND xcbosite = p_site
               AND xcbo001  = l_sfaa010
               AND xcbo002  = p_xcbp004     
            IF SQLCA.sqlcode AND NOT (l_sfaa010 = p_xcbp004) THEN
               #联产品成本计算:无法取得工单 %1 的入库联产品 %2 的分配比率
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code   = 'axc-00520'
               LET g_errparam.extend = ''
               LET g_errparam.replace[1] = p_sfaadocno
               LET g_errparam.replace[2] = p_xcbp004
               LET g_errparam.popup  = TRUE
               CALL cl_err()
               LET g_str = cl_getmsg('axc-00520',g_lang)
               LET g_str = cl_err_replace_msg(g_str)
               CALL s_axcp500_ins_error('','','','',p_sfaadocno,'','','',l_sfaa010,'','',
                                        '','axc-00520',g_str,'')            
               RETURN r_success,r_xcbp006
            END IF
         END IF
      END IF
   END IF   
   LET r_success = TRUE
   RETURN r_success,r_xcbp006
END FUNCTION

################################################################################
# Descriptions...: 拆件在制处理
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_1(p_seq,p_sfaadocno,p_close,p_imaa001,p_xccc002,p_xccc007,p_xccc008)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_sfaadocno    工单单号
#                : p_close        工单本期结案否
#                : p_imaa001      主件编号
#                : p_xccc002      成本域
#                : p_xccc007      产品特征
#                : p_xccc008      批号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-12 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_1(p_seq,p_sfaadocno,p_close,p_imaa001,p_xccc002,p_xccc007,p_xccc008)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_sfaadocno     LIKE sfaa_t.sfaadocno
   DEFINE p_close         LIKE type_t.chr1
   DEFINE p_imaa001       LIKE imaa_t.imaa001
   DEFINE p_xccc002       LIKE xccc_t.xccc002
   DEFINE p_xccc007       LIKE xccc_t.xccc007
   DEFINE p_xccc008       LIKE xccc_t.xccc008
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
      
   CALL s_axcp500_disassemble_wip_1(p_seq,p_sfaadocno,p_imaa001,p_xccc002,p_xccc007,p_xccc008)           #主件 - 投入工时
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   CALL s_axcp500_disassemble_wip_2()                            #元件投入 - 上期结转/材料/人工/加工/制费/调整 
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   

   CALL s_axcp500_disassemble_wip_4(p_close)                     #元件转出
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   CALL s_axcp500_disassemble_wip_5()                            #主件转出
        RETURNING l_success
    IF NOT l_success THEN
      RETURN r_success
   END IF

   CALL s_axcp500_disassemble_wip_del(p_seq,p_sfaadocno,p_imaa001,p_xccc002,p_xccc007,p_xccc008)
        RETURNING l_success
    IF NOT l_success THEN
      RETURN r_success
   END IF
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 折件-在制成本计算-主件工时算
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_1(p_seq,p_sfaadocno,p_xcch007,p_xcch002,p_xcch008,p_xcch009)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_sfaadocno    工单单号
#                : p_xcch007      料件编号
#                : p_xcch002      成本域
#                : p_xcch008      产品特征
#                : p_xcch009      批号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-04 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_1(p_seq,p_sfaadocno,p_xcch007,p_xcch002,p_xcch008,p_xcch009)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_sfaadocno     LIKE sfaa_t.sfaadocno
   DEFINE p_xcch007       LIKE xcch_t.xcch007
   DEFINE p_xcch002       LIKE xcch_t.xcch002
   DEFINE p_xcch008       LIKE xcch_t.xcch008
   DEFINE p_xcch009       LIKE xcch_t.xcch009
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcch          RECORD LIKE xcch_t.*  #161124-00048#20 mark
   DEFINE l_xcch          type_g_xcch  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcch002       LIKE xcch_t.xcch002
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   LET l_xcch002 = ' '
   IF g_field_type = '1' THEN
      SELECT xcbf001 INTO l_xcch002 FROM xcbf_t,sfaa_tmp
       WHERE xcbfent   = sfaaent AND xcbfent = g_enterprise
         AND xcbfcomp  = g_comp
         AND sfaadocno = p_sfaadocno
         AND xcbf002   = sfaasite
   END IF
   
   IF l_xcch002 IS NULL THEN
      LET l_xcch002 = ' '
   END IF
         
   
   CALL s_axcp500_get_xcch(p_seq,l_xcch002,p_sfaadocno,p_xcch007,p_xcch008,p_xcch009)
        RETURNING l_xcch.*

   #本期投入工時
   CALL s_axcp500_get_xccd200(p_sfaadocno)    #工时统计
        RETURNING l_xcch.xcch200
   
   CALL s_axcp500_ins_or_upd_xcch(l_xcch.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
      
   LET g_xcch.* = l_xcch.*
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 元件投入
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_2() 
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_2()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #STEP -1 结转上期的xcci资料至本期
   CALL s_axcp500_disassemble_wip_2_1()
        RETURNING l_success   
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   #STEP -2 取当期的发退料元件成本
   CALL s_axcp500_disassemble_wip_2_2()
        RETURNING l_success   
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   #STEP -3 取当期的人工/加工/制费
   CALL s_axcp500_disassemble_wip_2_3()
        RETURNING l_success   
   IF NOT l_success THEN
      RETURN r_success
   END IF

   #STEP -4 取当期的在制成本调整
   CALL s_axcp500_disassemble_wip_2_4()
        RETURNING l_success   
   IF NOT l_success THEN
      RETURN r_success
   END IF
               
   LET r_success = TRUE   
   RETURN r_success
    
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 结转元件上期成本
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_2_1()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成本否标识符
# Date & Author..: 2014-08-05 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_2_1()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcci          RECORD LIKE xcci_t.*   #161124-00048#20 mark
#   DEFINE l_t_xcci        RECORD LIKE xcci_t.*   #161124-00048#20 mark
   DEFINE l_xcci           type_g_xcci  #170605-00013#1-add
   DEFINE l_t_xcci         type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
##161124-00048#20 add(s)
#DEFINE l_t_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   FOREACH s_axcp500_disassemble_wip_2_1_cs1 USING g_xcch.xcch001,g_xcch.xcch003,
                                                   g_last_yy,g_last_pp,g_xcch.xcch006
                                  INTO l_t_xcci.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_disassemble_wip_2_1_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()  
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
                                  '',SQLCA.sqlcode,'','s_axcp500_disassemble_wip_2_1_cs1')         
         CONTINUE FOREACH   
      END IF 
      
      CALL s_axcp500_get_xcci(g_xcch.xcch001,l_t_xcci.xcci002,g_xcch.xcch006,l_t_xcci.xcci007,l_t_xcci.xcci008,l_t_xcci.xcci009)
           RETURNING l_xcci.* 
           
      CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END FOREACH                                  
                                  
   LET r_success = TRUE                                   
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 下阶料投入(发料/退料等)
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_2_2()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_2_2()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_xcci          RECORD LIKE xcci_t.* #161124-00048#20 mark
   DEFINE l_xcci           type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_inaj          RECORD 
                          inaj005     LIKE inaj_t.inaj005,
                          inaj006     LIKE inaj_t.inaj006,
                          inaj010     LIKE inaj_t.inaj010,
                          inaj015     LIKE inaj_t.inaj015,
                          inaj036     LIKE inaj_t.inaj036,
                          qty         LIKE inaj_t.inaj011,
                          xcci002     LIKE xcci_t.xcci002
                          END RECORD
   TYPE   l_type1         type_get_cost_rec
   DEFINE l_sum1          l_type1
   DEFINE l_sum2          l_type1
   DEFINE l_avg           type_g_std_cost 
   DEFINE l_choice        LIKE type_t.chr10
   DEFINE l_avg1          type_g_std_cost   
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   
   FOREACH s_axcp500_wip_2_cs1 USING g_xcch.xcch001,g_xcch.xcch003,g_xcch.xcch006
                                INTO l_inaj.*,l_avg.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
                                  '',SQLCA.sqlcode,'','s_axcp500_wip_2_cs1')         
         CONTINUE FOREACH     
      END IF  

      CALL s_axcp500_get_xcci(g_xcch.xcch001,l_inaj.xcci002,g_xcch.xcch006,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010)
           RETURNING l_xcci.*
              
      IF g_cost_type = '1' THEN   #标准成本
         SELECT xcag102,xcag102a,xcag102b,xcag102c,xcag102d,xcag102e,xcag102f,xcag102g,xcag102h
           INTO l_avg.*
           FROM std_cost_tmp
          WHERE xcagsite = l_xcci.xcci002
            AND xcag004  = l_xcci.xcci007   
            
         LET l_avg.sum = l_avg.sum * l_inaj.qty
         LET l_avg.a   = l_avg.a   * l_inaj.qty
         LET l_avg.b   = l_avg.b   * l_inaj.qty
         LET l_avg.c   = l_avg.c   * l_inaj.qty
         LET l_avg.d   = l_avg.d   * l_inaj.qty
         LET l_avg.e   = l_avg.e   * l_inaj.qty
         LET l_avg.f   = l_avg.f   * l_inaj.qty
         LET l_avg.g   = l_avg.g   * l_inaj.qty
         LET l_avg.h   = l_avg.h   * l_inaj.qty
         
      ELSE

#        CALL s_axcp500_avg_get_cost(g_xcch.xcch007,l_xcci.xcci001,l_xcci.xcci002,l_xcci.xcci003,g_yy,
#                                g_pp,l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci009)
#             RETURNING l_success,l_avg.*     
#        IF NOT l_success THEN
#  #         RETURN r_success
#        END IF  

      END IF
      
      LET l_xcci.xcci201  = l_xcci.xcci201  + l_inaj.qty
      LET l_xcci.xcci202  = l_xcci.xcci202  + l_avg.sum
      LET l_xcci.xcci202a = l_xcci.xcci202a + l_avg.a
      LET l_xcci.xcci202b = l_xcci.xcci202b + l_avg.b
      LET l_xcci.xcci202c = l_xcci.xcci202c + l_avg.c
      LET l_xcci.xcci202d = l_xcci.xcci202d + l_avg.d
      LET l_xcci.xcci202e = l_xcci.xcci202e + l_avg.e
      LET l_xcci.xcci202f = l_xcci.xcci202f + l_avg.f
      LET l_xcci.xcci202g = l_xcci.xcci202g + l_avg.g
      LET l_xcci.xcci202h = l_xcci.xcci202h + l_avg.h    

      CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   END FOREACH
   
            
   LET r_success = TRUE   
   RETURN r_success
 
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 取得人工/加工/制费
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_2_3()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_2_3()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcci          RECORD LIKE xcci_t.* #161124-00048#20 mark
   DEFINE l_xcci           type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_arr           ARRAY[6] OF RECORD
                          xcbk202     LIKE xcbk_t.xcbk202,
                          xcbk212     LIKE xcbk_t.xcbk212,
                          xcbk222     LIKE xcbk_t.xcbk222
                          END RECORD
#   DEFINE l_inaj          RECORD LIKE inaj_t.*   #161124-00048#20 mark
 #161124-00048#20 add(s)
DEFINE l_inaj RECORD  #庫存交易明細檔
       inajent LIKE inaj_t.inajent, #企业编号
       inajsite LIKE inaj_t.inajsite, #营运据点
       inaj001 LIKE inaj_t.inaj001, #单据编号
       inaj002 LIKE inaj_t.inaj002, #项次
       inaj003 LIKE inaj_t.inaj003, #项序
       inaj004 LIKE inaj_t.inaj004, #出入库码
       inaj005 LIKE inaj_t.inaj005, #料件编号
       inaj006 LIKE inaj_t.inaj006, #产品特征
       inaj007 LIKE inaj_t.inaj007, #库存管理特征
       inaj008 LIKE inaj_t.inaj008, #库位编号
       inaj009 LIKE inaj_t.inaj009, #储位编号
       inaj010 LIKE inaj_t.inaj010, #批号
       inaj011 LIKE inaj_t.inaj011, #交易数量
       inaj012 LIKE inaj_t.inaj012, #交易单位
       inaj013 LIKE inaj_t.inaj013, #交易单位与库存单位换算率
       inaj014 LIKE inaj_t.inaj014, #交易单位与料件基本单位换算率
       inaj015 LIKE inaj_t.inaj015, #异动单据性质
       inaj016 LIKE inaj_t.inaj016, #理由码
       inaj017 LIKE inaj_t.inaj017, #异动部门编号
       inaj018 LIKE inaj_t.inaj018, #异动供应商/客户编号
       inaj019 LIKE inaj_t.inaj019, #备注
       inaj020 LIKE inaj_t.inaj020, #工单单号
       inaj021 LIKE inaj_t.inaj021, #多角序号
       inaj022 LIKE inaj_t.inaj022, #单据扣账日期
       inaj023 LIKE inaj_t.inaj023, #实际运行扣账日期
       inaj024 LIKE inaj_t.inaj024, #数据生成时间
       inaj025 LIKE inaj_t.inaj025, #异动数据生成者
       inaj026 LIKE inaj_t.inaj026, #参考单位
       inaj027 LIKE inaj_t.inaj027, #参考数量
       inaj028 LIKE inaj_t.inaj028, #成本料号
       inaj036 LIKE inaj_t.inaj036, #库存异动类型
       inaj029 LIKE inaj_t.inaj029, #交易单位与成本单位换算率
       inaj030 LIKE inaj_t.inaj030, #VMI交易结算否
       inaj031 LIKE inaj_t.inaj031, #VMI对应入库/仓退单号
       inaj032 LIKE inaj_t.inaj032, #VMI对应入库/仓退项次
       inaj033 LIKE inaj_t.inaj033, #VMI对应杂发/杂收单号
       inaj034 LIKE inaj_t.inaj034, #VMI对应杂发/杂收项次
       inaj035 LIKE inaj_t.inaj035, #异动作业编号
       inaj037 LIKE inaj_t.inaj037, #成本中心
       inaj038 LIKE inaj_t.inaj038, #项目编号
       inaj039 LIKE inaj_t.inaj039, #WBS编号
       inaj040 LIKE inaj_t.inaj040, #重复性生产-计划编号
       inaj041 LIKE inaj_t.inaj041, #重复性生产-生产料号
       inaj042 LIKE inaj_t.inaj042, #重复性生产-生产料号BOM特性
       inaj043 LIKE inaj_t.inaj043, #重复性生产-生产料号产品特征
       inaj044 LIKE inaj_t.inaj044, #来源单号
       inaj200 LIKE inaj_t.inaj200, #内部结算否
       inaj201 LIKE inaj_t.inaj201, #业务类型
       inaj202 LIKE inaj_t.inaj202, #内部交易类型
       inaj203 LIKE inaj_t.inaj203, #币种
       inaj204 LIKE inaj_t.inaj204, #税种
       inaj205 LIKE inaj_t.inaj205, #内部结算税前金额
       inaj206 LIKE inaj_t.inaj206, #内部结算含税金额
       inaj207 LIKE inaj_t.inaj207, #交易所属法人
       inaj208 LIKE inaj_t.inaj208, #内部交易对象组织
       inaj209 LIKE inaj_t.inaj209, #内部交易对象法人
       inaj045 LIKE inaj_t.inaj045, #异动时库存单位
       inaj046 LIKE inaj_t.inaj046, #交易单位与库存单位换算分子
       inaj047 LIKE inaj_t.inaj047, #交易单位与库存单位换算分母
       inaj048 LIKE inaj_t.inaj048, #交易单位与料件基本单位换算分子
       inaj049 LIKE inaj_t.inaj049, #交易单位与料件基本单位换算分母
       inaj050 LIKE inaj_t.inaj050, #交易单位与成本单位换算分子
       inaj051 LIKE inaj_t.inaj051, #交易单位与成本单位换算分母
       inaj210 LIKE inaj_t.inaj210, #单据单价
       inaj211 LIKE inaj_t.inaj211  #品类
END RECORD
#161124-00048#20 add(e)  
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_sum           LIKE xccc_t.xccc202
   DEFINE l_tot           LIKE xccc_t.xccc202   
   DEFINE l_inajsite      LIKE inaj_t.inajsite #160823-00040#1
   DEFINE l_inaj001       LIKE inaj_t.inaj001  #160823-00040#1
   DEFINE l_inaj002       LIKE inaj_t.inaj002  #160823-00040#1
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   CALL s_axcp500_get_xcci(g_xcch.xcch001,' ',g_xcch.xcch006,'DL+OH+SUB',' ',' ')
        RETURNING l_xcci.*   

#wujie 160523 --begin 五合一，提高执行效能
   EXECUTE s_axcp500_def_cursor_p10 USING g_xcch.xcch006
                                     INTO l_arr[1].*,l_arr[2].*,l_arr[3].*,l_arr[4].*,l_arr[5].*,l_arr[6].* 

   IF cl_null(l_arr[1].xcbk202) THEN LET l_arr[1].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[1].xcbk212) THEN LET l_arr[1].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[1].xcbk222) THEN LET l_arr[1].xcbk222 = 0 END IF
   IF cl_null(l_arr[2].xcbk202) THEN LET l_arr[2].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[2].xcbk212) THEN LET l_arr[2].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[2].xcbk222) THEN LET l_arr[2].xcbk222 = 0 END IF
   IF cl_null(l_arr[3].xcbk202) THEN LET l_arr[3].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[3].xcbk212) THEN LET l_arr[3].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[3].xcbk222) THEN LET l_arr[3].xcbk222 = 0 END IF 
   IF cl_null(l_arr[4].xcbk202) THEN LET l_arr[4].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[4].xcbk212) THEN LET l_arr[4].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[4].xcbk222) THEN LET l_arr[4].xcbk222 = 0 END IF
   IF cl_null(l_arr[5].xcbk202) THEN LET l_arr[5].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[5].xcbk212) THEN LET l_arr[5].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[5].xcbk222) THEN LET l_arr[5].xcbk222 = 0 END IF  
   IF cl_null(l_arr[6].xcbk202) THEN LET l_arr[6].xcbk202 = 0 END IF                            
   IF cl_null(l_arr[6].xcbk212) THEN LET l_arr[6].xcbk212 = 0 END IF                            
   IF cl_null(l_arr[6].xcbk222) THEN LET l_arr[6].xcbk222 = 0 END IF 
   
#   #人工
#   EXECUTE s_axcp500_def_cursor_p10 USING '1',g_xcch.xcch006 
#                                     INTO l_arr[1].*   
#   IF cl_null(l_arr[1].xcbk202) THEN LET l_arr[1].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[1].xcbk212) THEN LET l_arr[1].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[1].xcbk222) THEN LET l_arr[1].xcbk222 = 0 END IF                            
#   #制费1                            
#   EXECUTE s_axcp500_def_cursor_p10 USING '2',g_xcch.xcch006 
#                                     INTO l_arr[2].*                            
#   IF cl_null(l_arr[2].xcbk202) THEN LET l_arr[2].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[2].xcbk212) THEN LET l_arr[2].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[2].xcbk222) THEN LET l_arr[2].xcbk222 = 0 END IF                            
#   #制费2
#   EXECUTE s_axcp500_def_cursor_p10 USING '3',g_xcch.xcch006 
#                                     INTO l_arr[3].*                            
#   IF cl_null(l_arr[3].xcbk202) THEN LET l_arr[3].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[3].xcbk212) THEN LET l_arr[3].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[3].xcbk222) THEN LET l_arr[3].xcbk222 = 0 END IF                            
#   #制费3
#   EXECUTE s_axcp500_def_cursor_p10 USING '4',g_xcch.xcch006 
#                                     INTO l_arr[4].*                            
#   IF cl_null(l_arr[4].xcbk202) THEN LET l_arr[4].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[4].xcbk212) THEN LET l_arr[4].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[4].xcbk222) THEN LET l_arr[4].xcbk222 = 0 END IF                            
#   #制费4
#   EXECUTE s_axcp500_def_cursor_p10 USING '5',g_xcch.xcch006 
#                                     INTO l_arr[5].*                            
#   IF cl_null(l_arr[5].xcbk202) THEN LET l_arr[5].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[5].xcbk212) THEN LET l_arr[5].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[5].xcbk222) THEN LET l_arr[5].xcbk222 = 0 END IF                            
#   #制费5
#   EXECUTE s_axcp500_def_cursor_p10 USING '6',g_xcch.xcch006 
#                                     INTO l_arr[6].*                            
#   IF cl_null(l_arr[6].xcbk202) THEN LET l_arr[6].xcbk202 = 0 END IF                            
#   IF cl_null(l_arr[6].xcbk212) THEN LET l_arr[6].xcbk212 = 0 END IF                            
#   IF cl_null(l_arr[6].xcbk222) THEN LET l_arr[6].xcbk222 = 0 END IF                            
#wujie 160523 --end

   CASE g_xcch.xcch001
        WHEN '1'  #第一记帐本位币
                  LET l_xcci.xcci202b = l_xcci.xcci202b + l_arr[1].xcbk202
                  LET l_xcci.xcci202d = l_xcci.xcci202d + l_arr[2].xcbk202
                  LET l_xcci.xcci202e = l_xcci.xcci202e + l_arr[3].xcbk202
                  LET l_xcci.xcci202f = l_xcci.xcci202f + l_arr[4].xcbk202
                  LET l_xcci.xcci202g = l_xcci.xcci202g + l_arr[5].xcbk202
                  LET l_xcci.xcci202h = l_xcci.xcci202h + l_arr[6].xcbk202
        WHEN '2'  #第二记帐本位币
                  LET l_xcci.xcci202b = l_xcci.xcci202b + l_arr[1].xcbk212
                  LET l_xcci.xcci202d = l_xcci.xcci202d + l_arr[2].xcbk212
                  LET l_xcci.xcci202e = l_xcci.xcci202e + l_arr[3].xcbk212
                  LET l_xcci.xcci202f = l_xcci.xcci202f + l_arr[4].xcbk212
                  LET l_xcci.xcci202g = l_xcci.xcci202g + l_arr[5].xcbk212
                  LET l_xcci.xcci202h = l_xcci.xcci202h + l_arr[6].xcbk212
        WHEN '3'  #第三记帐本位币
                  LET l_xcci.xcci202b = l_xcci.xcci202b + l_arr[1].xcbk222
                  LET l_xcci.xcci202d = l_xcci.xcci202d + l_arr[2].xcbk222
                  LET l_xcci.xcci202e = l_xcci.xcci202e + l_arr[3].xcbk222
                  LET l_xcci.xcci202f = l_xcci.xcci202f + l_arr[4].xcbk222
                  LET l_xcci.xcci202g = l_xcci.xcci202g + l_arr[5].xcbk222
                  LET l_xcci.xcci202h = l_xcci.xcci202h + l_arr[6].xcbk222
   END CASE

   #取委外加工费
   LET l_tot = 0
   #FOREACH s_axcp500_wip_2_3_cs1 USING g_xcch.xcch006 INTO l_inaj.*   #160823-00040#1 mark
   FOREACH s_axcp500_wip_2_3_cs1 USING g_xcch.xcch006 INTO l_inajsite,l_inaj001,l_inaj002   #160823-00040#1 add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_3_cs1'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CONTINUE FOREACH   
      END IF 
      #CALL s_axcp500_get_ap_sum_1(g_xcch.xcch001,l_inaj.inaj001,l_inaj.inaj002,l_inaj.inaj003)   #160823-00040#1 mark     
      #CALL s_axcp500_get_ap_sum_1(g_xccd.xccd001,l_inaj001,l_inaj002,0)   #160823-00040#1 add      #190416-00001#1 mark
      CALL s_axcp500_get_ap_sum_1(g_xcch.xcch001,l_inaj001,l_inaj002,0)   #160823-00040#1 add      #190416-00001#1
           RETURNING l_sum
      LET l_tot = l_tot + l_sum
      
   END FOREACH
   LET l_xcci.xcci202c = l_xcci.xcci202c + l_tot
   
   #add 150721 zhangllc--begin-- 
   #取工艺委外加工费
   LET l_tot = 0
   INITIALIZE l_inaj.inaj001 TO NULL 
   INITIALIZE l_inaj.inaj002 TO NULL 
   INITIALIZE l_inaj.inaj003 TO NULL 
   FOREACH s_axcp500_wip_2_3_cs2 USING g_xcch.xcch006 INTO l_inaj.inaj001,l_inaj.inaj002#,l_inaj.inaj003 
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'FOREACH s_axcp500_wip_2_3_cs2'
         LET g_errparam.popup  = TRUE
         CALL cl_err()   
         CONTINUE FOREACH   
      END IF   
      #CALL s_axcp500_get_ap_sum_1(g_xcch.xcch001,l_inaj.inaj001,l_inaj.inaj002,l_inaj.inaj003)
      CALL s_axcp500_get_ap_sum_1(g_xcch.xcch001,l_inaj.inaj001,l_inaj.inaj002,0)
           RETURNING l_sum
      LET l_tot = l_tot + l_sum
   END FOREACH 
   LET l_xcci.xcci202c = l_xcci.xcci202c + l_tot
   #add 150721 zhangllc---end---
   
   CALL s_axcp500_set_xcci_null_to_zero(l_xcci.*)
        RETURNING l_xcci.*
        
   IF l_xcci.xcci201  = 0 AND l_xcci.xcci202  = 0 AND l_xcci.xcci202a = 0 AND l_xcci.xcci202b = 0 AND l_xcci.xcci202c = 0 AND
      l_xcci.xcci202d = 0 AND l_xcci.xcci202e = 0 AND l_xcci.xcci202f = 0 AND l_xcci.xcci202g = 0 AND l_xcci.xcci202h = 0 THEN
      LET r_success = TRUE
      RETURN r_success
   END IF        
           
   CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
      
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 取当期拆件在制成本调整资料
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_2_4()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-06 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_2_4()
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcci          RECORD LIKE xcci_t.*  #161124-00048#20 mark
   DEFINE l_xcci          type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_sum           type_get_cost_rec

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   CALL s_axcp500_get_xcci(g_xcch.xcch001,' ',g_xcch.xcch006,'ADJUST',' ',' ')
        RETURNING l_xcci.* 

   EXECUTE s_axcp500_def_cursor_p11 USING g_xcch.xcch001,g_xcch.xcch006
                                     INTO l_sum.*
   IF cl_null(l_sum.qty) THEN LET l_sum.qty = 0 END IF
   IF cl_null(l_sum.a)   THEN LET l_sum.a   = 0 END IF
   IF cl_null(l_sum.b)   THEN LET l_sum.b   = 0 END IF
   IF cl_null(l_sum.c)   THEN LET l_sum.c   = 0 END IF
   IF cl_null(l_sum.d)   THEN LET l_sum.d   = 0 END IF
   IF cl_null(l_sum.e)   THEN LET l_sum.e   = 0 END IF
   IF cl_null(l_sum.f)   THEN LET l_sum.f   = 0 END IF
   IF cl_null(l_sum.g)   THEN LET l_sum.g   = 0 END IF
   IF cl_null(l_sum.h)   THEN LET l_sum.h   = 0 END IF
   LET l_sum.tot = l_sum.a + l_sum.b + l_sum.c + l_sum.d +
                   l_sum.e + l_sum.f + l_sum.g + l_sum.h
   
   LET l_xcci.xcci201  = l_xcci.xcci201  + l_sum.qty
   LET l_xcci.xcci202  = l_xcci.xcci202  + l_sum.tot
   LET l_xcci.xcci202a = l_xcci.xcci202a + l_sum.a
   LET l_xcci.xcci202b = l_xcci.xcci202b + l_sum.b
   LET l_xcci.xcci202c = l_xcci.xcci202c + l_sum.c
   LET l_xcci.xcci202d = l_xcci.xcci202d + l_sum.d
   LET l_xcci.xcci202e = l_xcci.xcci202e + l_sum.e
   LET l_xcci.xcci202f = l_xcci.xcci202f + l_sum.f
   LET l_xcci.xcci202g = l_xcci.xcci202g + l_sum.g
   LET l_xcci.xcci202h = l_xcci.xcci202h + l_sum.h                       

   CALL s_axcp500_set_xcci_null_to_zero(l_xcci.*)
        RETURNING l_xcci.*
        
   IF l_xcci.xcci201  = 0 AND l_xcci.xcci202  = 0 AND l_xcci.xcci202a = 0 AND l_xcci.xcci202b = 0 AND l_xcci.xcci202c = 0 AND
      l_xcci.xcci202d = 0 AND l_xcci.xcci202e = 0 AND l_xcci.xcci202f = 0 AND l_xcci.xcci202g = 0 AND l_xcci.xcci202h = 0 THEN
      LET r_success = TRUE
      RETURN r_success
   END IF        
        
   CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
      
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 拆件在制成本计算 - 成品入xcci
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_4(p_close) 
#                       RETURNING r_success
# Input parameter: p_close        工单本期结案否
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-08-13 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_4(p_close)
   DEFINE p_close         LIKE type_t.chr1
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_inaj          RECORD
                          inaj005     LIKE inaj_t.inaj005,
                          inaj006     LIKE inaj_t.inaj006,
                          inaj010     LIKE inaj_t.inaj010,
                          qty         LIKE xccc_t.xccc201,
                          xcci002     LIKE xcci_t.xcci002
                          END RECORD
   DEFINE l_sum           type_get_cost_rec    
#   DEFINE l_xcci          RECORD LIKE xcci_t.*     #161124-00048#20 mark
   DEFINE l_xcci          type_g_xcci  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcci RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企业编号
#       xccicomp LIKE xcci_t.xccicomp, #法人组织
#       xccild LIKE xcci_t.xccild, #账套
#       xcci001 LIKE xcci_t.xcci001, #账套本位币顺序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本计算类型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期别
#       xcci006 LIKE xcci_t.xcci006, #拆件工单编号
#       xcci007 LIKE xcci_t.xcci007, #元件料号
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批号
#       xcci010 LIKE xcci_t.xcci010, #核算币种
#       xcci101 LIKE xcci_t.xcci101, #上期结存数量
#       xcci102 LIKE xcci_t.xcci102, #上期结存金额
#       xcci102a LIKE xcci_t.xcci102a, #上期结存金额-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期结存金额-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期结存金额-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期结存金额-制费一
#       xcci102e LIKE xcci_t.xcci102e, #上期结存金额-制费二
#       xcci102f LIKE xcci_t.xcci102f, #上期结存金额-制费三
#       xcci102g LIKE xcci_t.xcci102g, #上期结存金额-制费四
#       xcci102h LIKE xcci_t.xcci102h, #上期结存金额-制费五
#       xcci201 LIKE xcci_t.xcci201, #本期投入数量
#       xcci202 LIKE xcci_t.xcci202, #本期本阶投入金额
#       xcci202a LIKE xcci_t.xcci202a, #本期本阶投入金额-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本阶投入金额-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本阶投入金额-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本阶投入金额-制费一
#       xcci202e LIKE xcci_t.xcci202e, #本期本阶投入金额-制费二
#       xcci202f LIKE xcci_t.xcci202f, #本期本阶投入金额-制费三
#       xcci202g LIKE xcci_t.xcci202g, #本期本阶投入金额-制费四
#       xcci202h LIKE xcci_t.xcci202h, #本期本阶投入金额-制费五
#       xcci301 LIKE xcci_t.xcci301, #本期转出数量
#       xcci302 LIKE xcci_t.xcci302, #本期转出金额
#       xcci302a LIKE xcci_t.xcci302a, #本期转出金额-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期转出金额-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期转出金额-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期转出金额-制费一
#       xcci302e LIKE xcci_t.xcci302e, #本期转出金额-制费二
#       xcci302f LIKE xcci_t.xcci302f, #本期转出金额-制费三
#       xcci302g LIKE xcci_t.xcci302g, #本期转出金额-制费四
#       xcci302h LIKE xcci_t.xcci302h, #本期转出金额-制费五
#       xcci303 LIKE xcci_t.xcci303, #差异转出数量
#       xcci304 LIKE xcci_t.xcci304, #差异转出金额
#       xcci304a LIKE xcci_t.xcci304a, #差异转出金额-材料
#       xcci304b LIKE xcci_t.xcci304b, #差异转出金额-人工
#       xcci304c LIKE xcci_t.xcci304c, #差异转出金额-加工
#       xcci304d LIKE xcci_t.xcci304d, #差异转出金额-制费一
#       xcci304e LIKE xcci_t.xcci304e, #差异转出金额-制费二
#       xcci304f LIKE xcci_t.xcci304f, #差异转出金额-制费三
#       xcci304g LIKE xcci_t.xcci304g, #差异转出金额-制费四
#       xcci304h LIKE xcci_t.xcci304h, #差异转出金额-制费五
#       xcci901 LIKE xcci_t.xcci901, #期末结存数量
#       xcci902 LIKE xcci_t.xcci902, #期末结存金额
#       xcci902a LIKE xcci_t.xcci902a, #期末结存金额-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末结存金额-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末结存金额-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末结存金额-制费一
#       xcci902e LIKE xcci_t.xcci902e, #期末结存金额-制费二
#       xcci902f LIKE xcci_t.xcci902f, #期末结存金额-制费三
#       xcci902g LIKE xcci_t.xcci902g, #期末结存金额-制费四
#       xcci902h LIKE xcci_t.xcci902h, #期末结存金额-制费五
#       xccitime LIKE xcci_t.xccitime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark
   DEFINE l_avg           type_g_std_cost
   
   #170609-00032#1 add--s
   DEFINE l_sum1          RECORD
                          sum  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD  
                          
                          
   DEFINE l_xcck          RECORD
                          xcck010     LIKE xcck_t.xcck010,
                          xcck011     LIKE xcck_t.xcck011,
                          xcck017     LIKE xcck_t.xcck017,
                          xcck201     LIKE xcck_t.xcck201,
                          xcck002     LIKE xcck_t.xcck002,
                          xcck049     LIKE xcck_t.xcck049,
                          xccksite    LIKE xcck_t.xccksite,
                          xcck006     LIKE xcck_t.xcck006,
                          xcck007     LIKE xcck_t.xcck007,
                          xcck008     LIKE xcck_t.xcck008,
                          xcck009     LIKE xcck_t.xcck009 
                          END RECORD   
   #170609-00032#1 add--e
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE

   #取此拆件工单的入库资料   
   FOREACH s_axcp500_disassemble_wip_4_cs1 USING g_xcch.xcch001,g_xcch.xcch003,g_xcch.xcch006 INTO l_inaj.*
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "FOREACH s_axcp500_disassemble_wip_4_cs1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
                                  '',SQLCA.sqlcode,'','FOREACH s_axcp500_disassemble_wip_4_cs1')         
         CONTINUE FOREACH   
      END IF      
      
      CALL s_axcp500_get_xcci(g_xcch.xcch001,l_inaj.xcci002,g_xcch.xcch006,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010)
           RETURNING l_xcci.* 

      CASE 
           WHEN g_cost_type = '1'   #标准成本
#              CALL s_axcp500_std_get_std_cost(l_xcci.xcci001,l_xcci.xcci002,g_xcag001,l_xcci.xcci007) #171211-00028#13 mark
              CALL s_axcp500_std_get_std_cost1(l_xcci.xcci001,l_xcci.xcci002,g_xcag001,l_xcci.xcci007,l_xcci.xcci008) #171211-00028#13 mod
                   RETURNING l_success,l_avg.*  
#              LET l_sum.qty = 0
#              LET l_sum.tot = l_avg.sum
#              LET l_sum.a   = l_avg.a
#              LET l_sum.b   = l_avg.b
#              LET l_sum.c   = l_avg.c
#              LET l_sum.d   = l_avg.d
#              LET l_sum.e   = l_avg.e
#              LET l_sum.f   = l_avg.f
#              LET l_sum.g   = l_avg.g
#              LET l_sum.h   = l_avg.h           
           WHEN g_cost_type MATCHES '[35]'   #月加权 & 批次
              CALL s_axcp500_avg_get_cost(g_xcch.xcch007,l_xcci.xcci001,l_xcci.xcci002,l_xcci.xcci003,g_yy,
                                          g_pp,l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci009)
                   RETURNING l_success,l_avg.*                    
      END CASE
      IF NOT l_success THEN
#        RETURN r_success
      END IF

      LET l_xcci.xcci301  = l_inaj.qty                      #本期轉出數量             
      LET l_xcci.xcci302a = l_avg.a * l_xcci.xcci301        #本期轉出金額-材料 
      LET l_xcci.xcci302b = l_avg.b * l_xcci.xcci301        #本期轉出金額-人工 
      LET l_xcci.xcci302c = l_avg.c * l_xcci.xcci301        #本期轉出金額-加工 
      LET l_xcci.xcci302d = l_avg.d * l_xcci.xcci301        #本期轉出金額-制費一 
      LET l_xcci.xcci302e = l_avg.e * l_xcci.xcci301        #本期轉出金額-制費二 
      LET l_xcci.xcci302f = l_avg.f * l_xcci.xcci301        #本期轉出金額-制費三 
      LET l_xcci.xcci302g = l_avg.g * l_xcci.xcci301        #本期轉出金額-制費四 
      LET l_xcci.xcci302h = l_avg.h * l_xcci.xcci301        #本期轉出金額-制費五 
      #本期轉出金額  
      LET l_xcci.xcci302 = l_xcci.xcci302a + l_xcci.xcci302b + l_xcci.xcci302c + l_xcci.xcci302d +
                           l_xcci.xcci302e + l_xcci.xcci302f + l_xcci.xcci302g + l_xcci.xcci302h
           
      CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF    
#180418-00031#1---mark---s      
#      #170609-00032#1--add--s
#      FOREACH s_axcp500_disassemble_wip_4_cs2 
#             USING g_xcch.xcch001,g_xcch.xcch003,g_xcch.xcch006,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010,l_inaj.xcci002 INTO l_xcck.*
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code   = SQLCA.sqlcode
#            LET g_errparam.extend = "FOREACH s_axcp500_disassemble_wip_4_cs1"
#            LET g_errparam.popup  = TRUE
#            CALL cl_err()
#            CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
#                                     '',SQLCA.sqlcode,'','FOREACH s_axcp500_disassemble_wip_4_cs1')         
#            CONTINUE FOREACH   
#         END IF      
#         CALL s_axcp500_disassemble_get_store_in_sum(l_xcci.xcci001,l_xcci.xcci002,l_xcck.xcck201,l_xcci.xcci006,
#                                                     l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci009,
#                                                     l_xcck.xcck049,l_xcck.xccksite,
#                                                     l_xcck.xcck010,l_xcck.xcck006,l_xcck.xcck007,l_xcck.xcck008,l_xcck.xcck009)
#              RETURNING l_sum1.*  
#         IF l_sum1.sum <> 0 THEN
#            UPDATE xcck_tmp SET xcck202  = l_sum1.sum*xcck009*-1, xcck202a = l_sum1.a*xcck009*-1, xcck202b = l_sum1.b*xcck009*-1,
#                                xcck202c = l_sum1.c*xcck009*-1,   xcck202d = l_sum1.d*xcck009*-1, xcck202e = l_sum1.e*xcck009*-1,
#                                xcck202f = l_sum1.f*xcck009*-1,   xcck202g = l_sum1.g*xcck009*-1, xcck202h = l_sum1.h*xcck009*-1
#             WHERE xcckent = g_enterprise
#               AND xcckld  = g_ld
#               AND xcck001 = l_xcci.xcci001
#               AND xcck002 = l_xcci.xcci002
#               AND xcck003 = g_xcat001
#               AND xcck004 = g_yy
#               AND xcck005 = g_pp
#               AND xcck006 = l_xcck.xcck006
#               AND xcck007 = l_xcck.xcck007
#               AND xcck008 = l_xcck.xcck008
#               AND xcck009 = l_xcck.xcck009         
#            IF SQLCA.sqlcode THEN
#               INITIALIZE g_errparam TO NULL
#               LET g_errparam.code   = SQLCA.sqlcode
#               LET g_errparam.extend = "UPDATE xcci302/xcck202 sum"
#               LET g_errparam.popup  = TRUE
#               CALL cl_err()
#               CALL s_axcp500_ins_error('','','','','','','','','','','',
#                                        '',SQLCA.sqlcode,'','UPDATE xcci302/xcck202 sum')         
#            END IF
#         END IF   
#      END FOREACH    
#180418-00031#1---mark---e      
      #171017-00040#1 add (s)
      EXECUTE s_axcp500_def_cursor_p37 USING g_xcch.xcch001,g_xcch.xcch003,g_xcch.xcch006,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'EXECUTE s_axcp500_def_cursor_p37'
         LET g_errparam.popup  = TRUE
         CALL cl_err()  
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','','','','',
                                  '',SQLCA.sqlcode,'','EXECUTE s_axcp500_def_cursor_p37')         
      END IF      
      #171017-00040#1 add (e)

      #因為拆件入庫的料是<計算成本階，所以更新完xcck_t後還要更新xccc_t
      EXECUTE s_axcp500_def_cursor_p35 USING g_xcch.xcch001,g_xcch.xcch003,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'EXECUTE s_axcp500_def_cursor_p35'
         LET g_errparam.popup  = TRUE
         CALL cl_err()  
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','','','','',
                                  '',SQLCA.sqlcode,'','EXECUTE s_axcp500_def_cursor_p35')         
      END IF
      
      EXECUTE s_axcp500_def_cursor_p36 USING g_xcch.xcch001,g_xcch.xcch003,l_inaj.inaj005,l_inaj.inaj006,l_inaj.inaj010
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = 'EXECUTE s_axcp500_def_cursor_p36'
         LET g_errparam.popup  = TRUE
         CALL cl_err()  
         CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','','','','',
                                  '',SQLCA.sqlcode,'','EXECUTE s_axcp500_def_cursor_p35')         
      END IF
      #170609-00032#1--add--e
      
   END FOREACH

   #若工单结案,则把所有还未结转完的全部转至差异,本期结存保持0
   IF p_close = 'Y' THEN
      FOREACH s_axcp500_disassemble_wip_2_1_cs1 USING g_xcch.xcch001,g_xcch.xcch003,
                                                      g_xcch.xcch004,g_xcch.xcch005,g_xcch.xcch006
                                                 INTO l_xcci.*
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = SQLCA.sqlcode
            LET g_errparam.extend = 'FOREACH s_axcp500_disassemble_wip_2_1_cs1'
            LET g_errparam.popup  = TRUE
            CALL cl_err()   
            CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
                                     '',SQLCA.sqlcode,'','FOREACH s_axcp500_disassemble_wip_2_1_cs1')         
            CONTINUE FOREACH   
         END IF    
         IF l_xcci.xcci901  <> 0 OR l_xcci.xcci902  <> 0 OR l_xcci.xcci902a <> 0 OR l_xcci.xcci902b <> 0 OR 
            l_xcci.xcci902c <> 0 OR l_xcci.xcci902d <> 0 OR l_xcci.xcci902e <> 0 OR l_xcci.xcci902f <> 0  OR
            l_xcci.xcci902g <> 0 OR l_xcci.xcci902h <> 0 THEN
            
            LET l_xcci.xcci303  = l_xcci.xcci901  * -1
            LET l_xcci.xcci304  = l_xcci.xcci902  * -1
            LET l_xcci.xcci304a = l_xcci.xcci902a * -1
            LET l_xcci.xcci304b = l_xcci.xcci902b * -1
            LET l_xcci.xcci304c = l_xcci.xcci902c * -1
            LET l_xcci.xcci304d = l_xcci.xcci902d * -1
            LET l_xcci.xcci304e = l_xcci.xcci902e * -1
            LET l_xcci.xcci304f = l_xcci.xcci902f * -1
            LET l_xcci.xcci304g = l_xcci.xcci902g * -1
            LET l_xcci.xcci304h = l_xcci.xcci902h * -1
            
            LET l_xcci.xcci901  = 0
            LET l_xcci.xcci902  = 0
            LET l_xcci.xcci902a = 0
            LET l_xcci.xcci902b = 0
            LET l_xcci.xcci902c = 0
            LET l_xcci.xcci902d = 0
            LET l_xcci.xcci902e = 0
            LET l_xcci.xcci902f = 0
            LET l_xcci.xcci902g = 0
            LET l_xcci.xcci902h = 0
            
            CALL s_axcp500_ins_or_upd_xcci(l_xcci.*)
                 RETURNING l_success
            IF NOT l_success THEN
               RETURN r_success
            END IF 
      
         END IF
      END FOREACH
   END IF


   LET r_success = TRUE
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: xcci的材料/人工/加工/制费更新xcch的投入                      
# Memo...........:                                                              
# Usage..........: CALL s_axcp500_disassemble_wip_5()                        
#                       RETURNING r_success                                       
# Input parameter: NULL                           
# Return code....: r_success      成功否标识符                            
# Date & Author..: 2014-08-13 By Carrier                                        
# Modify.........:                                                              
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_5()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   LET r_success = FALSE
   
   WHENEVER ERROR CONTINUE
   SELECT SUM(xcci102),                                               #期初
          SUM(xcci102a),SUM(xcci102b),SUM(xcci102c),SUM(xcci102d),
          SUM(xcci102e),SUM(xcci102f),SUM(xcci102g),SUM(xcci102h),
          
          SUM(xcci202),                                               #本期投入
          SUM(xcci202a),SUM(xcci202b),SUM(xcci202c),SUM(xcci202d),
          SUM(xcci202e),SUM(xcci202f),SUM(xcci202g),SUM(xcci202h),  
          
          SUM(xcci302),                                               #本期转出
          SUM(xcci302a),SUM(xcci302b),SUM(xcci302c),SUM(xcci302d),
          SUM(xcci302e),SUM(xcci302f),SUM(xcci302g),SUM(xcci302h),   
                 
          SUM(xcci304),                                               #差异转出
          SUM(xcci304a),SUM(xcci304b),SUM(xcci304c),SUM(xcci304d),
          SUM(xcci304e),SUM(xcci304f),SUM(xcci304g),SUM(xcci304h),   
          
          SUM(xcci902),                                               #期末结余
          SUM(xcci902a),SUM(xcci902b),SUM(xcci902c),SUM(xcci902d),
          SUM(xcci902e),SUM(xcci902f),SUM(xcci902g),SUM(xcci902h)
          
     INTO g_xcch.xcch102, 
          g_xcch.xcch102a,g_xcch.xcch102b,g_xcch.xcch102c,g_xcch.xcch102d,
          g_xcch.xcch102e,g_xcch.xcch102f,g_xcch.xcch102g,g_xcch.xcch102h,
          
          g_xcch.xcch202, 
          g_xcch.xcch202a,g_xcch.xcch202b,g_xcch.xcch202c,g_xcch.xcch202d,
          g_xcch.xcch202e,g_xcch.xcch202f,g_xcch.xcch202g,g_xcch.xcch202h, 
          
          g_xcch.xcch302, 
          g_xcch.xcch302a,g_xcch.xcch302b,g_xcch.xcch302c,g_xcch.xcch302d,
          g_xcch.xcch302e,g_xcch.xcch302f,g_xcch.xcch302g,g_xcch.xcch302h, 
          
          g_xcch.xcch304,                                                                                   
          g_xcch.xcch304a,g_xcch.xcch304b,g_xcch.xcch304c,g_xcch.xcch304d,                                  
          g_xcch.xcch304e,g_xcch.xcch304f,g_xcch.xcch304g,g_xcch.xcch304h, 
          
          g_xcch.xcch902,                                                                                   
          g_xcch.xcch902a,g_xcch.xcch902b,g_xcch.xcch902c,g_xcch.xcch902d,                                  
          g_xcch.xcch902e,g_xcch.xcch902f,g_xcch.xcch902g,g_xcch.xcch902h                                                                          
     FROM xcci_t
    WHERE xccient = g_enterprise
      AND xccild  = g_ld
      AND xcci001 = g_xcch.xcch001
      AND xcci003 = g_xcch.xcch003
      AND xcci004 = g_xcch.xcch004
      AND xcci005 = g_xcch.xcch005
      AND xcci006 = g_xcch.xcch006  
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 's_axcp500_disassemble_wip_5'
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error('','','','',g_xcch.xcch006,'','','',g_xcch.xcch007,'','',
                               '',SQLCA.sqlcode,'','s_axcp500_disassemble_wip_5')         
      RETURN r_success
   END IF

   CALL s_axcp500_ins_or_upd_xcch(g_xcch.*)
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
      
   LET r_success = TRUE
   RETURN r_success 

END FUNCTION

################################################################################
# Descriptions...: 在制成本计算-若主件无异动,元件无异动时,删除在制资料
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_wip_del(p_seq,p_sfaadocno,p_imaa001,p_xccc002,p_xccc007,p_xccc008)
#                       RETURNING r_success
# Input parameter: p_seq          记帐本位币顺序
#                : p_sfaadocno    工单单号
#                : p_imaa001      主件编号
#                : p_xccc002      成本域
#                : p_xccc007      产品特征
#                : p_xccc008      批号
# Return code....: r_success      成功否标识符
# Date & Author..: 2014-09-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_wip_del(p_seq,p_sfaadocno,p_imaa001,p_xccc002,p_xccc007,p_xccc008)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_sfaadocno     LIKE sfaa_t.sfaadocno
   DEFINE p_imaa001       LIKE imaa_t.imaa001
   DEFINE p_xccc002       LIKE xccc_t.xccc002
   DEFINE p_xccc007       LIKE xccc_t.xccc007
   DEFINE p_xccc008       LIKE xccc_t.xccc008
   DEFINE r_success       LIKE type_t.num5
#   DEFINE l_xcch          RECORD LIKE xcch_t.*  #161124-00048#20 mark
   DEFINE l_xcch          type_g_xcch  #170605-00013#1-add
#170605-00013#1-s-mark 改用type方式
#   #161124-00048#20 add(s)
#DEFINE l_xcch RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企业编号
#       xcchcomp LIKE xcch_t.xcchcomp, #法人组织
#       xcchld LIKE xcch_t.xcchld, #账套
#       xcch001 LIKE xcch_t.xcch001, #账套本位币顺序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本计算类型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期别
#       xcch006 LIKE xcch_t.xcch006, #拆件工单编号
#       xcch007 LIKE xcch_t.xcch007, #主件料号
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批号
#       xcch010 LIKE xcch_t.xcch010, #项目号
#       xcch011 LIKE xcch_t.xcch011, #核算币种
#       xcch101 LIKE xcch_t.xcch101, #上期结存数量
#       xcch102 LIKE xcch_t.xcch102, #上期结存金额
#       xcch102a LIKE xcch_t.xcch102a, #上期结存金额-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期结存金额-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期结存金额-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期结存金额-制费一
#       xcch102e LIKE xcch_t.xcch102e, #上期结存金额-制费二
#       xcch102f LIKE xcch_t.xcch102f, #上期结存金额-制费三
#       xcch102g LIKE xcch_t.xcch102g, #上期结存金额-制费四
#       xcch102h LIKE xcch_t.xcch102h, #上期结存金额-制费五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工时
#       xcch201 LIKE xcch_t.xcch201, #本期投入数量
#       xcch202 LIKE xcch_t.xcch202, #本期本阶投入金额
#       xcch202a LIKE xcch_t.xcch202a, #本期本阶投入金额-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本阶投入金额-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本阶投入金额-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本阶投入金额-制费一
#       xcch202e LIKE xcch_t.xcch202e, #本期本阶投入金额-制费二
#       xcch202f LIKE xcch_t.xcch202f, #本期本阶投入金额-制费三
#       xcch202g LIKE xcch_t.xcch202g, #本期本阶投入金额-制费四
#       xcch202h LIKE xcch_t.xcch202h, #本期本阶投入金额-制费五
#       xcch204 LIKE xcch_t.xcch204, #本期下阶投入金额
#       xcch204a LIKE xcch_t.xcch204a, #本期下阶投入金额-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下阶投入金额-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下阶投入金额-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下阶投入金额-制费一
#       xcch204e LIKE xcch_t.xcch204e, #本期下阶投入金额-制费二
#       xcch204f LIKE xcch_t.xcch204f, #本期下阶投入金额-制费三
#       xcch204g LIKE xcch_t.xcch204g, #本期下阶投入金额-制费四
#       xcch204h LIKE xcch_t.xcch204h, #本期下阶投入金额-制费五
#       xcch301 LIKE xcch_t.xcch301, #本期转出数量
#       xcch302 LIKE xcch_t.xcch302, #本期转出金额
#       xcch302a LIKE xcch_t.xcch302a, #本期转出金额-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期转出金额-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期转出金额-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期转出金额-制费一
#       xcch302e LIKE xcch_t.xcch302e, #本期转出金额-制费二
#       xcch302f LIKE xcch_t.xcch302f, #本期转出金额-制费三
#       xcch302g LIKE xcch_t.xcch302g, #本期转出金额-制费四
#       xcch302h LIKE xcch_t.xcch302h, #本期转出金额-制费五
#       xcch303 LIKE xcch_t.xcch303, #差异转出数量
#       xcch304 LIKE xcch_t.xcch304, #差异转出金额
#       xcch304a LIKE xcch_t.xcch304a, #差异转出金额-材料
#       xcch304b LIKE xcch_t.xcch304b, #差异转出金额-人工
#       xcch304c LIKE xcch_t.xcch304c, #差异转出金额-加工
#       xcch304d LIKE xcch_t.xcch304d, #差异转出金额-制费一
#       xcch304e LIKE xcch_t.xcch304e, #差异转出金额-制费二
#       xcch304f LIKE xcch_t.xcch304f, #差异转出金额-制费三
#       xcch304g LIKE xcch_t.xcch304g, #差异转出金额-制费四
#       xcch304h LIKE xcch_t.xcch304h, #差异转出金额-制费五
#       xcch901 LIKE xcch_t.xcch901, #期末结存数量
#       xcch902 LIKE xcch_t.xcch902, #期末结存金额
#       xcch902a LIKE xcch_t.xcch902a, #期末结存金额-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末结存金额-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末结存金额-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末结存金额-制费一
#       xcch902e LIKE xcch_t.xcch902e, #期末结存金额-制费二
#       xcch902f LIKE xcch_t.xcch902f, #期末结存金额-制费三
#       xcch902g LIKE xcch_t.xcch902g, #期末结存金额-制费四
#       xcch902h LIKE xcch_t.xcch902h, #期末结存金额-制费五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本计算时间
#END RECORD
##161124-00048#20 add(e)
#170605-00013#1-e-mark

   WHENEVER ERROR CONTINUE
   
   #170406-00074#1--mark--s
   #LET r_success = FALSE
   #
   #CALL s_axcp500_get_xcch(p_seq,p_xccc002,p_sfaadocno,p_imaa001,p_xccc007,p_xccc008)
   #     RETURNING l_xcch.*
   #     
   #IF l_xcch.xcch101 = 0 AND l_xcch.xcch102 = 0 AND l_xcch.xcch200 = 0 AND l_xcch.xcch201 = 0 AND l_xcch.xcch202 = 0 AND
   #   l_xcch.xcch204 = 0 AND l_xcch.xcch301 = 0 AND l_xcch.xcch302 = 0 AND l_xcch.xcch303 = 0 AND l_xcch.xcch304 = 0 AND
   #   l_xcch.xcch901 = 0 AND l_xcch.xcch902 = 0 THEN
   #   DELETE FROM xcci_t 
   #    WHERE xccient = g_enterprise     
   #      AND xccild  = g_ld
   #      AND xcci001 = l_xcch.xcch001
   #      AND xcci003 = l_xcch.xcch003
   #      AND xcci004 = l_xcch.xcch004
   #      AND xcci005 = l_xcch.xcch005
   #      AND xcci006 = l_xcch.xcch006
   #   IF SQLCA.sqlcode THEN
   #      INITIALIZE g_errparam TO NULL
   #      LET g_errparam.code   = SQLCA.sqlcode
   #      LET g_errparam.extend = 'DELETE FROM xcci_t'
   #      LET g_errparam.popup  = TRUE
   #      CALL cl_err()      
   #      CALL s_axcp500_ins_error('','','','',l_xcch.xcch006,'','','',l_xcch.xcch007,'','',
   #                               '',SQLCA.sqlcode,'','DELETE FROM xcci_t')         
   #   END IF    
   #
   #   DELETE FROM xcch_t 
   #    WHERE xcchent = g_enterprise
   #      AND xcchld  = g_ld
   #      AND xcch001 = l_xcch.xcch001
   #      AND xcch003 = l_xcch.xcch003
   #      AND xcch004 = l_xcch.xcch004
   #      AND xcch005 = l_xcch.xcch005
   #      AND xcch006 = l_xcch.xcch006
   #   IF SQLCA.sqlcode THEN
   #      INITIALIZE g_errparam TO NULL
   #      LET g_errparam.code   = SQLCA.sqlcode
   #      LET g_errparam.extend = 'DELETE FROM xcch_t'
   #      LET g_errparam.popup  = TRUE
   #      CALL cl_err()      
   #      CALL s_axcp500_ins_error('','','','',l_xcch.xcch006,'','','',l_xcch.xcch007,'','',
   #                               '',SQLCA.sqlcode,'','DELETE FROM xcch_t')         
   #   END IF  
   #
   #   DELETE FROM xcdi_t 
   #    WHERE xcdient = g_enterprise     
   #      AND xcdild  = g_ld
   #      AND xcdi001 = l_xcch.xcch001
   #      AND xcdi003 = l_xcch.xcch003
   #      AND xcdi004 = l_xcch.xcch004
   #      AND xcdi005 = l_xcch.xcch005
   #      AND xcdi006 = l_xcch.xcch006
   #   IF SQLCA.sqlcode THEN
   #      INITIALIZE g_errparam TO NULL
   #      LET g_errparam.code   = SQLCA.sqlcode
   #      LET g_errparam.extend = 'DELETE FROM xcdi_t'
   #      LET g_errparam.popup  = TRUE
   #      CALL cl_err()      
   #      CALL s_axcp500_ins_error('','','','',l_xcch.xcch006,'','','',l_xcch.xcch007,'','',
   #                               '',SQLCA.sqlcode,'','DELETE FROM xcdi_t')         
   #   END IF    
   #   
   #END IF
   #170406-00074#1--mark--e
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取料件的成本单位
# Memo...........:
# Usage..........: CALL s_axcp500_get_cost_unit(p_comp,p_imag001)
#                       RETURNING r_cost_unit
# Input parameter: p_comp         法人
#                : p_imag001      料件编号
# Return code....: r_cost_unit    成本单位
# Date & Author..: 2014-12-19 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_cost_unit(p_comp,p_imag001)
   DEFINE p_comp          LIKE imag_t.imagsite
   DEFINE p_imag001       LIKE imag_t.imag001
   DEFINE r_cost_unit     LIKE imag_t.imag014
   
   WHENEVER ERROR CONTINUE
#  SELECT imag014 INTO r_cost_unit FROM imag_t
#   WHERE imagent  = g_enterprise
#     AND imagsite = p_comp
#     AND imag001  = p_imag001
#  
#  IF cl_null(r_cost_unit) THEN
      SELECT imaa006 INTO r_cost_unit FROM imaa_t 
       WHERE imaaent = g_enterprise
         AND imaa001 = p_imag001   
#  END IF
   
   RETURN r_cost_unit
END FUNCTION

################################################################################
# Descriptions...: 取采购入库金额-材料
# Memo...........:
# Usage..........: CALL s_axcp500_get_ap_sum_1(p_seq,p_inaj001,p_inaj002,p_inaj003)
#                        RETURNING r_xccc202a
# Input parameter: p_seq          本位币顺序
#                : p_inaj001      单据编号
#                : p_inaj002      单据项次
#                : p_inaj003      单据项序 
# Return code....: r_xccc202a     采购金额
# Date & Author..: 2014-10-28 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_ap_sum_1(p_seq,p_inaj001,p_inaj002,p_inaj003)
   DEFINE p_seq           LIKE xcck_t.xcck001
   DEFINE p_inaj001       LIKE inaj_t.inaj001
   DEFINE p_inaj002       LIKE inaj_t.inaj002
   DEFINE p_inaj003       LIKE inaj_t.inaj003
   DEFINE r_xccc202a      LIKE xccc_t.xccc202a
   DEFINE l_qty           LIKE apcb_t.apcb007
   DEFINE l_apcb118       LIKE apcb_t.apcb118
   DEFINE l_apcb128       LIKE apcb_t.apcb128
   DEFINE l_apcb138       LIKE apcb_t.apcb138
   DEFINE l_apcb115       LIKE apcb_t.apcb115  #add zhangllc 150810
   DEFINE l_apcb125       LIKE apcb_t.apcb125  #add zhangllc 150810
   DEFINE l_apcb135       LIKE apcb_t.apcb135  #add zhangllc 150810
   DEFINE l_sum1          LIKE apcb_t.apcb118
   DEFINE l_sum2          LIKE apcb_t.apcb118
   DEFINE l_sum3          LIKE apcb_t.apcb118
   DEFINE l_pmdsdocdt     LIKE pmds_t.pmdsdocdt
   DEFINE l_pmds037       LIKE pmds_t.pmds037
   DEFINE l_pmds038       LIKE pmds_t.pmds038
   DEFINE l_pmdt019       LIKE pmdt_t.pmdt019
   DEFINE l_pmdt020       LIKE pmdt_t.pmdt020
   DEFINE l_pmdt038       LIKE pmdt_t.pmdt038
   DEFINE l_pmdt039       LIKE pmdt_t.pmdt039
   DEFINE l_cost          LIKE pmdt_t.pmdt038
   DEFINE l_flag          LIKE type_t.chr1     #160906-00036#1
   DEFINE l_pmds000       LIKE pmds_t.pmds000  #170608-00028#1 add
   
   LET r_xccc202a = 0
   
   #IF p_inaj003>1  THEN RETURN END IF   #160823-00040#1  #161202-00047#1 mark
   
   LET l_sum1 = 0
   LET l_sum2 = 0
   IF p_inaj003>1  THEN RETURN l_sum1 END IF   #161202-00047#1 add
   #AP立帐的数量及金额
   #SELECT SUM(apcb007),SUM(apcb118),SUM(apcb128),SUM(apcb138),    #160823-00040#1 mark
   #SELECT SUM(apcb007),SUM(apcb113),SUM(apcb123),SUM(apcb133),      #160823-00040#1 add #161226-00079#1 mark
   #       SUM(apcb115),SUM(apcb125),SUM(apcb135)    #add zhangllc 150810,apcb118这个代表未税的本币成本认列金额，但是含税的本币成本认列金额还没有，所以暂时用115 #161226-00079#1 mark
   SELECT SUM(apcb007*apcb022),SUM(apcb113*apcb022),SUM(apcb123*apcb022),SUM(apcb133*apcb022), #161226-00079#1 add
          SUM(apcb115*apcb022),SUM(apcb125*apcb022),SUM(apcb135*apcb022) #161226-00079#1 add
     INTO l_qty,l_apcb118,l_apcb128,l_apcb138,
          l_apcb115,l_apcb125,l_apcb135   #add zhangllc 150810
     FROM apca_t,apcb_t
    WHERE apcaent   = apcbent AND apcaent = g_enterprise
      AND apcald    = apcbld  AND apcald  = g_ld
      AND apcadocno = apcbdocno
      AND apcastus  = 'Y'
      AND apcb023   = 'N'   #排除冲暂估的 # mod 1 add zhangllc 160527
      AND apcb002   = p_inaj001
      AND apcb003   = p_inaj002
      AND apcadocdt BETWEEN g_bdate AND g_edate
   #160906-00036#1-s
   LET l_flag = 'N'
   #IF STATUS = 100 THEN         #161219-00037#1 mark
   #161230-00010#7---s
   #因sql中有使用SUM函数，抓不到资料时，sqlcode也会是0，不会是100
   #IF SQLCA.sqlcode = 100 THEN   #161219-00037#1     
   IF (cl_null(l_qty) OR l_qty = 0)         AND 
      (cl_null(l_apcb118) OR l_apcb118 = 0) AND
      (cl_null(l_apcb128) OR l_apcb128 = 0) AND
      (cl_null(l_apcb138) OR l_apcb138 = 0) AND
      (cl_null(l_apcb115) OR l_apcb115 = 0) AND
      (cl_null(l_apcb125) OR l_apcb125 = 0) AND
      (cl_null(l_apcb135) OR l_apcb135 = 0) THEN
   #161230-00010#7---e
      LET l_flag = 'Y'
   END IF
   #160906-00036#1-e
   IF cl_null(l_qty)  THEN LET l_qty  = 0 END IF 
   IF cl_null(l_apcb118) THEN LET l_apcb118 = 0 END IF
   IF cl_null(l_apcb128) THEN LET l_apcb128 = 0 END IF
   IF cl_null(l_apcb138) THEN LET l_apcb138 = 0 END IF
   IF cl_null(l_apcb115) THEN LET l_apcb115 = 0 END IF  #add zhangllc 150810
   IF cl_null(l_apcb125) THEN LET l_apcb125 = 0 END IF  #add zhangllc 150810
   IF cl_null(l_apcb135) THEN LET l_apcb135 = 0 END IF  #add zhangllc 150810
   IF cl_null(l_sum1) THEN LET l_sum1 = 0 END IF
   
   CASE p_seq
        WHEN '1' #LET l_sum1 = l_apcb118  #mark zhangllc 150810
                 #add zhangllc 150810
                 IF g_cost_taxed = 'Y' THEN
                    LET l_sum1 = l_apcb115
                 ELSE
                    LET l_sum1 = l_apcb118
                 END IF
                 #add zhangllc 150810 end
        WHEN '2' #LET l_sum1 = l_apcb128  #mark zhangllc 150810
                 #add zhangllc 150810
                 IF g_cost_taxed = 'Y' THEN
                    LET l_sum1 = l_apcb125
                 ELSE
                    LET l_sum1 = l_apcb128
                 END IF
                 #add zhangllc 150810 end
        WHEN '3' #LET l_sum1 = l_apcb138  #mark zhangllc 150810
                 #add zhangllc 150810
                 IF g_cost_taxed = 'Y' THEN
                    LET l_sum1 = l_apcb135
                 ELSE
                    LET l_sum1 = l_apcb138
                 END IF
                 #add zhangllc 150810 end
   END CASE

   #160906-00036#1-s
  #IF l_sum1 = 0 THEN
   IF l_flag = 'Y' THEN
   #160906-00036#1-e
      #入库单的数量及金额
      #      單據日期  幣別     匯率    收貨/入庫單位 数量 未稅金額 含稅金額
      SELECT pmdsdocdt,pmds037,pmds038,pmdt019,pmdt020,pmdt038,pmdt039,pmds000   #170608-00028#1 add pmds000
        INTO l_pmdsdocdt,l_pmds037,l_pmds038,l_pmdt019,l_pmdt020,l_pmdt038,l_pmdt039,l_pmds000  #170608-00028#1 add pmds000
        FROM pmds_t,pmdt_t
       WHERE pmdsent   = pmdtent   AND pmdsent = g_enterprise
         AND pmdsdocno = pmdtdocno AND pmdsdocno = p_inaj001
         AND pmdtseq   = p_inaj002
      IF g_cost_taxed = 'Y' THEN
         LET l_cost = l_pmdt039 #含稅金額
      ELSE
         LET l_cost = l_pmdt038 #未稅金額
      END IF
      #IF l_pmds037 <> g_curr[1].curr THEN
      IF l_pmds037 <> g_curr[1].curr AND l_cost !=0 THEN #mod zhangllc 151202 s_aooi160_get_exrate此元件金额传进去若是0，回传的就不是金额而是汇率了
         CALL s_aooi160_get_exrate('2',g_ld,l_pmdsdocdt,l_pmds037,g_curr[1].curr,l_cost,g_curr[1].type2)
              RETURNING l_sum1
      ELSE
         LET l_sum1 = l_cost
      END IF
      #170608-00028#1--modify--s
      #委外仓退单的金额，应该要乘以负数
      IF l_pmds000 = '14' THEN
         LET l_sum1 = l_sum1 * (-1)
      END IF
      #170608-00028#1--modify--e
   END IF
   
   
   LET r_xccc202a = l_sum1
   RETURN r_xccc202a
END FUNCTION

################################################################################
# Descriptions...: 取料件进出补成本档--异动金额
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccw202_1(p_seq,p_xccw002,p_xccw006,p_xccw007,p_xccw008,p_xccw009)
#                       RETURNING r_sum
# Input parameter: p_seq          记帐本位币顺序
#                : p_xccw002      成本域
#                : p_xccw006      参考单号
#                : p_xccw007      项次
#                : p_xccw008      项序
#                : p_xccw009      出入库码
# Return code....: r_sum          成本金额
# Date & Author..: 2014-10-28 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccw202_1(p_seq,p_xccw002,p_xccw006,p_xccw007,p_xccw008,p_xccw009)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_xccw002       LIKE xccc_t.xccc002
   DEFINE p_xccw006       LIKE inaj_t.inaj001
   DEFINE p_xccw007       LIKE inaj_t.inaj002
   DEFINE p_xccw008       LIKE inaj_t.inaj003
   DEFINE p_xccw009       LIKE inaj_t.inaj004
   DEFINE r_sum           RECORD
                          tot  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD  
                          
   SELECT SUM(xccw202),SUM(xccw202a),SUM(xccw202b),SUM(xccw202c),SUM(xccw202d),
                       SUM(xccw202e),SUM(xccw202f),SUM(xccw202g),SUM(xccw202h)
     INTO r_sum.tot,r_sum.a,r_sum.b,r_sum.c,r_sum.d,
                    r_sum.e,r_sum.f,r_sum.g,r_sum.h
     FROM xccw_t
    WHERE xccwent = g_enterprise
      AND xccwld  = g_ld
      AND xccw001 = p_seq
      AND xccw002 = p_xccw002
      AND xccw003 = g_xcat001
      AND xccw004 = g_yy
      AND xccw005 = g_pp
      AND xccw006 = p_xccw006
      AND xccw007 = p_xccw007
      AND xccw008 = p_xccw008
      AND xccw009 = p_xccw009

   IF cl_null(r_sum.a) THEN LET r_sum.a = 0 END IF
   IF cl_null(r_sum.b) THEN LET r_sum.b = 0 END IF
   IF cl_null(r_sum.c) THEN LET r_sum.c = 0 END IF
   IF cl_null(r_sum.d) THEN LET r_sum.d = 0 END IF
   IF cl_null(r_sum.e) THEN LET r_sum.e = 0 END IF
   IF cl_null(r_sum.f) THEN LET r_sum.f = 0 END IF
   IF cl_null(r_sum.g) THEN LET r_sum.g = 0 END IF
   IF cl_null(r_sum.h) THEN LET r_sum.h = 0 END IF
#   IF cl_null(r_sum.a) THEN LET r_sum.a = 1 END IF
#   IF cl_null(r_sum.b) THEN LET r_sum.b = 2 END IF
#   IF cl_null(r_sum.c) THEN LET r_sum.c = 3 END IF
#   IF cl_null(r_sum.d) THEN LET r_sum.d = 4 END IF
#   IF cl_null(r_sum.e) THEN LET r_sum.e = 5 END IF
#   IF cl_null(r_sum.f) THEN LET r_sum.f = 6 END IF
#   IF cl_null(r_sum.g) THEN LET r_sum.g = 7 END IF
#   IF cl_null(r_sum.h) THEN LET r_sum.h = 8 END IF
   LET r_sum.tot = r_sum.a + r_sum.b + r_sum.c + r_sum.d + 
                   r_sum.e + r_sum.f + r_sum.g + r_sum.h
   RETURN r_sum.*           
END FUNCTION

################################################################################
# Descriptions...: 成本计算 - 优化版
# Memo...........:
# Usage..........: CALL s_axcp500_cal1(p_ld,p_xcat001,p_yy,p_pp,p_wc)
#                       RETURNING r_success
# Input parameter: p_ld           帐套
#                : p_xcat001      成本类型编号
#                : p_yy           年度
#                : p_pp           期别
#                : p_wc           成本计算范围的WHERE子句
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-02-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_cal1(p_ld,p_xcat001,p_yy,p_pp,p_wc)
   DEFINE p_ld            LIKE glaa_t.glaald
   DEFINE p_xcat001       LIKE xcat_t.xcat001
   DEFINE p_yy            LIKE type_t.num5
   DEFINE p_pp            LIKE type_t.num5
   DEFINE p_wc            STRING
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_cnt           LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcat005       LIKE xcat_t.xcat005
   DEFINE l_done          LIKE type_t.chr1
   DEFINE l_xcbf004       LIKE xcbf_t.xcbf004
   DEFINE l_cnt1          LIKE type_t.num10
   DEFINE l_cnt2          LIKE type_t.num10
   DEFINE l_choice        LIKE type_t.num5 #add zhangllc 150821
   
   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #170816-00007#104 by 09773 mod(S)
#   IF cl_null(p_ld) OR cl_null(p_yy) OR cl_null(p_xcat001) OR cl_null(p_pp) THEN
#      #传入参数为空或传入值不正确!
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code   = "sub-00280"
#      LET g_errparam.popup  = TRUE
#      CALL cl_err()
#      RETURN r_success
#   END IF
   #170816-00007#104 by 09773 mod(E)
   
   #170816-00007#104 by 09773 add(S)
   #修改錯誤訊息報錯內容
   LET g_msg = ''
   LET g_colname_1 = ''
   LET g_comment_1 = ''
   IF cl_null(p_ld) THEN
      CALL s_azzi902_get_gzzd("aapp131","lbl_apcald") RETURNING g_colname_1,g_comment_1  #帐套 
      LET g_msg = g_colname_1   
   END IF
   IF cl_null(p_yy) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("axcp500","lbl_xcat001") RETURNING g_colname_1,g_comment_1   #成本类型编号
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF cl_null(p_xcat001) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("aapp940","lbl_xref001") RETURNING g_colname_1,g_comment_1   #年度
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF cl_null(p_pp) THEN
      LET g_colname_1 = ''
      LET g_comment_1 = ''    
      CALL s_azzi902_get_gzzd("aapp134","lbl_apca064") RETURNING g_colname_1,g_comment_1   #期别
      IF g_msg IS NULL THEN   
         LET g_msg = g_colname_1   
      ELSE   
         LET g_msg = g_msg,",",g_colname_1
      END IF        
   END IF
   IF NOT cl_null(g_msg) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-00788'  #%1傳入值為空(錯誤)
      LET g_errparam.extend = ''
      LET g_errparam.popup = TRUE
      LET g_errparam.replace[1] = g_msg
      CALL cl_err()
      
      RETURN r_success
   END IF   
   #170816-00007#104 by 09773 add(E)
   
   #171007-00001#1--mark--s
   ##成本计算前检查-是否已经成本计算且已经抛转凭证
   #CALL s_axcp500_chk_cal(p_ld,p_xcat001,p_yy,p_pp)
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF
   #171007-00001#1--mark--e
   
   LET g_tot_begin = TIME
   
   #GLOBAL变量赋值
   LET g_xcat001 = p_xcat001
   LET g_ld = p_ld
   LET g_yy = p_yy
   LET g_pp = p_pp
   LET g_wc = p_wc
   IF cl_null(g_wc) THEN LET g_wc = ' 1=1' END IF
   SELECT glaacomp INTO g_comp FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_ld

   #取参数
   LET g_sys_6001 = cl_get_para(g_enterprise,g_comp,'S-FIN-6001')   #系统参数[S-FIN-6001]:採用成本域否
   LET g_sys_6002 = cl_get_para(g_enterprise,g_comp,'S-FIN-6002')   #系统参数[S-FIN-6002]:成本域類型
   IF g_sys_6001 = 'N' THEN
      LET g_sys_6002 = ''
   END IF
   LET g_sys_6003 = cl_get_para(g_enterprise,g_comp,'S-FIN-6003')   #系统参数[S-FIN-6003]:按製程算成本       #161121-00018#5 add
   LET g_sys_6004 = cl_get_para(g_enterprise,g_comp,'S-FIN-6004')   #系统参数[S-FIN-6004]:雜項發料的取價方式
   LET g_sys_6005 = cl_get_para(g_enterprise,g_comp,'S-FIN-6005')   #系统参数[S-FIN-6005]:銷退成本來源
   LET g_sys_6006 = cl_get_para(g_enterprise,g_comp,'S-FIN-6006')   #系统参数[S-FIN-6006]:銷退是否影響成本
   LET g_sys_6008 = cl_get_para(g_enterprise,g_comp,'S-FIN-6008')   #系统参数[S-FIN-6008]:工單結案在製差異轉入主件當期入庫
   LET g_sys_6009 = cl_get_para(g_enterprise,g_comp,'S-FIN-6009')   #系统参数[S-FIN-6009]:聯產品分配方式
   LET g_sys_6017 = cl_get_para(g_enterprise,g_comp,'S-FIN-6017')   #系统参数[S-FIN-6017]:聯產品入庫折算在制轉出數量是否按分配率計算  #add zhangllc 150717
   LET g_sys_6013 = cl_get_para(g_enterprise,g_comp,'S-FIN-6013')   #系统参数[S-FIN-6013]:按料件特性计算成本否
   LET g_sys_6014 = cl_get_para(g_enterprise,g_comp,'S-FIN-6014')   #系统参数[S-FIN-6014]:在製人工製費分攤方式
   LET g_sys_6015 = cl_get_para(g_enterprise,g_comp,'S-FIN-6015')   #系统参数[S-FIN-6015]:啟用成本次要素
   LET g_sys_6016 = cl_get_para(g_enterprise,g_comp,'S-FIN-6016')   #系统参数[S-FIN-6016]:當站下線是否影響成本
   LET g_sys_6018 = cl_get_para(g_enterprise,g_comp,'S-FIN-6018')   #系统参数[S-FIN-6018]:調撥是否納入計算  #add zhangllc 150825
   LET g_sys_6019 = cl_get_para(g_enterprise,g_comp,'S-FIN-6019')   #系统参数[S-FIN-6019]:是否样品单独列示  #add zhangllc 151029

   #LET g_ent_0001 = cl_get_para(g_enterprise,'','E-CIR-0001')  #集团参数[E-CIR-0001]:品類管理層級  #add zhangllc 150809  mark zhangllc 151204
   
   LET g_sys_6021 = cl_get_para(g_enterprise,g_comp,'S-FIN-6021')  #系统参数[S-FINC6001]:xccq   #add zhangllc 160526 SBS1_客制
   LET g_sys_6022 = cl_get_para(g_enterprise,g_comp,'S-FIN-6022')  #系统参数[S-FINC6002]:本月无入库的在制差异转入主件当期入库   #add zhangllc 160527 SBS2_客制
   
   #170120-00013#1---s
   LET g_sys_6007 = cl_get_para(g_enterprise,g_comp,'S-FIN-6007')  #系统参数[S-FINC6001]:當站報廢轉出方式
   LET g_sys_6023 = cl_get_para(g_enterprise,g_comp,'S-FIN-6023')  #系统参数[S-FINC6001]:超領轉出方式
   LET g_sys_6024 = cl_get_para(g_enterprise,g_comp,'S-FIN-6024')  #系统参数[S-FINC6002]:下階料報廢轉出方式
   #170120-00013#1---e
   
   LET g_sys_6025 = cl_get_para(g_enterprise,g_comp,'S-FIN-6025')  #系统参数[S-FINC6025]:當站下線的取價方式  #170629-00004#1 add
   
   LET g_sys_6026 = cl_get_para(g_enterprise,g_comp,'S-FIN-6026')  #系统参数[S-FINC6026]:回收料轉出方式  #170411-00032#1 add
   
   #add zhangllc 151120 begin 移动加权成本时会计算到成本次要素，但变量值未赋值
   #启用成本次要素
   LET g_sub_element = g_sys_6015
   IF cl_null(g_sub_element) OR g_sub_element NOT MATCHES '[YN]' THEN
      #成本参数[S-FIN-6015](启用成本次要素否)为空或是参数值非法,无法进行成本计算!
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = "axc-00533"
      LET g_errparam.extend = ""
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   #add zhangllc 151120 end
   
   #取成本计算方式
   SELECT xcat005,xcat002 INTO l_xcat005,g_xcat002 FROM xcat_t  #mod zhangllc 151126 add xcat002
    WHERE xcatent = g_enterprise
      AND xcat001 = p_xcat001
   LET g_field_type = g_sys_6002
   CASE l_xcat005
        WHEN '7'
             LET g_cost_type = '7'
        WHEN '6'
             LET g_cost_type = '6'
             #成本域类型
             LET g_field_type = g_sys_6002
        OTHERWISE 
             LET g_cost_type = l_xcat005
   END CASE
   
   #目前仅支援“月加权”，其他不支持
   IF g_cost_type NOT MATCHES '[123456]' THEN
      #传入参数为空或传入值不正确!
      INITIALIZE g_errparam TO NULL
     #LET g_errparam.code   = "" #161229-00020#1 mark
     #LET g_errparam.extend = "目前仅支持月加权,标准,移动加权,先进先出,批次的成本计算方式，其他方式暂时不支持" #161229-00020#1 mark
      LET g_errparam.code   = 'axc-00822' #161229-00020#1 add
      LET g_errparam.extend = ''          #161229-00020#1 add
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success   
   END IF
   
   MESSAGE "get date"  
   #取日期相关资讯
   CALL s_axcp500_get_date()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   #取得帐套对应的本位币信息
   CALL s_axcp500_get_curr() 
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF 
   
   #成本域时,检查同一类型是否相同的成本计算类型,若同一类型,则目前可以支持
   #若不同类型,则目前不支持
   #若成本域类型为3.库存管理特征时,先用月加权方式
   IF g_cost_type = '6' THEN
      CASE g_field_type
           WHEN '1'      #组织型
             SELECT UNIQUE xcbf004 INTO l_xcbf004 
               FROM xcbf_t,inaj_t,inaa_t,ooef_t
              WHERE xcbfent  = inajent AND inajent = inaaent AND xcbfent  = g_enterprise
                AND inajsite = inaasite
                AND inaj008  = inaa001
                AND inaa010  = 'Y'
                AND ooef001  = inajsite
                AND ooefent  = inajent
                AND xcbfcomp = ooef017 AND xcbfcomp = g_comp
                AND (inaj004 = 1 OR inaj004 = -1)
                AND inaj022 BETWEEN g_bdate AND g_edate
                AND xcbf002  = inajsite         
                
           WHEN '2'      #仓库型
             SELECT UNIQUE xcbf004 INTO l_xcbf004 
               FROM xcbf_t,inaj_t,inaa_t,ooef_t      #170620-00100#1 add ooef_t
              WHERE xcbfent  = inajent AND inajent = inaaent AND xcbfent  = g_enterprise
                AND inajsite = inaasite
                AND inaj008  = inaa001
                AND inaa010  = 'Y'
                AND ooef001  = inajsite
                AND ooefent  = inajent
                AND xcbfcomp = ooef017 AND xcbfcomp = g_comp
                AND (inaj004 = 1 OR inaj004 = -1)
                AND inaj022 BETWEEN g_bdate AND g_edate
                AND xcbf002  = inaj008
                
           WHEN '3'      #库存管理特征
              LET l_xcbf004 = '1'
              
      END CASE 
      
      IF cl_null(l_xcbf004) THEN
         #传入参数为空或传入值不正确!
         INITIALIZE g_errparam TO NULL 
        #LET g_errparam.code   = "" #161229-00020#1 mark
        #LET g_errparam.extend = "成本域条件下,目前不支持不同的成本计算方式" #161229-00020#1 mark
         LET g_errparam.code   = 'axc-00823' #161229-00020#1 add
         LET g_errparam.extend = '' #161229-00020#1 add
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success  
      ELSE
         LET g_cost_type = l_xcbf004
      END IF      
   END IF
   
   #9.成本含税否
   LET g_cost_taxed = 'N'
   SELECT xcaz010 INTO g_cost_taxed FROM xcaz_t
    WHERE xcazent = g_enterprise
      AND xcazld  = g_ld
      AND xcaz001 = g_xcat001
   IF cl_null(g_cost_taxed) OR g_cost_taxed NOT MATCHES '[YN]' THEN
      LET g_cost_taxed = 'N'   
   END IF
      
   LET g_sfaa028 = NULL    #wujie 160522

   MESSAGE "cre_tmp_table"  
#   #建立xcck_tmp/sfaa_tmp/inaj_tmp/xccc_tmp/xccd_tmp/xcce_tmp/xccg_tmp/xccz_tmp 等临时表   
   CALL s_axcp500_cre_tmp_table()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   #成本阶数
   IF g_cost_type = '5' OR g_cost_type = '3' THEN
      LET g_sql = " SELECT COUNT(UNIQUE xcbb006) FROM xcbb_t,imaa_t",
                  "  WHERE xcbbent = imaaent ",
                  "    AND xcbbcomp = '",g_comp,"'",
                  "    AND xcbb001 = ",g_yy,
                  "    AND xcbb002 = ",g_pp,
                  "    AND xcbb003 = imaa001 ",
                  "    AND ",g_wc
      PREPARE s_axcp500_cal1_p1 FROM g_sql
      EXECUTE s_axcp500_cal1_p1 INTO l_cnt1
       
      IF cl_null(l_cnt1) THEN LET l_cnt1 = 0 END IF
      IF l_cnt1 = 0 THEN
         #缺少成本阶资料
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = "axc-00764"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         RETURN r_success
      END IF
   END IF
   

   #计算进度条的笔数
   LET g_progress_cnt = l_cnt1 * 5
   IF l_cnt1 >=1 THEN
      LET g_progress_cnt = (l_cnt1 -1)*3
   END IF
   
   SELECT COUNT(*) INTO l_cnt1 FROM sfaa_tmp
   IF cl_null(l_cnt1) THEN LET l_cnt1 = 0 END IF
   LET g_progress_cnt = g_progress_cnt + l_cnt1 + 6
   
   #若是标准成本时,只有11个步骤
   IF g_cost_type = '1' THEN
      LET g_progress_cnt = 11
   END IF
   #預先計算progressbar迴圈次數
   IF g_bgjob <> "Y" THEN
      CALL cl_progress_bar_no_window(g_progress_cnt)
   END IF
   
   IF g_bgjob <> "Y" THEN      
      #建立临时表
      LET g_progress_msg = cl_getmsg('axc-00656',g_dlang)
      CALL cl_progress_no_window_ing(g_progress_msg)
   END IF  
   
   MESSAGE "ins_temp_table"   
   #处理资料插入临时表
   CALL s_axcp500_ins_temp_table()   
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   #不在料件范围中的工单不需要计算
   #20200612-02295---mark---s
   #DELETE FROM sfaa_tmp WHERE sfaa010 NOT IN (SELECT imaa001 FROM s_axcp500_tmp)
   ##add zhangllc 150730 --end 删除sfaa_tmp也同时将sfac_tmp,sfba_tmp删掉
   #DELETE FROM sfac_tmp WHERE sfacdocno NOT IN (select sfaadocno FROM sfaa_tmp)
   #DELETE FROM sfac_tmp2 WHERE sfacdocno NOT IN (select sfaadocno FROM sfaa_tmp)
   #DELETE FROM sfba_tmp WHERE sfbadocno NOT IN (select sfaadocno FROM sfaa_tmp)
   ##add zhangllc 150730 --end
   #20200612-02295---mark---e
   #20200612-02295---add---s
   DELETE FROM sfaa_tmp WHERE NOT EXISTS(SELECT 1 FROM s_axcp500_tmp WHERE sfaa010=imaa001)
   DELETE FROM sfac_tmp WHERE NOT EXISTS(SELECT 1 FROM sfaa_tmp WHERE sfacdocno=sfaadocno)
   DELETE FROM sfac_tmp2 WHERE NOT EXISTS(SELECT 1 FROM sfaa_tmp WHERE sfacdocno=sfaadocno)
   DELETE FROM sfba_tmp WHERE NOT EXISTS(SELECT 1 FROM sfaa_tmp WHERE sfbadocno=sfaadocno)
   #20200612-02295---add---e 
   #DELETE FROM inaj_tmp WHERE inaj020 NOT IN (SELECT sfaadocno FROM sfaa_tmp ) AND (inaj040 IS NULL OR inaj040 = '')

   #工单生产单位若与料件的成本单位不一样时,要把生产数量转换为成本数量
   CALL s_axcp500_convert_sfaa012()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   IF g_bgjob <> "Y" THEN      
      #删除本期成本资料,以便重新计算
      LET g_progress_msg = cl_getmsg('axc-00631',g_dlang)
      CALL cl_progress_no_window_ing(g_progress_msg)
   END IF   
   
   #成本计算前,把对应的资料删除
   CALL s_axcp500_del_data()   
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF
   
   
   #重复性生产,产生工单号(重复性的KEY是"计划号+生产料号+产品特征",但是成本是以工单为KEY的"
   CALL s_axcp500_gen_repeat_docno()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF   
   
   #161230-00010#15---s
   # CALL s_axcp500_def_cursor() 移到  CALL s_axcp500_get_previous_balance() "之前"就要做，因為這裡面定義的sql在 CALL s_axcp500_get_previous_balance()有用到
   #各成本计算类型共用的CURSOR定义放在s_axcp500中
   CALL s_axcp500_def_cursor()
        RETURNING l_success
   IF NOT l_success THEN
      RETURN r_success
   END IF   
   #161230-00010#15---e
   
   
   #结转上期资料
   IF g_bgjob <> "Y" THEN      
      #结转上期的结余成本至本期的期初成本中
      LET g_progress_msg = cl_getmsg('axc-00633',g_dlang)
      CALL cl_progress_no_window_ing(g_progress_msg)
   END IF    
   IF g_cost_type NOT MATCHES '[135]' THEN   #标准成本 & 批次成本 & 月加权成本
      CALL s_axcp500_get_previous_balance()
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF
   ELSE
      CALL s_axcp500_avg_get_previous_balance('1')
           RETURNING l_success
      IF NOT l_success THEN
         RETURN r_success
      END IF   
   END IF
   
   #161230-00010#15---s
   ##各成本计算类型共用的CURSOR定义放在s_axcp500中
   #CALL s_axcp500_def_cursor()
   #     RETURNING l_success
   #IF NOT l_success THEN
   #   RETURN r_success
   #END IF   
   #161230-00010#15---e
   
   #错误收集
   CALL cl_err_collect_init()   

   CASE g_cost_type
        WHEN '1' CALL s_axcp500_std1()
                      RETURNING l_success
        WHEN '2' CALL s_axcp500_fifo()
                      RETURNING l_success
        WHEN '3' CALL s_axcp500_lot1()
                      RETURNING l_success
        WHEN '4' CALL s_axcp500_moving()
                      RETURNING l_success
        WHEN '5' CALL s_axcp500_avg1()
                      RETURNING l_success
        OTHERWISE
   END CASE

   #错误整体显示
   CALL cl_err_collect_show()
   
   #add zhangllc 150821 为了批量报错信息汇总，此执行放在主作业里面，以防整批报错汇总冲突
   IF g_cost_type = '3' OR g_cost_type='4' THEN
      #询问:是否按本期成本资料更新“料件实时数量成本档”
      LET l_choice = cl_ask_promp('axc-00708')
      IF l_choice = TRUE THEN
         CALL cl_err_collect_init()  #汇总错误讯息初始化
         LET g_coll_title[1] = cl_getmsg('axc-00617',g_dlang) #料号
         LET g_coll_title[2] = cl_getmsg('axc-00554',g_dlang) #批号
         LET g_coll_title[3] = 'axcp500',cl_getmsg('axc-00726',g_dlang) #axcp500的数量
         LET g_coll_title[4] = 'xcbz101',cl_getmsg('axc-00726',g_dlang) #xcbz的数量
         LET g_coll_title[5] = cl_getmsg('axc-00323',g_dlang) #差异数量
         
         CALL s_axcp500_lot1_batch_upd_xccu()
              RETURNING l_success
              
         CALL cl_err_collect_show() #显示错误讯息汇总
      END IF
   END IF
   #add zhangllc 150821 end
   
   LET r_success = TRUE
   RETURN r_success
        

END FUNCTION

################################################################################
# Descriptions...: 取料件进出补成本档--异动金额
# Memo...........:
# Usage..........: CALL s_axcp500_get_xccw202_2(p_seq,p_xccw002,p_xccw010,p_xccw011,p_xccw017)
#                       RETURNING r_sum
# Input parameter: p_seq          记帐本位币顺序
#                : p_xccw002      成本域
#                : p_xccw010      料件
#                : p_xccw011      特征
#                : p_xccw017      批号
# Return code....: r_sum          成本金额
# Date & Author..: 2015-02-11 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_xccw202_2(p_seq,p_xccw002,p_xccw010,p_xccw011,p_xccw017)
   DEFINE p_seq           LIKE xccc_t.xccc001
   DEFINE p_xccw002       LIKE xccc_t.xccc002
   DEFINE p_xccw010       LIKE xccw_t.xccw010
   DEFINE p_xccw011       LIKE xccw_t.xccw011
   DEFINE p_xccw017       LIKE xccw_t.xccw017
   DEFINE r_sum           type_g_std_cost 
                          
   WHENEVER ERROR CONTINUE
   SELECT SUM(xccw202),SUM(xccw202a),SUM(xccw202b),SUM(xccw202c),SUM(xccw202d),
                       SUM(xccw202e),SUM(xccw202f),SUM(xccw202g),SUM(xccw202h)
     INTO r_sum.sum,r_sum.a,r_sum.b,r_sum.c,r_sum.d,
                    r_sum.e,r_sum.f,r_sum.g,r_sum.h
     FROM xccw_t
    WHERE xccwent = g_enterprise
      AND xccwld  = g_ld
      AND xccw001 = p_seq
      AND xccw002 = p_xccw002
      AND xccw003 = g_xcat001
      AND xccw004 = g_yy
      AND xccw005 = g_pp
      AND xccw010 = p_xccw010
      AND xccw011 = p_xccw011
      AND xccw017 = p_xccw017

   IF cl_null(r_sum.a) THEN LET r_sum.a = 0 END IF
   IF cl_null(r_sum.b) THEN LET r_sum.b = 0 END IF
   IF cl_null(r_sum.c) THEN LET r_sum.c = 0 END IF
   IF cl_null(r_sum.d) THEN LET r_sum.d = 0 END IF
   IF cl_null(r_sum.e) THEN LET r_sum.e = 0 END IF
   IF cl_null(r_sum.f) THEN LET r_sum.f = 0 END IF
   IF cl_null(r_sum.g) THEN LET r_sum.g = 0 END IF
   IF cl_null(r_sum.h) THEN LET r_sum.h = 0 END IF
   LET r_sum.sum = r_sum.a + r_sum.b + r_sum.c + r_sum.d + 
                   r_sum.e + r_sum.f + r_sum.g + r_sum.h
   RETURN r_sum.*           
END FUNCTION

################################################################################
# Descriptions...: 由于工单的生产单位与成本单位不相同，故工单单身的QPA会有问题，此FUNCTION用于转换工单的生产数量
# Memo...........:
# Usage..........: CALL s_axcp500_convert_sfaa012()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-04-23 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_convert_sfaa012()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_sfaa010       LIKE sfaa_t.sfaa010
   DEFINE l_sfaa013       LIKE sfaa_t.sfaa013
#  DEFINE l_imag014       LIKE imag_t.imag014
   DEFINE l_imaa006       LIKE imaa_t.imaa006
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_rate          LIKE type_t.num26_10
   DEFINE l_sfba006       LIKE sfba_t.sfba006
   DEFINE l_sfba014       LIKE sfba_t.sfba014

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #若工单的生产单位和成本单位不一致的,先把生产单位换算成"成本单位",为了后续工单备料QPA的问题
   #                    工单单号  生产料号 生产数量 工单生产单位 成本单位
#  LET g_sql = " SELECT UNIQUE sfaa010,sfaa013,nvl(imag014,imaa006) imag014",
#              "   FROM sfaa_tmp,s_axcp500_tmp ",
#              "  WHERE ( (sfaa013 <> imag014 AND imag014 IS NOT NULL)  ",           #库存单位与工单的生产单位不一致
#              "         OR (sfaa013 <> imaa006 AND imag014 IS NULL ) ) ",
#              "    AND sfaa010 = imaa001 "

   LET g_sql = " SELECT UNIQUE sfaa010,sfaa013,imaa006",
               "   FROM sfaa_tmp,s_axcp500_tmp ",
               "  WHERE sfaa013 <> imaa006   ",           #库存单位与工单的生产单位不一致
               "    AND sfaa010 = imaa001 "

   PREPARE s_axcp500_avg1_convert_sfaa012_p1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_avg1_convert_sfaa012_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_avg1_convert_sfaa012_cs1 CURSOR FOR s_axcp500_avg1_convert_sfaa012_p1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_avg1_convert_sfaa012_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF               

#  FOREACH s_axcp500_avg1_convert_sfaa012_cs1 INTO l_sfaa010,l_sfaa013,l_imag014
   FOREACH s_axcp500_avg1_convert_sfaa012_cs1 INTO l_sfaa010,l_sfaa013,l_imaa006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "FOREACH s_axcp500_avg1_convert_sfaa012_cs1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH
      END IF     
      
#     CALL s_aooi250_convert_qty1(l_sfaa010,l_sfaa013,l_imag014,1)
      CALL s_aooi250_convert_qty1(l_sfaa010,l_sfaa013,l_imaa006,1)
           RETURNING l_success,l_rate
      IF cl_null(l_rate) OR l_rate = 0 THEN
         LET l_rate = 1
      END IF
              
#     UPDATE sfaa_tmp SET sfaa012 = sfaa012 * l_rate,sfaa013 = l_imag014
      UPDATE sfaa_tmp SET sfaa012 = sfaa012 * l_rate,sfaa013 = l_imaa006
       WHERE sfaa010 = l_sfaa010
         AND sfaa013 = l_sfaa013
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE sfaa_tmp SET sfaa012 = sfaa012 * l_rate"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH      
      END IF
      
   END FOREACH      

   #若工单的生产单位和成本单位不一致的,先把生产单位换算成"成本单位",为了后续工单备料QPA的问题
   #                    工单单号  生产料号 生产数量 工单生产单位 成本单位
#  LET g_sql = " SELECT UNIQUE sfba006,sfba014,nvl(imag014,imaa006) imag014",
#              "   FROM sfba_tmp,s_axcp500_tmp ",
#              "  WHERE ( (sfba014 <> imag014 AND imag014 IS NOT NULL)  ",           #库存单位与工单的生产单位不一致
#              "         OR (sfba014 <> imaa006 AND imag014 IS NULL ) ) ",
#              "    AND sfba006 = imaa001 "

   LET g_sql = " SELECT UNIQUE sfba006,sfba014,imaa006 ",
               "   FROM sfba_tmp,s_axcp500_tmp ",
               "  WHERE sfba014 <> imaa006  ",           #库存单位与工单的生产单位不一致
               "    AND sfba006 = imaa001 "
               

   PREPARE s_axcp500_avg1_convert_sfba010_p2 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_avg1_convert_sfba010_p2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF   
   
   DECLARE s_axcp500_avg1_convert_sfba010_cs2 CURSOR FOR s_axcp500_avg1_convert_sfba010_p2
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_avg1_convert_sfba010_cs2"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF               

#  FOREACH s_axcp500_avg1_convert_sfba010_cs2 INTO l_sfba006,l_sfba014,l_imag014
   FOREACH s_axcp500_avg1_convert_sfba010_cs2 INTO l_sfba006,l_sfba014,l_imaa006
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "FOREACH s_axcp500_avg1_convert_sfba010_cs2"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH
      END IF     
      
#     CALL s_aooi250_convert_qty1(l_sfba006,l_sfba014,l_imag014,1)
      CALL s_aooi250_convert_qty1(l_sfba006,l_sfba014,l_imaa006,1)
           RETURNING l_success,l_rate
      IF cl_null(l_rate) OR l_rate = 0 THEN
         LET l_rate = 1
      END IF
              
      UPDATE sfba_tmp SET sfba010 = sfba010 * l_rate,
                          sfba013 = sfba013 * l_rate,
                          sfba015 = sfba015 * l_rate,
                          sfba016 = sfba016 * l_rate,
                          sfba017 = sfba017 * l_rate,
                          sfba018 = sfba018 * l_rate,
                          sfba023 = sfba023 * l_rate,
                          sfba024 = sfba024 * l_rate,
                          sfba025 = sfba025 * l_rate,
#                         sfba014 = l_imag014
                          sfba014 = l_imaa006
       WHERE sfba006 = l_sfba006
         AND sfba014 = l_sfba014
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE sfba_tmp SET sfba010 = sfba010 * l_rate"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH      
      END IF
      
   END FOREACH      
   
   LET r_success = TRUE
   
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 产生重复性生产的工单号
# Memo...........:
# Usage..........: CALL s_axcp500_gen_repeat_docno()
#                       RETURNING r_success
# Input parameter: NULL
# Return code....: r_success      成功否标识符
# Date & Author..: 2015-04-24 By Carrier
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_gen_repeat_docno()
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_inajsite      LIKE inaj_t.inajsite
   DEFINE l_inaj040       LIKE inaj_t.inaj040
   DEFINE l_inaj041       LIKE inaj_t.inaj041
   DEFINE l_inaj043       LIKE inaj_t.inaj043
   DEFINE l_xcck047       LIKE xcck_t.xcck047
   DEFINE l_max_no        LIKE type_t.num20

   WHENEVER ERROR CONTINUE
   LET r_success = FALSE
   
   #重复性生产,产生工单号(重复性的KEY是"计划号+生产料号+产品特征",但是成本是以工单为KEY的)
   #对于同一计划号/生产料号/产品特征的工单号要唯一,以便跨月时能正常结转上期期末余额

   LET g_sql = " SELECT UNIQUE inajsite,inaj040,inaj041,inaj043 FROM inaj_tmp",
               "  WHERE inaj040 IS NOT NULL "
   PREPARE s_axcp500_gen_repeat_docno_p1 FROM g_sql
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "PREPARE s_axcp500_gen_repeat_docno_p1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF

   DECLARE s_axcp500_gen_repeat_docno_cs1 CURSOR FOR s_axcp500_gen_repeat_docno_p1
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "DECLARE s_axcp500_gen_repeat_docno_cs1"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      RETURN r_success
   END IF 
   
   FOREACH s_axcp500_gen_repeat_docno_cs1 INTO l_inajsite,l_inaj040,l_inaj041,l_inaj043
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "FOREACH s_axcp500_gen_repeat_docno_cs1"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH
      END IF
      
      #检查此计划号+料件+特征是否已经存在
      #SELECT DISTINCT xcck047 INTO l_xcck047 FROM xcck_t
      # WHERE xcckent  = g_enterprise
      #   AND xccksite = l_inajsite
      #   AND xcck048  = l_inaj040            #计划号
      #   AND xcck049  = l_inaj041            #生产料号
      #   AND xcck051  = l_inaj043            #产品特征
      SELECT DISTINCT xcck047 INTO l_xcck047 FROM xcck_t
       WHERE xcckent  = g_enterprise
         AND xccksite = l_inajsite
         AND xcck048  = l_inaj040            #计划号
         AND xcck049  = l_inaj041            #生产料号
         AND xcck051  = l_inaj043            #产品特征
         AND ROWNUM  = 1     #200708-00088#1 add

      #200708-00088#1 add-s-
      #200708-00088#1 add-e-
      IF SQLCA.sqlcode THEN
         #此SITE+计划号+料号+特征是第一次出现，为了后续的计算方便，产生一个工单号码xccd006
         IF SQLCA.sqlcode = 100 THEN
            #第一次进来时,取xcck047的最大值+1,后面就直接用l_max_no+1即可
            IF cl_null(l_max_no) OR l_max_no = 0 THEN
               SELECT MAX(xcck047) INTO l_max_no FROM xcck_t
                WHERE xcckent = g_enterprise
                  AND xcck048 IS NOT NULL
               IF cl_null(l_max_no) THEN
                  LET l_xcck047 = '00000000000000000001'
               ELSE
                  LET l_max_no = l_max_no + 1
                  LET l_xcck047 = l_max_no USING '&&&&&&&&&&&&&&&&&&&&'
               END IF
            ELSE
               LET l_max_no = l_max_no + 1
               LET l_xcck047 = l_max_no USING '&&&&&&&&&&&&&&&&&&&&'            
            END IF
         ELSE
         #若计划号+料号+特征号出现多笔，则报错
         #重复性生产成本计算：计划号+料件+特征对应的工单号xcck047不唯一，导致上下期余额不能正常结转
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code   = 'axc-00689'
            LET g_errparam.extend = "XCCK047 UNIQUE "
            LET g_errparam.popup  = TRUE
            CALL cl_err()
            CONTINUE FOREACH
         END IF
      END IF
      
      #取得/产生工单号后，将inaj_tmp中的inaj020更新成l_xcck047
      UPDATE inaj_tmp SET inaj020 = l_xcck047
       WHERE inajsite = l_inajsite
         AND inaj040  = l_inaj040
         AND inaj041  = l_inaj041
         AND inaj043  = l_inaj043
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE inaj_tmp SET inaj020 = l_xcck047"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CONTINUE FOREACH
      END IF 
         
   END FOREACH
   
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取内部结算金额-材料
# Memo...........:
# Usage..........: CALL s_axcp500_get_stdf_amt(p_seq,p_stdf006,p_stdf007,p_stdf037,p_stdf038)
#                        RETURNING r_xccc202a
# Input parameter: p_seq          本位币顺序
#                : p_stdf006      单据编号
#                : p_stdf007      单据项次
#                : p_stdf037      单据项序 
#                : p_stdf038      出入庫碼
# Return code....: r_xccc202a     采购金额
# Date & Author..: 2015-12-03 By zhangllc 151203
# Modify.........:
################################################################################
PUBLIC FUNCTION s_axcp500_get_stdf_amt(p_seq,p_stdf006,p_stdf007,p_stdf037,p_stdf038)
   DEFINE p_seq           LIKE xcck_t.xcck001
   DEFINE p_stdf006       LIKE stdf_t.stdf006  #单据编号
   DEFINE p_stdf007       LIKE stdf_t.stdf007  #单据项次
   DEFINE p_stdf037       LIKE stdf_t.stdf037  #单据项序
   DEFINE p_stdf038       LIKE stdf_t.stdf038  #出入庫碼 
   DEFINE r_xccc202a      LIKE xccc_t.xccc202a
   DEFINE l_stdf005       LIKE stdf_t.stdf005  #单据日期
   DEFINE l_stdf014       LIKE stdf_t.stdf014  #币别
   DEFINE l_stdf018       LIKE stdf_t.stdf018  #未稅金額
   DEFINE l_stdf019       LIKE stdf_t.stdf019  #含稅金額
   DEFINE l_cost          LIKE stdf_t.stdf018
   
   WHENEVER ERROR CONTINUE
   LET r_xccc202a = 0
   
   #入库单的数量及金额
   #      單據日期 幣別    未稅金額 含稅金額
   SELECT stdf005,stdf014,stdf018,stdf019
     INTO l_stdf005,l_stdf014,l_stdf018,l_stdf019
     FROM stdf_t
    WHERE stdfent = g_enterprise
      AND stdf006 = p_stdf006
      AND stdf007 = p_stdf007
      AND stdf037 = p_stdf037
      AND stdf038 = p_stdf038
   IF g_cost_taxed = 'Y' THEN
      LET l_cost = l_stdf019 #含稅金額
   ELSE
      LET l_cost = l_stdf018 #未稅金額
   END IF
   IF l_stdf014 <> g_curr[1].curr AND l_cost !=0 THEN
      #s_aooi160_get_exrate此元件金额传进去若是0，回传的就不是金额而是汇率了
      CALL s_aooi160_get_exrate('2',g_ld,l_stdf005,l_stdf014,g_curr[1].curr,l_cost,g_curr[1].type2)
           RETURNING r_xccc202a
   ELSE
      LET r_xccc202a = l_cost
   END IF
   
   RETURN r_xccc202a
END FUNCTION

################################################################################
# Descriptions...: 在制成本异动资料插入xcct_t
# Memo...........:
# Usage..........: CALL s_axcp500_ins_or_upd_xcct()
#                       RETURNING r_success
# Input parameter: p_xcct         xcct_t资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2017-01-24 By lixiang
# Modify.........: #161230-00010#7 add
################################################################################
PUBLIC FUNCTION s_axcp500_ins_or_upd_xcct()
DEFINE r_success       LIKE type_t.num5
DEFINE l_xcct014       STRING
DEFINE l_seq        LIKE xccc_t.xccc001
   
   WHENEVER ERROR CONTINUE

   LET l_seq = g_xcct.xcct001
   CALL s_axcp500_get_round_setting(g_xcct.xcct007) 
   
   LET r_success = FALSE
   
   CALL s_axcp500_set_xcct_null_to_zero()
   
   CALL s_num_round(g_round_type,g_xcct.xcct202a,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202a
   CALL s_num_round(g_round_type,g_xcct.xcct202b,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202b
   CALL s_num_round(g_round_type,g_xcct.xcct202c,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202c
   CALL s_num_round(g_round_type,g_xcct.xcct202d,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202d
   CALL s_num_round(g_round_type,g_xcct.xcct202e,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202e
   CALL s_num_round(g_round_type,g_xcct.xcct202f,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202f
   CALL s_num_round(g_round_type,g_xcct.xcct202g,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202g
   CALL s_num_round(g_round_type,g_xcct.xcct202h,g_curr[l_seq].digit2)   RETURNING g_xcct.xcct202h

   LET g_xcct.xcct202  = g_xcct.xcct202a + g_xcct.xcct202b + g_xcct.xcct202c +
                         g_xcct.xcct202d + g_xcct.xcct202e + g_xcct.xcct202f +
                         g_xcct.xcct202g + g_xcct.xcct202h
   CALL s_num_round(g_round_type,g_xcct.xcct202 ,g_curr[l_seq].digit2) RETURNING g_xcct.xcct202

   
   LET l_xcct014 = g_xcct.xcct014
   LET l_xcct014 = l_xcct014.subString(1,6)
   #退料数量显示为负数
   IF l_xcct014 = 'asft32' AND g_xcct.xcct201 > 0 THEN
      LET g_xcct.xcct201 = g_xcct.xcct201 *(-1)
      LET g_xcct.xcct202 = g_xcct.xcct202 *(-1)
      LET g_xcct.xcct202a= g_xcct.xcct202a*(-1)
      LET g_xcct.xcct202b= g_xcct.xcct202b*(-1)
      LET g_xcct.xcct202c= g_xcct.xcct202c*(-1)
      LET g_xcct.xcct202d= g_xcct.xcct202d*(-1)
      LET g_xcct.xcct202e= g_xcct.xcct202e*(-1)
      LET g_xcct.xcct202f= g_xcct.xcct202f*(-1)
      LET g_xcct.xcct202g= g_xcct.xcct202g*(-1)
      LET g_xcct.xcct202h= g_xcct.xcct202h*(-1)
   END IF
   INSERT INTO xcct_t (xcctent,xcctcomp,xcctld,xcct001,xcct002,xcct003,xcct004,xcct005,
                       xcct006,xcct007,xcct008,xcct009,xcct010,xcct011,xcct012,xcct013,
                       xcct014,xcct015,xcct016,xcct017,
                       xcct101,xcct102,xcct102a,xcct102b,xcct102c,xcct102d,xcct102e,xcct102f,xcct102g,xcct102h,
                       xcct201,xcct202,xcct202a,xcct202b,xcct202c,xcct202d,xcct202e,xcct202f,xcct202g,xcct202h,
                       xcct901,xcct902,xcct902a,xcct902b,xcct902c,xcct902d,xcct902e,xcct902f,xcct902g,xcct902h,
                       xcctcrtdt)
        VALUES (g_xcct.xcctent,g_xcct.xcctcomp,g_xcct.xcctld,g_xcct.xcct001,g_xcct.xcct002,g_xcct.xcct003,g_xcct.xcct004,g_xcct.xcct005,
                g_xcct.xcct006,g_xcct.xcct007,g_xcct.xcct008,g_xcct.xcct009,g_xcct.xcct010,g_xcct.xcct011,g_xcct.xcct012,g_xcct.xcct013,
                g_xcct.xcct014,g_xcct.xcct015,g_xcct.xcct016,g_xcct.xcct017,
                g_xcct.xcct101,g_xcct.xcct102,g_xcct.xcct102a,g_xcct.xcct102b,g_xcct.xcct102c,g_xcct.xcct102d,g_xcct.xcct102e,g_xcct.xcct102f,g_xcct.xcct102g,g_xcct.xcct102h,
                g_xcct.xcct201,g_xcct.xcct202,g_xcct.xcct202a,g_xcct.xcct202b,g_xcct.xcct202c,g_xcct.xcct202d,g_xcct.xcct202e,g_xcct.xcct202f,g_xcct.xcct202g,g_xcct.xcct202h,
                g_xcct.xcct901,g_xcct.xcct902,g_xcct.xcct902a,g_xcct.xcct902b,g_xcct.xcct902c,g_xcct.xcct902d,g_xcct.xcct902e,g_xcct.xcct902f,g_xcct.xcct902g,g_xcct.xcct902h,
                g_xcct.xcctcrtdt)
   
   IF SQLCA.SQLCODE AND (NOT cl_err_sql_dup_value(SQLCA.SQLCODE)) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcct_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(g_xcct.xcct001,g_xcct.xcct002,g_xcct.xcct004,g_xcct.xcct005,
                               g_xcct.xcct010,g_xcct.xcct011,g_xcct.xcct012,'1',
                               g_xcct.xcct007,g_xcct.xcct008,g_xcct.xcct009,'',
                               SQLCA.sqlcode,'','INSERT INTO xcct_t')                                  
      RETURN r_success
   END IF     
   IF cl_err_sql_dup_value(SQLCA.SQLCODE) THEN 
      UPDATE xcct_t SET xcct201  = xcct201  + g_xcct.xcct201 ,
                        xcct202  = xcct202  + g_xcct.xcct202 ,
                        xcct202a = xcct202a + g_xcct.xcct202a,
                        xcct202b = xcct202b + g_xcct.xcct202b,
                        xcct202c = xcct202c + g_xcct.xcct202c,
                        xcct202d = xcct202d + g_xcct.xcct202d,
                        xcct202e = xcct202e + g_xcct.xcct202e,
                        xcct202f = xcct202f + g_xcct.xcct202f,
                        xcct202g = xcct202g + g_xcct.xcct202g,
                        xcct202h = xcct202h + g_xcct.xcct202h,
                        xcct901  = xcct901  + g_xcct.xcct901 ,
                        xcct902  = xcct902  + g_xcct.xcct902 ,
                        xcct902a = xcct902a + g_xcct.xcct902a,
                        xcct902b = xcct902b + g_xcct.xcct902b,
                        xcct902c = xcct902c + g_xcct.xcct902c,
                        xcct902d = xcct902d + g_xcct.xcct902d,
                        xcct902e = xcct902e + g_xcct.xcct902e,
                        xcct902f = xcct902f + g_xcct.xcct902f,
                        xcct902g = xcct902g + g_xcct.xcct902g,
                        xcct902h = xcct902h + g_xcct.xcct902h,
                        xcctcrtdt = g_xcct.xcctcrtdt
         WHERE xcctent = g_enterprise AND xcctld = g_xcct.xcctld 
           AND xcct001 = g_xcct.xcct001 AND xcct002 = g_xcct.xcct002
           AND xcct003 = g_xcct.xcct003 AND xcct004 = g_xcct.xcct004 AND xcct005 = g_xcct.xcct005
           AND xcct006 = g_xcct.xcct006 AND xcct007 = g_xcct.xcct007 AND xcct008 = g_xcct.xcct008
           AND xcct009 = g_xcct.xcct009 AND xcct010 = g_xcct.xcct010 AND xcct011 = g_xcct.xcct011
           AND xcct012 = g_xcct.xcct012
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.extend = "UPDATE xcct_t"
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CALL s_axcp500_ins_error(g_xcct.xcct001,g_xcct.xcct002,g_xcct.xcct004,g_xcct.xcct005,
                                  g_xcct.xcct010,g_xcct.xcct011,g_xcct.xcct012,'1',
                                  g_xcct.xcct007,g_xcct.xcct008,g_xcct.xcct009,'',
                                  SQLCA.sqlcode,'','UPDATE xcct_t')                                  
         RETURN r_success
      END IF         
   END IF
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: xcct重要字段若为NULL时,置为0
# Memo...........:
# Usage..........: CALL s_axcp500_set_xcct_null_to_zero()
#                       RETURNING r_xcct
# Input parameter: p_xcct         xcct的TABLE资料
# Return code....: r_xcct         xcct的TABLE资料
# Date & Author..: 2017-01-24 By lixiang
# Modify.........: #161230-00010#7 add
################################################################################
PUBLIC FUNCTION s_axcp500_set_xcct_null_to_zero()

   IF cl_null( g_xcct.xcct101 ) THEN LET g_xcct.xcct101 = 0 END IF
   IF cl_null( g_xcct.xcct102 ) THEN LET g_xcct.xcct102 = 0 END IF
   IF cl_null( g_xcct.xcct102a) THEN LET g_xcct.xcct102a = 0 END IF
   IF cl_null( g_xcct.xcct102b) THEN LET g_xcct.xcct102b = 0 END IF
   IF cl_null( g_xcct.xcct102c) THEN LET g_xcct.xcct102c = 0 END IF
   IF cl_null( g_xcct.xcct102d) THEN LET g_xcct.xcct102d = 0 END IF
   IF cl_null( g_xcct.xcct102e) THEN LET g_xcct.xcct102e = 0 END IF
   IF cl_null( g_xcct.xcct102f) THEN LET g_xcct.xcct102f = 0 END IF
   IF cl_null( g_xcct.xcct102g) THEN LET g_xcct.xcct102g = 0 END IF
   IF cl_null( g_xcct.xcct102h) THEN LET g_xcct.xcct102h = 0 END IF
                                         
   IF cl_null( g_xcct.xcct201 ) THEN LET g_xcct.xcct201 = 0 END IF
   IF cl_null( g_xcct.xcct202 ) THEN LET g_xcct.xcct202 = 0 END IF
   IF cl_null( g_xcct.xcct202a) THEN LET g_xcct.xcct202a = 0 END IF
   IF cl_null( g_xcct.xcct202b) THEN LET g_xcct.xcct202b = 0 END IF
   IF cl_null( g_xcct.xcct202c) THEN LET g_xcct.xcct202c = 0 END IF
   IF cl_null( g_xcct.xcct202d) THEN LET g_xcct.xcct202d = 0 END IF
   IF cl_null( g_xcct.xcct202e) THEN LET g_xcct.xcct202e = 0 END IF
   IF cl_null( g_xcct.xcct202f) THEN LET g_xcct.xcct202f = 0 END IF
   IF cl_null( g_xcct.xcct202g) THEN LET g_xcct.xcct202g = 0 END IF
   IF cl_null( g_xcct.xcct202h) THEN LET g_xcct.xcct202h = 0 END IF
   
   IF cl_null( g_xcct.xcct901 ) THEN LET g_xcct.xcct901 = 0 END IF
   IF cl_null( g_xcct.xcct902 ) THEN LET g_xcct.xcct902 = 0 END IF
   IF cl_null( g_xcct.xcct902a) THEN LET g_xcct.xcct902a = 0 END IF
   IF cl_null( g_xcct.xcct902b) THEN LET g_xcct.xcct902b = 0 END IF
   IF cl_null( g_xcct.xcct902c) THEN LET g_xcct.xcct902c = 0 END IF
   IF cl_null( g_xcct.xcct902d) THEN LET g_xcct.xcct902d = 0 END IF
   IF cl_null( g_xcct.xcct902e) THEN LET g_xcct.xcct902e = 0 END IF
   IF cl_null( g_xcct.xcct902f) THEN LET g_xcct.xcct902f = 0 END IF
   IF cl_null( g_xcct.xcct902g) THEN LET g_xcct.xcct902g = 0 END IF
   IF cl_null( g_xcct.xcct902h) THEN LET g_xcct.xcct902h = 0 END IF
   
END FUNCTION

################################################################################
# Descriptions...: 在制成本异动资料插入xcct_t
# Memo...........:
# Usage..........: CALL s_axcp500_upd_xcct()
#                       RETURNING r_success
# Input parameter: p_xcct         xcct_t资料
# Return code....: r_success      成功否标识符
# Date & Author..: 2017-01-24 By lixiang
# Modify.........: #161230-00010#7 add
################################################################################
PUBLIC FUNCTION s_axcp500_upd_xcct()
DEFINE r_success       LIKE type_t.num5
       
   WHENEVER ERROR CONTINUE
   
   LET r_success = FALSE
   
   #CALL s_axcp500_set_xcct_null_to_zero()

   UPDATE xcct_t SET xcct901  =  g_xcct.xcct901 ,
                     xcct902  =  g_xcct.xcct902 ,
                     xcct902a =  g_xcct.xcct902a,
                     xcct902b =  g_xcct.xcct902b,
                     xcct902c =  g_xcct.xcct902c,
                     xcct902d =  g_xcct.xcct902d,
                     xcct902e =  g_xcct.xcct902e,
                     xcct902f =  g_xcct.xcct902f,
                     xcct902g =  g_xcct.xcct902g,
                     xcct902h =  g_xcct.xcct902h,
                     xcctcrtdt = g_xcct.xcctcrtdt
      WHERE xcctent = g_enterprise AND xcctld = g_xcct.xcctld 
        AND xcct001 = g_xcct.xcct001 AND xcct002 = g_xcct.xcct002
        AND xcct003 = g_xcct.xcct003 AND xcct004 = g_xcct.xcct004 AND xcct005 = g_xcct.xcct005
        AND xcct006 = g_xcct.xcct006 AND xcct007 = g_xcct.xcct007 AND xcct008 = g_xcct.xcct008
        AND xcct009 = g_xcct.xcct009 AND xcct010 = g_xcct.xcct010 AND xcct011 = g_xcct.xcct011
        AND xcct012 = g_xcct.xcct012
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE xcct_t"
      LET g_errparam.popup  = TRUE
      CALL cl_err()
      CALL s_axcp500_ins_error(g_xcct.xcct001,g_xcct.xcct002,g_xcct.xcct004,g_xcct.xcct005,
                               g_xcct.xcct010,g_xcct.xcct011,g_xcct.xcct012,'1',
                               g_xcct.xcct007,g_xcct.xcct008,g_xcct.xcct009,'',
                               SQLCA.sqlcode,'','UPDATE xcct_t')                                  
      RETURN r_success
   END IF   
   
   LET r_success = TRUE
   RETURN r_success
   
END FUNCTION

################################################################################
# Descriptions...: 取得拆件工单的入库成本--BY料件及占比
# Memo...........:
# Usage..........: CALL s_axcp500_disassemble_get_store_in_sum(p_xcci001,p_xcci002,p_qty,p_xcci006,p_xcci007,p_site,p_xcck010,p_xcck006,p_xcck007,p_xcck008,p_xcck009)
#                       RETURNING r_sum
# Input parameter: p_xcci001      记账本位币顺序
#                : p_xcci002      成本域
#                : p_qty          异动数量
#                : p_xcci006      工单单号
#                : p_xcci007      生产主件
#                : p_site         营运据点
#                : p_xcck010      料件编号
#                : p_xcck006      单号
#                : p_xcck007      项次
#                : p_xcck008      项序
#                : p_xcck009      出入库码
# Return code....: r_sum          成本金额
# Date & Author..: 2017-06-12 By lixiang
# Modify.........: #170609-00032#1 add
################################################################################
PUBLIC FUNCTION s_axcp500_disassemble_get_store_in_sum(p_xcci001,p_xcci002,p_qty,p_xcci006,p_xcci007,p_xcci008,p_xcci009,p_xcck049,p_site,p_xcck010,p_xcck006,p_xcck007,p_xcck008,p_xcck009)
   DEFINE p_xcci001       LIKE xccc_t.xccc001
   DEFINE p_xcci002       LIKE xcci_t.xcci002
   DEFINE p_qty           LIKE xcci_t.xcci301
   DEFINE p_xcci006       LIKE xcci_t.xcci006
   DEFINE p_xcci007       LIKE xcci_t.xcci007
   DEFINE p_xcci008       LIKE xcci_t.xcci008
   DEFINE p_xcci009       LIKE xcci_t.xcci009
   DEFINE p_xcck049       LIKE xcck_t.xcck049
   DEFINE p_site          LIKE xcck_t.xccksite
   DEFINE p_xcck010       LIKE xcck_t.xcck010
   DEFINE p_xcck006       LIKE xcck_t.xcck006
   DEFINE p_xcck007       LIKE xcck_t.xcck007
   DEFINE p_xcck008       LIKE xcck_t.xcck008
   DEFINE p_xcck009       LIKE xcck_t.xcck009
   DEFINE r_sum           RECORD
                          tot  LIKE xccc_t.xccc202,
                          a    LIKE xccc_t.xccc202a,
                          b    LIKE xccc_t.xccc202b,
                          c    LIKE xccc_t.xccc202c,
                          d    LIKE xccc_t.xccc202d,
                          e    LIKE xccc_t.xccc202e,
                          f    LIKE xccc_t.xccc202f,
                          g    LIKE xccc_t.xccc202g,
                          h    LIKE xccc_t.xccc202h
                          END RECORD 
   DEFINE l_xcci301       LIKE xcci_t.xcci301
   DEFINE l_rate          LIKE type_t.num20_6
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_xcbp006       LIKE xcbp_t.xcbp006
   DEFINE l_done          type_g_std_cost
   DEFINE l_total         type_g_std_cost
   DEFINE l_mine          type_g_std_cost
   DEFINE l_sum           LIKE xcck_t.xcck202
   DEFINE l_cnt           LIKE type_t.num5     


   WHENEVER ERROR CONTINUE

   SELECT xcci301,xcci302 ,xcci302a,xcci302b,  #本期转出数量，本期转出金额
                  xcci302c,xcci302d,xcci302e,
                  xcci302f,xcci302g,xcci302h
     INTO l_xcci301,r_sum.*
     FROM xcci_t
    WHERE xccient = g_enterprise
      AND xccild  = g_ld
      AND xcci001 = p_xcci001
      AND xcci002 = p_xcci002
      AND xcci003 = g_xcat001
      AND xcci004 = g_yy
      AND xcci005 = g_pp
      AND xcci006 = p_xcci006 #工单单号  
      AND xcci007 = p_xcci007
      AND xcci008 = p_xcci008
      AND xcci009 = p_xcci009
      
   IF cl_null(r_sum.a) THEN LET r_sum.a = 0 END IF
   IF cl_null(r_sum.b) THEN LET r_sum.b = 0 END IF
   IF cl_null(r_sum.c) THEN LET r_sum.c = 0 END IF
   IF cl_null(r_sum.d) THEN LET r_sum.d = 0 END IF
   IF cl_null(r_sum.e) THEN LET r_sum.e = 0 END IF
   IF cl_null(r_sum.f) THEN LET r_sum.f = 0 END IF
   IF cl_null(r_sum.g) THEN LET r_sum.g = 0 END IF
   IF cl_null(r_sum.h) THEN LET r_sum.h = 0 END IF
   
   #l_total为工单的总转出
   LET l_total.sum = r_sum.tot
   LET l_total.a   = r_sum.a
   LET l_total.b   = r_sum.b
   LET l_total.c   = r_sum.c
   LET l_total.d   = r_sum.d
   LET l_total.e   = r_sum.e
   LET l_total.f   = r_sum.f
   LET l_total.g   = r_sum.g
   LET l_total.h   = r_sum.h
   
   #本次的转出量
   #取得联产品比率
   CALL s_axcp500_coproduct_get_share_rate(p_site,p_xcci006,p_xcck049,p_xcck010)
        RETURNING l_success,l_xcbp006  #联产期分配率
   IF NOT l_success OR cl_null(l_xcbp006) OR l_xcbp006 = 0 THEN
      LET l_xcbp006 = 100
   END IF
   #LET l_xcci301 = l_xcci301 / l_xcbp006 * 100  #170705-00006#1 mark
   #170705-00006#1 add(S)
   IF l_xcbp006 <> 0 THEN
      LET l_xcci301 = l_xcci301 / l_xcbp006 * 100
   ELSE 
      LET l_xcci301 = 0
   END IF      
   #170705-00006#1 add(E)
   IF l_xcci301 = p_qty * -1 THEN
      LET r_sum.a   = r_sum.a * -1
      LET r_sum.b   = r_sum.b * -1
      LET r_sum.c   = r_sum.c * -1
      LET r_sum.d   = r_sum.d * -1
      LET r_sum.e   = r_sum.e * -1
      LET r_sum.f   = r_sum.f * -1
      LET r_sum.g   = r_sum.g * -1
      LET r_sum.h   = r_sum.h * -1
      LET r_sum.tot = r_sum.a + r_sum.b + r_sum.c + r_sum.d + r_sum.e + r_sum.f + r_sum.g + r_sum.h   
   ELSE
      #170705-00006#1 mark(S)
      #LET r_sum.a   = r_sum.a / l_xcci301 * p_qty
      #LET r_sum.b   = r_sum.b / l_xcci301 * p_qty
      #LET r_sum.c   = r_sum.c / l_xcci301 * p_qty
      #LET r_sum.d   = r_sum.d / l_xcci301 * p_qty
      #LET r_sum.e   = r_sum.e / l_xcci301 * p_qty
      #LET r_sum.f   = r_sum.f / l_xcci301 * p_qty
      #LET r_sum.g   = r_sum.g / l_xcci301 * p_qty
      #LET r_sum.h   = r_sum.h / l_xcci301 * p_qty
      #170705-00006#1 mark(E)
      #170705-00006#1 add(S)
      IF l_xcci301 * p_qty <> 0 THEN
         LET r_sum.a   = r_sum.a / l_xcci301 * p_qty
         LET r_sum.b   = r_sum.b / l_xcci301 * p_qty
         LET r_sum.c   = r_sum.c / l_xcci301 * p_qty
         LET r_sum.d   = r_sum.d / l_xcci301 * p_qty
         LET r_sum.e   = r_sum.e / l_xcci301 * p_qty
         LET r_sum.f   = r_sum.f / l_xcci301 * p_qty
         LET r_sum.g   = r_sum.g / l_xcci301 * p_qty
         LET r_sum.h   = r_sum.h / l_xcci301 * p_qty
      ELSE 
         LET r_sum.a   = 0
         LET r_sum.b   = 0
         LET r_sum.c   = 0
         LET r_sum.d   = 0
         LET r_sum.e   = 0
         LET r_sum.f   = 0
         LET r_sum.g   = 0
         LET r_sum.h   = 0
      END IF 
      #170705-00006#1 add(E)      
      LET r_sum.tot = r_sum.a + r_sum.b + r_sum.c + r_sum.d + r_sum.e + r_sum.f + r_sum.g + r_sum.h
   END IF
   
   #取位
   CALL s_num_round(g_round_type,r_sum.tot,g_curr[p_xcci001].digit2) RETURNING r_sum.tot
   CALL s_num_round(g_round_type,r_sum.a,  g_curr[p_xcci001].digit2) RETURNING r_sum.a
   CALL s_num_round(g_round_type,r_sum.b,  g_curr[p_xcci001].digit2) RETURNING r_sum.b
   CALL s_num_round(g_round_type,r_sum.c,  g_curr[p_xcci001].digit2) RETURNING r_sum.c
   CALL s_num_round(g_round_type,r_sum.d,  g_curr[p_xcci001].digit2) RETURNING r_sum.d
   CALL s_num_round(g_round_type,r_sum.e,  g_curr[p_xcci001].digit2) RETURNING r_sum.e
   CALL s_num_round(g_round_type,r_sum.f,  g_curr[p_xcci001].digit2) RETURNING r_sum.f
   CALL s_num_round(g_round_type,r_sum.g,  g_curr[p_xcci001].digit2) RETURNING r_sum.g
   CALL s_num_round(g_round_type,r_sum.h,  g_curr[p_xcci001].digit2) RETURNING r_sum.h   
   
   #1分钱的问题
   #ex:xcci 入库数量 =100.000000 人工=13078.890000
   #   xcck 入库数量 =30.000000  人工=3923.67
   #   xcck 入库数量 =50.000000  人工=6539.45
   #   xcck 入库数量 =20.000000  人工=2615.78
   #   SUM(xcck入库数量)=100 SUM(人工)=13078.9
   #xcci的人工和SUM(xcck的人工)=13078.89 - 13078.9 = -0.01
   #xcck的数量<>xcci301,因为会有联产品比率的缘故,若要用数量来算的话,效率太差,要FOREACH所有资料再*联产品比例
   #目前只用0.01来做比较,若有<=0.01的差异的话,直接吸收

   LET l_done.sum = 0 LET l_done.a = 0 LET l_done.b = 0 LET l_done.c = 0 LET l_done.d = 0
                      LET l_done.e = 0 LET l_done.f = 0 LET l_done.g = 0 LET l_done.h = 0
   #全部已经入库的金额
   EXECUTE s_axcp500_def_cursor_p32 USING p_xcci001,p_xcci006,p_xcci007,p_xcci008,p_xcci009
                                  INTO l_done.*
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 'EXECUTE s_axcp500_def_cursor_p32'
      LET g_errparam.popup  = TRUE
      CALL cl_err()  
      CALL s_axcp500_ins_error('','','','',p_xcci006,'','','','','','',
                               '',SQLCA.sqlcode,'','EXECUTE s_axcp500_def_cursor_p32')         
      RETURN r_sum.* 
   END IF

   IF cl_null(l_done.sum) THEN LET l_done.sum = 0 END IF
   IF cl_null(l_done.a)   THEN LET l_done.a   = 0 END IF
   IF cl_null(l_done.b)   THEN LET l_done.b   = 0 END IF
   IF cl_null(l_done.c)   THEN LET l_done.c   = 0 END IF
   IF cl_null(l_done.d)   THEN LET l_done.d   = 0 END IF
   IF cl_null(l_done.e)   THEN LET l_done.e   = 0 END IF
   IF cl_null(l_done.f)   THEN LET l_done.f   = 0 END IF
   IF cl_null(l_done.g)   THEN LET l_done.g   = 0 END IF
   IF cl_null(l_done.h)   THEN LET l_done.h   = 0 END IF

   #联产品时,可能已经计算过,本笔要排除掉
   LET l_mine.sum = 0 LET l_mine.a = 0 LET l_mine.b = 0 LET l_mine.c = 0 LET l_mine.d = 0
                      LET l_mine.e = 0 LET l_mine.f = 0 LET l_mine.g = 0 LET l_mine.h = 0   
   EXECUTE s_axcp500_def_cursor_p33 USING p_xcci001,p_xcci006,p_xcck006,p_xcck007,p_xcck008,p_xcck009
                                  INTO l_mine.*
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code   = SQLCA.sqlcode
      LET g_errparam.extend = 'EXECUTE s_axcp500_def_cursor_p33'
      LET g_errparam.popup  = TRUE
      CALL cl_err()  
      CALL s_axcp500_ins_error('','','','',p_xcci006,'','','','','','',
                               '',SQLCA.sqlcode,'','EXECUTE s_axcp500_def_cursor_p33')         
      RETURN r_sum.* 
   END IF                      
                      
   IF cl_null(l_mine.sum) THEN LET l_mine.sum = 0 END IF
   IF cl_null(l_mine.a)   THEN LET l_mine.a   = 0 END IF
   IF cl_null(l_mine.b)   THEN LET l_mine.b   = 0 END IF
   IF cl_null(l_mine.c)   THEN LET l_mine.c   = 0 END IF
   IF cl_null(l_mine.d)   THEN LET l_mine.d   = 0 END IF
   IF cl_null(l_mine.e)   THEN LET l_mine.e   = 0 END IF
   IF cl_null(l_mine.f)   THEN LET l_mine.f   = 0 END IF
   IF cl_null(l_mine.g)   THEN LET l_mine.g   = 0 END IF
   IF cl_null(l_mine.h)   THEN LET l_mine.h   = 0 END IF
   
   #先調每一張合計的xcck202，避免之後再次被調整
   LET r_sum.tot = r_sum.a+r_sum.b+r_sum.c+r_sum.d+r_sum.e+r_sum.f+r_sum.g+r_sum.h

   #判斷最後一張入庫單(所有的工單都有金額了，再來做處理)
   LET l_cnt = 0
   SELECT COUNT(1) INTO l_cnt FROM xcck_tmp
    WHERE xcckent = g_enterprise
      AND xcckld  = g_ld
      AND xcck001 = p_xcci001
      AND xcck003 = g_xcat001
      AND xcck004 = g_yy
      AND xcck005 = g_pp
      AND xcck047 = p_xcci006
      AND xcck055 = '3012' AND (xcck020 = '113' OR xcck020 = '106') #拆件入库
      AND xcck202 = 0
      AND xcck201 = p_qty
      AND xcck201 = (SELECT MAX(xcck201) FROM xcck_tmp
                      WHERE xcckent = g_enterprise
                        AND xcckld  = g_ld
                        AND xcck001 = p_xcci001
                        AND xcck003 = g_xcat001
                        AND xcck004 = g_yy
                        AND xcck005 = g_pp
                        AND xcck047 = p_xcci006
                        AND xcck055 = '3012' AND (xcck020 = '113' OR xcck020 = '106'))         

   IF l_cnt = 1 THEN  #判斷是最後一張入庫單，把剩下的金額直接給此張入庫單
      LET r_sum.tot = (l_total.sum + l_done.sum) * -1
      LET r_sum.a   = (l_total.a   + l_done.a) * -1
      LET r_sum.b   = (l_total.b   + l_done.b) * -1
      LET r_sum.c   = (l_total.c   + l_done.c) * -1
      LET r_sum.d   = (l_total.d   + l_done.d) * -1
      LET r_sum.e   = (l_total.e   + l_done.e) * -1
      LET r_sum.f   = (l_total.f   + l_done.f) * -1
      LET r_sum.g   = (l_total.g   + l_done.g) * -1
      LET r_sum.h   = (l_total.h   + l_done.h) * -1
   END IF

   RETURN r_sum.*
      
END FUNCTION

 
{</section>}
 

```sql
SELECT curr,
       SUM(amt),
       SUM(amt2),
       SUM(amt3),
       SUM(amt4),
       SUM(amt5),
       SUM(amt6),
       SUM(amt7),
       SUM(amt8)
  FROM ((SELECT xccd011 curr,
                SUM(xccd902a) amt,
                SUM(xccd902b) amt2,
                SUM(xccd902c) amt3,
                SUM(xccd902d) amt4,
                SUM(xccd902e) amt5,
                SUM(xccd902f) amt6,
                SUM(xccd902g) amt7,
                SUM(xccd902h) amt8
           FROM xccd_t, xcbb_t
          WHERE xccdent = xcbbent
            AND xccd004 = xcbb001
            AND xccd005 = xcbb002
            AND xccd007 = xcbb003
            AND xccdent = 8
            AND xccdld = 'HB001'
            AND xccd001 = '1'
            AND xccd004 = 2020
            AND xccd005 = 9
            AND xcbbcomp = 'HB001'
            AND 1 = 1
            AND (xcbb010 IS NULL OR
                xcbb010 NOT IN (SELECT DISTINCT glcc011
                                   FROM glcc_t
                                  WHERE glccent = 8
                                    AND glccld = 'HB001'
                                    AND glcc001 = '3'
                                    AND glcc011 <> '*'))
            AND xccd006 IN (SELECT sfaadocno
                              FROM sfaa_t
                             WHERE sfaaent = 8
                               AND sfaa057 <> '2')
          GROUP BY xccd011) UNION
        (SELECT xcch011 curr,
                SUM(xcch902a) amt,
                SUM(xcch902b) amt2,
                SUM(xcch902c) amt3,
                SUM(xcch902d) amt4,
                SUM(xcch902e) amt5,
                SUM(xcch902f) amt6,
                SUM(xcch902g) amt7,
                SUM(xcch902h) amt8
           FROM xcch_t, xcbb_t
          WHERE xcchent = xcbbent
            AND xcch004 = xcbb001
            AND xcch005 = xcbb002
            AND xcch007 = xcbb003
            AND xcchent = 8
            AND xcchld = 'HB001'
            AND xcch001 = '1'
            AND xcch004 = 2020
            AND xcch005 = 9
            AND xcbbcomp = 'HB001'
            AND 1 = 1
            AND (xcbb010 IS NULL OR
                xcbb010 NOT IN (SELECT DISTINCT glcc011
                                   FROM glcc_t
                                  WHERE glccent = 8
                                    AND glccld = 'HB001'
                                    AND glcc001 = '3'
                                    AND glcc011 <> '*'))
          GROUP BY xcch011))
 GROUP BY curr
 ORDER BY curr

```



